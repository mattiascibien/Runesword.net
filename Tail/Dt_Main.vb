Option Strict Off
Option Explicit On
Imports VB = Microsoft.VisualBasic
Friend Class frmMain
	Inherits System.Windows.Forms.Form
	
	Dim isGameInit As Boolean
	Dim EncNow As Encounter ' [Titi 2.5.1] used to save EncounterNow when EnterEncounter finishes (in case RealTimeEvents messes with it because it fires at the same time!)
	Dim IsHomeTome As Boolean ' [Titi 2.5.1] flag to ensure ALL areas are saved where they should!
	Dim TurnsBeforeNextCamp As Short ' [Titi 2.5.1] used to ensure "Camp" is not used too often
	Dim FilterStatus(3) As Boolean ' [Titi 2.5.1] display the skill if True (0=always on, 1=on call, 2=spells, 3=special)
	Public EncounterTargetInArea As Encounter ' [Titi 2.5.1] keeps all the changes made to EncounterTarget when it's in a different area
	Public intCountEncounterTarget As Short ' [Titi 2.5.1] increased each time a TargetEncounterInArea statement is executed (used to keep the information of several TargetEncounterInArea)
	Dim ListEncounterTarget(255) As Encounter ' [Titi 2.5.1] array used to save all the EncounterTargetInArea
	Dim OnAdventureList() As String
	Dim OnAdventureListMaster() As String ' [Titi 2.6.0] array used to store the names of the tomes where creatures in the roster are (optimises the speed of the code)
	Dim sHint As String ' [Titi 2.6.0] to create some sort of balloon tip behavior
	
	'*************************************************************************
	' Combat related variables
	'*************************************************************************
	'Dim Turns(48) As Grid
	'UPGRADE_NOTE: Paint was upgraded to Paint_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Dim Paint_Renamed(48) As Short
	Dim CombatTurn As Short
	Dim TurnNow As Short
	Dim Target As Short
	Dim CombatMouseX, CombatMouseY As Short
	Dim LastTarget As Short
	Dim TargetCreatureRange As Short
	Dim CombatStepRow(50) As Short
	Dim CombatStepCol(50) As Short
	Dim CombatStepTop As Short
	Dim Combat20Bonus, Combat20, CombatDmgBonus As Short
	Dim CombatDiceType(5) As Short
	Dim CombatDiceValue(5) As Short
	Dim HiddenBonus As Boolean ' [Titi 2.4.9b]
	Dim bFromMainMenu As Boolean ' [Titi 2.4.9b]
	Dim bKeepWeapon As Boolean ' [Titi 2.6.0] tells NPC equipped with ranged weapon when to switch to close combat
	Dim iItemTop As Short
	
	Const bdCombatGridWidth As Short = 48
	Const bdCombatGridHeight As Short = 24
	Const bdCombatTop As Short = 135
	Const bdCombatLeft As Short = 12
	Const bdContextDice As Short = 31
	
	Public Enum MOVEDIRECTION
		bdMoveToward = 0
		bdMoveAway = 1
		bdMoveClick = 2
		bdMoveFlee = 3
	End Enum
	
	Public Enum MOVEMOTIVE
		bdMoveClosest = 0
		bdMoveFarthest = 1
		bdMoveStrongest = 2
		bdMoveWeakest = 3
		bdMoveRandom = 4
		bdMoveTarget = 5
		bdMoveRange = 6 ' [Titi 2.6.0]
	End Enum
	
	Const bdSFXFromHead As Short = 0
	Const bdSFXFromCenter As Short = 1
	Const bdSFXFling As Short = 0
	Const bdSFXStream As Short = 1
	Const bdSFXBurstHere As Short = 2
	Const bdSFXBurstThere As Short = 3
	Const bdSFXDown As Short = 4
	Const bdSFXAround As Short = 5
	Const bdSFXArch As Short = 6
	Const bdSFXSlow As Short = 0
	Const bdSFXMedium As Short = 1
	Const bdSFXFast As Short = 2
	
	Const bdCombatAttitudeWait As Short = 1
	Const bdCombatAttitudeWait2 As Short = 2
	Const bdCombatAttitudeDefend As Short = 3
	Const bdCombatAttitudeGuard As Short = 4 ' [Titi 2.5.1]
	
	' Variables to store picture file names and info
	Dim TileSetLoaded As String
	Dim SFXFile() As String
	Dim MaxSFX As Short
	Dim CommonScale As Double
	Dim PicSize As Double
	Dim LosDir(5, 5) As Short
	Dim picBlackHeightSmall As Short
	Const bdBlackWidth As Short = 288
	Dim MicroMapScale As Double
	
	' Variables for in game Menus
	Dim PartyLeft As Short
	Dim SplashNow, KillSplash As Short
	Dim CutSceneNow As Short
	Dim ActionNow As Short
	Dim MenuNow As Short
	Dim ClickY, ClickX, ClickZ As Short
	Dim HintX, HintY As Short
	Dim RuneMenuX(19) As Short
	Dim RuneMenuY(19) As Short
	Dim BtnClick As Short
	Dim TargetAllowDead As Short
	Const bdMenuActionDefault As Short = -1
	Const bdMenuDefault As Short = 0
	Const bdMenuOptions As Short = 1
	Const bdMenuInventory As Short = 3
	Const bdMenuSearch As Short = 4
	Const bdMenuTalkWith As Short = 7
	Const bdMenuEncounter As Short = 9
	Const bdMenuMapParty As Short = 10
	Const bdCombatMenuPC As Short = 13
	Const bdMenuTargetCreature As Short = 15
	Const bdMenuTargetItem As Short = 16
	Const bdMenuTargetAny As Short = 17
	Const bdMenuTargetParty As Short = 18
	
	' Variables for find path routine
	Dim DirX(7) As Short
	Dim DirY(7) As Short
	Dim TotalStepsTaken As Short
	
	' Constants for drawing the map
	Const bdMapBottom As Short = 0
	Const bdMapMiddle As Short = 1
	Const bdMapItems As Short = 2
	Const bdMapMonsters As Short = 3
	Const bdMapParty As Short = 4
	Const bdMapDoors As Short = 5
	Const bdMapTop As Short = 6
	Const bdMapDim As Short = 7
	
	Private WorldIndex As Short
	Private ScrollWorldDesc As Short
	
	Private FromEntryPoint As EntryPoint
	
	Private Const MM_TEXT As Short = 1
	Private Structure TEXTMETRIC
		Dim tmHeight As Integer
		Dim tmAscent As Integer
		Dim tmDescent As Integer
		Dim tmInternalLeading As Integer
		Dim tmExternalLeading As Integer
		Dim tmAveCharWidth As Integer
		Dim tmMaxCharWidth As Integer
		Dim tmWeight As Integer
		Dim tmOverhang As Integer
		Dim tmDigitizedAspectX As Integer
		Dim tmDigitizedAspectY As Integer
		Dim tmFirstChar As Byte
		Dim tmLastChar As Byte
		Dim tmDefaultChar As Byte
		Dim tmBreakChar As Byte
		Dim tmItalic As Byte
		Dim tmUnderlined As Byte
		Dim tmStruckOut As Byte
		Dim tmPitchAndFamily As Byte
		Dim tmCharSet As Byte
	End Structure
	'UPGRADE_WARNING: Structure TEXTMETRIC may require marshalling attributes to be passed as an argument in this Declare statement. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="C429C3A5-5D47-4CD9-8F51-74A1616405DC"'
	Private Declare Function GetTextMetrics Lib "gdi32"  Alias "GetTextMetricsA"(ByVal hdc As Integer, ByRef lpMetrics As TEXTMETRIC) As Integer
	Private Declare Function SetMapMode Lib "gdi32" (ByVal hdc As Integer, ByVal nMapMode As Integer) As Integer
	Private Declare Function GetDesktopWindow Lib "user32" () As Integer
	Private Declare Function GetWindowDC Lib "user32" (ByVal hWnd As Integer) As Integer
	Private Declare Function ReleaseDC Lib "user32" (ByVal hWnd As Integer, ByVal hdc As Integer) As Integer
	
	'[Titi 2.4.9b] Add tray icon
	Public LastState As Short
	'UPGRADE_ISSUE: Declaring a parameter 'As Any' is not supported. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="FAE78A8D-8978-4FD4-8208-5B7324A8F795"'
	Private Declare Function SendMessage Lib "user32"  Alias "SendMessageA"(ByVal hWnd As Integer, ByVal wMsg As Integer, ByVal wParam As Integer, ByRef lParam As Any) As Integer
	Private Const WM_SYSCOMMAND As Integer = &H112
	Private Const SC_MOVE As Integer = &HF010
	Private Const SC_RESTORE As Integer = &HF120
	Private Const SC_SIZE As Integer = &HF000
	
	Private Declare Function GetAsyncKeyState Lib "user32" (ByVal uAction As Integer) As Integer
	
	Public Sub SetTrayMenuItems(ByRef window_state As Short)
		'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbNormal to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
		Select Case window_state
			Case System.Windows.Forms.FormWindowState.Minimized
				mnuTrayMaximize.Enabled = True
				mnuTrayMinimize.Enabled = False
				mnuTrayMove.Enabled = False
				mnuTrayRestore.Enabled = True
				mnuTraySize.Enabled = False
			Case System.Windows.Forms.FormWindowState.Maximized
				mnuTrayMaximize.Enabled = False
				mnuTrayMinimize.Enabled = True
				mnuTrayMove.Enabled = False
				mnuTrayRestore.Enabled = True
				mnuTraySize.Enabled = False
			Case vbNormal
				mnuTrayMaximize.Enabled = True
				mnuTrayMinimize.Enabled = True
				mnuTrayMove.Enabled = True
				mnuTrayRestore.Enabled = False
				mnuTraySize.Enabled = True
		End Select
	End Sub
	
	Private Sub frmMain_KeyPress(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyPressEventArgs) Handles MyBase.KeyPress
		Dim KeyAscii As Short = Asc(eventArgs.KeyChar)
		If KeyAscii = System.Windows.Forms.Keys.Tab Or KeyAscii = System.Windows.Forms.Keys.Escape Or KeyAscii = System.Windows.Forms.Keys.ControlKey Then
			tmrKeyboardHandler.Enabled = True
		Else
			tmrKeyboardHandler.Enabled = False
		End If
		eventArgs.KeyChar = Chr(KeyAscii)
		If KeyAscii = 0 Then
			eventArgs.Handled = True
		End If
	End Sub
	
	Private Sub frmMain_FormClosed(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.FormClosedEventArgs) Handles Me.FormClosed
		Dim RemoveFromTray As Object
		Dim modGameGeneral As Object
		Dim modRegistry As Object
		' [Titi 2.6.0] feature not available for Win 9x
		'UPGRADE_WARNING: Couldn't resolve default property of object modRegistry.VBWinVer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Mid(modRegistry.VBWinVer, 9, 1) = "9" Or Mid(modRegistry.VBWinVer, 9, 1) = "M" Then Exit Sub
		'UPGRADE_WARNING: Couldn't resolve default property of object modGameGeneral.HookKeyboard. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call modGameGeneral.HookKeyboard(True)
		RemoveFromTray()
	End Sub
	
	Public Sub mnuTrayClose_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuTrayClose.Click
		GameEnd(False)
		Me.Close()
	End Sub
	
	Public Sub mnuTrayMaximize_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuTrayMaximize.Click
		Dim vsPAUSED As Object
		Dim oGameMusic As Object
		WindowState = System.Windows.Forms.FormWindowState.Maximized
		If Not Visible Then Me.Show()
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.Status. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.ResumePlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If oGameMusic.Status = vsPAUSED Then oGameMusic.ResumePlay()
	End Sub
	
	Public Sub mnuTrayMinimize_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuTrayMinimize.Click
		Dim oGameMusic As Object
		Dim modGameGeneral As Object
		WindowState = System.Windows.Forms.FormWindowState.Minimized
		'UPGRADE_WARNING: Couldn't resolve default property of object modGameGeneral.HookKeyboard. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call modGameGeneral.HookKeyboard(True)
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.PausePlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oGameMusic.PausePlay()
	End Sub
	
	Public Sub mnuTrayMove_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuTrayMove.Click
		SendMessage(Handle.ToInt32, WM_SYSCOMMAND, SC_MOVE, 0)
	End Sub
	
	Public Sub mnuTrayRestore_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuTrayRestore.Click
		Dim modGameGeneral As Object
		Dim vsPAUSED As Object
		Dim oGameMusic As Object
		SendMessage(Handle.ToInt32, WM_SYSCOMMAND, SC_RESTORE, 0)
		If Not Visible Then Me.Refresh()
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.Status. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.ResumePlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If oGameMusic.Status = vsPAUSED Then oGameMusic.ResumePlay()
		'UPGRADE_WARNING: Couldn't resolve default property of object modGameGeneral.HookKeyboard. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call modGameGeneral.HookKeyboard(False)
	End Sub
	
	Public Sub mnuTraySize_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuTraySize.Click
		SendMessage(Handle.ToInt32, WM_SYSCOMMAND, SC_SIZE, 0)
	End Sub
	' [Titi 2.4.9b] End of system tray icon addition
	
	Function SmallFonts() As Boolean
		Dim hdc, hWnd As Integer
		Dim PrevMapMode As Integer
		Dim tm As TEXTMETRIC
		' Set the default return value to small fonts
		SmallFonts = True
		' Get the handle of the desktop window
		hWnd = GetDesktopWindow()
		' Get the device context for the desktop
		hdc = GetWindowDC(hWnd)
		If hdc Then
			' Set the mapping mode to pixels
			PrevMapMode = SetMapMode(hdc, MM_TEXT)
			' Get the size of the system font
			GetTextMetrics(hdc, tm)
			' Set the mapping mode back to what it was
			PrevMapMode = SetMapMode(hdc, PrevMapMode)
			' Release the device context
			ReleaseDC(hWnd, hdc)
			' If the system font is more than 16 pixels high, then large fonts are being used
			If tm.tmHeight > 16 Then SmallFonts = False
		End If
	End Function
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function GetRunePool(ByRef Index As Short) As Short
		Dim Map_Renamed As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Runes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GetRunePool = Map.Runes(Index)
	End Function
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub LetRunePool(ByRef Index As Short, ByRef NewValue As Short)
		Dim Map_Renamed As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Runes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Map.Runes(Index) = NewValue
	End Sub
	
	Public Sub CutSceneVideo(ByRef VideoFile As String, Optional ByRef AlternatePath As Object = Nothing)
		Dim oErr As Object
		Dim vsPLAYING As Object
		Dim Frozen As Object
		Dim FileName As String
		Dim PosY As Short
		Dim OldTalk, OldInventory, OldFrozen, OldConvo, OldGrid As Short
		' CutScene trumps everything else
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		OldFrozen = Frozen
		OldInventory = picInventory.Visible
		OldConvo = picConvo.Visible
		OldTalk = picTalk.Visible
		OldGrid = picGrid.Visible
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = True
		picInventory.Visible = False
		picConvo.Visible = False
		picTalk.Visible = False
		picGrid.Visible = False
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		'UPGRADE_ISSUE: PictureBox method picMap.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picMap.Cls()
		' Find location of video
		'    FileName = Dir$(gAppPath & "\data\video\" & VideoFile)
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(gDataPath & "\video\" & VideoFile)
		'UPGRADE_NOTE: IsMissing() was changed to IsNothing(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="8AE1CB93-37AB-439A-A4FF-BE3B6760BB23"'
		If FileName = "" And IsNothing(AlternatePath) = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object AlternatePath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(AlternatePath & "\" & VideoFile)
			If FileName = "" Then
				'            Exit Sub  <-- Bug:  exiting now will not set the parameters back to their previous state
				GoTo BackToPreviousState
			Else
				'ChDir AlternatePath
				'UPGRADE_WARNING: Couldn't resolve default property of object AlternatePath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = AlternatePath & "\" & VideoFile
			End If
		Else
			'    ChDir gAppPath & "\data\video"
			'        FileName = gAppPath & "\data\video\" & VideoFile
			FileName = gDataPath & "\video\" & VideoFile
		End If
		' Center Video display and play
		fraMediaPlayerAVI.Left = 0 : fraMediaPlayerAVI.Top = 0
		fraMediaPlayerAVI.Width = picBox.Width : fraMediaPlayerAVI.Height = picBox.Height
		'    MediaPlayerAVI.Filename = VideoFile
		'    MediaPlayerAVI.Left = 0
		'    MediaPlayerAVI.Top = 0
		'    MediaPlayerAVI.Height = fraMediaPlayerAVI.Height * Screen.TwipsPerPixelY
		'    MediaPlayerAVI.Width = fraMediaPlayerAVI.Width * Screen.TwipsPerPixelX
		'    MediaPlayerAVI.Play
		'UPGRADE_ISSUE: IMCI object was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6B85A2A7-FE9F-4FBE-AA0C-CF11AC86A305"'
		Dim mmAVI As New IMCI
		'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.InitAVI. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If mmAVI.InitAVI(FileName, fraMediaPlayerAVI.Handle.ToInt32, "CutScene") Then
			'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			mmAVI.Left = (fraMediaPlayerAVI.Width - mmAVI.Width) / 2
			'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			mmAVI.Top = (fraMediaPlayerAVI.Height - mmAVI.Height) / 2
			'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.Play. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			mmAVI.Play()
			'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.GetError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If mmAVI.GetError() = 0 Then
				fraMediaPlayerAVI.Visible = True
				picMap.Refresh()
				MessageShow("Click to Continue", 0)
				'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				CutSceneNow = True
				Do Until CutSceneNow = False
					System.Windows.Forms.Application.DoEvents()
					'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.Status. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If mmAVI.Status <> vsPLAYING Then CutSceneNow = False
				Loop 
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.GetError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object oErr.LogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call oErr.LogText("Error CutSceneVideo: Video (#" & mmAVI.GetError() & ")")
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.mciClose. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			mmAVI.mciClose()
			fraMediaPlayerAVI.Visible = False
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object mmAVI.GetError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object oErr.LogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Call oErr.LogText("Error CutSceneVideo: Video (#" & mmAVI.GetError() & ")")
		End If
BackToPreviousState: 
		' Put everything back
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = OldFrozen
		picInventory.Visible = OldInventory
		picConvo.Visible = OldConvo
		picTalk.Visible = OldTalk
		picGrid.Visible = OldGrid
		If picGrid.Visible = True Then
			CombatWallpaper()
			CombatDraw()
		Else
			DrawMapAll()
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub CutScene(ByRef Style As Short, ByRef Text_Renamed As String, ByRef PictureFile As String)
		Dim bdFontNoxiousWhite As Object
		Dim Tome_Renamed As Object
		Dim Frozen As Object
		Dim FileName As String
		Dim PosY As Short
		Dim OldTalk, OldInventory, OldFrozen, OldConvo, OldGrid As Short
		' CutScene trumps everything else
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		OldFrozen = Frozen
		OldInventory = picInventory.Visible
		OldConvo = picConvo.Visible
		OldTalk = picTalk.Visible
		OldGrid = picGrid.Visible
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = True
		picInventory.Visible = False
		picConvo.Visible = False
		picTalk.Visible = False
		picGrid.Visible = False
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		'UPGRADE_ISSUE: PictureBox method picMap.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picMap.Cls()
		'UPGRADE_ISSUE: PictureBox method picWallPaper.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picWallPaper.Cls()
		If PictureFile <> "" And Style < 5 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(Tome.FullPath & "\" & PictureFile)
			If FileName <> "" Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				picWallPaper.Image = System.Drawing.Image.FromFile(Tome.FullPath & "\" & FileName)
			Else
				' [Titi 2.4.9b] why not use cutscenes available in the \data\graphics directory?
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gDataPath & "\Cutscenes\" & PictureFile)
				If FileName <> "" Then
					picWallPaper.Image = System.Drawing.Image.FromFile(gDataPath & "\Cutscenes\" & PictureFile)
				Else
					Style = 5 ' Couldn't load picture, so default to no picture
				End If
			End If
		End If
		Select Case Style
			Case 0 ' Picture Left, Text Right
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				PosY = ShowText(picMap, picWallPaper.Width + 12 + (picBox.Width - 608) / 2, 0, Greatest(608 - picWallPaper.Width - 18, 1), picBox.Height, bdFontNoxiousWhite, Text_Renamed, False, True)
				'UPGRADE_ISSUE: PictureBox method picMap.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picMap.Cls()
				picWallPaper.Top = (picBox.Height - Greatest(PosY, (picWallPaper.Height))) / 2
				picWallPaper.Left = 6 + (picBox.Width - 608) / 2
				picWallPaper.Visible = True
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picMap, picWallPaper.Width + 12 + (picBox.Width - 608) / 2, (picBox.Height - Greatest(PosY, (picWallPaper.Height))) / 2, Greatest(608 - picWallPaper.Width - 18, 1), picBox.Height, bdFontNoxiousWhite, Text_Renamed, False, False)
			Case 1 ' Picture Right, Text Left
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				PosY = ShowText(picMap, 6 + (picBox.Width - 608) / 2, 0, Greatest(608 - picWallPaper.Width - 18, 1), picBox.Height, bdFontNoxiousWhite, Text_Renamed, False, True)
				'UPGRADE_ISSUE: PictureBox method picMap.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picMap.Cls()
				picWallPaper.Top = (picBox.Height - Greatest(PosY, (picWallPaper.Height))) / 2
				picWallPaper.Left = (picBox.Width - 608) / 2 + 12 + Greatest(608 - picWallPaper.Width - 18, 1)
				picWallPaper.Visible = True
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picMap, 6 + (picBox.Width - 608) / 2, (picBox.Height - Greatest(PosY, (picWallPaper.Height))) / 2, Greatest(608 - picWallPaper.Width - 18, 1), picBox.Height, bdFontNoxiousWhite, Text_Renamed, False, False)
			Case 2 ' Picture Top, Text Bottom
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				PosY = ShowText(picMap, (picBox.Width - 608) / 2, 0, 608, picBox.Height, bdFontNoxiousWhite, Text_Renamed, True, True)
				'UPGRADE_ISSUE: PictureBox method picMap.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picMap.Cls()
				picWallPaper.Top = (picBox.Height - PosY - picWallPaper.Height - 6) / 2
				picWallPaper.Left = (picBox.Width - picWallPaper.Width) / 2
				picWallPaper.Visible = True
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picMap, (picBox.Width - 608) / 2, picWallPaper.Top + picWallPaper.Height + 6, 608, picBox.Height, bdFontNoxiousWhite, Text_Renamed, False, True)
			Case 3 ' Picture Bottom, Text Top
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				PosY = ShowText(picMap, (picBox.Width - 608) / 2, 0, 608, picBox.Height, bdFontNoxiousWhite, Text_Renamed, True, True)
				'UPGRADE_ISSUE: PictureBox method picMap.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picMap.Cls()
				picWallPaper.Top = (picBox.Height - PosY - picWallPaper.Height - 6) / 2 + PosY + 6
				picWallPaper.Left = (picBox.Width - picWallPaper.Width) / 2
				picWallPaper.Visible = True
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picMap, (picBox.Width - 608) / 2, (picBox.Height - PosY - picWallPaper.Height - 6) / 2, 608, picBox.Height, bdFontNoxiousWhite, Text_Renamed, False, True)
			Case 4 ' Picture Center
				picWallPaper.Left = (picBox.Width - picWallPaper.Width) / 2
				picWallPaper.Top = (picBox.Height - picWallPaper.Height) / 2
				picWallPaper.Visible = True
			Case 5 ' Text Center
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				PosY = ShowText(picMap, (picBox.Width - 608) / 2, 0, 608, picBox.Height, bdFontNoxiousWhite, Text_Renamed, True, True)
				'UPGRADE_ISSUE: PictureBox method picMap.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picMap.Cls()
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picMap, (picBox.Width - 608) / 2, (picBox.Height - PosY) / 2, 608, picBox.Height, bdFontNoxiousWhite, Text_Renamed, False, True)
		End Select
		picMap.Refresh()
		MessageShow("Click to Continue", 0)
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		CutSceneNow = True
		Do Until CutSceneNow = False
			System.Windows.Forms.Application.DoEvents()
		Loop 
		picWallPaper.Visible = False
		' Put everything back
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = OldFrozen
		picInventory.Visible = OldInventory
		picConvo.Visible = OldConvo
		picTalk.Visible = OldTalk
		picGrid.Visible = OldGrid
		If picGrid.Visible = True Then
			CombatWallpaper()
			CombatDraw()
		End If
	End Sub
	
	Public Sub CutSceneHide()
		picWallPaper.Visible = False
		MessageClear()
		' Redraw Map
		DrawMapAll()
		MoveParty()
		picMap.Refresh()
		Me.Refresh()
		ActionNow = 0
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub MapCenter(ByRef XMap As Short, ByRef YMap As Short)
		Dim Map_Renamed As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Map.Left = XMap + 2
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Map.Top = YMap - Int(System.Math.Sqrt((picMap.ClientRectangle.Width ^ 2) + (picMap.ClientRectangle.Height ^ 2)) / 108) + 1
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub MovePartySet(ByRef AtClickX As Short, ByRef AtClickY As Short, Optional ByRef AtMapX As Object = Nothing, Optional ByRef AtMapY As Object = Nothing)
		Dim GlobalAutoCenter As Object
		Dim Tome_Renamed As Object
		Dim Map_Renamed As Object
		Dim Y, X, c As Short
		Dim MoveToX, MoveToY As Short
		Dim CreatureX As Creature
		'UPGRADE_NOTE: IsMissing() was changed to IsNothing(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="8AE1CB93-37AB-439A-A4FF-BE3B6760BB23"'
		If IsNothing(AtMapX) Or IsNothing(AtMapY) Then
			If Int(AtClickY / 16) Mod 3 = 1 Or (Int(AtClickY / 8) Mod 3 = 1 And Int((AtClickX - 24) / 48) Mod 2 = 0) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MoveToX = Map.Left + Int(AtClickX / 96) - Int(AtClickY / 48)
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MoveToY = Map.Top + Int(AtClickX / 96) + Int(AtClickY / 48)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MoveToX = Map.Left + Int((AtClickX - 48) / 96) - Int((AtClickY - 24) / 48)
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MoveToY = Map.Top + Int((AtClickX + 48) / 96) + Int((AtClickY - 24) / 48)
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object AtMapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MoveToX = CShort(AtMapX)
			'UPGRADE_WARNING: Couldn't resolve default property of object AtMapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MoveToY = CShort(AtMapY)
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.MoveToX = MoveToX
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.MoveToY = MoveToY
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		FindPath(Tome)
		' Play a sound (maybe)
		'    If GlobalWAVState = 1 Then
		'        PlaySound "step" & Int(Rnd * 4) + 1, False
		'    End If
		c = -1
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In Tome.Creatures
			c = LoopNumber(0, 8, c, 1)
			CreatureX.TileSpot = c
		Next CreatureX
		tmrMoveParty.Enabled = True
		'    If GlobalAutoCenter Then ' [Titi 2.4.9]
		If GlobalAutoCenter And 1 Then ' [Titi 2.6.0]
			MapCenter(MoveToX, MoveToY) ' Ephestion [2.4.9]
			DrawMapAll() ' Ephestion [2.4.9]
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function CombatApplyDamage(ByRef Target As Creature, ByRef Damage As Short) As Short
		Dim CreatureTarget As Object
		Dim Tome_Renamed As Object
		Dim PlaySoundFile As Object
		Dim CreatureWithTurn As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim GlobalDamageRoll As Object
		Dim c, NoFail As Short
		Dim ItemX As Item
		Dim CreatureX As Creature
		Dim TriggerX As Trigger
		' If already dead, this does nothing more
		If Target.HPNow < 1 Then
			CombatApplyDamage = 0
			Exit Function
		End If
		' Fire Pre-ApplyDamage
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDamageRoll = Damage
		CreatureNow = Target
		ItemNow = Target.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(Target, bdPreApplyDamage)
		For	Each ItemNow In Target.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemNow.IsReady = True Then
				CreatureNow = Target
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemNow, bdPreApplyDamage)
			End If
		Next ItemNow
		' Apply Damage
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Target.HPNow = Target.HPNow - GlobalDamageRoll
		' Fire Post-ApplyDamage
		CreatureNow = Target
		ItemNow = Target.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(Tome, bdPostApplyDamage)
		CreatureNow = Target
		ItemNow = Target.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(Target, bdPostApplyDamage)
		For	Each ItemNow In Target.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemNow.IsReady = True Then
				CreatureNow = Target
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemNow, bdPostApplyDamage)
			End If
		Next ItemNow
		' Determine if killed
		If Target.HPNow < 1 Then
			' Fire Pre-Death
			CreatureNow = Target
			ItemNow = Target.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(Target, bdPreDeath)
			For	Each ItemNow In Target.Items
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemNow.IsReady = True Then
					CreatureNow = Target
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemNow, bdPreDeath)
				End If
			Next ItemNow
		End If
		' If still dead, then play dead sound
		If Target.HPNow < 1 Then
			' [Titi 2.5.1] update the additional information
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.Infos.KillsCount = CreatureWithTurn.Infos.KillsCount + 1
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatMessage(CreatureWithTurn.Name & " killed " & Target.Name & ".")
			If Target.DieWAV = "" Then
				If Target.Friendly = False Then
					Call PlaySoundFile("MonsDie", Tome,  , 5)
				Else
					If Target.Male = True Then
						Call PlaySoundFile("PCDie", Tome,  , 5)
					Else
						Call PlaySoundFile("PCDie2", Tome,  , 5)
					End If
				End If
			Else
				Call PlaySoundFile(Target.DieWAV, Tome, True)
				If Target.DieWAVOneTime = True Then
					Target.DieWAV = ""
					Target.DieWAVOneTime = False
				End If
			End If
			' [Titi 2.6.0] Additional info
			'UPGRADE_WARNING: Couldn't resolve default property of object Target.Infos.KilledBy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Target.Infos.KilledBy = AOrAn(CreatureWithTurn.Name) & CreatureWithTurn.Name
			'UPGRADE_WARNING: Couldn't resolve default property of object Target.Infos.DiedOn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Year. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Moon. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Cycle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Target.Infos.DiedOn = Tome.Cycle & IIf(Tome.Cycle = 1 Or Tome.Cycle = 21, "st", IIf(Tome.Cycle = 2 Or Tome.Cycle = 22, "nd", IIf(Tome.Cycle = 3 Or Tome.Cycle = 23, "rd", "th"))) & " day of the " & Tome.Moon & IIf(Tome.Moon = 1, "st", IIf(Tome.Moon = 2, "nd", IIf(Tome.Moon = 3, "rd", "th"))) & " moon of the year " & Tome.Year
			'        If Target.Friendly = True Then
			'            Target.Infos.Deaths = Target.Infos.Deaths + 1
			'            ' [Titi 2.6.0] dead can't walk
			'            UpdateCreatureInfo Target, True
			'            Tome.Creatures.Remove "X" & Target.Index
			'        Else
			'            UpdateCreatureInfo Target, True
			''            EncounterNow.Creatures.Remove "X" & Target.Index
			'        End If
			' Fire Post-Death
			CreatureNow = Target
			ItemNow = Target.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(Target, bdPostDeath)
			For	Each ItemNow In Target.Items
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemNow.IsReady = True Then
					CreatureNow = Target
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemNow, bdPostDeath)
				End If
			Next ItemNow
			' [Titi 2.6.0] moved AFTER post-death event to account for resurrection triggers ;)
			If Target.Friendly = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Target.Infos.Deaths. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Target.Infos.Deaths = Target.Infos.Deaths + 1
				' [Titi 2.6.0] dead can't walk
				UpdateCreatureInfo(Target, True)
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.Creatures.Remove("X" & Target.Index)
			Else
				UpdateCreatureInfo(Target, True)
				'            EncounterNow.Creatures.Remove "X" & Target.Index
			End If
			' Redraw Combat screen (if necessary)
			If picGrid.Visible = True Then
				CombatDraw()
			Else
				MenuDrawParty()
			End If
		Else
			If picGrid.Visible = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CombatDrawAttack(CreatureWithTurn, CreatureTarget, True)
				picToHit.Refresh()
				BorderDrawButtons(0)
				Me.Refresh()
			Else
				MenuDrawParty()
			End If
		End If
	End Function
	
	Private Sub CombatDrawAttack(ByRef FromCreature As Creature, ByRef ToCreature As Creature, ByRef ShowDice As Short)
		Dim GlobalDamageRoll As Object
		Dim GlobalAttackRoll As Object
		Dim bdFontSmallWhite As Object
		Dim bdFontLargeWhite As Object
		Dim bdFontNoxiousWhite As Object
		Dim c, HasRunes As Short
		Dim rc As Integer
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Y, X, Width_Renamed As Short
		Dim intDef, intAtt, intDmg As Short
		' Redraw Bottom
		'UPGRADE_ISSUE: PictureBox method picToHit.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picToHit.Cls()
		BorderDrawBottom()
		' Location of Text
		Y = Me.ClientRectangle.Height - 14 : X = picToHit.Left : Width_Renamed = picToHit.ClientRectangle.Width
		' Draw the appropriate text
		If FromCreature.Friendly = True Then
			MenuDrawFace(FromCreature, 5)
			If FromCreature.ItemInHand.Name <> "Hand" Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(Me, X, Y, Width_Renamed, 14, bdFontNoxiousWhite, FromCreature.Name & " * " & FromCreature.ItemInHand.Name, False, False)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(Me, X, Y, Width_Renamed, 14, bdFontNoxiousWhite, (FromCreature.Name), False, False)
			End If
		Else
			MenuDrawFace(FromCreature, 6)
			If FromCreature.ItemInHand.Name <> "Hand" Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(Me, X, Y, Width_Renamed, 14, bdFontNoxiousWhite, FromCreature.Name & " * " & FromCreature.ItemInHand.Name, 1, False)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(Me, X, Y, Width_Renamed, 14, bdFontNoxiousWhite, (FromCreature.Name), 1, False)
			End If
		End If
		If FromCreature.Name <> ToCreature.Name Or FromCreature.Index <> ToCreature.Index Then
			' [Titi 2.4.9b] Don't show actual Att and Def figures if you don't really know you equipment (not examined!)
			CalcGearBonus(ToCreature, intAtt, intDef, intDmg, True)
			' Show Defense Number
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontLargeWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picToHit, 128, 8, 46, 28, bdFontLargeWhite, VB6.Format(ToCreature.Defense + intDef, "##0"), True, False)
			' Show Creature Face and ItemInHand
			If FromCreature.Friendly = True Then
				MenuDrawFace(ToCreature, 6)
				If ToCreature.ItemInHand.Name <> "Hand" Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, X, Y, Width_Renamed, 14, bdFontNoxiousWhite, ToCreature.Name & " * " & ToCreature.ItemInHand.Name, 1, False)
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, X, Y, Width_Renamed, 14, bdFontNoxiousWhite, (ToCreature.Name), 1, False)
				End If
			Else
				MenuDrawFace(ToCreature, 5)
				If ToCreature.ItemInHand.Name <> "Hand" Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, X, Y, Width_Renamed, 14, bdFontNoxiousWhite, ToCreature.Name & " * " & ToCreature.ItemInHand.Name, False, False)
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, X, Y, Width_Renamed, 14, bdFontNoxiousWhite, (ToCreature.Name), False, False)
				End If
			End If
			' ShowDice (if needed)
			If ShowDice = True Then
				For c = 0 To 5
					If CombatDiceType(c) <> 0 Then
						DiceDraw(c, CombatDiceType(c), CombatDiceValue(c), True)
					End If
				Next c
				' [Titi 2.4.9b] Added all the IIf tests to hide unknown bonuses
				CalcGearBonus(FromCreature, intAtt, intDef, intDmg, True)
				If FromCreature.Friendly = False Then
					intAtt = 0 : intDef = 0 : intDmg = 0
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If GlobalAttackRoll >= ToCreature.Defense Then
					' [Titi 2.4.9b] only show bonus if attack was successful
					If Combat20Bonus < 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picToHit, 132, 40, 40, 10, bdFontSmallWhite, VB6.Format(Combat20Bonus + intAtt), 1, False)
						'ElseIf Combat20Bonus  > 0 Then
					ElseIf Combat20Bonus + intAtt > 0 Then 
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picToHit, 132, 40, 40, 10, bdFontSmallWhite, "+" & VB6.Format(Combat20Bonus + intAtt), 1, False)
					End If
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If GlobalDamageRoll > FromCreature.ItemInHand.DamageBonus Then
					If CombatDmgBonus < 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picToHit, 136 + 1 * 46, 40, 40, 10, bdFontSmallWhite, VB6.Format(CombatDmgBonus + intDmg), 1, False)
						'ElseIf CombatDmgBonus  > 0 Then
					ElseIf CombatDmgBonus + intDmg > 0 Then 
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picToHit, 136 + 1 * 46, 40, 40, 10, bdFontSmallWhite, "+" & VB6.Format(CombatDmgBonus + intDmg), 1, False)
					End If
				End If
				' Show Hit Location
			End If
			' Show current Armor Chits
			c = CombatRollArmor(ToCreature, False, 0)
		End If
		picToHit.Refresh()
		BorderDrawButtons(0)
		Me.Refresh()
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub MenuDrawParty()
		Dim bdFaceSelect As Object
		Dim MenuPartyIndex As Object
		Dim Tome_Renamed As Object
		Dim MenuParty As Object
		Dim c, i As Short
		Dim rc As Integer
		' Clear the faces
		For c = 0 To 5
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMenu.hdc, c * 122, 0, 32, 84, picMisc.hdc, 139, 89, SRCCOPY)
			If c < 5 Then
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picMenu.hdc, 32 + c * 122, 0, 90, 84, picMisc.hdc, 0, 36, SRCCOPY)
			End If
		Next c
		' Draw faces
		For c = 0 To 4
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If PartyLeft + c < Tome.Creatures.Count Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MenuParty(c) = Tome.Creatures(PartyLeft + c + 1)
				If picGrid.Visible = False Then
					'UPGRADE_WARNING: Couldn't resolve default property of object MenuParty(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					MenuDrawFace(MenuParty(c), c)
				End If
			Else
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picMenu.hdc, 36 + c * 122, 4, 66, 76, picFaces.hdc, 66, 0, SRCAND)
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picMenu.hdc, 36 + c * 122, 4, 66, 76, picFaces.hdc, 0, 0, SRCPAINT)
			End If
		Next c
		' Draw Scroll Arrows
		If PartyLeft > 0 Then
			' Left Arrow
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMenu.hdc, 8, 32, 18, 18, picMisc.hdc, 144, 18, SRCCOPY)
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If PartyLeft + 5 < Tome.Creatures.Count Then
			' Right Arrow
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMenu.hdc, 618, 32, 18, 18, picMisc.hdc, 108, 18, SRCCOPY)
		End If
		' Draw select box
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_WARNING: Couldn't resolve default property of object MenuPartyIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picMenu.hdc, 36 + MenuPartyIndex * 122, 4, 66, 76, picFaces.hdc, bdFaceSelect + 66, 0, SRCAND)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_WARNING: Couldn't resolve default property of object MenuPartyIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picMenu.hdc, 36 + MenuPartyIndex * 122, 4, 66, 76, picFaces.hdc, bdFaceSelect, 0, SRCPAINT)
		' Redraw buttons
		BorderDrawButtons(0)
		Me.Refresh()
		picMenu.Refresh()
	End Sub
	
	'UPGRADE_NOTE: Loc was upgraded to Loc_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub MenuDrawFace(ByRef CreatureX As Creature, ByRef Loc_Renamed As Short)
		Dim bdFaceMin As Object
		Dim rc As Short
		Dim TriggerX As Trigger
		' Draw face
		LoadCreaturePic(CreatureX)
		If picGrid.Visible = True Then
			' In combat
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picToHit.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picToHit.hdc, 36 + 388 * System.Math.Abs(CInt(Loc_Renamed = 6)), 4, 66, 76, picFaces.hdc, bdFaceMin + CreatureX.Pic * 66, 0, SRCCOPY)
			MenuDrawStats(CreatureX, Loc_Renamed)
		Else
			' On Menu
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMenu.hdc, 36 + Loc_Renamed * 122, 4, 66, 76, picFaces.hdc, bdFaceMin + CreatureX.Pic * 66, 0, SRCCOPY)
			If CreatureX.AllowedTurn = False Then
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picMenu.hdc, 36 + Loc_Renamed * 122, 4, 66, 76, picFaces.hdc, 66, 0, SRCAND)
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picMenu.hdc, 36 + Loc_Renamed * 122, 4, 66, 76, picFaces.hdc, 0, 0, SRCPAINT)
			End If
			MenuDrawStats(CreatureX, Loc_Renamed)
		End If
	End Sub
	
	'UPGRADE_NOTE: Loc was upgraded to Loc_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub MenuDrawStats(ByRef CreatureX As Creature, ByRef Loc_Renamed As Short)
		Dim c As Short
		Dim rc As Integer
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim PicX As System.Windows.Forms.PictureBox
		Dim PosX, Height_Renamed As Short
		If picGrid.Visible = True Then
			PicX = picToHit
			PosX = 106 + 388 * System.Math.Abs(CInt(Loc_Renamed = 6))
		Else
			PicX = picMenu
			PosX = 106 + Loc_Renamed * 122
		End If
		' HitPoints
		If CreatureX.HPMax > 0 And CreatureX.HPNow > 0 Then
			Height_Renamed = 84 * (CreatureX.HPNow / CreatureX.HPMax)
			Select Case (CreatureX.HPNow / CreatureX.HPMax) * 100
				' [Titi 2.5.1] added a health level
				'Case 0 To 50
				'    c = 32
				'Case Else
				'    c = 16
				Case 0 To 33
					c = 32
				Case 34 To 67
					c = 82
				Case Else
					c = 16
			End Select
		Else
			c = 0
			Height_Renamed = 0
		End If
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property PicX.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(PicX.hdc, PosX, 0, 16, 84 - Height_Renamed, picMisc.hdc, 90, 36, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property PicX.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(PicX.hdc, PosX, 0 + 84 - Height_Renamed, 16, Height_Renamed, picMisc.hdc, 90 + c, 36 + (84 - Height_Renamed), SRCCOPY)
		' Eternium Points [Titi 2.4.9b]
		If WorldNow.Runes = True Then
			If CreatureX.EterniumMax > 0 And CreatureX.Eternium > 0 Then
				Height_Renamed = 84 * (CreatureX.Eternium / CreatureX.EterniumMax)
				Select Case (CreatureX.Eternium / CreatureX.EterniumMax) * 100
					' [Titi 2.5.1] added a third level
					'Case 0 To 50
					'    c = 32
					'Case Else
					'    c = 16
					Case 0 To 33
						c = 32
					Case 34 To 67
						c = 82
					Case Else
						c = 16
				End Select
			Else
				c = 0
				Height_Renamed = 0
			End If
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property PicX.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(PicX.hdc, PosX + 16, 0, 16, 84 - Height_Renamed, picMisc.hdc, 90, 36, SRCCOPY)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property PicX.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(PicX.hdc, PosX + 16, 0 + 84 - Height_Renamed, 16, Height_Renamed, picMisc.hdc, 90 + c, 36 + (84 - Height_Renamed), SRCCOPY)
		End If
	End Sub
	
	Private Sub InventoryContainerClose()
		Dim bdInvItems As Object
		Dim InvContainer As Object
		Dim c As Short
		Dim rc As Integer
		' Close Container
		picContainer.Visible = False
		'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvContainer.Selected = False
		' If Inventory open, then redraw
		If picSearch.Visible = True Then
			SearchShow()
		ElseIf picInventory.Visible = True Then 
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InventoryShow(bdInvItems)
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub InventoryContainerDrag(ByRef AtX As Short, ByRef AtY As Short)
		Dim bdInvEncounter As Object
		Dim Tome_Renamed As Object
		Dim MenuParty As Object
		Dim bdInvItems As Object
		Dim bdInvObjects As Object
		Dim InvContainer As Object
		Dim InvC As Object
		Dim bdInvContainer As Object
		Dim CreatureWithTurn As Object
		Dim InvDragMode As Object
		Dim InvDragItem As Object
		Dim X, Found, c, i, Y As Short
		' No matter what, shut off dragging Item
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvDragItem.Selected = False
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvDragMode = False
		picInvDrag.Visible = False
		If PointIn(AtX, AtY, (picContainer.Left), (picContainer.Top), (picContainer.ClientRectangle.Width), (picContainer.ClientRectangle.Height)) = True Then
			' Drop back into Container
			For c = 1 To 80
				X = picContainer.Left + 23 + ((c - 1) Mod 8) * 34
				Y = picContainer.Top + 45 + Int((c - 1) / 8) * 34
				If PointIn(AtX, AtY, X, Y, 34, 34) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvC(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvContainer, bdInvContainer, InvC(c), c, InvDragItem)
					'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InventoryContainerShow(InvContainer)
					Exit For
				End If
			Next c
		ElseIf picInventory.Visible = True And PointIn(AtX, AtY, (picInventory.Left), (picInventory.Top), (picInventory.ClientRectangle.Width), (picInventory.ClientRectangle.Height)) = True Then 
			' Drop onto same creature
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvContainer, bdInvObjects, 0, 0, InvDragItem)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InventoryShow(bdInvItems)
		ElseIf AtY > picMenu.Top Then 
			' Drop to Party member
			c = Greatest(0, Least(Int((AtX - picMenu.Left) / 122), 4))
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, 0, Tome.Creatures.Count - 1) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object MenuParty(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TradeItem(CreatureWithTurn, MenuParty(c), bdInvContainer, bdInvObjects, 0, 0, InvDragItem)
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvContainer, bdInvEncounter, 0, 0, InvDragItem)
		End If
	End Sub
	
	Private Sub InventoryContainerClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short, ByRef Button As Short, Optional ByRef blnExamine As Boolean = False)
		Dim InvDragIndex As Object
		Dim InvDragPos As Object
		Dim InvDragItem As Object
		Dim JournalY As Object
		Dim JournalX As Object
		Dim InvY As Object
		Dim InvX As Object
		Dim InvDragMode As Object
		Dim ItemPicHeight As Object
		Dim ItemPicWidth As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim ConvoAction As Object
		Dim InvC As Object
		Dim InvTooMany As Object
		Dim bdInvObjects As Object
		Dim bdInvEncounter As Object
		Dim bdInvContainer As Object
		Dim CreatureWithTurn As Object
		Dim InvContainer As Object
		Dim c, i As Short
		Dim rc As Integer
		Dim ItemX As Item
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		If PointIn(AtX, AtY, picContainer.ClientRectangle.Width - 198, picContainer.ClientRectangle.Height - 30, 90, 18) Then
			' Empty
			ShowButton(picContainer, picContainer.ClientRectangle.Width - 198, picContainer.ClientRectangle.Height - 30, "Empty", ButtonDown)
			picContainer.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in InventoryContainerClick. Please check source code.
				If picSearch.Visible = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each ItemX In InvContainer.Items
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvContainer, bdInvEncounter, 0, 0, ItemX)
					Next ItemX
				ElseIf picInventory.Visible = True Then 
					'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each ItemX In InvContainer.Items
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvContainer, bdInvObjects, 0, 0, ItemX)
					Next ItemX
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryContainerShow(InvContainer)
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If InvContainer.Items.Count < 1 Then
					InventoryContainerClose()
					' [Titi 2.6.3] make sure InvContainer will not be wrongly set: "close" it too
					'UPGRADE_NOTE: Object InvContainer may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					InvContainer = Nothing
				End If
			End If
		ElseIf PointIn(AtX, AtY, picContainer.ClientRectangle.Width - 102, picContainer.ClientRectangle.Height - 30, 90, 18) Then 
			' Done
			ShowButton(picContainer, picContainer.ClientRectangle.Width - 102, picContainer.ClientRectangle.Height - 30, "Done", ButtonDown)
			picContainer.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in InventoryContainerClick. Please check source code.
				InventoryContainerClose()
				' [Titi 2.6.0] make sure InvContainer will not be wrongly set: "close" it too
				'UPGRADE_NOTE: Object InvContainer may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				InvContainer = Nothing
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, picSearch.ClientRectangle.Width - 294, picSearch.ClientRectangle.Height - 30, 90, 18) And InvTooMany = True Then 
			' More
			ShowButton(picSearch, picSearch.ClientRectangle.Width - 294, picSearch.ClientRectangle.Height - 30, "More", ButtonDown)
			picSearch.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in InventoryContainerClick. Please check source code.
				' Shuffle the Items
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemX In InvContainer.Items
					If ItemX.InvSpot > 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InvContainer.RemoveItem("I" & ItemX.Index)
						ItemX.InvSpot = 0
						'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.AddItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InvContainer.AddItem.Copy(ItemX)
					End If
				Next ItemX
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryContainerShow(InvContainer)
			End If
		ElseIf ButtonDown Then 
			For c = 1 To 80
				'UPGRADE_WARNING: Couldn't resolve default property of object InvC(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If PointIn(AtX, AtY, 23 + ((c - 1) Mod 8) * 34, 45 + Int((c - 1) / 8) * 34, 34, 34) And InvC(c) > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object InvC(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ItemX = InvContainer.Items("I" & InvC(c))
					' [Titi 2.5.1] double-click on an item within a container will move it to the inventory
					If blnExamine Then
						' [Titi 2.6.0] then default next action to "Done"
						'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ConvoAction = 0
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvContainer, bdInvObjects, 0, 0, ItemX)
					End If
					If Button = VB6.MouseButtonConstants.RightButton Then
						'UPGRADE_WARNING: Untranslated statement in InventoryContainerClick. Please check source code.
						' Don't show warning message if item already examined
						If ItemX.Examined = False Then
							DialogSetUp(bdDlgItem)
							DialogSetButton(1, "No")
							DialogSetButton(2, "Yes")
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Male. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							DialogShow("DM", IIf(ItemX.Capacity > 0, "Opening the ", "Examining the ") & ItemX.Name & " may trigger traps and harm " & CreatureWithTurn.Name & "." & vbCrLf & vbCrLf & "Will " & IIf(CreatureWithTurn.Male, "he", "she") & " try anyway?")
							DialogHide()
							'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If ConvoAction = 0 Then
								ExamineItem(ItemX)
							End If
						Else
							ExamineItem(ItemX)
						End If
						'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InventoryContainerShow(InvContainer)
					Else
						'UPGRADE_ISSUE: PictureBox method picInvDrag.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						picInvDrag.Cls()
						LoadItemPic(ItemX)
						Select Case ItemPicWidth(ItemX.Pic)
							Case 32 : Width_Renamed = 34
							Case 64 : Width_Renamed = 68
						End Select
						Select Case ItemPicHeight(ItemX.Pic)
							Case 32 : Height_Renamed = 34
							Case 64 : Height_Renamed = 68
							Case 96 : Height_Renamed = 102
						End Select
						For i = 1 To 80
							'UPGRADE_WARNING: Couldn't resolve default property of object InvC(i). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object InvC(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If InvC(i) = ItemX.InvSpot Then InvC(i) = 0
						Next i
						'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InvDragMode = True
						If blnExamine Then
							'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							picContainer_MouseUp(picContainer, New System.Windows.Forms.MouseEventArgs(VB6.MouseButtonConstants.LeftButton * &H100000, 0, CSng(InvX(ItemX.InvSpot)), CSng(InvY(ItemX.InvSpot)), 0))
						Else
							picInvDrag.Width = Width_Renamed : picInvDrag.Height = Height_Renamed
							'UPGRADE_ISSUE: PictureBox property picContainer.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picInvDrag.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picInvDrag.hdc, 0, 0, Width_Renamed, Height_Renamed, picContainer.hdc, 22 + ((ItemX.InvSpot - 1) Mod 8) * 34, 44 + Int((ItemX.InvSpot - 1) / 8) * 34, SRCCOPY)
							picInvDrag.Refresh()
							' Ready for Drag/Drop
							'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							JournalX = AtX - 23 - ((ItemX.InvSpot - 1) Mod 8) * 34
							'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							JournalY = AtY - 45 - Int((ItemX.InvSpot - 1) / 8) * 34
							InvDragItem = ItemX
							'UPGRADE_WARNING: Couldn't resolve default property of object InvDragPos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							InvDragPos = c
							'UPGRADE_WARNING: Couldn't resolve default property of object InvDragIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							InvDragIndex = 0
							'InvDragMode = True
							'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							InvDragItem.Selected = True
						End If
					End If
					Exit For
				End If
			Next c
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub InventoryDragItem(ByRef AtX As Short, ByRef AtY As Short)
		Dim Tome_Renamed As Object
		Dim bdInvParty As Object
		Dim MenuParty As Object
		Dim InvY As Object
		Dim InvX As Object
		Dim bdInvItems As Object
		Dim InvZ As Object
		Dim bdInvWear As Object
		Dim InvContainer As Object
		Dim bdInvContainer As Object
		Dim bdInvObjects As Object
		Dim CreatureWithTurn As Object
		Dim InvDragMode As Object
		Dim InvDragItem As Object
		Dim ToList, Found, c, FromList, i As Short
		' No matter what, shut off dragging Item
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvDragItem.Selected = False
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.InvSpot. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvDragItem.InvSpot = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvDragMode = False
		picInvDrag.Visible = False
		' Drop where appropriate
		If PointIn(AtX, AtY, (picContainer.Left), (picContainer.Top), (picContainer.Width), (picContainer.Height)) And picContainer.Visible = True Then
			' Drop on Container
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvObjects, bdInvContainer, 0, 0, InvDragItem)
			'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InventoryContainerShow(InvContainer)
		ElseIf PointIn(AtX, AtY, (picInventory.Left), (picInventory.Top), (picInventory.Width), (picInventory.Height)) And picSearch.Visible = False Then 
			' Drop on Inventory
			For c = 1 To 128
				'UPGRADE_WARNING: Couldn't resolve default property of object InvY(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If PointIn(AtX, AtY, picInventory.Left + InvX(c), picInventory.Top + InvY(c), 34, 34) Then
					If c < 49 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvWear. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ToList = bdInvWear
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ToList = bdInvObjects
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If InvDragItem.IsReady = True Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvWear. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						FromList = bdInvWear
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						FromList = bdInvObjects
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TradeItem(CreatureWithTurn, CreatureWithTurn, FromList, ToList, InvZ(c), c, InvDragItem)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InventoryShow(bdInvItems)
					Exit For
				End If
			Next c
		ElseIf AtY > picMenu.Top - 32 Then 
			' Drop to Party member
			c = Greatest(0, Least(Int((AtX - picMenu.Left) / 122), 4))
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, 0, Tome.Creatures.Count - 1) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object MenuParty(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TradeItem(CreatureWithTurn, MenuParty(c), bdInvObjects, bdInvParty, 0, 0, InvDragItem)
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DropItem(CreatureWithTurn, 0, 0, InvDragItem)
			DrawMapAll()
		End If
	End Sub
	
	Public Sub InventoryClose()
		Dim Frozen As Object
		' Only release map if not in combat
		If picTomeNew.Visible = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Frozen = False
			picMap.Focus()
		End If
		' If Searching or a Container is open, close it
		If picSearch.Visible = True Then
			picSearch.Visible = False
		End If
		' Shut off Inventory
		picInventory.Visible = False
	End Sub
	
	Private Sub InventoryClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short, ByRef Button As Short, Optional ByRef blnEquip As Boolean = False)
		Dim InvContainer As Object
		Dim CreatureNow As Object
		Dim InvDragIndex As Object
		Dim InvDragPos As Object
		Dim InvDragItem As Object
		Dim JournalY As Object
		Dim JournalX As Object
		Dim InvY As Object
		Dim InvX As Object
		Dim InvDragMode As Object
		Dim ItemPicHeight As Object
		Dim ItemPicWidth As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim ConvoAction As Object
		Dim InvZ As Object
		Dim ScrollList As Object
		Dim ScrollTop As Object
		Dim bdInvStatus As Object
		Dim InvTooMany As Object
		Dim bdInvItems As Object
		Dim CreatureWithTurn As Object
		Dim InvNowShow As Object
		Dim c, i As Short
		Dim rc As Integer
		Dim ItemX As Item
		Dim ItemInHand As Item
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		' [Titi 2.6.0] Fixes RT 424 & button "Equip" not responding at the bottom of the Skills window
		'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InventoryShow(InvNowShow)
		TargetAllowDead = 32000 ' flag to keep track of the last active window between Inventory and Skills
		Dim TriggerX As New Trigger
		Dim StmtX As New Statement
		If PointIn(AtX, AtY, 482, 406, 90, 18) Then
			' Done
			ShowButton(picInventory, 482, 406, "Done", ButtonDown)
			picInventory.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in InventoryClick. Please check source code.
				InventoryClose()
				MenuSkillLoad() ' [Titi 2.5.1] make sure the call to MenuSkillClose will not fire PostRaise triggers!
				MenuSkillClose() ' [Titi 2.5.1] monty's request
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 194, 406, 90, 18) And InvNowShow = bdInvItems And InvTooMany = True Then 
			' More
			ShowButton(picInventory, 194, 406, "More", ButtonDown)
			picInventory.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in InventoryClick. Please check source code.
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemX In CreatureWithTurn.Items
					If ItemX.InvSpot > 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.RemoveItem("I" & ItemX.Index)
						ItemX.InvSpot = 0
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AddItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.AddItem.Copy(ItemX)
					End If
				Next ItemX
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryShow(bdInvItems)
			End If
		ElseIf PointIn(AtX, AtY, 386, 406, 90, 18) Then 
			' Status/Equip
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If InvNowShow = bdInvItems Then
				ShowButton(picInventory, 386, 406, "Status", ButtonDown)
			Else
				ShowButton(picInventory, 386, 406, "Equip", ButtonDown)
			End If
			picInventory.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in InventoryClick. Please check source code.
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If InvNowShow = bdInvItems Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvStatus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InventoryShow(bdInvStatus)
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InventoryShow(bdInvItems)
				End If
			End If
		ElseIf PointIn(AtX, AtY, 290, 406, 90, 18) Then  ' [Titi 2.5.1] monty's request
			' Skills
			ShowButton(picInventory, 290, 406, "Skills", ButtonDown)
			picInventory.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in InventoryClick. Please check source code.
				MenuSkillLoad()
				MenuSkillShow(1)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvStatus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 544, 45, 18, 338) And InvNowShow = bdInvStatus Then 
			' ScrollBar Click
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ScrollBarClick(AtX, AtY, ButtonDown, picInventory, 544, 45, 338, ScrollTop, ScrollList.Count, 17) = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvStatus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryShow(bdInvStatus)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf ButtonDown And InvNowShow = bdInvItems Then 
			For c = 1 To 128
				'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvY(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If PointIn(AtX, AtY, InvX(c), InvY(c), 34, 34) And InvZ(c) > -1 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ItemX = CreatureWithTurn.Items("I" & InvZ(c))
					' [Titi 2.5.1] double-click means use/equip
					If blnEquip = True Then
						' [Titi 2.6.0] then default next action to "Done"
						'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ConvoAction = 0
						If ItemX.Examined = False Then
							If picGrid.Visible = True Then
								'CombatMessage "I'd better fight than examine the " & ItemX.Name & " right now."
								' [Titi 2.6.0] Allow examination of items, but on a combat penalty
								CombatMessage("Examining the " & ItemX.Name & " in the middle of a fight is not very wise... Let's hope I won't get hit!")
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								CreatureWithTurn.ActionPoints = 0
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AddTrigger. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								TriggerX = CreatureWithTurn.AddTrigger
								TriggerX.Name = "Examine item penalty"
								TriggerX.TriggerType = bdPreTurn
								TriggerX.IsPoison = False
								TriggerX.Turns = ItemX.MinLevel + 1
								StmtX = TriggerX.AddStatement
								' Put CreatureNow.DefenseBonus - Random.010 Into CreatureNow.DefenseBonus
								StmtX.Statement = 12 : StmtX.B(0) = 12 : StmtX.B(1) = 142 : StmtX.B(2) = 2 : StmtX.B(3) = 32 : StmtX.B(4) = 9 : StmtX.B(5) = 12 : StmtX.B(6) = StmtX.B(1)
								StmtX = TriggerX.AddStatement
								' Let CreatureNow.ActionPoints = Pos.000
								StmtX.Statement = 53 : StmtX.B(0) = 12 : StmtX.B(1) = 18 : StmtX.B(2) = 0 : StmtX.B(3) = 29 : StmtX.B(4) = 0
								ExamineItem(ItemX)
								Exit Sub
							End If
							ExamineItem(ItemX)
						Else
							If ItemX.IsReady = True Then
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								UnReadyItem(CreatureWithTurn, ItemX)
								ItemX.InvSpot = 49
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If ReadyItem(CreatureWithTurn, ItemX, True) = False Then
									' cannot be equipped, maybe because the corresponding spot is already taken?
									'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									ItemInHand = CreatureWithTurn.ItemInHand
									'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									If UnReadyItem(CreatureWithTurn, ItemInHand, True) = True And (ItemX.Family >= 4 Or ItemX.Family <= 10) Then
										' yes, unequip item in hand now
										'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										UnReadyItem(CreatureWithTurn, ItemInHand)
										ItemInHand.InvSpot = 49
										'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										ReadyItem(CreatureWithTurn, ItemX)
									Else
										' cannot be equipped, so we'll use it
										If ItemX.Count >= 2 Then
											'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AddItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
											ItemInHand = CreatureWithTurn.AddItem
											ItemInHand.Copy(ItemX)
											ItemX.Count = Int(ItemX.Count / 2) + (ItemX.Count Mod 2)
											ItemX.Value = Int(ItemX.Value / 2) + (ItemX.Value Mod 2)
											ItemX.Weight = Int(ItemX.Weight / 2) + (ItemX.Weight Mod 2)
											ItemX.Bulk = Int(ItemX.Bulk / 2) + (ItemX.Bulk Mod 2)
											ItemInHand.Count = Int(ItemInHand.Count / 2)
											ItemInHand.Value = Int(ItemInHand.Value / 2)
											ItemInHand.Weight = Int(ItemInHand.Weight / 2)
											ItemInHand.Bulk = Int(ItemInHand.Bulk / 2)
											ItemInHand.IsReady = False
											ItemInHand.InvSpot = 49
										Else
											UseShow(ItemX)
										End If
									End If
								Else ' item is equipped, updated display
									Select Case ItemX.WearType
										Case 0 ' Body
											ItemX.InvSpot = 27
										Case 1 ' Helm
											ItemX.InvSpot = 44
										Case 2 ' Glove
											ItemX.InvSpot = 17
										Case 3 ' Wrist
											ItemX.InvSpot = 21
										Case 4 ' Backpack
											ItemX.InvSpot = 1
										Case 5 ' Shield
											ItemX.InvSpot = 33
										Case 6 ' Boots
											ItemX.InvSpot = 45
										Case 7 ' Necklace
											ItemX.InvSpot = 25
										Case 8 ' Belt
											ItemX.InvSpot = 31
										Case 9 ' Rings
											ItemX.InvSpot = 17
										Case 10 ' OneHand
											ItemX.InvSpot = 39
										Case 11 ' TwoHand
											ItemX.InvSpot = 39
									End Select
								End If
							End If
						End If
					End If
					If ItemX.Selected = False Then
						If Button = VB6.MouseButtonConstants.RightButton Then
							'UPGRADE_WARNING: Untranslated statement in InventoryClick. Please check source code.
							' [Titi 2.4.9b] Warning! Pre-Examine triggers likely to fire...
							DialogSetUp(bdDlgNoReply)
							DialogSetButton(1, "No")
							DialogSetButton(2, "Yes")
							' [Titi 2.4.9b] No way we can examine an item while fighting!
							If picGrid.Visible = True Then
								' DialogBrief "DM", "Tss...Tss... Do you really think it's the right time to examine your gear?"
								' [Titi 2.5.1] However, OnUseInEncounter and OnUseOnCreature triggers for items previously examined should be allowed.
								If ItemX.Examined = False Then
									'CombatMessage "I'd better fight than examine the " & ItemX.Name & " right now."
									' [Titi 2.6.0] Allow examination of items, but on a combat penalty
									CombatMessage("Examining the " & ItemX.Name & " in the middle of a fight is not very wise... Let's hope I won't get hit!")
									'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									CreatureWithTurn.ActionPoints = 0
									'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AddTrigger. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									TriggerX = CreatureWithTurn.AddTrigger
									TriggerX.Name = "Examine item penalty"
									TriggerX.TriggerType = bdPreTurn
									TriggerX.IsPoison = False
									TriggerX.Turns = ItemX.MinLevel + 1
									StmtX = TriggerX.AddStatement
									' Put CreatureNow.DefenseBonus - Random.010 Into CreatureNow.DefenseBonus
									StmtX.Statement = 12 : StmtX.B(0) = 12 : StmtX.B(1) = 142 : StmtX.B(2) = 2 : StmtX.B(3) = 32 : StmtX.B(4) = 9 : StmtX.B(5) = 12 : StmtX.B(6) = StmtX.B(1)
									StmtX = TriggerX.AddStatement
									' Let CreatureNow.ActionPoints = Pos.000
								End If
								ExamineItem(ItemX)
								Exit Sub
							End If
							' Don't show warning message if item already examined
							' [Titi 2.6.0] Dead friends' bodies are considered known!
							'                        If ItemX.Examined = False Then
							If ItemX.Examined = False And ItemX.PictureFile <> "Dead body.bmp" Then
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Male. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								DialogShow("DM", IIf(ItemX.Capacity > 0, "Opening the ", "Examining the ") & ItemX.Name & " may trigger traps and harm " & CreatureWithTurn.Name & "." & vbCrLf & vbCrLf & "Will " & IIf(CreatureWithTurn.Male, "he", "she") & " try anyway?")
								DialogHide()
								'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If ConvoAction = 0 Then
									ExamineItem(ItemX)
								End If
							Else
								ExamineItem(ItemX)
							End If
							'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							InventoryShow(bdInvItems)
						Else
							'UPGRADE_ISSUE: PictureBox method picInvDrag.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							picInvDrag.Cls()
							LoadItemPic(ItemX)
							Select Case ItemPicWidth(ItemX.Pic)
								Case 32 : Width_Renamed = 34
								Case 64 : Width_Renamed = 68
							End Select
							Select Case ItemPicHeight(ItemX.Pic)
								Case 32 : Height_Renamed = 34
								Case 64 : Height_Renamed = 68
								Case 96 : Height_Renamed = 102
							End Select
							For i = 1 To 128
								'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(i). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If InvZ(i) = ItemX.InvSpot Then InvZ(i) = -1
							Next i
							'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							InvDragMode = True
							If blnEquip Then
								'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								picInventory_MouseUp(picInventory, New System.Windows.Forms.MouseEventArgs(VB6.MouseButtonConstants.LeftButton * &H100000, 0, CSng(InvX(ItemX.InvSpot)), CSng(InvY(ItemX.InvSpot)), 0))
							Else
								picInvDrag.Width = Width_Renamed : picInvDrag.Height = Height_Renamed
								'UPGRADE_WARNING: Couldn't resolve default property of object InvY(ItemX.InvSpot). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_ISSUE: PictureBox property picInventory.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
								'UPGRADE_ISSUE: PictureBox property picInvDrag.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
								rc = BitBlt(picInvDrag.hdc, 0, 0, Width_Renamed, Height_Renamed, picInventory.hdc, InvX(ItemX.InvSpot), InvY(ItemX.InvSpot), SRCCOPY)
								picInvDrag.Refresh()
								' Ready for Drag/Drop
								'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								JournalX = AtX - InvX(ItemX.InvSpot)
								'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								JournalY = AtY - InvY(ItemX.InvSpot)
								InvDragItem = ItemX
								' [Titi 2.6.0] only allow drag & drop if can be moved into container
								If Not InvContainer Is Nothing Then
									'If TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvObjects, bdInvContainer, InvContainer.Index, 0, ItemX) = True Then
									'If TradeItem(CreatureWithTurn, CreatureWithTurn, 0, 0, InvContainer.Index, 0, ItemX) = True Then
									' [Titi 2.6.0] Changed second CreatureWithTurn to CreatureNow to enable drag & drop from a character's inventory into another's container
									'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									If TradeItem(CreatureWithTurn, CreatureNow, 0, 0, InvContainer.Index, 0, ItemX) = True Then
										'UPGRADE_WARNING: Couldn't resolve default property of object InvDragPos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InvDragPos = c
										'UPGRADE_WARNING: Couldn't resolve default property of object InvDragIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InvDragIndex = 0
										'InvDragMode = True
										'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InvDragItem.Selected = True
									End If
								End If
							End If
						End If
					End If
					Exit For
				End If
			Next c
		End If
	End Sub
	
	Private Function InventoryStatus(ByRef Index As Short) As String
		If Index < 16 Then
			InventoryStatus = "Excellent"
		ElseIf Index > 20 Then 
			InventoryStatus = "Wild"
		Else
			Select Case Index
				Case 16
					InventoryStatus = "Low"
				Case 17
					InventoryStatus = "Mild"
				Case 18
					InventoryStatus = "Average"
				Case 19
					InventoryStatus = "Excessive"
				Case 20
					InventoryStatus = "High"
			End Select
		End If
	End Function
	
	'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub InventoryFindSpot(ByRef ItemX As Item, ByRef AtSpot As Short, ByRef MaxSlot As Short, ByRef Width_Renamed As Short, ByRef Slot() As Short)
		Dim ItemPicWidth As Object
		Dim ItemPicHeight As Object
		Dim i, c, Found As Short
		' Find an appropriate spot for an Item
		Found = False
		For i = AtSpot To MaxSlot
			If ItemX.InvSpot < 1 Then
				c = i
			Else
				c = ItemX.InvSpot
			End If
			If Slot(c) < 0 Then
				Found = True
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemPicHeight(ItemX.Pic) > 32 Then
					' Check for one spot down
					If c + Width_Renamed > MaxSlot Then
						Found = False
					ElseIf Slot(c + Width_Renamed) > -1 Then 
						Found = False
					End If
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemPicHeight(ItemX.Pic) > 64 Then
					' Check for two spots down
					If c + Width_Renamed * 2 > MaxSlot Then
						Found = False
					ElseIf Slot(c + Width_Renamed * 2) > -1 Then 
						Found = False
					End If
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemPicWidth(ItemX.Pic) > 32 Then
					' Check for one spot to the right
					If c + 1 > MaxSlot Or Int((c - 1) / Width_Renamed) <> Int(c / Width_Renamed) Then
						Found = False
					ElseIf Slot(c + 1) > -1 Then 
						Found = False
					End If
				End If
				If Found = True Then
					ItemX.InvSpot = c
					Exit For
				End If
			End If
		Next i
		If Found = True Then
			Slot(c) = ItemX.Index ' Mark current slot
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemPicHeight(ItemX.Pic) > 32 Then Slot(c + Width_Renamed) = ItemX.Index
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemPicHeight(ItemX.Pic) > 64 Then Slot(c + Width_Renamed * 2) = ItemX.Index
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemPicWidth(ItemX.Pic) > 32 Then Slot(c + 1) = ItemX.Index
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemPicHeight(ItemX.Pic) > 32 And ItemPicWidth(ItemX.Pic) > 32 Then
				Slot(c + Width_Renamed + 1) = ItemX.Index
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemPicHeight(ItemX.Pic) > 64 And ItemPicWidth(ItemX.Pic) > 32 Then
				Slot(c + Width_Renamed * 2 + 1) = ItemX.Index
			End If
		Else
			ItemX.InvSpot = 0
		End If
	End Sub
	
	Private Function InventoryViceText(ByRef c As Short) As String
		Select Case c
			Case 0 To 14
				InventoryViceText = "Superb"
			Case 15 To 16
				InventoryViceText = "Great"
			Case 17
				InventoryViceText = "Good"
			Case 18
				InventoryViceText = "Average"
			Case 19
				InventoryViceText = "Weak"
			Case Else
				InventoryViceText = "Uncontrolled"
		End Select
	End Function
	
	Private Sub InventoryHint(ByRef Style As Short, ByRef AtX As Short, ByRef AtY As Short)
		Dim ItemNow As Object
		Dim InvC As Object
		Dim InvContainer As Object
		Dim EncounterNow As Object
		Dim InvY As Object
		Dim InvX As Object
		Dim InvZ As Object
		Dim CreatureWithTurn As Object
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim c, Found As Short
		Dim ItemX As Item
		Dim Text_Renamed As String
		Dim ItemY As Item
		Found = False
		Select Case Style
			Case 0 ' Inventory
				For c = 1 To 128
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If PointIn(AtX, AtY, InvX(c), InvY(c), 34, 34) And InvZ(c) > -1 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						For	Each ItemX In CreatureWithTurn.Items
							'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If ItemX.Index = InvZ(c) Then
								Found = True
								ItemY = ItemX ' [Titi 2.6.0] save ref for future use
								Exit For
							End If
						Next ItemX
						Exit For
					End If
				Next c
			Case 1 ' Search
				For c = 1 To 80
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If PointIn(AtX, AtY, 23 + ((c - 1) Mod 8) * 34, 45 + Int((c - 1) / 8) * 34, 34, 34) And InvZ(c) > -1 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ItemX = EncounterNow.Items("I" & InvZ(c))
						Found = True
						Exit For
					End If
				Next c
			Case 2 ' Container
				For c = 1 To 80
					'UPGRADE_WARNING: Couldn't resolve default property of object InvC(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If PointIn(AtX, AtY, 23 + ((c - 1) Mod 8) * 34, 45 + Int((c - 1) / 8) * 34, 34, 34) And InvC(c) > 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object InvC(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ItemX = InvContainer.Items("I" & InvC(c))
						Found = True
						Exit For
					End If
				Next c
		End Select
		If Found = True Then
			If ItemX.Selected = False Then
				ItemNow = ItemX
				BorderDrawButtons(-1)
			Else
				BorderDrawButtons(0)
			End If
		Else ' [Titi 2.6.0] show "balloon tip" like info
			'        sHint = ""
			' [Titi 2.6.0] some items are smaller than the available space. Show info on the item still (hence ItemY)
			If ItemY Is Nothing Then
				ItemY = ItemNow
				sHint = ""
			Else
				sHint = ItemY.Hint
			End If
			If Style = 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(1). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvY(1). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If PointIn(AtX, AtY, InvX(1), InvY(1), 34 * 2, 34 * 3) And InvZ(1) <> ItemY.Index Then ' LeftBack
					sHint = "This is where you would carry quiver or your backpack."
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(7). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(7). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf PointIn(AtX, AtY, InvX(7), InvY(7), 34 * 2, 34 * 3) And InvZ(7) <> ItemY.Index Then  ' RightBack
					sHint = "This is another place for a quiver or backpack."
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(13). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(13). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf PointIn(AtX, AtY, InvX(13), InvY(13), 34 * 2, 34 * 2) And InvZ(13) <> ItemY.Index Then  ' Head
					sHint = "On the head? All hats and caps of course (or, in this game, helmets!)"
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(17). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(17). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf PointIn(AtX, AtY, InvX(17), InvY(17), 34 * 2, 34 * 2) And InvZ(17) <> ItemY.Index Then  ' LeftHandOther
					sHint = "Why not wear rings, or gloves?"
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(21). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(21). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf PointIn(AtX, AtY, InvX(21), InvY(21), 34 * 2, 34 * 2) And InvZ(21) <> ItemY.Index Then  ' RightHandOther
					sHint = "Why not wear rings, or gloves?"
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(25). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(25). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf PointIn(AtX, AtY, InvX(25), InvY(25), 34 * 2, 34 * 3) And InvZ(25) <> ItemY.Index Then  ' Body
					sHint = "Unless you feel like walking naked, you'd better wear a shirt or armor."
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(31). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(31). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf PointIn(AtX, AtY, InvX(31), InvY(31), 34 * 2, 34) And InvZ(31) <> ItemY.Index Then  ' Belt
					sHint = "Around the waist, what about a belt?"
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(33). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(33). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf PointIn(AtX, AtY, InvX(33), InvY(33), 34 * 2, 34 * 3) And InvZ(33) <> ItemY.Index Then  ' LeftHand
					sHint = "Unless you're an adept of martial arts, hold weapons here."
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(39). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(39). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf PointIn(AtX, AtY, InvX(39), InvY(39), 34 * 2, 34 * 3) And InvZ(39) <> ItemY.Index Then  ' RightHand
					sHint = "If you need a shield, grab it with this hand."
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(45). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvY(45). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf PointIn(AtX, AtY, InvX(45), InvY(45), 34 * 2, 34 * 2) And InvZ(45) <> ItemY.Index Then  ' Feet
					sHint = "Boots would fit nicely here."
				End If
			End If
			If sHint <> "" Then
				BorderDrawButtons(-1)
			Else
				BorderDrawButtons(0)
			End If
		End If
		Me.Refresh()
	End Sub
	
	Public Sub CalcGearBonus(ByRef CreatureX As Creature, ByRef intAtt As Short, ByRef intDef As Short, ByRef intDmg As Short, ByRef InCombat As Boolean)
		Dim ItemX As Item
		For	Each ItemX In CreatureX.Items
			If ItemX.IsReady = True Then
				If InCombat Then
					' If in combat, substract the bonuses
					intAtt = intAtt + ItemX.AttackBonus * CShort((ItemX.Examined = False) And (CreatureX.Level < ItemX.MinLevel + System.Math.Abs(ItemX.AttackBonus)))
					intDmg = intDmg + ItemX.DamageBonus * CShort((ItemX.Examined = False) And (CreatureX.Level < ItemX.MinLevel + System.Math.Abs(ItemX.DamageBonus)))
				Else
					' If not, just don't show them
					intAtt = intAtt + ItemX.AttackBonus * System.Math.Abs(ItemX.Examined) * System.Math.Abs(CInt(CreatureX.Level >= ItemX.MinLevel + System.Math.Abs(ItemX.AttackBonus)))
					intDmg = intDmg + ItemX.DamageBonus * System.Math.Abs(ItemX.Examined) * System.Math.Abs(CInt(CreatureX.Level >= ItemX.MinLevel + System.Math.Abs(ItemX.DamageBonus)))
				End If
				' In any case, Defense bonuses are automatically added to CreatureX.Defense, so let's deduct them for the display if the item is not examined!
				intDef = intDef + ItemX.Defense * CShort((ItemX.Examined = False) And (CreatureX.Level < ItemX.MinLevel + System.Math.Abs(ItemX.Defense)))
			End If
		Next ItemX
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub InventoryShow(ByRef ListToShow As Short)
		Dim bdFontNoxiousGold As Object
		Dim ScrollTop As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim ScrollList As Object
		Dim bdFontNoxiousBlack As Object
		Dim File As Object
		Dim oFileSys As Object
		Dim Tome_Renamed As Object
		Dim bdInvStatus As Object
		Dim bdFontSmallWhite As Object
		Dim InvY As Object
		Dim InvX As Object
		Dim ItemPicHeight As Object
		Dim ItemPicWidth As Object
		Dim InvTooMany As Object
		Dim InvZ As Object
		Dim bdFontNoxiousWhite As Object
		Dim InvNowShow As Object
		Dim CreatureWithTurn As Object
		Dim bdFontElixirWhite As Object
		Dim bdInvItems As Object
		Dim Frozen As Object
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim k, c, i, Found As Short
		Dim rc As Integer
		Dim Text_Renamed As String
		'UPGRADE_NOTE: Size was upgraded to Size_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Height_Renamed, Width_Renamed, NoFail As Short
		Dim Size_Renamed As Double
		Dim NextLevel As Double
		Dim OldFrozen As Short
		Dim ItemX As Item
		Dim TriggerX, TriggerZ As Trigger
		Dim X, Y As Short
		Dim intDef, intAtt, intDmg As Short '[Titi 2.4.9b]
		'UPGRADE_WARNING: Arrays in structure bmMons may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMons As BITMAPINFO
		Dim hMemMons As Integer
		'UPGRADE_WARNING: Arrays in structure bmBlack may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmBlack As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmMask may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMask As BITMAPINFO
		Dim lpMem, TransparentRGB As Integer
		' Freeze out rest of screen
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = True
		' Show header
		'UPGRADE_ISSUE: PictureBox method picInventory.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picInventory.Cls()
		'    ShowText picInventory, 0, 12, 584, 14, bdFontElixirWhite, CreatureWithTurn.Name, True, False
		' [Titi 2.4.8] moved AFTER the picture is loaded ;)
		Dim sTmp As String
		Dim intMoons, intYears, intCycles As Short
		Dim intTurns As Integer
		Dim lngVar As Double
		'UPGRADE_WARNING: Couldn't resolve default property of object bdInvStatus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Select Case ListToShow
			Case bdInvItems
				'            picInventory.Picture = LoadPicture(gAppPath & "\data\interface\" & GlobalInterfaceName & "\DialogInventory.bmp")
				picInventory.Image = System.Drawing.Image.FromFile(gDataPath & "\interface\" & GlobalInterfaceName & "\DialogInventory.bmp")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 0, 12, 584, 14, bdFontElixirWhite, CreatureWithTurn.Name, True, False)
				' [Titi 2.4.9b] Show size of creature
				Found = -1
				For c = 0 To 4
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Size. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.Size(c) <> 0 Then Found = c
				Next 
				Select Case Found
					Case 0
						Text_Renamed = "Tiny"
					Case 1
						Text_Renamed = "Small"
					Case 3
						Text_Renamed = "Large"
					Case 4
						Text_Renamed = "Huge"
					Case Else
						Text_Renamed = "Medium"
				End Select
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 0, 30, 584, 14, bdFontElixirWhite, Text_Renamed, True, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvNowShow = bdInvItems
				' Show Bulk and Weight ([Titi 2.4.8] modified the bulk max)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Agility. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Bulk. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 16, 360, 82, 14, bdFontNoxiousWhite, "Bulk " & Int((CreatureWithTurn.Bulk / Greatest(CreatureWithTurn.Agility * 8, 1)) * 100) & "%", True, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MaxWeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Weight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 16, 380, 82, 14, bdFontNoxiousWhite, "Wgt " & Int((CreatureWithTurn.Weight / Greatest(CreatureWithTurn.MaxWeight, 1)) * 100) & "%", True, False)
				' Clear current locations
				For c = 0 To 128
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvZ(c) = -1
				Next c
				' Show all Items
				'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvTooMany = False : intAtt = 0 : intDef = 0
				For c = 0 To 1
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each ItemX In CreatureWithTurn.Items
						If (c = 0 And ItemX.InvSpot > 0) Or (c = 1 And ItemX.InvSpot = 0) Then
							LoadItemPic(ItemX)
							' Set Inventory Spot on screen
							If ItemX.IsReady = True Then
								Select Case ItemX.WearType
									Case 0 ' Body
										'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InventoryFindSpot(ItemX, 27, 32, 2, InvZ())
										If ItemX.InvSpot = 0 Then
											'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
											InventoryFindSpot(ItemX, 25, 32, 2, InvZ())
										End If
									Case 1 ' Helm
										'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InventoryFindSpot(ItemX, 13, 16, 2, InvZ())
									Case 2, 3, 9 ' Glove, Bracelet, Ring
										'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InventoryFindSpot(ItemX, 17, 20, 2, InvZ())
										If ItemX.InvSpot = 0 Then
											'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
											InventoryFindSpot(ItemX, 21, 24, 2, InvZ())
										End If
									Case 4 ' Backpack
										'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InventoryFindSpot(ItemX, 1, 6, 2, InvZ())
										If ItemX.InvSpot = 0 Then
											'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
											InventoryFindSpot(ItemX, 7, 12, 2, InvZ())
										End If
									Case 5 ' Shield
										'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InventoryFindSpot(ItemX, 39, 44, 2, InvZ())
									Case 6 ' Boots
										'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InventoryFindSpot(ItemX, 45, 48, 2, InvZ())
									Case 7 ' Necklace
										'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InventoryFindSpot(ItemX, 25, 26, 2, InvZ())
									Case 8 ' Belt
										'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InventoryFindSpot(ItemX, 31, 32, 2, InvZ())
									Case Else ' InHand
										'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										InventoryFindSpot(ItemX, 33, 38, 2, InvZ())
								End Select
								' If no spot available, unready
								If ItemX.InvSpot = 0 Then
									ItemX.IsReady = False
									'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									InventoryFindSpot(ItemX, 49, 128, 8, InvZ())
								End If
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								InventoryFindSpot(ItemX, 49, 128, 8, InvZ())
							End If
							' Draw Item in Inventory (if have a spot to display)
							If ItemX.Selected = False Then
								If ItemX.InvSpot > 0 Then
									'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									Width_Renamed = ItemPicWidth(ItemX.Pic)
									'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									Height_Renamed = ItemPicHeight(ItemX.Pic)
									'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									'UPGRADE_WARNING: Couldn't resolve default property of object InvY(ItemX.InvSpot). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_ISSUE: PictureBox property picInventory.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = BitBlt(picInventory.hdc, InvX(ItemX.InvSpot), InvY(ItemX.InvSpot), Width_Renamed, Height_Renamed, picItem.hdc, 64 * ItemX.Pic - 64, 96, SRCAND)
									'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									'UPGRADE_WARNING: Couldn't resolve default property of object InvY(ItemX.InvSpot). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_ISSUE: PictureBox property picInventory.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = BitBlt(picInventory.hdc, InvX(ItemX.InvSpot), InvY(ItemX.InvSpot), Width_Renamed, Height_Renamed, picItem.hdc, 64 * ItemX.Pic - 64, 0, SRCPAINT)
									If ItemX.Capacity > 0 Then
										'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										'UPGRADE_WARNING: Couldn't resolve default property of object InvY(ItemX.InvSpot). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										ShowText(picInventory, InvX(ItemX.InvSpot), InvY(ItemX.InvSpot), Width_Renamed, 10, bdFontSmallWhite, "(" & ItemX.Items.Count() & ")", 1, False)
									End If
									If ItemX.Count > 1 Then
										'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										'UPGRADE_WARNING: Couldn't resolve default property of object InvY(ItemX.InvSpot). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										ShowText(picInventory, InvX(ItemX.InvSpot), InvY(ItemX.InvSpot) + Height_Renamed - 10, Width_Renamed, 10, bdFontSmallWhite, CStr(ItemX.Count), True, False)
									End If
								Else
									'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									InvTooMany = True
								End If
							End If
						End If
					Next ItemX
				Next c
				' [Titi 2.4.9b] Now shows the defense and attack values (with item's bonuses, but only if known!)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CalcGearBonus(CreatureWithTurn, intAtt, intDef, intDmg, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Defense. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 186, 360, 82, 14, bdFontNoxiousWhite, "Def " & CreatureWithTurn.Defense + intDef, True, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AttackBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 186, 380, 82, 14, bdFontNoxiousWhite, "Att " & CreatureWithTurn.AttackBonus + intAtt, True, False)
				' Show Buttons
				'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If InvTooMany = True Then
					ShowButton(picInventory, 194, 406, "More", False)
				End If
				ShowButton(picInventory, 290, 406, "Skills", False) ' [Titi 2.5.1] monty's request to access the skills from the status window
				ShowButton(picInventory, 386, 406, "Status", False)
				ShowButton(picInventory, 482, 406, "Done", False)
				If picTomeNew.Visible Then ' [Titi 2.5.1] monty's request
					MenuSkillLoad()
					MenuSkillShow(1)
				End If
				picInventory.Refresh()
				picInventory.Left = 0
				picInventory.Top = Me.ClientRectangle.Height - 48 - picMenu.ClientRectangle.Height - picInventory.ClientRectangle.Height
				picInventory.Visible = True
			Case bdInvStatus
				'            picInventory.Picture = LoadPicture(gAppPath & "\data\interface\" & GlobalInterfaceName & "\DialogStatus.bmp")
				picInventory.Image = System.Drawing.Image.FromFile(gDataPath & "\interface\" & GlobalInterfaceName & "\DialogStatus.bmp")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 0, 12, 584, 14, bdFontElixirWhite, CreatureWithTurn.Name, True, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvStatus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvNowShow = bdInvStatus
				' Load Clean Creature Picture
				'            sTmp = gAppPath & "\data\graphics\creatures\" & CreatureWithTurn.PictureFile
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sTmp = gDataPath & "\graphics\creatures\" & CreatureWithTurn.PictureFile
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Not oFileSys.CheckExists(sTmp, File) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sTmp = Tome.FullPath & "\" & CreatureWithTurn.PictureFile
					'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Not oFileSys.CheckExists(sTmp, File) Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sTmp = Tome.FullPath & "\creatures\" & CreatureWithTurn.PictureFile
						'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Not oFileSys.CheckExists(sTmp, File) Then
							' [Titi 2.4.9b] look in the world directory too
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							sTmp = gAppPath & "\Roster\" & WorldNow.Name & "\" & CreatureWithTurn.PictureFile
							'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If Not oFileSys.CheckExists(sTmp, File) Then
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								sTmp = gAppPath & "\Roster\" & WorldNow.Name & "\Creatures\" & CreatureWithTurn.PictureFile
								'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If Not oFileSys.CheckExists(sTmp, File) Then
									sTmp = ""
								End If
							End If
						End If
					End If
				End If
				If sTmp <> "" Then
					ReadBitmapFile(sTmp, bmMons, hMemMons, TransparentRGB)
					' Make a copy of the current palette for the picture
					'UPGRADE_WARNING: Couldn't resolve default property of object bmBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					bmBlack = bmMons
					' Then change Pure Blue to Pure Black
					ChangeColor(bmBlack, TransparentRGB, 0, 0, 0)
					MakeMask(bmMons, bmMask, TransparentRGB)
					' Paint bitmap to picture box using converted palette
					lpMem = GlobalLock(hMemMons)
					Width_Renamed = bmMons.bmiHeader.biWidth
					Height_Renamed = bmMons.bmiHeader.biHeight
					Size_Renamed = 1
					If Width_Renamed * Size_Renamed > 228 Or Height_Renamed * Size_Renamed > 266 Then
						Size_Renamed = 228 / Width_Renamed
						If Height_Renamed * Size_Renamed > 266 Then
							Size_Renamed = 266 / Height_Renamed
						End If
					End If
					X = 35 + (228 - Width_Renamed * Size_Renamed) / 2 : Y = 81 + (266 - Height_Renamed * Size_Renamed) / 2
					'UPGRADE_ISSUE: PictureBox property picInventory.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = SetStretchBltMode(picInventory.hdc, 3)
					'UPGRADE_ISSUE: PictureBox property picInventory.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = StretchDIBits(picInventory.hdc, X, Y, Width_Renamed * Size_Renamed, Height_Renamed * Size_Renamed, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmMask, DIB_RGB_COLORS, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picInventory.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = StretchDIBits(picInventory.hdc, X, Y, Width_Renamed * Size_Renamed, Height_Renamed * Size_Renamed, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmBlack, DIB_RGB_COLORS, SRCPAINT)
					' Release memory
					rc = GlobalUnlock(hMemMons)
					rc = GlobalFree(hMemMons)
				End If
				' Show Level and basic Stats
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 45, 52, 216, 14, bdFontNoxiousBlack, "Level: " & VB6.Format(CreatureWithTurn.Level), True, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Will. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 45, 82, 216, 14, bdFontNoxiousBlack, "Int " & VB6.Format(CreatureWithTurn.Will), True, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Strength. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 45, 102, 216, 14, bdFontNoxiousBlack, "Str " & VB6.Format(CreatureWithTurn.Strength), 0, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Agility. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 45, 102, 216, 14, bdFontNoxiousBlack, "Agl " & VB6.Format(CreatureWithTurn.Agility), 1, False)
				' [Titi 2.4.9b] Added the new stats
				intDef = 0 : intDmg = 20
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each TriggerX In CreatureWithTurn.Triggers
					If TriggerX.TriggerType = bdShowNewStat Then
						For	Each TriggerZ In TriggerX.Triggers
							intAtt = TriggerZ.VarA
							'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ShowText(picInventory, 45, 102 + intDmg, 216, 14, bdFontNoxiousBlack, VB.Left(TriggerZ.Name, 3) & " " & intAtt, intDef, False)
							intDmg = intDmg + 20 * intDef
							intDef = 1 - intDef
							'                    If intDmg = 100 Then
							'                        intDmg = 40
							'                        intDef = intDef + 20
							'                    End If
						Next TriggerZ
					End If
				Next TriggerX
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPMax. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.HPNow > 0 And CreatureWithTurn.HPMax > 0 Then
					' [Titi 2.4.9b] Show "magic points" when necessary
					'ShowText picInventory, 45, 335, 216, 14, bdFontNoxiousBlack, "Health " & Format$(CreatureWithTurn.HPNow) & " of " & Format$(CreatureWithTurn.HPMax) & " (" & Int((CreatureWithTurn.HPNow / CreatureWithTurn.HPMax) * 100) & "%)", True, False
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPMax. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picInventory, 45, 310, 216, 14, bdFontNoxiousBlack, "Health " & VB6.Format(CreatureWithTurn.HPNow) & " of " & VB6.Format(CreatureWithTurn.HPMax) & " (" & Int((CreatureWithTurn.HPNow / CreatureWithTurn.HPMax) * 100) & "%)", True, False)
					If WorldNow.Runes Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.EterniumMax. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Eternium. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picInventory, 45, 335, 216, 14, bdFontNoxiousBlack, WorldNow.Magic & " " & VB6.Format(CreatureWithTurn.Eternium) & " of " & VB6.Format(CreatureWithTurn.EterniumMax) & " (" & Int((CreatureWithTurn.Eternium / CreatureWithTurn.EterniumMax) * 100) & "%)", True, False)
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPMax. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf CreatureWithTurn.HPMax > 0 Then 
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPMax. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picInventory, 45, 335, 216, 14, bdFontNoxiousBlack, "Dead " & VB6.Format(CreatureWithTurn.HPNow) & " of " & VB6.Format(CreatureWithTurn.HPMax) & " (" & Int((CreatureWithTurn.HPNow / CreatureWithTurn.HPMax) * 100) & "%)", True, False)
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picInventory, 45, 335, 216, 14, bdFontNoxiousBlack, "Stone Dead", True, False)
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Defense. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picInventory, 45, 365, 216, 14, bdFontNoxiousBlack, "Defense " & VB6.Format(CreatureWithTurn.Defense), True, False)
				' Set up Status
				ScrollList = New Collection
				' Determine if there are any Effects Triggers
				Found = False
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each TriggerX In CreatureWithTurn.Triggers
					If (TriggerX.Styles And &H7C) > 0 And TriggerX.TriggerType <> bdOnCast Then
						Found = True
						Exit For
					End If
				Next TriggerX
				' If there are Effects Triggers (that are not On-Cast Triggers), show them
				If Found = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollList.Add("`Effects")
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each TriggerX In CreatureWithTurn.Triggers
						If (TriggerX.Styles And &H7C) > 0 And TriggerX.TriggerType <> bdOnCast Then
							'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ScrollList.Add(TriggerX.Name)
						End If
					Next TriggerX
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollList.Add("")
				End If
				' Vices
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("`Vices")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Lunacy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Lunacy: " & InventoryViceText(CreatureWithTurn.Lunacy))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Revelry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Revelry: " & InventoryViceText(CreatureWithTurn.Revelry))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Wrath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Wrath: " & InventoryViceText(CreatureWithTurn.Wrath))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Pride. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Pride: " & InventoryViceText(CreatureWithTurn.Pride))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Greed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Greed: " & InventoryViceText(CreatureWithTurn.Greed))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Lust. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Lust: " & InventoryViceText(CreatureWithTurn.Lust))
				' Add any additional Special Status
				Found = False
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each TriggerX In CreatureWithTurn.Triggers
					If TriggerX.TriggerType = bdOnStatus Then
						Found = True
						Exit For
					End If
				Next TriggerX
				If Found = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollList.Add("")
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollList.Add("`Stats")
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each TriggerX In CreatureWithTurn.Triggers
						If TriggerX.TriggerType = bdOnStatus Then
							CreatureNow = CreatureWithTurn
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ItemNow = CreatureWithTurn.ItemInHand
							NoFail = FireTrigger(CreatureWithTurn, TriggerX)
							'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ScrollList.Add(TriggerX.Name & ": " & TriggerX.VarA)
						End If
					Next TriggerX
				End If
				' Experience Information
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("")
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("`Experience")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ExperiencePoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Current: " & VB6.Format(CreatureWithTurn.ExperiencePoints, "###,###,###,##0"))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				c = CreatureWithTurn.Level : NextLevel = (c * Int(c / 2 + 0.5) + (c / 2) * (1 - (c Mod 2))) * 1000
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Next Level: " & VB6.Format(NextLevel, "###,###,###,##0"))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Skill Points: " & CreatureWithTurn.SkillPoints)
				' Resistances
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("")
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("`Resistances")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ResistanceTypeWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Sharp " & CreatureWithTurn.ResistanceTypeWithArmor(1) & "%")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ResistanceTypeWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Blunt " & CreatureWithTurn.ResistanceTypeWithArmor(2) & "%")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ResistanceTypeWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Cold " & CreatureWithTurn.ResistanceTypeWithArmor(3) & "%")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ResistanceTypeWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Heat " & CreatureWithTurn.ResistanceTypeWithArmor(4) & "%")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ResistanceTypeWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Evil " & CreatureWithTurn.ResistanceTypeWithArmor(5) & "%")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ResistanceTypeWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Good " & CreatureWithTurn.ResistanceTypeWithArmor(6) & "%")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ResistanceTypeWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Energy " & CreatureWithTurn.ResistanceTypeWithArmor(7) & "%")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ResistanceTypeWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Mind " & CreatureWithTurn.ResistanceTypeWithArmor(8) & "%")
				' [Titi 2.5.1] additional information
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				intTurns = CreatureWithTurn.Infos.Age
				' 200 turns = 1 cycle, 50 cycles = 1 moon, 10 moons = 1 year
				lngVar = intTurns / 200 / 50 / 10
				intYears = Int(lngVar)
				intTurns = intTurns - intYears * 200 * 50 * 10
				lngVar = intTurns / 200 / 50
				intMoons = Int(lngVar)
				intTurns = intTurns - intMoons * 200 * 50
				intCycles = Int(intTurns / 200)
				intTurns = intTurns - intCycles * 200
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("")
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("`Extra information")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Battles: " & CreatureWithTurn.Infos.Battles)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Kills: " & CreatureWithTurn.Infos.KillsCount)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Highest XP gain: " & CreatureWithTurn.Infos.RecordXP)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Highest damage inflicted: " & CreatureWithTurn.Infos.Damage)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Hits: " & CreatureWithTurn.Infos.Hits)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Misses: " & CreatureWithTurn.Infos.Misses)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Accuracy: " & IIf(CreatureWithTurn.Infos.Accuracy = -1, "N/A", CreatureWithTurn.Infos.Accuracy & "%"))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Spells cast: " & CreatureWithTurn.Infos.SpellsCast)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Spells failed: " & CreatureWithTurn.Infos.SpellsFailed)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Aptitude: " & IIf(CreatureWithTurn.Infos.Aptitude = -1, "N/A", CreatureWithTurn.Infos.Aptitude & "%"))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Died " & CreatureWithTurn.Infos.Deaths & IIf(CreatureWithTurn.Infos.Deaths > 1, " times", " time"))
				' [Titi 2.6.0]
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.Infos.KilledBy <> "" Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollList.Add("Killed by " & CreatureWithTurn.Infos.KilledBy)
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollList.Add("Declared dead on " & CreatureWithTurn.Infos.DiedOn)
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Age: " & intYears & " year" & IIf(intYears > 1, "s ", " ") & intMoons & " moon" & IIf(intMoons > 1, "s ", " "))
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add(intCycles & " cycle" & IIf(intCycles > 1, "s ", " ") & intTurns & " turn" & IIf(intTurns > 1, "s ", " ") & " adventuring!")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add("Tomes played: " & CreatureWithTurn.Infos.Tomes)
				' Show all Stats
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollTop = Greatest(Least(ScrollTop, ScrollList.Count - 17), 1)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For c = 0 To Least(17, ScrollList.Count - ScrollTop)
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If VB.Left(ScrollList(ScrollTop + c), 1) = "`" Then
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picInventory, 305, 50 + c * 18, 235, 14, bdFontNoxiousGold, Mid(ScrollList(ScrollTop + c), 2), True, False)
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picInventory, 305, 50 + c * 18, 235, 14, bdFontNoxiousWhite, ScrollList(ScrollTop + c), True, False)
					End If
				Next c
				' Show scroll bar
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollBarShow(picInventory, 544, 45, 338, ScrollTop, ScrollList.Count - 17, 0)
				' Show Buttons
				ShowButton(picInventory, 386, 406, "Equip", False)
				ShowButton(picInventory, 482, 406, "Done", False)
				picInventory.Refresh()
				picInventory.Visible = True
		End Select
		picInventory.Refresh()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	'UPGRADE_NOTE: Add was upgraded to Add_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub MenuSkillSpend(ByRef Add_Renamed As Short)
		Dim FireTriggers As Object
		Dim GlobalSkillLevel As Object
		Dim CreatureWithTurn As Object
		Dim CreatureNow As Object
		Dim CreateSkillsIndex As Object
		Dim ScrollList As Object
		Dim TriggerX As Trigger
		Dim NoFail As Short
		' Only allow spend if there is a positive cost for the Skill
		TriggerX = ScrollList(CreateSkillsIndex)
		If TriggerX.Turns > 0 Then
			' Only add if have enough points to level. Else, only subtract to previous level
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Add_Renamed = True And CreatureWithTurn.SkillPoints >= TriggerX.Turns Then
				CreatureNow = CreatureWithTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSkillLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalSkillLevel = Int(TriggerX.SkillPoints / TriggerX.Turns)
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(TriggerX, bdPreRaiseSkill)
				If NoFail Then
					TriggerX.SkillPoints = TriggerX.SkillPoints + TriggerX.Turns
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.SkillPoints = CreatureWithTurn.SkillPoints - TriggerX.Turns
				End If
			ElseIf Add_Renamed = False And CShort(CShort(TriggerX.SkillPoints) - CShort(TriggerX.Turns)) >= CShort(TriggerX.TempSkill) Then 
				TriggerX.SkillPoints = TriggerX.SkillPoints - TriggerX.Turns
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureWithTurn.SkillPoints = CreatureWithTurn.SkillPoints + TriggerX.Turns
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MenuSkillShow(CreateSkillsIndex)
		End If
	End Sub
	
	Private Sub MenuSkillSet()
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub Camp()
		Dim EncounterNow As Object
		Dim Map_Renamed As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetUp As Object
		Dim CreatureX As Creature
		Dim i, intHours, intFullNight As Short
		Dim bCombat As Boolean
		' [Titi 2.5.1] Check if camping is allowed
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanCamp. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.CanCamp. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Map.CanCamp = False And EncounterNow.CanCamp = False Then
			Exit Sub
		ElseIf TurnsBeforeNextCamp > 0 Then 
			' not long enough since last rest
			DialogSetUp(bdDlgNoReply)
			DialogShow("DM", "You rested not so long ago, and cannot find sleep..." & vbCrLf & "You estimate you will be tired enough in " & TurnsBeforeNextCamp & " turn" & IIf(TurnsBeforeNextCamp = 1, ".", "s."))
			DialogHide()
		Else ' if one of the flags is set, camping is allowed
			' time passes
			intFullNight = 65 ' approximately 8 hours
			If Tome.Turn > 150 Then ' it's night, so take a full rest
				intHours = intFullNight
			ElseIf Tome.Turn < 40 Then 
				intHours = intFullNight * 2 / 3 ' approximately 5 hours
			Else ' daylight, only a nap then
				intHours = intFullNight / 3 ' between 2 and 3 hours
			End If
			' add some randomization
			intHours = intHours + 16 * (Rnd() - 0.5) ' +/- one hour of sleep
			For i = 1 To intHours
				For	Each CreatureX In Tome.Creatures
					If CreatureX.HPNow > 0 Then
						CreatureX.HPNow = CreatureX.HPNow + Int((CreatureX.HPMax - CreatureX.HPNow) / intFullNight) + 1
						CreatureX.Eternium = CreatureX.EterniumMax + Int((CreatureX.EterniumMax - CreatureX.Eternium) / intFullNight) + 1
						MenuDrawParty()
					End If
					TurnCycleTimedTriggers(CreatureX)
				Next CreatureX
				TurnCycleTime(bCombat)
			Next 
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Interval. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Map.Interval > 0 Then
				' provide a duration between 95 and 105% of the nominal interval between rests
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Interval. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TurnsBeforeNextCamp = Map.Interval * (1 + 0.1 * (Rnd() - 0.5))
				If bCombat Then
					TurnsBeforeNextCamp = TurnsBeforeNextCamp / 2
				End If
				'        Else
				'            TurnsBeforeNextCamp = 40 + 16 * (Rnd - 0.5) ' about five +/- one hour before next rest
			End If
			While picGrid.Visible = True
				System.Windows.Forms.Application.DoEvents()
			End While
			DialogSetUp(bdDlgNoReply)
			If bCombat Then
				DialogShow("DM", "After this combat, you're too excited to go back to sleep...")
			Else
				DialogShow("DM", "After " & intHours & " turns' sleep, your party feels refreshed.")
			End If
			DialogHide()
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Function CheckWanderingMonster(ByRef MapX As Map) As Boolean
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetUp As Object
		Dim Tome_Renamed As Object
		Dim EncounterNow As Object
		Dim j, intMonsters, Index As Short
		Dim CreatureX As Creature
		CheckWanderingMonster = False
		If Not FromEntryPoint Is Nothing Then
			' check if reached an entrypoint
			If Tome.MapX = FromEntryPoint.MapX And Tome.MapY = FromEntryPoint.MapY Then
				' yes, no wandering monsters here
				Exit Function
			End If
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If EncounterNow.Name <> "BlankEncounter" Or MapX.Creatures.Count() = 0 Then
			' this encounter has been pre-made, or no wandering monsters are expected: no need to continue
			Exit Function
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If EncounterNow.Creatures.Count > 0 Then
				' get rid of previous corpses!
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				While EncounterNow.Creatures.Count > 0
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					EncounterNow.Creatures.Remove(1)
				End While
			End If
		End If
		If MapX.Hazard > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Classification. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If 100 * Rnd() <= MapX.Hazard And (EncounterNow.Classification = 2 Or EncounterNow.Classification = 0) Then
				' Wandering monsters arrive
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				intMonsters = Rnd() * Tome.Creatures.Count + 3 * Rnd() ' number based on party size
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Classification. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If EncounterNow.Classification = 2 Then intMonsters = Int(intMonsters * 1.5) ' and increased in dangerous areas
				For j = 1 To intMonsters
					Index = Int(Rnd() * MapX.Creatures.Count()) + 1
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.AddCreature. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					EncounterNow.AddCreature.Copy(MapX.Creatures.Item(Index))
				Next 
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanFight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				EncounterNow.CanFight = True
				' Load up Creature pictures if missing
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each CreatureX In EncounterNow.Creatures
					If CreatureX.Pic = 0 Then
						LoadCreaturePic(CreatureX)
					End If
				Next CreatureX
				DialogSetUp(bdDlgNoReply)
				DialogShow("DM", "Wandering monsters found your party and attack!")
				DialogHide()
				CombatStart()
				CheckWanderingMonster = True
			End If
		End If
	End Function
	
	'Private Function GetWanderingMonster(MapX As Map) As Collection
	'    Dim Monsters As New Collection, WanderingMonsters As Collection, ListMonsters As Collection
	'    Dim c As Integer, i As Integer, Found As Integer, sText As String
	'    Dim CreatureX As Creature, CreatureZ As Creature
	'    Set WanderingMonsters = New Collection
	'    Set ListMonsters = New Collection
	'    sText = MapX.WanderingMonsters & ","
	'    While InStr(sText, ",") > 1
	'        ListMonsters.Add Left$(sText, InStr(sText, ",") - 1)
	'        sText = Mid$(sText, InStr(sText, ",") + 1)
	'    Wend
	'    modDungeonMaker.SearchFolders "*.rsc", gAppPath & "\Library", Monsters
	'    i = 1
	'    Do
	'        For c = 1 To Monsters.Count
	'            Found = False
	'            If Mid$(Monsters.Item(c).Text, InStrRev(Monsters.Item(c).Text, "\") + 1) = ListMonsters.Item(i) Then
	'            ' found one, store it
	'                Found = True
	'                ListMonsters.Remove i
	'                WanderingMonsters.Add Monsters.Item(c)
	'                Exit For
	'            End If
	'        Next
	'        If Not Found Then
	'            i = i + 1
	'        End If
	'    Loop Until i > ListMonsters.Count
	'    ' OK, we can now replace the names by real monsters
	'    Set GetWanderingMonster = New Collection
	'    For c = 1 To WanderingMonsters.Count
	'        i = FreeFile
	'        Set CreatureX = New Creature
	'        Open WanderingMonsters.Item(c).Text For Binary As i
	'        CreatureX.ReadFromFile i
	'        Close #i
	'        GetWanderingMonster.Add CreatureX
	'    Next c
	'End Function
	
	Private Sub DoorListen()
		Dim DialogDM As Object
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureWithTurn As Object
		Dim CreatureNow As Object
		Dim Frozen As Object
		Dim TriggerX As Trigger
		Dim Found, NoFail, OldFrozen As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		OldFrozen = Frozen
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = True
		If HasTrigger(EncounterNow, bdOnListen) Then
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(EncounterNow, bdOnListen)
		ElseIf HasTrigger(Tome, bdOnListen) Then 
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(Tome, bdOnListen)
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DialogDM(CreatureWithTurn.Name & " listens, but doesn't hear anything.")
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = OldFrozen
	End Sub
	
	Private Sub SearchShow()
		Dim CreatureWithTurn As Object
		Dim bdFontSmallWhite As Object
		Dim ItemPicHeight As Object
		Dim ItemPicWidth As Object
		Dim EncounterNow As Object
		Dim InvTooMany As Object
		Dim InvZ As Object
		Dim bdFontElixirWhite As Object
		Dim c, yOffSet As Short
		Dim rc As Integer
		Dim ItemX As Item
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, X, Y, Height_Renamed As Short
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		'UPGRADE_ISSUE: PictureBox method picSearch.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picSearch.Cls()
		' Show header
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picSearch, 0, 12, picSearch.Width, 14, bdFontElixirWhite, "On the Ground", True, False)
		' Clear current locations
		For c = 0 To 128
			'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvZ(c) = -1
		Next c
		' Show all Items (those with a spot first, without a spot second)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvTooMany = False
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemX In EncounterNow.Items
			If ItemX.Selected = False Then
				LoadItemPic(ItemX)
				'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryFindSpot(ItemX, 1, 80, 8, InvZ())
				' Draw Item in Inventory (if have a spot to display)
				If ItemX.InvSpot > 0 Then
					' Configure Width and Height
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Width_Renamed = ItemPicWidth(ItemX.Pic)
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Height_Renamed = ItemPicHeight(ItemX.Pic)
					' Set location on Search box
					X = 23 + ((ItemX.InvSpot - 1) Mod 8) * 34
					Y = 45 + Int((ItemX.InvSpot - 1) / 8) * 34
					' Paint the Item picture
					'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picSearch.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picSearch.hdc, X, Y, Width_Renamed, Height_Renamed - yOffSet, picItem.hdc, 64 * ItemX.Pic - 64, 96, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picSearch.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picSearch.hdc, X, Y, Width_Renamed, Height_Renamed - yOffSet, picItem.hdc, 64 * ItemX.Pic - 64, 0, SRCPAINT)
					If ItemX.Capacity > 0 And yOffSet = 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picSearch, X, Y, Width_Renamed, 10, bdFontSmallWhite, "(" & ItemX.Items.Count() & ")", 1, False)
					End If
					If ItemX.Count > 1 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picSearch, X, Y + Height_Renamed - 10, Width_Renamed, 10, bdFontSmallWhite, CStr(ItemX.Count), True, False)
					End If
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvTooMany = True
				End If
			End If
		Next ItemX
		' Show Buttons
		'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If InvTooMany = True Then
			ShowButton(picSearch, picSearch.ClientRectangle.Width - 294, picSearch.ClientRectangle.Height - 30, "More", False)
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowButton(picSearch, picSearch.ClientRectangle.Width - 198, picSearch.ClientRectangle.Height - 30, "Take All", False, (CreatureWithTurn.HPNow <= 0))
		ShowButton(picSearch, picSearch.ClientRectangle.Width - 102, picSearch.ClientRectangle.Height - 30, "Done", False)
		picSearch.Left = 0
		picSearch.Top = Me.ClientRectangle.Height - 48 - picMenu.ClientRectangle.Height - picSearch.ClientRectangle.Height
		' Search gets the focus however
		picSearch.Visible = True
		picSearch.BringToFront()
		picSearch.Focus()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Private Sub SearchClose()
		Dim Frozen As Object
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureWithTurn As Object
		Dim CreatureNow As Object
		Dim c As Short
		Dim rc As Integer
		' Close Search and fire Post-Search Triggers
		picSearch.Visible = False
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		rc = FireTriggers(EncounterNow, bdPostSearch)
		' Redraw Map and release
		DrawMapAll()
		BorderDrawButtons(0)
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = False
	End Sub
	
	Private Sub SearchClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short, ByRef Button As Short, Optional ByRef blnSearch As Boolean = False)
		Dim InvDragMode As Object
		Dim InvDragIndex As Object
		Dim InvDragPos As Object
		Dim InvDragItem As Object
		Dim JournalY As Object
		Dim JournalX As Object
		Dim ItemPicHeight As Object
		Dim ItemPicWidth As Object
		Dim ConvoAction As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim InvZ As Object
		Dim InvTooMany As Object
		Dim DialogDM As Object
		Dim bdInvObjects As Object
		Dim bdInvEncounter As Object
		Dim CreatureWithTurn As Object
		Dim EncounterNow As Object
		Dim ItemNow As Object
		Dim c, i As Short
		Dim rc As Integer
		Dim ItemX, ItemY As Item
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		' [Titi 2.6.0] He he he... Since when can dead people carry things?
		' If PointIn(AtX, AtY, picSearch.ScaleWidth - 198, picSearch.ScaleHeight - 30, 90, 18) Then
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If PointIn(AtX, AtY, picSearch.ClientRectangle.Width - 198, picSearch.ClientRectangle.Height - 30, 90, 18) And CreatureWithTurn.HPNow > 0 Then
			' Take All
			ShowButton(picSearch, picSearch.ClientRectangle.Width - 198, picSearch.ClientRectangle.Height - 30, "Take All", ButtonDown)
			picSearch.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in SearchClick. Please check source code.
				ItemY = ItemNow
				' [Titi 2.4.9b] flag to avoid "ItemX is too bulky for..." for a series of items.
				c = True
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemX In EncounterNow.Items
					ItemNow = ItemX ' [Titi 2.4.9b] otherwise the Post-Take and Pre-Take triggers will refers to ItemInHand!
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvEncounter, bdInvObjects, 0, 0, ItemX, True)
				Next ItemX
				ItemNow = ItemY ' [Titi 2.4.9b] shouldn't be necessary, but let's set it back to what it was, just in case
				SearchShow()
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If EncounterNow.Items.Count < 1 Then
					SearchClose()
				End If
				If c = False Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogDM("Some items are too bulky or too heavy for " & CreatureWithTurn.Name & " to carry.")
				End If
			End If
		ElseIf PointIn(AtX, AtY, picSearch.ClientRectangle.Width - 102, picSearch.ClientRectangle.Height - 30, 90, 18) Then 
			' Done
			ShowButton(picSearch, picSearch.ClientRectangle.Width - 102, picSearch.ClientRectangle.Height - 30, "Done", ButtonDown)
			picSearch.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in SearchClick. Please check source code.
				SearchClose()
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, picSearch.ClientRectangle.Width - 294, picSearch.ClientRectangle.Height - 30, 90, 18) And InvTooMany = True Then 
			' More
			ShowButton(picSearch, picSearch.ClientRectangle.Width - 294, picSearch.ClientRectangle.Height - 30, "More", ButtonDown)
			picSearch.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in SearchClick. Please check source code.
				' Shuffle the Items
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemX In EncounterNow.Items
					If ItemX.InvSpot > 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						EncounterNow.RemoveItem("I" & ItemX.Index)
						ItemX.InvSpot = 0
						'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.AddItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						EncounterNow.AddItem.Copy(ItemX)
					End If
				Next ItemX
				SearchShow()
			End If
		ElseIf ButtonDown Then 
			' Drag and drop some items
			For c = 1 To 80
				'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If PointIn(AtX, AtY, 23 + ((c - 1) Mod 8) * 34, 45 + Int((c - 1) / 8) * 34, 34, 34) And InvZ(c) > -1 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ItemX = EncounterNow.Items("I" & InvZ(c))
					' [Titi 2.5.1] Double-click means automatically take/open
					If blnSearch And Button = VB6.MouseButtonConstants.LeftButton Then
						If ItemX.Capacity > 0 Then
							' chest or bag: open it
							ExamineItem(ItemX)
						Else
							' move into inventory
							' [Titi 2.6.0] but only if no Pre-Take trigger or equivalent doesn't prevent from doing so!
							' TradeItem CreatureWithTurn, CreatureWithTurn, bdInvEncounter, bdInvObjects, 0, 0, ItemX ', True
							'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvEncounter, bdInvObjects, 0, 0, ItemX) = False Then Exit Sub
						End If
					End If
					If Button = VB6.MouseButtonConstants.RightButton Then
						'UPGRADE_WARNING: Untranslated statement in SearchClick. Please check source code.
						' Don't show warning message if item already examined
						If ItemX.Examined = False Then
							DialogSetUp(bdDlgNoReply)
							DialogSetButton(1, "No")
							DialogSetButton(2, "Yes")
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Male. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							DialogShow("DM", IIf(ItemX.Capacity > 0, "Opening the ", "Examining the ") & ItemX.Name & " may trigger traps and harm " & CreatureWithTurn.Name & "." & vbCrLf & vbCrLf & "Will " & IIf(CreatureWithTurn.Male, "he", "she") & " try anyway?")
							DialogHide()
							'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If ConvoAction = 0 Then
								ExamineItem(ItemX)
							End If
						Else
							ExamineItem(ItemX)
						End If
					Else
						'UPGRADE_ISSUE: PictureBox method picInvDrag.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						picInvDrag.Cls()
						LoadItemPic(ItemX)
						Select Case ItemPicWidth(ItemX.Pic)
							Case 32 : Width_Renamed = 34
							Case 64 : Width_Renamed = 68
						End Select
						Select Case ItemPicHeight(ItemX.Pic)
							Case 32 : Height_Renamed = 34
							Case 64 : Height_Renamed = 68
							Case 96 : Height_Renamed = 102
						End Select
						For i = 1 To 80
							'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(i). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If InvZ(i) = ItemX.InvSpot Then InvZ(i) = -1
						Next i
						picInvDrag.Width = Width_Renamed : picInvDrag.Height = Height_Renamed
						'UPGRADE_ISSUE: PictureBox property picSearch.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						'UPGRADE_ISSUE: PictureBox property picInvDrag.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						rc = BitBlt(picInvDrag.hdc, 0, 0, Width_Renamed, Height_Renamed, picSearch.hdc, 22 + ((ItemX.InvSpot - 1) Mod 8) * 34, 44 + Int((ItemX.InvSpot - 1) / 8) * 34, SRCCOPY)
						picInvDrag.Refresh()
						' Ready for Drag/Drop
						'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						JournalX = AtX - 23 - ((ItemX.InvSpot - 1) Mod 8) * 34
						'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						JournalY = AtY - 45 - Int((ItemX.InvSpot - 1) / 8) * 34
						InvDragItem = ItemX
						'UPGRADE_WARNING: Couldn't resolve default property of object InvDragPos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InvDragPos = c
						'UPGRADE_WARNING: Couldn't resolve default property of object InvDragIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InvDragIndex = 0
						'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InvDragMode = True
						' [Titi 2.5.1] if container is opened on the ground (double-click), no drag/drop!
						If ItemX.Capacity > 0 And blnSearch Then
							'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							InvDragMode = False
						End If
						'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InvDragItem.Selected = True
					End If
					Exit For
				End If
			Next c
		End If
	End Sub
	
	Private Sub Search()
		Dim Frozen As Object
		Dim ScrollTop As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureWithTurn As Object
		Dim CreatureNow As Object
		Dim DialogHide As Object
		Dim DialogDM As Object
		Dim EncounterNow As Object
		Dim Found, NoFail As Short
		Dim CreatureX As Creature
		Dim ItemX, ItemZ As Item
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			' [Titi 2.4.9] You cannot even try to search while in combat!
			'        If (EncounterNow.HaveEntered = False Or (CreatureX.Agressive = True And CreatureX.HPNow > 0)) And EncounterNow.Creatures.Count > 0 Then
			' [Titi 2.5.1] If you're inanimate, you can't guard, right?
			'        If (CreatureX.Agressive = True And CreatureX.HPNow > 0 And CreatureX.Friendly = False) And EncounterNow.CanFight = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanFight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If (CreatureX.Agressive = True And CreatureX.HPNow > 0 And CreatureX.Friendly = False And CreatureX.IsInanimate = False) And EncounterNow.CanFight = True Then
				DialogDM("You can't search while fighting...")
				DialogHide()
				CombatStart()
				Exit Sub
			End If
			If CreatureX.Guard = True And CreatureX.AllowedTurn = True Then
				Found = True
				Exit For
			End If
		Next CreatureX
		If Found Then
			DialogDM("You can't search while the " & CreatureX.Name & " is guarding.")
			DialogHide()
		Else
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(EncounterNow, bdPreSearch)
			If NoFail Then
				' [Titi 2.6.0] No need to dump the items as of 2.6.0, dead bodies can now be searched
				' Dump Creatures Items into Encounter
				'            For Each CreatureX In EncounterNow.Creatures
				'                If CreatureX.AllowedTurn = False Then
				'                    For Each ItemX In CreatureX.Items
				'                        ItemX.IsReady = False
				'                        EncounterNow.AddItem.Copy ItemX
				'                        CreatureX.RemoveItem "I" & ItemX.Index
				'                    Next ItemX
				'                End If
				'            Next CreatureX
				' Generate any random items as required
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemX In EncounterNow.Items
					If IsBetween(ItemX.Family, 9, 13) Then
						MakeItem(ItemX)
					End If
				Next ItemX
				' [Titi 2.5.1] Search for traps
				SearchTraps()
				' Check for any Items to find
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If EncounterNow.Items.Count < 1 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogDM(CreatureWithTurn.Name & " searches, but doesn't find anything.")
					DialogHide()
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollTop = 1
					SearchShow()
					'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Frozen = True
				End If
			End If
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub SearchDrag(ByRef AtX As Short, ByRef AtY As Short)
		Dim Tome_Renamed As Object
		Dim bdInvObjects As Object
		Dim MenuParty As Object
		Dim InvZ As Object
		Dim bdInvEncounter As Object
		Dim CreatureWithTurn As Object
		Dim EncounterNow As Object
		Dim InvDragMode As Object
		Dim InvDragItem As Object
		Dim X, c, Y As Short
		Dim ItemX As Item
		' No matter what, shut off dragging Item
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvDragItem.Selected = False
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvDragMode = False
		picInvDrag.Visible = False
		' [Titi 2.6.0] now, check if dragging is intended (as opposed to double-click with a slight mouse move!)
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemX In EncounterNow.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemX.Index = InvDragItem.Index And ItemX.Name = InvDragItem.Name Then
				c = True
				Exit For
			End If
		Next ItemX
		If Not c Then Exit Sub ' means the item doesn't exist any longer! Skip the drag part...
		' First, check if droppping onto an open Container
		If PointIn(AtX, AtY, (picSearch.Left), (picSearch.Top), (picSearch.Width), (picSearch.Height)) Then
			' Drop on Search
			For c = 1 To 80
				X = picSearch.Left + 23 + ((c - 1) Mod 8) * 34
				Y = picSearch.Top + 45 + Int((c - 1) / 8) * 34
				If PointIn(AtX, AtY, X, Y, 34, 34) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvZ(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TradeItem(CreatureWithTurn, CreatureWithTurn, bdInvEncounter, bdInvEncounter, InvZ(c), c, InvDragItem)
					SearchShow()
					Exit For
				End If
			Next c
		ElseIf AtY > picMenu.Top Then 
			' Drop to Party member
			c = Greatest(Least(Int((AtX - picMenu.Left) / 122), 4), 0)
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, 0, Tome.Creatures.Count - 1) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object MenuParty(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TradeItem(CreatureWithTurn, MenuParty(c), bdInvEncounter, bdInvObjects, 0, 0, InvDragItem)
			End If
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub UseShow(ByRef ItemToUse As Item)
		Dim DialogDM As Object
		Dim Tome_Renamed As Object
		Dim CreatureTarget As Object
		Dim ItemTarget As Object
		Dim DialogBrief As Object
		Dim GlobalDamageRoll As Object
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim CreatureWithTurn As Object
		Dim OldActionPoints, Found, NoFail, rc As Short
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim ItemX As Item
		Dim TriggerX As Trigger
		Dim StmtX As Statement
		Dim HasTarget As Short
		Dim Text_Renamed As String
		Dim DiceType, DiceCnt, InVar, intDuration As Short ' [Titi 2.4.9b] used to determine the food effects
		' Save actions points. If find use, deduct (if Trigger does not do it)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		OldActionPoints = CreatureWithTurn.ActionPoints
		Found = False
		' Fire Pre-UseInEncounter
		If HasTrigger(EncounterNow, bdPreUseInEncounter) = True Then
			CreatureNow = CreatureWithTurn
			ItemNow = ItemToUse
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(EncounterNow, bdPreUseInEncounter)
			Found = True
		End If
		' Determine what type of item is being used and use it
		CreatureNow = CreatureWithTurn
		ItemNow = ItemToUse
		' [Titi 2.4.9b] Case of the Food family (new addition)
		If ItemToUse.Family = 3 Then
			InVar = ItemToUse.Damage - 1
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalDamageRoll = 0
			DiceCnt = InVar Mod 5 + 1
			DiceType = Int((InVar Mod 25) / 5) * 2 + 4
			If InVar > 24 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalDamageRoll = GlobalDamageRoll + Int(InVar / 25)
			End If
			For Found = 1 To DiceCnt
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalDamageRoll = GlobalDamageRoll + Int(Rnd() * DiceType) + 1
			Next 
			Select Case ItemToUse.DamageType - 1
				Case 0
					' None
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.RemoveItem("I" & ItemToUse.Index)
					' [Titi 2.6.0] flavor text
					If picGrid.Visible = True Then ' In combat
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.Name & " ate the " & ItemToUse.Name & ".")
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogBrief(CreatureWithTurn, CreatureWithTurn.Name & " ate the " & ItemToUse.Name & ".")
					End If
				Case 1
					' Heal
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.HPNow = CreatureWithTurn.HPNow + GlobalDamageRoll
					If picGrid.Visible = True Then ' In combat
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.Name & " feels refreshed.")
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogBrief(CreatureWithTurn, CreatureWithTurn.Name & " feels refreshed.")
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.RemoveItem("I" & ItemToUse.Index)
				Case 2
					'Sickness
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.HPNow = CreatureWithTurn.HPNow - GlobalDamageRoll
					If picGrid.Visible = True Then ' In combat
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.Name & " feels sick.")
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogBrief(CreatureWithTurn, CreatureWithTurn.Name & " feels sick.")
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.RemoveItem("I" & ItemToUse.Index)
				Case 3
					' Energy
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Eternium. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.Eternium = CreatureWithTurn.Eternium + GlobalDamageRoll
					If picGrid.Visible = True Then ' In combat
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.Name & " feels rested.")
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogBrief(CreatureWithTurn, CreatureWithTurn.Name & " feels rested.")
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.RemoveItem("I" & ItemToUse.Index)
				Case 4
					' Fatigue
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Eternium. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.Eternium = CreatureWithTurn.Eternium - GlobalDamageRoll
					If picGrid.Visible = True Then ' In combat
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.Name & " feels exhausted.")
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogBrief(CreatureWithTurn, CreatureWithTurn.Name & " feels exhausted.")
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.RemoveItem("I" & ItemToUse.Index)
				Case 5
					' Poison
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.HPNow = CreatureWithTurn.HPNow - GlobalDamageRoll
					'                Set TriggerX = New Trigger
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AddTrigger. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TriggerX = CreatureWithTurn.AddTrigger
					TriggerX.Name = "Poisoned food"
					TriggerX.TriggerType = bdPreTurn
					TriggerX.IsPoison = True
					TriggerX.Turns = ItemToUse.MinLevel
					StmtX = TriggerX.AddStatement
					' Put CreatureNow.Health - Random.010 Into CreatureNow.Health
					StmtX.Statement = 12 : StmtX.B(0) = 12 : StmtX.B(1) = 23 : StmtX.B(2) = 2 : StmtX.B(3) = 32 : StmtX.B(4) = 9 : StmtX.B(5) = 12 : StmtX.B(6) = 23
					If picGrid.Visible = True Then ' In combat
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.Name & " feels very ill.")
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogBrief(CreatureWithTurn, CreatureWithTurn.Name & " feels very ill.")
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.RemoveItem("I" & ItemToUse.Index)
				Case 6
					' Curse
					'                Set TriggerX = New Trigger
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AddTrigger. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TriggerX = CreatureWithTurn.AddTrigger
					TriggerX.Name = "Cursed food"
					TriggerX.TriggerType = bdPreTurn
					TriggerX.IsCurse = True
					Select Case ItemToUse.MinLevel
						Case 1 To 5
							intDuration = 5 + Int(Rnd(10)) + ItemToUse.MinLevel
						Case 6 To 10
							intDuration = 20 + Int(Rnd(20)) + ItemToUse.MinLevel
						Case 11 To 20
							intDuration = 50 + Int(Rnd(30)) + ItemToUse.MinLevel
						Case 20 To 40
							intDuration = 100 + Int(Rnd(100)) + ItemToUse.MinLevel
						Case Else
							intDuration = 0 ' infinite
					End Select
					TriggerX.Turns = CByte(intDuration)
					StmtX = TriggerX.AddStatement
					' Put CreatureNow.<Str/Agl/Int/Att/Dmg/Def/Armor>Bonus - Random.010 Into CreatureNow.<Str/Agl/Int/Att/Dmg/Def/Armor>Bonus
					StmtX.Statement = 12 : StmtX.B(0) = 12 : StmtX.B(1) = 137 + Int(Rnd(7)) : StmtX.B(2) = 2 : StmtX.B(3) = 32 : StmtX.B(4) = 9 : StmtX.B(5) = 12 : StmtX.B(6) = StmtX.B(1)
					If picGrid.Visible = True Then ' In combat
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.Name & " feels bad.")
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogBrief(CreatureWithTurn, CreatureWithTurn.Name & " feels bad.")
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.RemoveItem("I" & ItemToUse.Index)
				Case 7
					' Random
					ItemToUse.DamageType = Int(Rnd() * 8)
					ItemToUse.Damage = Int(Rnd() * 9)
					UseShow(ItemToUse)
			End Select
			' [Titi 2.6.0] refresh screen!
			If picGrid.Visible = True Then
				CombatDraw()
			Else
				MenuDrawParty()
			End If
			Exit Sub
		End If
		' [Titi 2.6.0] Check if required level is reached
		' If HasTrigger(ItemToUse, bdOnUseOnItem) = True Then
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If HasTrigger(ItemToUse, bdOnUseOnItem) = True And CreatureNow.Level >= ItemToUse.MinLevel Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TargetItem(ItemTarget) = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(ItemTarget, bdPreUseOnItem). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If FireTriggers(ItemTarget, bdPreUseOnItem) = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemToUse, bdOnUseOnItem)
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemTarget, bdPostUseOnItem)
				End If
			End If
			Found = True
			' [Titi 2.6.0] Check if required level is reached
			'ElseIf HasTrigger(ItemToUse, bdOnUseOnCreature) = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf HasTrigger(ItemToUse, bdOnUseOnCreature) = True And CreatureNow.Level >= ItemToUse.MinLevel Then 
			NoFail = True
			For	Each TriggerX In ItemToUse.Triggers
				If TriggerX.TriggerType = bdOnUseOnCreature Then
					' Determine if have a TargetCreature Statement
					If picGrid.Visible Then InventoryClose() ' [Titi 2.6.1] force the inventory screen to close to show the combat screen
					HasTarget = False
					For	Each StmtX In TriggerX.Statements
						If StmtX.Statement = 31 Then ' TargetCreature
							HasTarget = True
							Exit For
						End If
					Next StmtX
					If HasTarget = False Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						HasTarget = TargetCreature(CreatureTarget, 2, 0, False)
					End If
					If HasTarget = True Then
						NoFail = FireTrigger(ItemToUse, TriggerX)
						If NoFail = True Then
							'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							NoFail = FireTriggers(CreatureTarget, bdPostUseOnCreature)
						End If
					End If
					Found = True
				End If
			Next TriggerX
			Found = True
			' [Titi 2.6.0] Check if required level is reached
			' ElseIf HasTrigger(ItemToUse, bdOnUseInEncounter) = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf HasTrigger(ItemToUse, bdOnUseInEncounter) = True And CreatureNow.Level >= ItemToUse.MinLevel Then 
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(ItemToUse, bdOnUseInEncounter)
			Found = True
		ElseIf ItemToUse.Family = 1 Then 
			' DoorOpen with Key
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DoorOpen(Tome.MapX, Tome.MapY)
			Found = True
			' [Titi 2.4.9b] what if we want to split and not use? --> moved to DialogItem
			'    ElseIf ItemToUse.Count > 1 Then
			'        DialogDM "You split the " & ItemToUse.Name & " into two piles."
			'        Set ItemX = CreatureWithTurn.AddItem
			'        ItemX.Copy ItemToUse
			'        ItemToUse.Count = Int(ItemToUse.Count / 2) + (ItemToUse.Count Mod 2)
			'        ItemToUse.Value = Int(ItemToUse.Value / 2) + (ItemToUse.Value Mod 2)
			'        ItemToUse.Weight = Int(ItemToUse.Weight / 2) + (ItemToUse.Weight Mod 2)
			'        ItemToUse.Bulk = Int(ItemToUse.Bulk / 2) + (ItemToUse.Bulk Mod 2)
			'        ItemX.Count = Int(ItemX.Count / 2)
			'        ItemX.Value = Int(ItemX.Value / 2)
			'        ItemX.Weight = Int(ItemX.Weight / 2)
			'        ItemX.Bulk = Int(ItemX.Bulk / 2)
			'        ItemX.IsReady = False
			'        ItemX.InvSpot = 0
			'        Found = True
		End If
		' Fire Post-UseInEncounter
		' [Titi 2.6.0] Check if required level is reached
		' If HasTrigger(EncounterNow, bdPostUseInEncounter) Then
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If HasTrigger(EncounterNow, bdPostUseInEncounter) And CreatureNow.Level >= ItemToUse.MinLevel Then
			CreatureNow = CreatureWithTurn
			ItemNow = ItemToUse
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(EncounterNow, bdPostUseInEncounter)
			Found = True
			' [Titi 2.4.9b] if you use a container, something happens: you open it
		ElseIf Found = False Then 
			If ItemToUse.Capacity = 0 Then
				DialogDM("Nothing happens.")
			Else
				Select Case ItemToUse.Size
					Case 1
						Text_Renamed = " tiny "
					Case 2
						Text_Renamed = " small "
					Case 3
						Text_Renamed = " medium "
					Case 4
						Text_Renamed = " large "
					Case 5
						Text_Renamed = " huge "
				End Select
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.Level >= ItemToUse.MinLevel Then
					'   DialogDM "The " & ItemToUse.Name & " can store items up to" & Text & "size."
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogDM(CreatureWithTurn.Name & " is not experienced enough to use the " & ItemToUse.Name & ".")
				End If
			End If
		End If
		' If had a Use, deduct Action Points
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Found = True And CreatureWithTurn.ActionPoints = OldActionPoints Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.ActionPoints = CreatureWithTurn.ActionPoints - 5
		End If
	End Sub
	
	Private Sub SearchTraps(Optional ByRef blnInCombat As Boolean = False)
		Dim DialogBrief As Object
		Dim DialogDM As Object
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim GlobalRemoveTrapChance As Object
		Dim CreatureWithTurn As Object
		Dim NoFail, Found As Short
		Dim TriggerX As Trigger
		Dim ItemX As Item
		Found = False
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Will. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Agility. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalRemoveTrapChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalRemoveTrapChance = CreatureWithTurn.Agility + CreatureWithTurn.Will
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(EncounterNow, bdPreSearchTraps)
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(CreatureWithTurn, bdPreSearchTraps)
		If NoFail Then
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each TriggerX In EncounterNow.Triggers
				If TriggerX.IsTrap Then
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalRemoveTrapChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Int(Rnd() * 100) < GlobalRemoveTrapChance Then
						DialogDM("You found and removed the " & TriggerX.Name & " in this area.")
						'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.RemoveTrigger. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						EncounterNow.RemoveTrigger("T" & TriggerX.Index)
						Found = True
					End If
				End If
			Next TriggerX
			If blnInCombat Then Exit Sub
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each ItemX In EncounterNow.Items
				CreatureNow = CreatureWithTurn
				ItemNow = ItemX
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemX, bdPreSearchTraps)
				If NoFail Then
					For	Each TriggerX In ItemX.Triggers
						If TriggerX.IsTrap Then
							'UPGRADE_WARNING: Couldn't resolve default property of object GlobalRemoveTrapChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If Int(Rnd() * 100) < GlobalRemoveTrapChance Then
								DialogDM("You found and removed the " & TriggerX.Name & " on the " & ItemX.Name & ".")
								ItemX.RemoveTrigger("T" & TriggerX.Index)
								Found = True
							End If
						End If
					Next TriggerX
					CreatureNow = CreatureWithTurn
					ItemNow = ItemX
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemX, bdPostSearchTraps)
				End If
			Next ItemX
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(CreatureNow, bdPostSearchTraps)
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(EncounterNow, bdPostSearchTraps)
		End If
		If Not Found Then
			' [Titi 2.6.0] changed to a brief box
			'DialogDM "You don't find any traps."
			DialogBrief("Whew! No Traps!", "You don't find any traps.")
		End If
	End Sub
	
	Private Sub TargetCreatureClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short)
		Dim ScrollSelect As Object
		Dim ScrollList As Object
		Dim ScrollTop As Object
		Dim c As Short
		Dim rc As Integer
		If PointIn(AtX, AtY, 331, 2, 18, 269) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ScrollBarClick(AtX, AtY, ButtonDown, picConvoList, 331, 2, 269, ScrollTop, ScrollList.Count, 2) = True Then
				TargetCreatureShow()
			End If
		ElseIf PointIn(AtX, AtY, 12, 9, 275, 328) And ButtonDown = False Then 
			' Pick Creature in List
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = Int((AtY - 9) / 87) + ScrollTop
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If c > 0 And c <= ScrollList.Count Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollSelect = c
				TargetCreatureShow()
				'UPGRADE_WARNING: Untranslated statement in TargetCreatureClick. Please check source code.
			End If
		End If
	End Sub
	
	Private Sub TargetCreatureShow()
		Dim ScrollSelect As Object
		Dim bdFaceSelect As Object
		Dim bdFontNoxiousWhite As Object
		Dim bdFontElixirWhite As Object
		Dim bdFaceMin As Object
		Dim ScrollList As Object
		Dim ScrollTop As Object
		Dim c, Pos, i As Short
		Dim rc As Integer
		Dim CreatureX As Creature
		Dim TriggerX As Trigger
		Pos = 0
		'UPGRADE_ISSUE: PictureBox method picConvoList.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picConvoList.Cls()
		'UPGRADE_ISSUE: PictureBox method picInvDrag.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picInvDrag.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = ScrollTop To Least(ScrollTop + 2, ScrollList.Count)
			CreatureX = ScrollList(c)
			' Show Picture
			LoadCreaturePic(CreatureX)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picConvoList.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picConvoList.hdc, 8, 8 + 87 * Pos, 74, 84, picMisc.hdc, 0, 36, SRCCOPY)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picConvoList.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picConvoList.hdc, 12, 12 + 87 * Pos, 66, 76, picFaces.hdc, bdFaceMin + CreatureX.Pic * 66, 0, SRCCOPY)
			' Show name and stats
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picConvoList, 80, 12 + 87 * Pos, 250, 14, bdFontElixirWhite, (CreatureX.Name), True, False)
			If CreatureX.HPNow < 1 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picConvoList, 80, 28 + 87 * Pos, 250, 14, bdFontNoxiousWhite, "Lvl " & CreatureX.Level & " * Health DEAD", True, False)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picConvoList, 80, 28 + 87 * Pos, 250, 14, bdFontNoxiousWhite, "Lvl " & CreatureX.Level & " * Health " & CreatureX.HPNow & " of " & CreatureX.HPMax, True, False)
			End If
			' Show 3 skills
			i = 0
			For	Each TriggerX In CreatureX.Triggers
				If TriggerX.IsSkill = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picConvoList, 80, 44 + 87 * Pos + i * 16, 250, 14, bdFontNoxiousWhite, (TriggerX.Name), True, False)
					i = i + 1
					If i > 2 Then
						Exit For
					End If
				End If
			Next TriggerX
			If i = 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picConvoList, 80, 44 + 87 * Pos, 250, 14, bdFontNoxiousWhite, "No Skills", True, False)
			End If
			' Show Select Box
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ScrollSelect = c Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picConvoList.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picConvoList.hdc, 12, 12 + 87 * Pos, 66, 76, picFaces.hdc, bdFaceSelect + 66, 0, SRCAND)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picConvoList.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picConvoList.hdc, 12, 12 + 87 * Pos, 66, 76, picFaces.hdc, bdFaceSelect, 0, SRCPAINT)
			End If
			Pos = Pos + 1
		Next c
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollBarShow(picConvoList, 331, 2, 269, ScrollTop, ScrollList.Count - 2, 0)
	End Sub
	
	Private Sub TargetCreatureRightClick()
		Dim CreatureTarget As Object
		Dim CreatureWithTurn As Object
		' Check for Skill or Spell
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.CombatAction2 > 0 Then
		Else
			
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TargetCreatureSave(CreatureTarget). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TargetCreatureSave(CreatureTarget) = True Then
			
		End If
	End Sub
	
	Private Function TargetCreatureSave(ByRef CreatureTargeted As Creature) As Object
		Dim GlobalSaveStyle As Object
		Dim DialogHide As Object
		Dim DialogDM As Object
		Dim DialogDice As Object
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim i, c, SaveThrow As Short
		Dim Text_Renamed As String
		'UPGRADE_WARNING: Couldn't resolve default property of object TargetCreatureSave. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TargetCreatureSave = False
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSaveStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If GlobalSaveStyle > 0 And CreatureTargeted.Family(0) = True Then
			For c = 8 To 13
				If (GlobalSaveStyle And (2 ^ c)) > 0 Then
					Select Case c
						Case 8 ' Lunacy
							SaveThrow = CreatureTargeted.Lunacy
							Text_Renamed = "Lunacy"
						Case 9 ' Revelry
							SaveThrow = CreatureTargeted.Revelry
							Text_Renamed = "Revelry"
						Case 10 ' Wrath
							SaveThrow = CreatureTargeted.Wrath
							Text_Renamed = "Wrath"
						Case 11 ' Pride
							SaveThrow = CreatureTargeted.Pride
							Text_Renamed = "Pride"
						Case 12 ' Greed
							SaveThrow = CreatureTargeted.Greed
							Text_Renamed = "Greed"
						Case 13 ' Lust
							SaveThrow = CreatureTargeted.Lust
							Text_Renamed = "Lust"
					End Select
					If CreatureTargeted.DMControlled = False Then
						DialogDice(CreatureTargeted, "Roll verses your " & Text_Renamed & " Vice.", 25, i)
						If i > SaveThrow Then
							DialogDM(CreatureTargeted.Name & " saves and is unaffected!")
							DialogHide()
							'UPGRADE_WARNING: Couldn't resolve default property of object TargetCreatureSave. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TargetCreatureSave = True
							Exit For
						End If
						DialogHide()
					ElseIf Int(Rnd() * 20) + 1 > SaveThrow Then 
						DialogDM(CreatureTargeted.Name & " saves and is unaffected!")
						DialogHide()
						'UPGRADE_WARNING: Couldn't resolve default property of object TargetCreatureSave. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TargetCreatureSave = True
						Exit For
					End If
				End If
			Next c
		End If
	End Function
	
	Public Function TargetCreature(ByRef CreatureTargeted As Creature, ByVal Range As Short, ByRef WithMotive As Short, ByRef AllowDead As Short) As Short
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim ScrollSelect As Object
		Dim ScrollTop As Object
		Dim ScrollList As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim CreatureTarget As Object
		Dim ConvoAction As Object
		Dim EncounterNow As Object
		Dim CreatureWithTurn As Object
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim SaveThrow, c, Found As Short
		Dim Text_Renamed As String
		Dim CreatureX As Creature
		Dim OldPointer As Short
		' Move 0 = Any, 1 = Party Only, 2 = Non-Party Only
		' If this is a DM controlled Creature, then Target with a Motive
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.DMControlled. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.DMControlled = True Then
			Found = False
			Select Case WithMotive
				Case 0 ' Any (Tome is first choice)
					For	Each CreatureX In Tome.Creatures
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(CreatureWithTurn, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CombatRange(CreatureWithTurn, (CreatureX.Col), (CreatureX.Row)) <= Range And (Found = False Or Int(Rnd() * 2) < 1) And (CreatureX.HPNow > 0 Or AllowDead > 0) Then
							CreatureTargeted = CreatureX
							Found = True
						End If
					Next CreatureX
					' If can't find one in the Party, then try the Encounter
					If Found = False Then
						'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						For	Each CreatureX In EncounterNow.Creatures
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(CreatureWithTurn, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If CombatRange(CreatureWithTurn, (CreatureX.Col), (CreatureX.Row)) <= Range And (Found = False Or Int(Rnd() * 2) < 1) And (CreatureX.HPNow > 0 Or AllowDead > 0) Then
								CreatureTargeted = CreatureX
								Found = True
							End If
						Next CreatureX
					End If
				Case 1 ' PartyOnly
					For	Each CreatureX In Tome.Creatures
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(CreatureWithTurn, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CombatRange(CreatureWithTurn, (CreatureX.Col), (CreatureX.Row)) <= Range And (CreatureX.HPNow > 0 Or AllowDead > 0) Then
							CreatureTargeted = CreatureX
							Found = True
							Exit For
						End If
					Next CreatureX
				Case 2 ' NonPartyOnly
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each CreatureX In EncounterNow.Creatures
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(CreatureWithTurn, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CombatRange(CreatureWithTurn, (CreatureX.Col), (CreatureX.Row)) <= Range And (CreatureX.HPNow > 0 Or AllowDead > 0) Then
							CreatureTargeted = CreatureX
							Found = True
							Exit For
						End If
					Next CreatureX
			End Select
			' Show who is being targeted if this is in combat
			TargetCreature = Found
			If picGrid.Visible = True And Found Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CombatDrawAttack(CreatureWithTurn, CreatureTargeted, False)
			End If
		Else
			'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			OldPointer = System.Windows.Forms.Cursor.Current
			'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
			Select Case WithMotive
				Case 0 ' Any
					MenuNow = bdMenuTargetAny
				Case 1 ' PartyOnly
					MenuNow = bdMenuTargetParty
				Case 2 ' NonPartyOnly
					MenuNow = bdMenuTargetCreature
			End Select
			' Else you can let the Player do the Targeting.
			If picGrid.Visible = True Then
				' In combat, do normal highlight to select
				TargetCreatureRange = Range
				TargetAllowDead = (AllowDead > 0)
				'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ConvoAction = -1
				MessageShow("Target a Creature (Esc to Cancel)", 0)
				picGrid.Focus()
				'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Do Until ConvoAction > -1
					System.Windows.Forms.Application.DoEvents()
				Loop 
				CombatDraw()
				TargetCreatureRange = 0
				TargetAllowDead = 0
				'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ConvoAction > 0 Then
					CreatureTargeted = CreatureTarget
					TargetCreature = True
					' Show ToHit number
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CombatDrawAttack(CreatureWithTurn, CreatureTargeted, False)
				Else
					TargetCreature = False
				End If
				MenuNow = bdMenuDefault
			Else
				DialogSetUp(bdDlgCreatureList)
				DialogSetButton(1, "Done")
				DialogSetButton(2, "Cancel")
				ScrollList = New Collection
				If WithMotive = 0 Or WithMotive = 2 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each CreatureX In EncounterNow.Creatures
						If CreatureX.HPNow > 0 Or AllowDead > 0 Then
							'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ScrollList.Add(Item:=CreatureX)
						End If
					Next CreatureX
				End If
				If WithMotive = 0 Or WithMotive = 1 Then
					For	Each CreatureX In Tome.Creatures
						If CreatureX.HPNow > 0 Or AllowDead > 0 Then
							'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ScrollList.Add(Item:=CreatureX)
						End If
					Next CreatureX
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollTop = 1
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollSelect = 1
				TargetCreatureShow()
				DialogShow("DM", "Target Creature")
				DialogHide()
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ConvoAction = 1 And ScrollList.Count >= ScrollSelect Then
					CreatureTargeted = ScrollList(ScrollSelect)
					TargetCreature = True
				Else
					TargetCreature = False
				End If
				' [Titi 2.5.1] Freeze bug here if MenuNow was still set to bdMenuTargetParty!
				MenuNow = bdMenuDefault
				'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ConvoAction = 0
			End If
			'UPGRADE_ISSUE: Screen property Screen.MousePointer does not support custom mousepointers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="45116EAB-7060-405E-8ABE-9DBB40DC2E86"'
			'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = OldPointer
		End If
		' Check for a Saving Throw (if allowed and creature is sentient)
		'UPGRADE_WARNING: Couldn't resolve default property of object TargetCreatureSave(CreatureTargeted). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TargetCreature = True And TargetCreatureSave(CreatureTargeted) = True Then
			TargetCreature = False
		End If
	End Function
	
	Private Sub TargetItemClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short)
		Dim ScrollSelect As Object
		Dim ScrollList As Object
		Dim ScrollTop As Object
		Dim c As Short
		Dim rc As Integer
		If PointIn(AtX, AtY, 331, 2, 18, 269) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ScrollBarClick(AtX, AtY, ButtonDown, picConvoList, 331, 2, 269, ScrollTop, ScrollList.Count, 6) = True Then
				TargetItemShow()
			End If
		ElseIf PointIn(AtX, AtY, 12, 9, 275, 328) And ButtonDown = False Then 
			' Pick Item in List
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = Int((AtY - 9) / 37) + ScrollTop
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If c > 0 And c <= ScrollList.Count Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollSelect = c
				TargetItemShow()
				'UPGRADE_WARNING: Untranslated statement in TargetItemClick. Please check source code.
			End If
		End If
	End Sub
	
	Private Sub TargetItemShow()
		Dim ScrollSelect As Object
		Dim bdFontNoxiousWhite As Object
		Dim bdFontNoxiousGold As Object
		Dim ItemPicHeight As Object
		Dim ItemPicWidth As Object
		Dim ScrollList As Object
		Dim ScrollTop As Object
		Dim Pos, c As Short
		Dim rc As Integer
		Dim ItemX As Item
		Pos = 0
		'UPGRADE_ISSUE: PictureBox method picConvoList.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picConvoList.Cls()
		'UPGRADE_ISSUE: PictureBox method picInvDrag.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picInvDrag.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = ScrollTop To Least(ScrollTop + 6, ScrollList.Count)
			ItemX = ScrollList(c)
			' Show Picture
			LoadItemPic(ItemX)
			'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picConvoList.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picConvoList.hdc, 12, 9 + 37 * Pos, ItemPicWidth(ItemX.Pic) / 3, ItemPicHeight(ItemX.Pic) / 3, picItem.hdc, 64 * ItemX.Pic - 32, 96 * 2, SRCAND)
			'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picConvoList.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picConvoList.hdc, 12, 9 + 37 * Pos, ItemPicWidth(ItemX.Pic) / 3, ItemPicHeight(ItemX.Pic) / 3, picItem.hdc, 64 * ItemX.Pic - 64, 96 * 2, SRCPAINT)
			' Show Description
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ScrollSelect = c Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picConvoList, 53, 20 + 37 * Pos, 275, 14, bdFontNoxiousGold, (ItemX.Name), False, False)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picConvoList, 53, 20 + 37 * Pos, 275, 14, bdFontNoxiousWhite, (ItemX.Name), False, False)
			End If
			Pos = Pos + 1
		Next c
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollBarShow(picConvoList, 331, 2, 269, ScrollTop, ScrollList.Count - 6, 0)
	End Sub
	
	Public Function TargetItem(ByRef IntoItem As Item) As Short
		Dim ConvoAction As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim ScrollSelect As Object
		Dim EncounterNow As Object
		Dim CreatureNow As Object
		Dim ScrollTop As Object
		Dim ScrollList As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim ItemX As Item
		Dim CreatureX As Creature
		Dim Found As Short
		' Setup with List
		DialogSetUp(bdDlgItemList)
		DialogSetButton(1, "Done")
		DialogSetButton(2, "Cancel")
		ScrollList = New Collection
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollTop = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemX In CreatureNow.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ScrollList.Add(Item:=ItemX)
		Next ItemX
		' Check for Guarding creatures
		Found = False
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			If CreatureX.Guard = True And CreatureX.AllowedTurn = True Then
				Found = True
				Exit For
			End If
		Next CreatureX
		If Not Found Then
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each ItemX In EncounterNow.Items
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add(Item:=ItemX)
			Next ItemX
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollTop = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollSelect = 1
		TargetItemShow()
		DialogShow("DM", "Pick an Item")
		DialogHide()
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ConvoAction = 1 And ScrollList.Count > 0 Then ' [Titi 2.4.7] crash if nothing to appraise!
			IntoItem = ScrollList(ScrollSelect)
			TargetItem = True
		Else
			TargetItem = False
		End If
	End Function
	
	Public Sub MessageShow(ByRef InText As String, ByRef Index As Short)
		Dim bdFontSmallWhite As Object
		Dim c As Short
		Dim rc As Integer
		If picGrid.Visible = False Or Index <> 0 Then
			BorderDrawBottom()
			Select Case Index
				Case 0 ' Center
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, 0, Me.ClientRectangle.Height - 14, Me.ClientRectangle.Width, 14, bdFontSmallWhite, InText, True, False)
				Case 1 ' Right
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, 0, Me.ClientRectangle.Height - 14, Me.ClientRectangle.Width, 14, bdFontSmallWhite, InText, 1, False)
				Case 2 ' Left
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, 0, Me.ClientRectangle.Height - 14, Me.ClientRectangle.Width, 14, bdFontSmallWhite, InText, False, False)
			End Select
			Me.Refresh()
		Else
			CombatMessage(InText)
		End If
	End Sub
	
	Private Sub MessageClear()
		Dim c As Short
		For c = 0 To 2
			MessageShow("", c)
		Next c
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub MessageEncounterName(ByRef AtX As Short, ByRef AtY As Short)
		Dim bdFontNoxiousWhite As Object
		Dim bdIntHeight As Object
		Dim Map_Renamed As Object
		'UPGRADE_NOTE: my was upgraded to my_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Found, mx, my_Renamed, c As Short
		Dim rc As Integer
		Dim EncounterX As Encounter
		If Int(AtY / 16) Mod 3 = 1 Or (Int(AtY / 8) Mod 3 = 1 And Int((AtX - 24) / 48) Mod 2 = 0) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			mx = Map.Left + Int(AtX / 96) - Int(AtY / 48)
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			my_Renamed = Map.Top + Int(AtX / 96) + Int(AtY / 48)
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			mx = Map.Left + Int((AtX - 48) / 96) - Int((AtY - 24) / 48)
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			my_Renamed = Map.Top + Int((AtX + 48) / 96) + Int((AtY - 24) / 48)
		End If
		Found = False
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If IsBetween(mx, 0, Map.Width) And IsBetween(my_Renamed, 0, Map.Height) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Map.EncPointer(mx, my_Renamed) > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Encounters. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				EncounterX = Map.Encounters("E" & Map.EncPointer(mx, my_Renamed))
				If EncounterX.UseHint = True And EncounterX.HaveEntered = True Then
					BorderDrawBottom()
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, 0, Me.ClientRectangle.Height - bdIntHeight, Me.ClientRectangle.Width, 14, bdFontNoxiousWhite, (EncounterX.Name), True, False)
					Me.Refresh()
				End If
			End If
		End If
	End Sub
	
	Private Function ReadyItem(ByRef ToChar As Creature, ByRef ItemToReady As Item, Optional ByRef bWeaponOnly As Boolean = False) As Short
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim DialogDM As Object
		Dim c, NoFail As Short
		Dim ItemX As Item
		Dim WearType(11) As Short
		' [Titi 2.5.1] with the double-click support, we will only equip weapon
		If bWeaponOnly And (ItemToReady.Family < 4 Or ItemToReady.Family > 9) Then
			ReadyItem = False
			Exit Function
		End If
		' [Titi 2.5.1] Level and sizes will be checked only for party members!
		If ToChar.Friendly Or ToChar.DMControlled = False Then
			'    ' [Titi 2.4.9b] only use an item if it's been examined first!
			'    Finally decided to remove this test: more fun if you don't know the bonuses of your equipment because you forget to check it!
			'    If ItemToReady.Examined = False Then
			'        DialogDM ToChar.Name & " must first examine the " & ItemToReady.Name & "!"
			'        Exit Function
			'    End If
			' [Titi 2.4.9b] only use an item if experience enough!
			If ItemToReady.MinLevel > ToChar.Level Then
				DialogDM(ToChar.Name & " is not experienced enough to equip the " & ItemToReady.Name & "!")
				Exit Function
			End If
			' [Titi 2.4.9b] check if size matches
			If (ItemToReady.SizeBit(9) And 512) = 0 Then ' usable only by a specific size
				For c = 0 To 4
					If ToChar.Size(c) <> 0 Then NoFail = c
				Next 
				For c = 0 To 4
					If ItemToReady.Size < NoFail + 1 Then
						DialogDM("The " & ItemToReady.Name & " is too small for " & ToChar.Name)
						ReadyItem = False
						Exit Function
					ElseIf ItemToReady.Size > NoFail + 1 Then 
						DialogDM("The " & ItemToReady.Name & " is too big for " & ToChar.Name)
						ReadyItem = False
						Exit Function
					End If
				Next 
			End If
		End If
		' If in combat, then this Fails if equipping anything other than a OneHand Item.
		If picGrid.Visible = True And ItemToReady.WearType < 10 Then
			If ToChar.DMControlled = False Then
				DialogDM("You can only equip weapons during combat.")
			End If
			ReadyItem = False
			Exit Function
		End If
		' Fire Triggers on ReadyItem
		CreatureNow = ToChar
		ItemNow = ItemToReady
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(ToChar, bdPreReady)
		If NoFail Then
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(ItemToReady, bdPreReady)
			If NoFail Then
				' Count number of Items already worn
				For	Each ItemX In ToChar.Items
					If ItemX.IsReady = True Then
						WearType(ItemX.WearType) = WearType(ItemX.WearType) + ItemX.Count
					End If
				Next ItemX
				' Check if will be wearing too many
				ReadyItem = True
				Select Case ItemToReady.WearType
					Case 5, 10 ' Shield, OneHand
						If WearType(ItemToReady.WearType) > 0 Or WearType(11) > 0 Then
							ReadyItem = False
						End If
					Case 0, 1, 6, 7, 8 ' Body, Helm, Boots, Necklace, Belt
						' Can only wear one
						If WearType(ItemToReady.WearType) > 0 Then
							ReadyItem = False
						End If
					Case 2, 3, 4 ' Glove, Wrist, Backpack
						' Can wear only two
						If WearType(ItemToReady.WearType) > 1 Then
							ReadyItem = False
						End If
					Case 9 ' Rings
						' Can wear only eight
						If WearType(9) > 7 Then
							ReadyItem = False
						End If
					Case 11 ' TwoHand
						' Can only wear without OneHand, Shield or TwoHand
						If WearType(5) > 0 Or WearType(10) > 0 Or WearType(11) > 0 Then
							ReadyItem = False
						End If
				End Select
				' If conflicts then try to UnReady the offending item
				If ReadyItem = False Then
					' Loop through all ready itm
					For	Each ItemX In ToChar.Items
						If ItemX.IsReady = True And (ItemX.WearType = ItemToReady.WearType Or (ItemToReady.WearType = 11 And ItemX.WearType = 10 And WearType(5) = 0) Or (ItemToReady.WearType = 10 And ItemX.WearType = 11 And WearType(5) = 0)) Then
							ReadyItem = UnReadyItem(ToChar, ItemX)
							Exit For
						End If
					Next ItemX
				End If
				' Ready the Item
				If ReadyItem = True Then
					ItemToReady.IsReady = True
					CreatureNow = ToChar
					ItemNow = ItemToReady
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ToChar, bdPostReady)
					CreatureNow = ToChar
					ItemNow = ItemToReady
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemToReady, bdPostReady)
				Else
					' [Titi 2.6.0] explain why can't ready (double-click only)
					If bWeaponOnly Then
						If ItemToReady.WearType = 11 Then
							For	Each ItemX In ToChar.Items
								If ItemX.WearType = 5 And ItemX.IsReady = True Then
									DialogDM("The " & ItemToReady.Name & " is a two-handed weapon. You must put your " & ItemX.Name & " in the inventory before being able to wield it.")
									Exit For
								End If
							Next ItemX
						Else
							DialogDM("You cannot wear more of this type.")
						End If
					End If
				End If
			Else
				ReadyItem = False
			End If
		Else
			ReadyItem = False
		End If
	End Function
	
	Public Function UnReadyItem(ByRef FromChar As Creature, ByRef ItemToUnReady As Item, Optional ByRef bWeaponOnly As Boolean = False) As Short
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim DialogDM As Object
		Dim NoFail As Short
		' This fails if in Combat and UnReady anything other than a OneHand or TwoHand Item
		If picGrid.Visible = True And ItemToUnReady.WearType < 10 Then
			DialogDM("You can only equip weapons during combat.")
			UnReadyItem = False
			Exit Function
		End If
		' Set up for Triggers
		If ItemToUnReady.IsReady Then
			CreatureNow = FromChar
			ItemNow = ItemToUnReady
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(FromChar, bdPreUnReady)
			CreatureNow = FromChar
			ItemNow = ItemToUnReady
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(ItemToUnReady, bdPreUnReady)
			If NoFail Then
				' [Titi 2.5.1] only unequip item if not coming from a double-click
				If bWeaponOnly Then
					UnReadyItem = False
					Exit Function
				End If
				If FromChar.Bulk + ItemToUnReady.Bulk > FromChar.Agility * 8 Then 'was 100 - now depends on Agility
					' [Titi 2.4.8] added check bulk
					DialogDM("The " & ItemToUnReady.Name & " is too bulky for " & FromChar.Name & " to carry.")
					UnReadyItem = False
				Else
					ItemToUnReady.IsReady = False
					ItemToUnReady.InvSpot = 0
					CreatureNow = FromChar
					ItemNow = ItemToUnReady
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(FromChar, bdPostUnReady)
					CreatureNow = FromChar
					ItemNow = ItemToUnReady
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemToUnReady, bdPostUnReady)
					UnReadyItem = True
				End If
			Else
				UnReadyItem = False
			End If
		Else
			UnReadyItem = True
		End If
	End Function
	
	Public Function CombineWithAnything(ByRef ObjectX As Object, ByRef ItemX As Item) As Short
		' This combines ItemX with some Item in ObjectX (if it can find one)
		Dim ItemZ As Item
		Dim rc3, rc1, rc2, rc4 As Integer
		CombineWithAnything = False
		If ItemX.CanCombine = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ObjectX.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each ItemZ In ObjectX.Items
				If ItemZ.CanCombine = True And (ItemX.NameText = ItemZ.NameText Or (LCase(ItemX.NameText) = LCase(ItemZ.NameText) And ItemZ.IsMoney = True And ItemX.IsMoney = True)) Then ' [Titi 2.6.0] money is not case-sensitive any more
					rc1 = CInt(ItemZ.Count) + CInt(ItemX.Count)
					rc2 = CInt(ItemZ.Value) + CInt(ItemX.Value)
					rc3 = CInt(ItemZ.Weight) + CInt(ItemX.Weight)
					rc4 = CInt(ItemZ.Bulk) + CInt(ItemX.Bulk)
					If rc1 < 32700 And rc2 < 32700 And rc3 < 32700 And rc4 < 32700 Then
						ItemZ.Count = rc1
						ItemZ.Value = rc2
						ItemZ.Weight = rc3
						ItemZ.Bulk = rc4
						CombineWithAnything = True
						Exit For
					End If
				End If
				If ItemZ.Capacity > 0 Then
					If CombineWithAnything(ItemZ, ItemX) = True Then
						CombineWithAnything = True
						Exit For
					End If
				End If
			Next ItemZ
		End If
	End Function
	
	Private Function CombineItemsTriggers(ByRef FromChar As Creature, ByRef FromItem As Item, ByRef ToItem As Item) As Short
		Dim bdInvItems As Object
		Dim FireTriggers As Object
		Dim ItemTarget As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim c, NoFail As Short
		Dim ItemX As Item
		' Check if have any Combine Triggers to fire
		If HasTrigger(FromItem, bdPreCombine) Or HasTrigger(ToItem, bdPreCombine) Or HasTrigger(FromItem, bdOnCombine) Or HasTrigger(ToItem, bdOnCombine) Or HasTrigger(FromItem, bdPostCombine) Or HasTrigger(ToItem, bdPostCombine) Then
			CombineItemsTriggers = True
			' Create FromItem on FromCharacter
			ItemX = FromChar.AddItem
			ItemX.Copy(FromItem)
			' Fire PreCombine Triggers
			CreatureNow = FromChar
			ItemNow = ItemX : ItemTarget = ToItem
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(ItemX, bdPreCombine)
			CreatureNow = FromChar
			ItemNow = ToItem : ItemTarget = ItemX
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = FireTriggers(ToItem, bdPreCombine)
			If NoFail And c Then
				' Fire OnCombine Triggers
				CreatureNow = FromChar
				ItemNow = ItemX : ItemTarget = ToItem
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemX, bdOnCombine)
				CreatureNow = FromChar
				ItemNow = ToItem : ItemTarget = ItemX
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ToItem, bdOnCombine)
				If NoFail Then
					' Fire PostCombine Triggers
					CreatureNow = FromChar
					ItemNow = ItemX : ItemTarget = ToItem
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemX, bdPostCombine)
					CreatureNow = FromChar
					ItemNow = ToItem : ItemTarget = ItemX
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ToItem, bdPostCombine)
				End If
			End If
			' Refresh the Inventory screen
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InventoryShow(bdInvItems)
		End If
	End Function
	
	'UPGRADE_NOTE: Container was upgraded to Container_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Function CheckSize(ByRef Container_Renamed As Item, ByRef Thing As Item) As Boolean
		Dim IndexContainer, c, IndexThing As Short
		For c = 0 To 4
			If Thing.SizeBit(c + 4) <> 0 Then IndexThing = c
		Next 
		If IndexThing = 0 Then IndexThing = 2 ' if item created in a previous version of Creator, its size is unknown --> default to medium
		For c = 0 To 4
			If Container_Renamed.SizeBit(c + 4) <> 0 Then IndexContainer = c
		Next c
		If IndexContainer = 0 Then IndexContainer = 2 ' if item created in a previous version of Creator, its size is unknown --> default to medium
		CheckSize = (IndexContainer >= IndexThing) ' container must be at least as big as the item it needs to store
	End Function
	
	Private Function TradeItem(ByRef FromChar As Creature, ByRef ToChar As Creature, ByVal FromList As Short, ByVal ToList As Short, ByVal IntoIndex As Short, ByVal Spot As Short, ByRef ItemToTrade As Item, Optional ByRef blnDontShowMsg As Boolean = False) As Short
		Dim InvDragMode As Object
		Dim InvDragItem As Object
		Dim bdInvContainer As Object
		Dim bdInvEncounter As Object
		Dim InvContainer As Object
		Dim bdInvParty As Object
		Dim bdInvObjects As Object
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim CreatureNow As Object
		Dim CreatureTarget As Object
		Dim bdInvWear As Object
		Dim DialogDM As Object
		Dim c, NoFail As Short
		Dim ItemX, ItemContainerX As Item
		Dim blnWasEquipped As Boolean
		' [Titi 2.6.0] since when can dead characters take things?
		If ToChar.HPNow <= 0 Then
			If blnDontShowMsg = False Then DialogDM(ToChar.Name & " is dead and cannot take anything.")
			TradeItem = False
			Exit Function
		End If
		blnWasEquipped = ItemToTrade.IsReady
		' If moving around on same list, just move the InvSpot
		'UPGRADE_WARNING: Couldn't resolve default property of object bdInvWear. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If FromList = ToList And ToList <> bdInvWear And (IntoIndex < 1 Or IntoIndex = ItemToTrade.Index) Then
			ItemToTrade.InvSpot = Spot
			'UPGRADE_WARNING: Untranslated statement in TradeItem. Please check source code.
			TradeItem = True
			Exit Function
		Else
			ItemToTrade.InvSpot = 0
		End If
		' Check for Pre-Take if Search window is open
		If picSearch.Visible = True Then
			' Items in an Encounter are *always* not equipped
			ItemToTrade.IsReady = False
			' Fire Take Triggers
			CreatureTarget = ToChar
			CreatureNow = ToChar
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(EncounterNow, bdPreTake). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If FireTriggers(EncounterNow, bdPreTake) = False Then
				TradeItem = False
				Exit Function
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(ItemToTrade, bdPreTake). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf FireTriggers(ItemToTrade, bdPreTake) = False Then 
				TradeItem = False
				Exit Function
			End If
		End If
		' If taking off, unready (if necessary)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdInvWear. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If FromList = bdInvWear Then
			If UnReadyItem(FromChar, ItemToTrade) = False Then
				TradeItem = False
				Exit Function
			End If
		End If
		' If putting on, ready the Item.
		'UPGRADE_WARNING: Couldn't resolve default property of object bdInvWear. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ToList = bdInvWear Then
			TradeItem = ReadyItem(ToChar, ItemToTrade)
			'UPGRADE_WARNING: Untranslated statement in TradeItem. Please check source code.
			Exit Function
		End If
		' Check if too heavy or bulky
		'UPGRADE_WARNING: Couldn't resolve default property of object bdInvParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdInvObjects. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ToList = bdInvObjects Or ToList = bdInvParty Then '[Titi 2.4.8] added the second part of the test
			' Check weight
			If ToChar.Weight + ItemToTrade.Weight > ToChar.MaxWeight Then
				'If blnWasEquipped = False Or ToChar.Index <> FromChar.Index Then ' if the item was equipped, its weight is counted twice in the above test! [Titi 2.4.8]
				If ToChar.Index <> FromChar.Index Then ' if the item was carried by the character, its weight is counted twice in the above test! [Titi 2.6.1]
					If blnDontShowMsg = False Then DialogDM("The " & ItemToTrade.Name & " weighs too much for " & ToChar.Name & " to carry.")
					'UPGRADE_ISSUE: PictureBox event picInvDrag.KeyPress was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
					picInvDrag_KeyPress(System.Windows.Forms.Keys.Escape) ' cancel drag & drop [Titi 2.6.1]
					TradeItem = False
					Exit Function
				End If
			End If
			' Check bulk
			If ToChar.Bulk + ItemToTrade.Bulk > ToChar.Agility * 8 Then ' was 100, now depends on Agility
				' [Titi 2.4.8] item cannot be unequipped if too bulky - check done in function UnReadyItem()
				'If blnWasEquipped = False Or ToChar.Index <> FromChar.Index Then
				If ToChar.Index <> FromChar.Index Then ' [Titi 2.6.1] same problem as weight above
					If blnDontShowMsg = False Then DialogDM("The " & ItemToTrade.Name & " is too bulky for " & ToChar.Name & " to carry.")
					TradeItem = False
					Exit Function
				End If
			End If
		End If
		' If moving into a container, check for capacity of target container
		If IntoIndex > 0 Then
			' Set up the target container
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ToList = bdInvContainer Then
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemContainerX = InvContainer.Items("I" & IntoIndex)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf ToList = bdInvEncounter Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemContainerX = EncounterNow.Items("I" & IntoIndex)
			Else
				ItemContainerX = ToChar.Items.Item("I" & IntoIndex)
			End If
			' [Titi 2.4.9b] Check if item is not too big
			'        If CheckSize(ItemContainerX, ItemToTrade) = False And ToList <> bdInvEncounter Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemContainerX.Size < ItemToTrade.Size And ToList <> bdInvEncounter Then ' [Titi 2.6.0] CheckSize function not working!
				DialogDM("The " & ItemToTrade.Name & " is too big to be stored in the " & ItemContainerX.Name & ".")
				TradeItem = False
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvDragItem.Selected = False
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvDragMode = False
				picInvDrag.Visible = False
				Exit Function
			End If
			' Check bulk
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemContainerX.Capacity > 0 And ToList <> bdInvEncounter Then
				If ItemContainerX.Full + ItemToTrade.Bulk > ItemContainerX.Capacity Then
					DialogDM("The " & ItemToTrade.Name & " is too bulky to fit in the " & ItemContainerX.Name & ".")
					'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvDragItem.Selected = False
					'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvDragMode = False
					picInvDrag.Visible = False
					Exit Function
				End If
			End If
			'        ' Check if container is already open (as a container box)
			If ItemContainerX.Selected = True Then
				TradeItem = False
				Exit Function
			End If
		End If
		' [Titi 2.4.9b] Check if item is not too big
		If Not InvContainer Is Nothing Then
			' move into a container
			'        If CheckSize(InvContainer, ItemToTrade) = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Size. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If InvContainer.Size < ItemToTrade.Size And ToList = bdInvContainer Then ' [Titi 2.6.0] CheckSize function not working!
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DialogDM("The " & ItemToTrade.Name & " is too big to be stored in the " & InvContainer.Name & ".")
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvDragItem.Selected = False
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvDragMode = False
				picInvDrag.Visible = False
				Exit Function
			End If
			' Check bulk
			'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Capacity. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If InvContainer.Capacity > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Capacity. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Full. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If InvContainer.Full + ItemToTrade.Bulk > InvContainer.Capacity And ToList = bdInvContainer Then
					'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogDM("The " & ItemToTrade.Name & " is too bulky to fit in the " & InvContainer.Name & ".")
					'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvDragItem.Selected = False
					'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvDragMode = False
					picInvDrag.Visible = False
					Exit Function
				End If
			End If
		End If
		' If pass all checks, remove the Item from where it was: Container, Encounter or Creature
		'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If FromList = bdInvContainer Then
			'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvContainer.RemoveItem("I" & ItemToTrade.Index)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf FromList = bdInvEncounter Then 
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.RemoveItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			EncounterNow.RemoveItem("I" & ItemToTrade.Index)
		Else
			FromChar.RemoveItem("I" & ItemToTrade.Index)
		End If
		' Combine the Item with the target item
		If IntoIndex > 0 Then
			If ItemContainerX.Capacity > 0 Then
				If CombineWithAnything(ItemContainerX, ItemToTrade) = False Then
					ItemContainerX.AddItem.Copy(ItemToTrade)
				End If
				TradeItem = True
				Exit Function
			End If
			If CombineItemsTriggers(ToChar, ItemToTrade, ItemContainerX) = True Then
				TradeItem = True
				Exit Function
			End If
		End If
		' Create the item in the new location
		'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ToList = bdInvContainer Then
			If CombineWithAnything(InvContainer, ItemToTrade) = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.AddItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvContainer.AddItem.Copy(ItemToTrade)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf ToList = bdInvEncounter Then 
			If CombineWithAnything(EncounterNow, ItemToTrade) = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.AddItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				EncounterNow.AddItem.Copy(ItemToTrade)
			End If
		Else
			If CombineWithAnything(ToChar, ItemToTrade) = False Then
				ToChar.AddItem.Copy(ItemToTrade)
			End If
		End If
		'UPGRADE_WARNING: Untranslated statement in TradeItem. Please check source code.
		TradeItem = True
		FireTriggers(EncounterNow, bdPostTake)
		FireTriggers(ItemToTrade, bdPostTake)
	End Function
	
	Private Sub CursorToGrid(ByVal CursorAtX As Short, ByVal CursorAtY As Short, ByRef Row As Short, ByRef Col As Short)
		' Returns number of char(0-4) or mons(5-14) at (x,y). Also sets x, y, Row, Col.
		Dim c, GridAdjust As Short
		Dim GridWidth As Double
		' Adjust where Cursor is now based on CommonScale
		CursorAtX = Int(CursorAtX / CommonScale)
		CursorAtY = Int(CursorAtY / CommonScale)
		' Calculate Grid Row
		Row = Least(bdCombatHeight - Int((CursorAtY - bdCombatTop) / bdCombatGridHeight) - 1, bdCombatHeight)
		' Set GridWidth and GridAdjust to X
		GridWidth = bdCombatGridWidth
		GridAdjust = bdCombatLeft + (bdCombatGridWidth / 2) * (Row Mod 2)
		' Calculate Grid Col
		Col = Least(Greatest(Int((CursorAtX - GridAdjust) / bdCombatGridWidth), 0), bdCombatWidth)
		' Do final adjustments to CursorAtX and CursorAtY (bound to grid)
		CursorAtY = (Int((bdCombatHeight - Row) * bdCombatGridHeight) + bdCombatTop) * CommonScale
		CursorAtX = Int(Col * GridWidth + GridAdjust) * CommonScale
	End Sub
	
	Private Sub SetMapCursor(ByVal ScreenX As Short, ByVal ScreenY As Short, ByRef MapLeft As Short, ByRef MapTop As Short, ByRef ToScreenX As Short, ByRef ToScreenY As Short, ByRef ToMapX As Short, ByRef ToMapY As Short)
		' Converts any ScreenX, ScreenY to true blue MapX and MapY
		If Int(ScreenY / 16) Mod 3 = 1 Or (Int(ScreenY / 8) Mod 3 = 1 And Int((ScreenX - 24) / 48) Mod 2 = 0) Then
			ToMapX = MapLeft + Int(ScreenX / 96) - Int(ScreenY / 48)
			ToMapY = MapTop + Int(ScreenX / 96) + Int(ScreenY / 48)
			ToScreenX = Int(ScreenX / 96) * 96
			ToScreenY = Int(ScreenY / 48) * 48
		Else
			ToMapX = MapLeft + Int((ScreenX - 48) / 96) - Int((ScreenY - 24) / 48)
			ToMapY = MapTop + Int((ScreenX + 48) / 96) + Int((ScreenY - 24) / 48)
			ToScreenX = Int((ScreenX - 48) / 96) * 96 + 48
			ToScreenY = Int((ScreenY - 24) / 48) * 48 + 24
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function CombatMessage(ByRef InText As String) As Object
		Dim JournalMode As Object
		Dim JournalShow As Object
		Dim JournalCombatLoad As Object
		Dim Tome_Renamed As Object
		Dim CreatureWithTurn As Object
		Dim c As Short
		' [Titi 2.5.1] Log message
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.AddJournal. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.AddJournal.Text = "Log|" & CreatureWithTurn.Name & "|" & InText
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If JournalMode = 3 And Me.picJournal.Visible = True Then
			JournalCombatLoad(True)
			JournalShow()
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MsgQueTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreatureWithTurn.MsgQueTop = CreatureWithTurn.MsgQueTop + 1
		' If moved beyond top, scroll off
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MsgQueTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.MsgQueTop > 7 Then
			For c = 0 To 6
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MsgQue. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureWithTurn.MsgQue(c) = CreatureWithTurn.MsgQue(c + 1)
			Next c
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MsgQueTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.MsgQueTop = CreatureWithTurn.MsgQueTop - 1
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MsgQueTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MsgQue. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreatureWithTurn.MsgQue(CreatureWithTurn.MsgQueTop) = InText
		If picGrid.Visible = True Then
			CombatDraw()
		End If
	End Function
	
	Public Function CombatTarget(ByRef CreatureX As Creature, ByRef Motive As Short) As Creature
		Dim CreatureTarget As Object
		Dim Turns As Object
		Dim i, c, Found As Short
		' Find a Target
		i = 0 : Found = False
		For c = 0 To CombatTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureX.Friendly <> Turns(c).Ref.Friendly And Turns(c).Ref.HPNow > 0 Then
				Select Case Motive
					Case MOVEMOTIVE.bdMoveClosest
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(Turns(i).Ref, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(Turns(c).Ref, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If (CombatRange(Turns(c).Ref, (CreatureX.Col), (CreatureX.Row)) < CombatRange(Turns(i).Ref, (CreatureX.Col), (CreatureX.Row))) Or Found = False Then
							i = c
							Found = True
						End If
					Case MOVEMOTIVE.bdMoveFarthest
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(Turns(i).Ref, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(Turns(c).Ref, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If (CombatRange(Turns(c).Ref, (CreatureX.Col), (CreatureX.Row)) > CombatRange(Turns(i).Ref, (CreatureX.Col), (CreatureX.Row))) Or Found = False Then
							i = c
							Found = True
						End If
					Case MOVEMOTIVE.bdMoveStrongest
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns(i).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Turns(c).Ref.HPNow > Turns(i).Ref.HPNow Or Found = False Then
							i = c
							Found = True
						End If
					Case MOVEMOTIVE.bdMoveWeakest
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns(i).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Turns(c).Ref.HPNow < Turns(i).Ref.HPNow Or Found = False Then
							i = c
							Found = True
						End If
					Case MOVEMOTIVE.bdMoveRandom
						Found = True
						If i = 0 Then
							i = c
						ElseIf Int(Rnd() * 100) < 25 Then 
							i = c
							Exit For
						End If
					Case MOVEMOTIVE.bdMoveRange
						' [Titi 2.6.0] select target in adequate range
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(Turns(c).Ref, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If (CombatRange(Turns(c).Ref, (CreatureX.Col), (CreatureX.Row)) <= CreatureX.ItemInHand.MaxRange And CombatRange(Turns(c).Ref, (CreatureX.Col), (CreatureX.Row)) >= CreatureX.ItemInHand.MinRange) Then
							i = c
							Found = True
						End If
				End Select
			End If
		Next c
		' Acquire target defaults to failed
		Target = -1
		If Found = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatTarget = Turns(i).Ref
			' Configure Target pointer to Turns() to new CreatureTarget
			CreatureTarget = CombatTarget
			For c = 0 To CombatTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Turns(c).Ref.Name = CreatureTarget.Name And Turns(c).Ref.Index = CreatureTarget.Index Then
					Target = c
					Exit For
				End If
			Next c
		Else
			' if no target in range, move to range
			If Motive = MOVEMOTIVE.bdMoveRange Then
				For c = 0 To CombatTurn
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureX.Friendly <> Turns(c).Ref.Friendly And Turns(c).Ref.HPNow > 0 Then
						' pick first possible opponent
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(Turns(c).Ref, CreatureX.Col, CreatureX.Row). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CombatRange(Turns(c).Ref, (CreatureX.Col), (CreatureX.Row)) > CreatureX.ItemInHand.MaxRange Then
							'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CombatTarget = Turns(c).Ref
							CreatureTarget = CombatTarget
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CombatMove(MOVEDIRECTION.bdMoveToward, MOVEMOTIVE.bdMoveRange, CombatRange(CreatureX, CreatureTarget.Col, CreatureTarget.Row))
							Found = bKeepWeapon
							Exit For
						Else
							'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CombatTarget = Turns(c).Ref
							CreatureTarget = CombatTarget
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CombatMove(MOVEDIRECTION.bdMoveAway, MOVEMOTIVE.bdMoveRange, CombatRange(CreatureX, CreatureTarget.Col, CreatureTarget.Row))
							Found = bKeepWeapon
							Exit For
						End If
					End If
				Next 
			End If
			If Found = False Then
				CombatTarget = CreatureX
			End If
		End If
	End Function
	
	Private Sub CombatMonster()
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim bdInvEncounter As Object
		Dim CreatureTarget As Object
		Dim Turns As Object
		Dim CreatureWithTurn As Object
		Dim i, c, OldActionPoints As Short
		Dim CreatureX As Creature
		Dim ItemX As Item
		Dim TriggerX As Trigger
		Dim Dmg, Attack, NoFail As Short
		Dim DiceCnt, DiceType As Short
		Dim Range As Short
		Dim CantAttack As Boolean
		' Continue attacking until out of ActionPoints
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Do Until CreatureWithTurn.ActionPoints < 1
			CantAttack = False
			System.Windows.Forms.Application.DoEvents()
			' [Titi 2.6.0] are they any targets left?
			NoFail = 0 ' used to count the possible opponents
			For c = 0 To CombatTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Turns(c).Ref.HPNow > 0 And Turns(c).Ref.Friendly <> CreatureWithTurn.Friendly Then
					NoFail = NoFail + 1
				End If
			Next 
			If NoFail = 0 Then Exit Do ' no live target, stop fighting
			' Find the closest live Target
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.ItemInHand.MinRange = 1 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureTarget = CombatTarget(CreatureWithTurn, MOVEMOTIVE.bdMoveClosest) ' <-- Medium range combat bug here! Closest might not be the right choice!
			Else
				' [Titi 2.6.0] select target according to weapon in hand!
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureTarget = CombatTarget(CreatureWithTurn, MOVEMOTIVE.bdMoveRange)
			End If
			' If failed to find a Target, Monster stops attacking
			If Target < 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If (CreatureTarget.Name = CreatureWithTurn.Name And CreatureTarget.Index = CreatureWithTurn.Index) Then
					' [Titi 2.6.0] if no target, check if because they're too close
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.ItemInHand.MinRange > CombatRange(CreatureWithTurn, CreatureTarget.Col, CreatureTarget.Row) Then
						' yes, can use another weapon?
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CreatureWithTurn.ItemInHand.Name = "Hand" Then
							' nope...
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CombatMessage(CreatureWithTurn.Name & " is blocked!")
						Else
							'yes, pick up another weapon
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CombatMessage(CreatureWithTurn.Name & " drops the " & CreatureWithTurn.ItemInHand.Name & " due to lack of space to wield it!")
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							NoFail = DropItem(CreatureWithTurn, bdInvEncounter, 0, CreatureWithTurn.ItemInHand)
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CreatureTarget = CombatTarget(CreatureWithTurn, MOVEMOTIVE.bdMoveClosest)
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If CreatureTarget.Name = CreatureWithTurn.Name And CreatureTarget.Index = CreatureWithTurn.Index Then
								' still no target? Then stop attacking
								' [Titi 2.6.0] if no weapon equipped, monsters would not fight at all!
								CantAttack = True ' Exit Do
							End If
						End If
					Else
						' [Titi 2.6.0] if no weapon equipped, monsters would not fight at all!
						CantAttack = True ' Exit Do
					End If
				End If
			End If
			' Choose Monster attack by looping through Skills which are of Type On-Attack
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			OldActionPoints = CreatureWithTurn.ActionPoints
			c = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each TriggerX In CreatureWithTurn.Triggers
				If TriggerX.TriggerType = bdOnAttack Then
					c = c + 1
				End If
			Next TriggerX
			If c > 0 Then
				c = Int(Rnd() * c) + 1 : i = 0
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each TriggerX In CreatureWithTurn.Triggers
					If TriggerX.TriggerType = bdOnAttack Then
						i = i + 1
						If i = c Then
							Exit For
						End If
					End If
				Next TriggerX
				CreatureNow = CreatureWithTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemNow = CreatureWithTurn.ItemInHand
				' [Titi 2.4.6] even without ammo, monsters continued to shoot! - case of the On-Attack triggers
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.ItemInHand.IsShooter = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.ItemAmmo.Index = CreatureWithTurn.ItemInHand.Index And CreatureWithTurn.ItemAmmo.Name = CreatureWithTurn.ItemInHand.Name Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.Name & " drops the " & CreatureWithTurn.ItemInHand.Name & " due to lack of ammo!")
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = DropItem(CreatureWithTurn, bdInvEncounter, 0, CreatureWithTurn.ItemInHand)
					End If
				End If
				NoFail = FireTrigger(CreatureWithTurn, TriggerX)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.IsInanimate. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf CreatureWithTurn.IsInanimate = False Then 
				' [Titi 2.6.0] if no weapon equipped, monsters would not fight at all!
				If CantAttack = True Then Exit Do
				' [Titi 2.4.6] even without ammo, monsters continued to shoot! - case of the standard combat
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.ItemInHand.IsShooter = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.ItemAmmo.Index = CreatureWithTurn.ItemInHand.Index And CreatureWithTurn.ItemAmmo.Name = CreatureWithTurn.ItemInHand.Name Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.Name & " drops the " & CreatureWithTurn.ItemInHand.Name & " due to lack of ammo!")
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = DropItem(CreatureWithTurn, bdInvEncounter, 0, CreatureWithTurn.ItemInHand)
					End If
				End If
				' Attack with a weapon
				CombatAttack(12, "", 0, 0)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.ActionPoints = OldActionPoints Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureWithTurn.ActionPoints = CreatureWithTurn.ActionPoints - 10
			End If
			System.Windows.Forms.Application.DoEvents()
			' Fire Post-Attack Triggers
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(CreatureWithTurn, bdPostAttack)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each ItemX In CreatureWithTurn.Items
				If ItemX.IsReady = True Then
					CreatureNow = CreatureWithTurn
					ItemNow = ItemX
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemX, bdPostAttack)
				End If
			Next ItemX
		Loop 
	End Sub
	
	Public Sub CombatGuard()
		Dim CreatureWithTurn As Object
		' [Titi 2.5.1] will only attack enemies in range, without moving
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAttitude. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreatureWithTurn.CombatAttitude = bdCombatAttitudeGuard
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.OpportunityAttack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreatureWithTurn.OpportunityAttack = True
		CombatNextTurn()
	End Sub
	
	Public Sub CombatDefend()
		Dim CreatureWithTurn As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAttitude. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreatureWithTurn.CombatAttitude = bdCombatAttitudeDefend
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.DefenseBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreatureWithTurn.DefenseBonus = Int(CreatureWithTurn.ActionPoints / 5)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreatureWithTurn.ActionPoints = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.OpportunityAttack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreatureWithTurn.OpportunityAttack = True
		CombatNextTurn()
	End Sub
	
	'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function CombatAttack(ByRef AttackType As Short, ByRef Text_Renamed As String, ByRef InContext As Short, ByRef InVar As Short) As Short
		Dim CreatureNow As Object
		Dim ItemNow As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetUp As Object
		Dim CreatureTarget As Object
		Dim CreatureWithTurn As Object
		Dim ItemX As Item
		Dim Found, OverSwing As Short
		Dim Attack, c, Dmg As Short
		Dim MaxRange, Distance, MinRange As Short
		Dim DiceType, DiceCnt, DmgBonus As Short
		Select Case AttackType
			Case 0, 1, 10, 63 ' AttackWith
				If Len(Text_Renamed) < 1 Then
					Text_Renamed = "Claw Attack"
				End If
				' Compute (DistanceToTarget - Range - Movement)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Distance = CombatRange(CreatureWithTurn, CreatureTarget.Col, CreatureTarget.Row)
				If Distance > 1 Then
					CombatMove(MOVEDIRECTION.bdMoveToward, MOVEMOTIVE.bdMoveTarget)
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Distance = CombatRange(CreatureWithTurn, CreatureTarget.Col, CreatureTarget.Row)
				End If
				' Compute Overswing penalty or message
				OverSwing = 0
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If (CreatureWithTurn.ActionPoints - 10) < 0 Then
					If GlobalOverSwing = 1 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						OverSwing = CreatureWithTurn.ActionPoints - 10
					Else
						Distance = 2
					End If
				End If
				' If in range now, attack
				If Distance < 2 Then
					CombatMessage(Text_Renamed)
					If CombatRollAttack(0, OverSwing) = True Then
						c = CombatRollDamage(InContext, InVar, 0, True, 0)
					Else
						CombatMessage("Miss")
					End If
				End If
			Case 11 ' Say
				DialogSetUp(bdDlgNoReply)
				DialogShow(CreatureWithTurn, Text_Renamed)
				DialogHide()
			Case 12, 62 ' Weapon
				' Ready weapon if have nothing in hand
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.ItemInHand.Name = "Hand" Then
					Found = False
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each ItemX In CreatureWithTurn.Items
						If InStr(UCase(ItemX.Name), UCase(Text_Renamed)) > 0 And Len(UCase(Text_Renamed)) > 0 Then
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If ReadyItem(CreatureWithTurn, ItemX) Then
								Found = True
								Exit For
							End If
						End If
					Next ItemX
				Else
					Found = True
				End If
				' If can't find matching weapon, find any damaging thing and ready it
				If Found = False Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each ItemX In CreatureWithTurn.Items
						If ItemX.Damage > 0 And ItemX.IsAmmo = False Then
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If UnReadyItem(CreatureWithTurn, CreatureWithTurn.ItemInHand) Then
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If ReadyItem(CreatureWithTurn, ItemX) Then
									Found = True
									Exit For
								End If
							End If
						End If
					Next ItemX
				End If
				' If weapon is a shoot, but there's no ammo, you're done for
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Found = True And CreatureWithTurn.ItemInHand.IsShooter = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.ItemAmmo.Index = CreatureWithTurn.ItemInHand.Index And CreatureWithTurn.ItemAmmo.Name = CreatureWithTurn.ItemInHand.Name Then
						Found = False
					End If
				End If
				' If now have a weapon, attack!
				If Found = True Or Int(Rnd() * 10) < 5 Then
					' Compute (DistanceToTarget - Range - Movement)
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemMaxRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					MaxRange = CreatureWithTurn.ItemMaxRange
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemMinRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					MinRange = CreatureWithTurn.ItemMinRange
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Distance = CombatRange(CreatureWithTurn, CreatureTarget.Col, CreatureTarget.Row)
					If Distance > MaxRange Then
						CombatMove(MOVEDIRECTION.bdMoveToward, MOVEMOTIVE.bdMoveTarget, Distance)
					ElseIf Distance < MinRange Then 
						CombatMove(MOVEDIRECTION.bdMoveAway, MOVEMOTIVE.bdMoveTarget, Distance)
					End If
					' If in range now, attack
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Distance = CombatRange(CreatureWithTurn, CreatureTarget.Col, CreatureTarget.Row)
					' Compute Overswing penalty or message
					OverSwing = 0
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If (CreatureWithTurn.ActionPoints - CreatureWithTurn.ItemInHand.ActionPoints < 0) Or (CreatureWithTurn.ItemInHand.ActionPoints = 0 And CreatureWithTurn.ActionPoints < 10) Then
						If GlobalOverSwing = 1 Then
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If CreatureWithTurn.ItemInHand.ActionPoints = 0 Then
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								OverSwing = CreatureWithTurn.ActionPoints - 10
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								OverSwing = CreatureWithTurn.ActionPoints - CreatureWithTurn.ItemInHand.ActionPoints
							End If
						Else
							Distance = MaxRange + 1
						End If
					End If
					' If now in range, attack
					If Distance <= MaxRange And Distance >= MinRange Then
						' Remove ActionPoints and remove ability to Move
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CreatureWithTurn.ItemInHand.ActionPoints = 0 Then
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CreatureWithTurn.ActionPoints = CreatureWithTurn.ActionPoints - 10
						Else
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CreatureWithTurn.ActionPoints = CreatureWithTurn.ActionPoints - CreatureWithTurn.ItemInHand.ActionPoints
						End If
						CombatDraw()
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ItemNow = CreatureWithTurn.ItemInHand
						' Begin Attack
						'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.NameText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(ItemNow.NameText & " Attack")
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						PlaySFXItem(CreatureWithTurn)
						'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.AttackBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CombatRollAttack(Greatest(CreatureWithTurn.ItemAmmo.DamageType, 0), ItemNow.AttackBonus + OverSwing) = True Then
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.DamageBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							c = CombatRollDamage(bdContextDice, CreatureWithTurn.ItemAmmo.Damage - 1, Greatest(CreatureNow.ItemAmmo.DamageType, 0), True, ItemNow.DamageBonus + CreatureNow.ItemAmmo.DamageBonus)
						Else
							CombatMessage("Miss")
						End If
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.UseAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.UseAmmo()
						CombatDraw()
					End If
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CombatMessage(CreatureWithTurn.Name & " has no weapon and stays away from the battle.")
					CombatMove(MOVEDIRECTION.bdMoveFlee, MOVEMOTIVE.bdMoveRandom)
				End If
		End Select
	End Function
	
	Public Function CombatRange(ByRef FromCreature As Creature, ByRef ToCol As Short, ByRef ToRow As Short) As Object
		' Compute corrected range from one creature to another in combat
		' Even: (-1,0), (+1,0), (0,+1), (1,+1), (0,-1), (1,-1)
		' Odd : (-1,0), (+1,0), (-1,+1), (0,+1), (-1,-1), (0,-1)
		' To find correct, keep traversing until within 1. Count how far have moved.
		Dim Row, Found, Col As Short
		Row = FromCreature.Row : Col = FromCreature.Col
		Found = False
		'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CombatRange = 0
		Do 
			If System.Math.Abs(Row - ToRow) < 2 And System.Math.Abs(Col - ToCol) < 2 Then
				If Row - ToRow = 0 Then
					Found = True
				Else
					Select Case Row Mod 2
						Case 0 ' Even
							If Col - ToCol > -1 Then
								Found = True
							End If
						Case 1 ' Odd
							If Col - ToCol < 1 Then
								Found = True
							End If
					End Select
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatRange = CombatRange + 1
			' Move toward ToCreature
			If Found = False Then
				Row = Greatest(Least(Row + System.Math.Sign(ToRow - Row), bdCombatHeight), 0)
				Col = Greatest(Least(Col + System.Math.Sign(ToCol - Col), bdCombatWidth), 0)
			End If
		Loop Until Found = True
	End Function
	
	Public Function CombatRollAttack(ByRef Style As Short, ByRef Bonus As Short) As Short
		Dim PlaySoundFile As Object
		Dim bdInvEncounter As Object
		Dim DialogDM As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim GlobalDamageRoll As Object
		Dim GlobalArmorRoll As Object
		Dim GlobalAttackRoll As Object
		Dim CreatureTarget As Object
		Dim CreatureWithTurn As Object
		Dim GlobalDamageStyle As Object
		' Returns True if Hit, False if Miss
		Dim c, NoFail As Short
		Dim ItemX As Item
		' Set GlobalDamageStyle for Triggers
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDamageStyle = Style
		' Draw the Attacker and Target in the menu bar
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CombatDrawAttack(CreatureWithTurn, CreatureTarget, False)
		' Clear global variables
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AttackBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalAttackRoll = Bonus + CreatureWithTurn.AttackBonus
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalArmorRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalArmorRoll = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDamageRoll = 0
		For c = 1 To 5 : CombatDiceType(c) = 0 : CombatDiceValue(c) = 0 : Next c
		Combat20Bonus = 0 : CombatDmgBonus = 0
		' Fire Pre-Attacked Triggers
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(CreatureTarget, bdPreAttacked)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemNow In CreatureTarget.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemNow.IsReady = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemNow, bdPreAttacked)
			End If
		Next ItemNow
		' Fire Pre-RollAttack Triggers
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(CreatureWithTurn, bdPreRollAttack)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemNow In CreatureWithTurn.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemNow.IsReady = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemNow, bdPreRollAttack)
			End If
		Next ItemNow
		' Roll to Hit
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalAttackRoll = DiceRoll(1, 20, GlobalAttackRoll, True, True)
		' Fire Post-RollAttack Triggers
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(CreatureWithTurn, bdPostRollAttack)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemNow In CreatureWithTurn.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemNow.IsReady = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemNow, bdPostRollAttack)
			End If
		Next ItemNow
		' Fire Post-Attacked Triggers
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(CreatureTarget, bdPostAttacked)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemNow In CreatureTarget.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemNow.IsReady = True Then
				CreatureNow = CreatureWithTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemNow = CreatureTarget.ItemInHand
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemNow, bdPostAttacked)
			End If
		Next ItemNow
		' If roll a natural 1, chance to drop Item in hand
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If GlobalAttackRoll = 1 And CreatureWithTurn.ItemInHand.Name <> "Hand" Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Agility. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Int(Rnd() * 20) + 1 > CreatureWithTurn.Agility Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DialogDM(CreatureWithTurn.Name & " fumbles and drops the " & CreatureWithTurn.ItemInHand.Name & ".")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = DropItem(CreatureWithTurn, bdInvEncounter, 0, CreatureWithTurn.ItemInHand)
			End If
		End If
		' [Titi 2.4.9b] actual values not displayed if item not examined!
		HiddenBonus = False
		Dim intDmgTarget, intAttTurn, intAttTarget, intDefTarget, intDefTurn, intDmgTurn As Short
		Dim X, Y As Short
		Dim GridWidth As Double
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CalcGearBonus(CreatureTarget, intAttTarget, intDefTarget, intDmgTarget, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CalcGearBonus(CreatureWithTurn, intAttTurn, intDefTurn, intDmgTurn, True)
		' Play hit or miss sound
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Defense. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If GlobalAttackRoll < CreatureTarget.Defense Then
			Call PlaySoundFile("miss" & Int(Rnd() * 4) + 1, Tome,  , 5)
			' [Titi 2.5.1] update the additional information
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.Infos.Misses = CreatureWithTurn.Infos.Misses + 1
			CombatRollAttack = False
			' [Titi 2.4.9b] check if results differ from displayed values - if so, try to explain
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Defense. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If GlobalAttackRoll >= CreatureTarget.Defense + intDefTarget Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.Friendly Then
					CombatMessage("Huh? Should have hit!")
				Else
					HiddenBonus = True
				End If
			End If
		Else
			CombatRollAttack = True
			' [Titi 2.5.1] update the additional information
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.Infos.Hits = CreatureWithTurn.Infos.Hits + 1
			' [Titi 2.4.9b] check if results differ from displayed values - if so, try to explain
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Defense. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If GlobalAttackRoll + intAttTurn < CreatureTarget.Defense Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.Friendly Then
					CombatMessage("Wow! I didn't think that one would hit!")
				Else
					HiddenBonus = True
				End If
			End If
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
	End Function
	
	Public Function CombatRollDamage(ByRef InContext As Short, ByRef InVar As Short, ByRef Style As Short, ByRef CheckArmor As Short, ByRef Bonus As Short) As Short
		Dim PlaySoundFile As Object
		Dim GlobalAttackRoll As Object
		Dim GlobalHitLocation As Object
		Dim GlobalArmorRoll As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim GlobalDamageStyle As Object
		Dim CreatureWithTurn As Object
		Dim GlobalDamageRoll As Object
		Dim CreatureTarget As Object
		Dim DiceType, c, DiceCnt, NoFail As Short
		' Style is 0 = None, 1 = Sharp, 2 = Blunt, etc. This applies to Resistance in Creatures.
		' If already dead, this does nothing
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureTarget.HPNow < 1 Then
			CombatRollDamage = 0
			Exit Function
		End If
		' Add Bonus for Creature, Weapon and Strength
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.DamageBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDamageRoll = GlobalDamageRoll + CreatureWithTurn.DamageBonus + Bonus
		' Add Strength ToDamage Bonus (Short Range Only)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemMinRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.ItemMinRange < 2 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Strength. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalDamageRoll = GlobalDamageRoll + Fix((CreatureWithTurn.Strength - 10) / 3)
		End If
		' Set GlobalDamageStyle for Triggers to access
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDamageStyle = Style
		' Draw the Attacker and Target in the menu bar
		If picGrid.Visible = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatDrawAttack(CreatureWithTurn, CreatureTarget, True)
		End If
		' If allow checking Armor Then do so
		If CheckArmor = True Then
			' Fire Pre-RollArmorChit Triggers
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(CreatureNow, bdPreRollArmorChit)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each ItemNow In CreatureNow.Items
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemNow.IsReady = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemNow, bdPreRollArmorChit)
				End If
			Next ItemNow
			' Roll Armor
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalArmorRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalArmorRoll = CombatRollArmor(CreatureTarget, True, GlobalArmorRoll)
			' Set HitLocation
			' [Titi 2.5.1] Update the location of the hit based on the creature's set of body parts: + 11 * Int(CreatureTarget.BodyType(2) / 11)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.BodyType. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalHitLocation. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalHitLocation = modBD.SetUpArmorType(CreatureTarget.BodyType(GlobalArmorRoll))
			' Fire Post-RollArmorChit Triggers
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(CreatureWithTurn, bdPostRollArmorChit)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each ItemNow In CreatureWithTurn.Items
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemNow.IsReady = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemNow, bdPostRollArmorChit)
				End If
			Next ItemNow
		Else
			' Roll Armor
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalArmorRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalArmorRoll = CombatRollArmor(CreatureTarget, True, GlobalArmorRoll)
			' Set HitLocation
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.BodyType. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalHitLocation. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalHitLocation = modBD.SetUpArmorType(CreatureTarget.BodyType(GlobalArmorRoll))
		End If
		' Fire Pre-RollDamage Triggers
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(CreatureWithTurn, bdPreRollDamage)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemNow In CreatureWithTurn.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemNow.IsReady = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemNow, bdPreRollDamage)
			End If
		Next ItemNow
		' Roll for Damage (or Set Damage if not dice)
		If InContext = bdContextDice Then
			DiceCnt = InVar Mod 5 + 1
			DiceType = Int((InVar Mod 25) / 5) * 2 + 4
			If InVar > 24 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalDamageRoll = GlobalDamageRoll + Int(InVar / 25)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalDamageRoll = DiceRoll(DiceCnt, DiceType, GlobalDamageRoll, False, True)
		Else
			If IsNumeric(modEvents.GetVarContext(InContext, InVar)) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object modEvents.GetVarContext(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalDamageRoll = modEvents.GetVarContext(InContext, InVar)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalDamageRoll = 0
			End If
		End If
		' Fire Post-RollDamage Triggers
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(CreatureWithTurn, bdPostRollDamage)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemNow In CreatureWithTurn.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemNow.IsReady = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(ItemNow, bdPostRollDamage)
			End If
		Next ItemNow
		' Modify Damage based on Great Roll
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Defense. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If GlobalAttackRoll >= CreatureTarget.Defense * 2 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalDamageRoll = GlobalDamageRoll * 2
			CombatMessage("* Great Hit - Double Damage! *")
		End If
		' Modify Damage based on Vulnerable
		If IsBetween(Style, 1, 8) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.ResistanceTypeWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = CreatureTarget.ResistanceTypeWithArmor(Style)
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalDamageRoll = GlobalDamageRoll - Int(GlobalDamageRoll * (c / 100))
			If c < 0 Then
				If IsBetween(c, -100, -1) Then
					CombatMessage("* Weakness - Double Damage! *")
				ElseIf IsBetween(c, -200, -101) Then 
					CombatMessage("* Weakness - Triple Damage! *")
				Else
					CombatMessage("* Weakness - Crippling Damage! *")
				End If
			ElseIf c > 0 Then 
				CombatMessage("* " & modBD.SetUpResistanceType(Style) & " Resistance *")
			ElseIf c >= 100 Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalDamageRoll = 0
				CombatMessage("* " & modBD.SetUpResistanceType(Style) & " Immune - No Damage! *")
			End If
		End If
		' Normal Resistance
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CheckArmor = True And GlobalDamageRoll > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.ResistanceWithArmor. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = CreatureTarget.ResistanceWithArmor(GlobalArmorRoll)
			If c > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CombatMessage("Armor Absorbs " & Int(GlobalDamageRoll * (c / 100)))
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalDamageRoll = GlobalDamageRoll - Int(GlobalDamageRoll * (c / 100))
			End If
		End If
		' Never go less than 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If GlobalDamageRoll < 1 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalDamageRoll = 0
		End If
		' [Titi 2.4.9b] Hide weapon bonus
		Dim intDef, intAtt, intDmg As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CalcGearBonus(CreatureWithTurn, intAtt, intDef, intDmg, True)
		' If display mode, show location hit
		If CheckArmor = True And picGrid.Visible = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalHitLocation. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatMessage(GlobalHitLocation & " hit for " & IIf(GlobalDamageRoll + intDmg > 0, GlobalDamageRoll + intDmg, 0) & " damage")
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatMessage("Hit for " & IIf(GlobalDamageRoll + intDmg > 0, GlobalDamageRoll + intDmg, 0) & " damage")
		End If
		' Damage or Not?
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If GlobalDamageRoll > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.HitWAV. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureTarget.HitWAV = "" Then
				Call PlaySoundFile("hit", Tome,  , 5)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.HitWAV. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call PlaySoundFile(CreatureTarget.HitWAV, Tome,  , 5)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.HitWAVOneTime. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureTarget.HitWAVOneTime = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.HitWAV. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureTarget.HitWAV = ""
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.HitWAVOneTime. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureTarget.HitWAVOneTime = False
				End If
			End If
			' Apply Damage
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatApplyDamage(CreatureTarget, GlobalDamageRoll)
		Else
			Call PlaySoundFile("armor", Tome,  , 5)
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CombatRollDamage = GlobalDamageRoll
		' [Titi 2.5.1] update the additional information
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If GlobalDamageRoll > CreatureWithTurn.Infos.Damage Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.Infos.Damage = GlobalDamageRoll
		End If
	End Function
	
	Public Sub CombatDraw(Optional ByRef ShowMsg As Object = Nothing)
		Dim GlobalAttackRoll As Object
		Dim bdFontSmallWhite As Object
		Dim CreatureTarget As Object
		Dim Turns As Object
		Dim bdFontNoxiousWhite As Object
		Dim CreatureWithTurn As Object
		Dim n, c, i, Found As Short
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim rc As Integer
		Dim OffX, Height_Renamed, Width_Renamed, OffY As Short
		Dim HasRunes, X, Y, RuneX As Short
		Dim GridWidth As Double
		Dim hOldBrush, hOldPen, hNewPen, hNewBrush As Integer
		Dim CreatureX As Creature
		Dim Distance, MaxRange As Short
		Dim tmp As String
		' [Titi 2.6.0] Widescreens display bug: in combat, monsters would be below the visible area
		' Since the bug was only reported for the combat screen, the code was first corrected here, but then a more generic fix was made (hence the commented lines below)
		Dim iWideScreenFactor As Double
		'    If Screen.Width / Screen.Height <= 4 / 3 Then
		iWideScreenFactor = 1
		'    Else
		'        iWideScreenFactor = Screen.Width / Screen.Height
		'    End If
		' Sort all pictures in order
		CombatPaintSort()
		' Draw background wallpaper
		'UPGRADE_ISSUE: PictureBox property picWallPaper.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picGrid.hdc, 0, 0, picGrid.Width, picGrid.Height, picWallPaper.hdc, 0, 0, SRCCOPY)
		' Draw Action Point globes at Top (500 Pixels is the total width of 20 ActionPoints)
		X = (picGrid.Width - 500) / 2
		For c = 0 To 19
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picGrid.hdc, X + c * 25, 8, 25, 25, picMisc.hdc, 50, 121, SRCAND)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If c < CreatureWithTurn.ActionPoints Then
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picGrid.hdc, X + c * 25, 8, 25, 25, picMisc.hdc, 0, 121, SRCPAINT)
			Else
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picGrid.hdc, X + c * 25, 8, 25, 25, picMisc.hdc, 25, 121, SRCPAINT)
			End If
		Next c
		' [Titi 2.5.1] if ActionPoints exceed 20, say so
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If c < CreatureWithTurn.ActionPoints Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picGrid, X + 525, 14, picGrid.ClientRectangle.Width, 14, bdFontNoxiousWhite, "+" & CreatureWithTurn.ActionPoints - 20, False, False)
		End If
		' Draw path to Target
		If Target > -1 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Target).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Distance = CombatRange(CreatureWithTurn, Turns(Target).Ref.Col, Turns(Target).Ref.Row)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemMaxRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MaxRange = Greatest(CreatureWithTurn.ItemMaxRange, TargetCreatureRange)
		Else
			Distance = 1 : MaxRange = 0
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.DMControlled. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.DMControlled = False And MenuNow <> bdMenuTargetCreature And MenuNow <> bdMenuTargetAny And MenuNow <> bdMenuTargetParty And Distance > MaxRange Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MovementRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For c = CombatStepTop To Greatest(CombatStepTop - CreatureWithTurn.MovementRange, 0) Step -1
				GridToCursor(X, Y, CombatStepRow(c), CombatStepCol(c), GridWidth)
				OffX = ((bdCombatGridWidth * CommonScale) - bdCombatGridWidth) / 2
				OffY = ((bdCombatGridHeight * CommonScale / iWideScreenFactor) - bdCombatGridHeight) / 2
				'UPGRADE_ISSUE: PictureBox property picSteps.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picGrid.hdc, X + OffX, Y - bdCombatGridHeight + OffY, bdCombatGridWidth, bdCombatGridHeight, picSteps.hdc, 0, bdCombatGridHeight, SRCAND)
				'UPGRADE_ISSUE: PictureBox property picSteps.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picGrid.hdc, X + OffX, Y - bdCombatGridHeight + OffY, bdCombatGridWidth, bdCombatGridHeight, picSteps.hdc, 0, 0, SRCPAINT)
			Next c
		End If
		' Determine color of rectangle based on distance from CreatureWithTurn
		Dim intDmgTarget, intAttTurn, intAttTarget, intDefTarget, intDefTurn, intDmgTurn As Short
		For c = 0 To CombatTurn
			' Convert where CreatureWithTurn row and col to x and y coordinate
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GridToCursor(X, Y, Turns(Paint_Renamed(c)).Ref.Row, Turns(Paint_Renamed(c)).Ref.Col, GridWidth)
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Turns(Paint_Renamed(c)).Ref.HPNow > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				n = Turns(Paint_Renamed(c)).Ref.Pic
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				LoadCreaturePic(Turns(Paint_Renamed(c)).Ref) '[Titi 2.6.0] update the "bones.bmp" if necessary
				n = 0 ' Default for bones
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Turns(Paint_Renamed(c)).Ref.Facing = 1
			End If
			' Determine size of picture to draw
			Height_Renamed = Int(picCPic(n).Height / 4)
			Width_Renamed = Int(picCPic(n).Width / 2)
			' Center the picture in the square
			Y = Int(Y - Height_Renamed)
			X = X - (Width_Renamed - GridWidth) / 2
			' Paint Yellow around TurnNow, Red outline around Target, others are Black
			If Paint_Renamed(c) = TurnNow Then
				' Yellow
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picGrid.hdc, X, Y, Width_Renamed, Height_Renamed, picCPic(n).hdc, Turns(Paint_Renamed(c)).Ref.Facing * Width_Renamed, Height_Renamed, SRCAND)
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picGrid.hdc, X, Y, Width_Renamed, Height_Renamed, picCPic(n).hdc, Turns(Paint_Renamed(c)).Ref.Facing * Width_Renamed, Height_Renamed * 2, SRCPAINT)
			ElseIf Paint_Renamed(c) = Target Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemMaxRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemMinRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If IsBetween(CombatRange(CreatureWithTurn, CreatureTarget.Col, CreatureTarget.Row), CreatureWithTurn.ItemMinRange, CreatureWithTurn.ItemMaxRange) Then
					' Red
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, X, Y, Width_Renamed, Height_Renamed, picCPic(n).hdc, Turns(Paint_Renamed(c)).Ref.Facing * Width_Renamed, Height_Renamed, SRCAND)
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, X, Y, Width_Renamed, Height_Renamed, picCPic(n).hdc, Turns(Paint_Renamed(c)).Ref.Facing * Width_Renamed, Height_Renamed * 3, SRCPAINT)
				Else
					' Normal
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, X, Y, Width_Renamed, Height_Renamed, picCPic(n).hdc, Turns(Paint_Renamed(c)).Ref.Facing * Width_Renamed, Height_Renamed, SRCAND)
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, X, Y, Width_Renamed, Height_Renamed, picCPic(n).hdc, Turns(Paint_Renamed(c)).Ref.Facing * Width_Renamed, 0, SRCPAINT)
				End If
			Else
				' Normal
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picGrid.hdc, X, Y, Width_Renamed, Height_Renamed, picCPic(n).hdc, Turns(Paint_Renamed(c)).Ref.Facing * Width_Renamed, Height_Renamed, SRCAND)
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picGrid.hdc, X, Y, Width_Renamed, Height_Renamed, picCPic(n).hdc, Turns(Paint_Renamed(c)).Ref.Facing * Width_Renamed, 0, SRCPAINT)
			End If
			' Draw MsgQue
			'UPGRADE_NOTE: IsMissing() was changed to IsNothing(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="8AE1CB93-37AB-439A-A4FF-BE3B6760BB23"'
			If (Paint_Renamed(c) = Target And IsNothing(ShowMsg) = False) Or (Paint_Renamed(c) = TurnNow And (Target = -1 Or IsNothing(ShowMsg) = True)) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GridToCursor(X, Y, Turns(Paint_Renamed(c)).Ref.Row, Turns(Paint_Renamed(c)).Ref.Col, GridWidth)
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Y = Greatest(Y - Int(picCPic(Turns(Paint_Renamed(c)).Ref.Pic).Height / 3) - Turns(Paint_Renamed(c)).Ref.MsgQueTop * 10, 32)
				Found = 0
				If X + 256 > picGrid.ClientRectangle.Width Then
					X = picGrid.ClientRectangle.Width - 264
					Found = 1
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For i = 0 To Turns(Paint_Renamed(c)).Ref.MsgQueTop
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Y = Y + ShowText(picGrid, X, Y, 256, 90, bdFontSmallWhite, Turns(Paint_Renamed(c)).Ref.MsgQue(i), Found, True)
				Next i
				' [Titi 2.4.9b] display information message if hit although the maths prove that shouldn't have happened!
				' This would be because some equipment has not been examined yet...
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CalcGearBonus(CreatureTarget, intAttTarget, intDefTarget, intDmgTarget, True)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CalcGearBonus(CreatureWithTurn, intAttTurn, intDefTurn, intDmgTurn, True)
				If HiddenBonus Then
					' Case of player defending: not hit because an item (or more) has a Def bonus not shown (because item not examined)
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Defense. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If IsBetween(GlobalAttackRoll, CreatureTarget.Defense + intDefTarget, CreatureTarget.Defense + 1) Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CreatureWithTurn.Friendly = False Then
							' Convert where CreatureTarget row and col to x and y coordinate
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							GridToCursor(X, Y, CreatureTarget.Row, CreatureTarget.Col, GridWidth)
							'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ShowText(picGrid, X, Y, 256, 90, bdFontSmallWhite, "Lucky me! I was sure to be hit!", 0, True)
						End If
					End If
					' Case of player attacking: attack bonus hidden somewhere
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Defense. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If GlobalAttackRoll + intAttTarget < CreatureTarget.Defense Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CreatureTarget.Friendly = False Then
							' Convert where CreatureWithTurn row and col to x and y coordinate
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							GridToCursor(X, Y, CreatureWithTurn.Row, CreatureWithTurn.Col, GridWidth)
							'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ShowText(picGrid, X, Y, 256, 90, bdFontSmallWhite, "How? Couldn't have hit!", 0, True)
						End If
					End If
				End If
			End If
		Next c
		' Set focus to the combat screen
		If picGrid.Visible Then ' [Titi 2.5.0] case of targetting spells still available when the combat is over (ie picGrid no more visible)
			picGrid.Focus()
			picGrid.Refresh()
		End If
	End Sub
	
	Private Sub GridToCursor(ByRef CursorAtX As Short, ByRef CursorAtY As Short, ByVal Row As Short, ByVal Col As Short, ByRef GridWidth As Double)
		Dim c, GridAdjust As Short
		' Set GridWidth and GridAdjust to X
		GridWidth = bdCombatGridWidth
		GridAdjust = bdCombatLeft + bdCombatGridHeight * (Row Mod 2)
		' Do final adjustments to CursorAtX and CursorAtY (bound to grid)
		CursorAtY = (Int((bdCombatHeight - Row) * bdCombatGridHeight) + bdCombatTop) * CommonScale
		CursorAtX = (Int(Col * GridWidth + GridAdjust)) * CommonScale
	End Sub
	
	Private Function GetTileSetIndex(ByRef c As Short) As Short
		' [Titi 2.5.1] Tilesets being only a collection, when one is deleted during the making of the tome we've got a gap --> RT9
		' so, let's match the tileset reference of the tile to the tilesets index of the map
		Dim Index As Short
		For Index = Map.TileSets.Count() To 1 Step -1
			'UPGRADE_WARNING: Untranslated statement in GetTileSetIndex. Please check source code.
		Next 
		GetTileSetIndex = Index
	End Function
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub CombatWallpaper()
		Dim Tome_Renamed As Object
		Dim Map_Renamed As Object
		Dim EncounterNow As Object
		Dim FileName As String
		Dim c, Found As Short
		Dim PictureFile As String
		'UPGRADE_WARNING: Arrays in structure bmBlack may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmBlack As BITMAPINFO
		Dim hMem, TransparentRGB As Integer
		Dim rc As Short
		Dim lpMem As Integer
		' Default to a forest wallpaper
		PictureFile = "forest1.bmp"
		' Set PictureFile based on EncounterNow
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Wallpaper. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Len(EncounterNow.Wallpaper) > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Wallpaper. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PictureFile = EncounterNow.Wallpaper
		Else
			' Set PictureFile based on Tiles: Bottom, Middle and Top
			Found = False
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.MiddleTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = Map.MiddleTile(Tome.MapX, Tome.MapY)
			If c > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Map.Tiles("L" & c).TileSet > 0 Then
					'                PictureFile = Map.TileSets(Map.Tiles("L" & c).TileSet).PictureFile
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.TileSets. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					PictureFile = Map.TileSets(GetTileSetIndex(c)).PictureFile
					Found = Len(PictureFile) > 0
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.TopTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = Map.TopTile(Tome.MapX, Tome.MapY)
			If c > 0 And Not Found Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Map.Tiles("L" & c).TileSet > 0 Then
					'                PictureFile = Map.TileSets(Map.Tiles("L" & c).TileSet).PictureFile
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.TileSets. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					PictureFile = Map.TileSets(GetTileSetIndex(c)).PictureFile
					Found = Len(PictureFile) > 0
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.BottomTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = Map.BottomTile(Tome.MapX, Tome.MapY)
			If c > 0 And Not Found Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Map.Tiles("L" & c).TileSet > 0 Then
					'                PictureFile = Map.TileSets(Map.Tiles("L" & c).TileSet).PictureFile
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.TileSets. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					PictureFile = Map.TileSets(GetTileSetIndex(c)).PictureFile
					Found = Len(PictureFile) > 0
				End If
			End If
			If Not Found Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.TileSets. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Map.TileSets.Count > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.TileSets. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					PictureFile = Map.TileSets(Int(Map.TileSets.Count * Rnd()) + 1).PictureFile
				End If
			End If
		End If
		' Load Bitmap
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(Tome.FullPath & "\" & PictureFile)
		If FileName = "" Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(Tome.FullPath & "\wallpapers\" & PictureFile)
			If FileName = "" Then
				' [Titi 2.4.9b] added the possibility to have pictures only in a given world
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gAppPath & "\Roster\" & WorldNow.Name & "\" & PictureFile)
				If FileName = "" Then
					'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
					FileName = Dir(gAppPath & "\Roster\" & WorldNow.Name & "\Wallpapers" & PictureFile)
					If FileName = "" Then
						'          FileName = gAppPath & "\data\graphics\wallpapers\" & PictureFile
						FileName = gDataPath & "\graphics\wallpapers\" & PictureFile
					Else
						FileName = gAppPath & "\Roster\" & WorldNow.Name & "\Wallpapers" & PictureFile
					End If
				Else
					FileName = gAppPath & "\Roster\" & WorldNow.Name & "\" & PictureFile
				End If
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = Tome.FullPath & "\wallpapers\" & PictureFile
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileName = Tome.FullPath & "\" & PictureFile
		End If
		ReadBitmapFile(FileName, bmBlack, hMem, TransparentRGB)
		' Paint bitmap to picture box using converted palette
		lpMem = GlobalLock(hMem)
		picWallPaper.Width = picGrid.Width
		picWallPaper.Height = picGrid.Height
		' Draw Wallpaper
		'UPGRADE_ISSUE: PictureBox property picWallPaper.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picWallPaper.hdc, 3)
		'UPGRADE_ISSUE: PictureBox property picWallPaper.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picWallPaper.hdc, 0, 0, picWallPaper.Width, picWallPaper.Height, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCCOPY)
		' Release memory
		rc = GlobalUnlock(hMem)
		rc = GlobalFree(hMem)
	End Sub
	
	'Public Sub CombatMove(InDirection As Integer, Motive As Integer)
	Public Sub CombatMove(ByRef InDirection As MOVEDIRECTION, ByRef Motive As MOVEMOTIVE, Optional ByRef Distance As Short = 0)
		Dim PlaySoundFile As Object
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim CreatureTarget As Object
		Dim CreatureWithTurn As Object
		Dim Turns As Object
		Dim Found, c, NoFail As Short
		Dim ItemX As Item
		Dim rc, Steps As Short
		Dim j, i, PlayedSound As Short
		Dim ChangeDirectionCol, RowTo, ColTo, ChangeDirectionRow As Short
		Dim MoveCol, MoveRow, UpdateDistance As Short
		Dim InDirectionCol, InvalidMove, InDirectionRow As Short
		Dim MaxTries As Short
		Dim MoveCnt, Near As Short
		Dim CreatureX As Creature
		Dim CreatureWithTurnHold As Creature
		Dim CreatureTargetHold As Creature
		Dim ItemNowHold As Item
		Dim CreatureNowHold As Creature
		' Locate Target to move toward
		i = -1
		Select Case Motive
			Case MOVEMOTIVE.bdMoveTarget, MOVEMOTIVE.bdMoveRandom
				' If Target set, use that Target
				If Motive = MOVEMOTIVE.bdMoveTarget And Target > -1 Then
					i = Target
				Else ' Move Random
					For c = 0 To CombatTurn
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Turns(c).Ref.Friendly <> CreatureWithTurn.Friendly And (i = -1 Or Int(Rnd() * 100) < 50) Then
							i = c
						End If
					Next c
				End If
			Case MOVEDIRECTION.bdMoveClick
				' Don't need to choose a Target
			Case MOVEDIRECTION.bdMoveFlee
				' Nothing to do here
			Case Else
				For c = 0 To CombatTurn
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Turns(c).Ref.Friendly <> CreatureWithTurn.Friendly Then
						i = 0
						Select Case Motive
							Case MOVEMOTIVE.bdMoveClosest
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(i).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If (Turns(c).Ref.Col - CreatureWithTurn.Col) ^ 2 + (Turns(c).Ref.Row - CreatureWithTurn.Row) ^ 2 < (Turns(i).Ref.Col - CreatureWithTurn.Col) ^ 2 + (Turns(i).Ref.Row - CreatureWithTurn.Row) ^ 2 Then
									i = c
								End If
							Case MOVEMOTIVE.bdMoveFarthest
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(i).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If (Turns(c).Ref.Col - CreatureWithTurn.Col) ^ 2 + (Turns(c).Ref.Row - CreatureWithTurn.Row) ^ 2 > (Turns(i).Ref.Col - CreatureWithTurn.Col) ^ 2 + (Turns(i).Ref.Row - CreatureWithTurn.Row) ^ 2 Then
									i = c
								End If
							Case MOVEMOTIVE.bdMoveStrongest
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(i).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If Turns(c).Ref.HPNow + Turns(c).Ref.ActionPoints > Turns(i).Ref.HPNow + Turns(i).Ref.ActionPoints Then
									i = c
								End If
							Case MOVEMOTIVE.bdMoveWeakest
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(i).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If Turns(c).Ref.HPNow + Turns(c).Ref.ActionPoints < Turns(i).Ref.HPNow + Turns(i).Ref.ActionPoints Then
									i = c
								End If
						End Select
					End If
				Next c
		End Select
		' When we get here, a Target has been chosen
		If i > -1 And Motive <> MOVEMOTIVE.bdMoveRange Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureTarget = Turns(i).Ref
		End If
		' Fire Pre-CombatMove Triggers
		NoFail = True
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		rc = FireTriggers(EncounterNow, bdPreCombatMove)
		If rc = False Then
			NoFail = False
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemNow In CreatureWithTurn.Items
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemNow.IsReady = True Then
				CreatureNow = CreatureWithTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rc = FireTriggers(ItemNow, bdPreCombatMove)
				If rc = False Then
					NoFail = False
				End If
			End If
		Next ItemNow
		' If NoFail on all Triggers, then you can Move
		If NoFail = True Then
			' Move the Creature
			If InDirection = MOVEDIRECTION.bdMoveClick Then
				' Move to cursor click
				CursorToGrid(ClickX, ClickY, RowTo, ColTo)
				Near = 1
			ElseIf InDirection = MOVEDIRECTION.bdMoveToward Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ColTo = CreatureTarget.Col
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				RowTo = CreatureTarget.Row
				Near = 2
			ElseIf InDirection = MOVEDIRECTION.bdMoveFlee Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.Col < 5 Then
					ColTo = 0
				Else
					ColTo = bdCombatWidth
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.Row < 3 Then
					RowTo = 0
				Else
					RowTo = bdCombatHeight
				End If
			Else ' bdMoveAway
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ColTo = 5 - CreatureTarget.Col
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				RowTo = 3 - CreatureTarget.Row
				Near = 1
			End If
			' Play Move Sound
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MoveWAV. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.MoveWAV <> "" Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MoveWAV. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call PlaySoundFile(CreatureWithTurn.MoveWAV, Tome)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MoveWAVOneTime. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.MoveWAVOneTime = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MoveWAV. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.MoveWAV = ""
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MoveWAVOneTime. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.MoveWAVOneTime = False
				End If
			End If
			' [Titi 2.6.0] see if CreatureWithTurn has moved
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ChangeDirectionCol = CreatureWithTurn.Col
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ChangeDirectionRow = CreatureWithTurn.Row
			' Find path to Target
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			bKeepWeapon = CombatFindPath(CreatureWithTurn, ColTo, RowTo)
			' Play step sound and then move toward target
			Call PlaySoundFile("step" & Int(Rnd() * 4) + 1, Tome)
			i = 0 : Steps = 0
			For c = CombatStepTop To 0 Step -1
				' Fire Pre-CombatStep Triggers
				NoFail = True
				CreatureNow = CreatureWithTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemNow = CreatureWithTurn.ItemInHand
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rc = FireTriggers(CreatureNow, bdPreCombatStep)
				CreatureNow = CreatureWithTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemNow = CreatureWithTurn.ItemInHand
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rc = FireTriggers(EncounterNow, bdPreCombatStep)
				If rc = False Then
					NoFail = False
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemNow In CreatureWithTurn.Items
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ItemNow.IsReady = True Then
						CreatureNow = CreatureWithTurn
						'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rc = FireTriggers(ItemNow, bdPreCombatStep)
						If rc = False Then
							NoFail = False
						End If
					End If
				Next ItemNow
				' If no Trigger failure, move the Creature
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If NoFail = True And CreatureWithTurn.ActionPoints > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.Row = CombatStepRow(c)
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.Col = CombatStepCol(c)
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CombatStepCol(CombatStepTop) < CreatureWithTurn.Col Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Facing. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.Facing = 1
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Facing. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.Facing = 0
					End If
					i = i + 1
					' Refresh the screen and pause a brief moment
					CombatDraw()
					GameDelay(10)
					' Gains Opportunity Attack (if attack attitude is set)
					For j = 0 To CombatTurn
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns(j).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Turns(j).Ref.AllowedTurn = True And Turns(j).Ref.Friendly <> CreatureWithTurn.Friendly Then
							'                        If CombatRange(CreatureWithTurn, Turns(j).Ref.Col, Turns(j).Ref.Row) < 2 And Turns(j).Ref.OpportunityAttack = True Then
							'UPGRADE_WARNING: Couldn't resolve default property of object Turns(j).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If CombatRange(CreatureWithTurn, Turns(j).Ref.Col, Turns(j).Ref.Row) < IIf(Turns(j).Ref.CombatAttitude = bdCombatAttitudeGuard, Turns(j).Ref.ItemInHand.MaxRange + 1, 2) And Turns(j).Ref.OpportunityAttack = True Then
								' Opportunity Attack
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								CombatMessage(CreatureTarget.Name & IIf(Turns(j).Ref.CombatAttitude = bdCombatAttitudeGuard, " Guards", " Defends"))
								CreatureTargetHold = CreatureTarget
								CreatureTarget = CreatureWithTurn
								CreatureWithTurnHold = CreatureWithTurn
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								CreatureWithTurn = Turns(j).Ref
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(j).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If Turns(j).Ref.CombatAttitude = bdCombatAttitudeGuard Then
									' [Titi 2.5.1] if you guard, opportunity attacks cost action points
									'UPGRADE_WARNING: Couldn't resolve default property of object Turns(j).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									Turns(j).Ref.ActionPoints = Turns(j).Ref.ActionPoints - IIf(Turns(j).Ref.ItemInHand.ActionPoints > 0, Turns(j).Ref.ItemInHand.ActionPoints, 10)
									'UPGRADE_WARNING: Couldn't resolve default property of object Turns(j).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									If Turns(j).Ref.ActionPoints < 0 Or Turns(j).Ref.ItemInHand.IsShooter Then ' bows and the like will only give one such attack (game balance!)
										'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										Turns(j).Ref.ActionPoints = 0
										'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										Turns(j).Ref.CombatAttitude = bdCombatAttitudeWait2
									End If
								End If
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns(j).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								Turns(j).Ref.OpportunityAttack = IIf(Turns(j).Ref.CombatAttitude = bdCombatAttitudeGuard, True, False)
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								CombatAttack(62, CreatureWithTurn.ItemInHand.Name, 0, 0)
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If CreatureTarget.HPNow < 1 Then
									Exit Sub
								End If
								CreatureTarget = CreatureTargetHold
								CreatureWithTurn = CreatureWithTurnHold
							End If
						End If
					Next j
					' Fire Post-CombatStep Triggers
					NoFail = True
					CreatureNow = CreatureWithTurn
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ItemNow = CreatureWithTurn.ItemInHand
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rc = FireTriggers(CreatureNow, bdPostCombatStep)
					CreatureNow = CreatureWithTurn
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ItemNow = CreatureWithTurn.ItemInHand
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rc = FireTriggers(EncounterNow, bdPostCombatStep)
					If rc = False Then
						NoFail = False
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each ItemNow In CreatureWithTurn.Items
						'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If ItemNow.IsReady = True Then
							CreatureNow = CreatureWithTurn
							'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							rc = FireTriggers(ItemNow, bdPostCombatStep)
							If rc = False Then
								NoFail = False
							End If
						End If
					Next ItemNow
					' Take away ActionPoints for moving and end move if out of points
					Steps = Steps + 1
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MovementCost. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.ActionPoints - CreatureWithTurn.MovementCost * Steps < 1 Then
						Exit For
					End If
					' [Titi 2.6.0] If now in range, stop moving
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If IsBetween((CreatureWithTurn.Col - CreatureTarget.Col) ^ 2 + (CreatureWithTurn.Row - CreatureTarget.Row) ^ 2, CreatureWithTurn.ItemInHand.MinRange ^ 2, CreatureWithTurn.ItemInHand.MaxRange ^ 2) Then
						Exit For
					End If
				End If
			Next c
			' [Titi 2.6.0] if no path to target, but was able to move, keep weapon in hand
			If bKeepWeapon = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				bKeepWeapon = (System.Math.Abs(CreatureWithTurn.Col - ChangeDirectionCol) + System.Math.Abs(CreatureWithTurn.Row - ChangeDirectionRow)) <> 0
				If bKeepWeapon = False Then
					'CombatMessage CreatureWithTurn.Name & " is blocked!"
				End If
			End If
			' Spend Action Points
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MovementCost. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.ActionPoints = CreatureWithTurn.ActionPoints - CreatureWithTurn.MovementCost * Steps
			' Fire Post-CombatMove
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(EncounterNow, bdPostCombatMove)
			CreatureNow = CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each ItemNow In CreatureWithTurn.Items
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemNow.IsReady = True Then
					CreatureNow = CreatureWithTurn
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemNow, bdPostCombatMove)
				End If
			Next ItemNow
		End If
	End Sub
	
	Public Sub GameDelay(ByRef AtSpeed As Single)
		' Waits an amount of time.
		Dim SlowDown As Single
		SlowDown = VB.Timer() + ((21 - GlobalGameSpeed) / 3) / AtSpeed
		Do While VB.Timer() < SlowDown
		Loop 
	End Sub
	
	Private Sub GameSpeed(ByRef AddTo As Short)
		GlobalGameSpeed = LoopNumber(1, 20, GlobalGameSpeed, AddTo)
		MessageShow("Game Speed now set at " & 21 - GlobalGameSpeed, 0)
	End Sub
	
	Private Sub CombatWait()
		Dim CreatureWithTurn As Object
		Dim Turns As Object
		Dim c As Short
		Dim GridX As Grid
		'UPGRADE_WARNING: Couldn't resolve default property of object Turns(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GridX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GridX = Turns(TurnNow)
		For c = 0 To CombatTurn - 1
			If c >= TurnNow Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Turns(c) = Turns(c + 1)
			End If
		Next c
		'UPGRADE_WARNING: Couldn't resolve default property of object Turns(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Turns(CombatTurn) = GridX
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAttitude. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreatureWithTurn.CombatAttitude = bdCombatAttitudeWait
		CombatNextTurn()
	End Sub
	
	Public Sub CombatNextTurn()
		Dim EncounterNow As Object
		Dim PlaySoundFile As Object
		Dim GlobalHitLocation As Object
		Dim GlobalDamageRoll As Object
		Dim GlobalArmorRoll As Object
		Dim GlobalAttackRoll As Object
		Dim Turns As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureWithTurn As Object
		Dim CreatureNow As Object
		Dim Frozen As Object
		Dim PlayerTurn, c, n, NoFail As Short
		Dim rc As Integer
		Dim Y, X, Found As Short
		Dim CreatureX As Creature
		PlayerTurn = False
		Do 
			'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Frozen = True
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAttitude. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.CombatAttitude <> bdCombatAttitudeWait Then
				' Fire Post-Turn Trigger on CreatureWithTurn
				CreatureNow = CreatureWithTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemNow = CreatureWithTurn.ItemInHand
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(CreatureWithTurn, bdPostTurn)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemNow In CreatureWithTurn.Items
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ItemNow.IsReady = True Then
						CreatureNow = CreatureWithTurn
						'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = FireTriggers(ItemNow, bdPostTurn)
					End If
				Next ItemNow
				' Go to the next turn
				c = -1
				Do 
					TurnNow = LoopNumber(0, CombatTurn, TurnNow, 1)
					If TurnNow = 0 Then
						'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						TurnCycle()
						CombatArrays()
						'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
					End If
					c = c + 1
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(TurnNow).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Loop Until (Turns(TurnNow).Ref.HPNow > 0 And Turns(TurnNow).Ref.IsInanimate = False) Or CombatTurn < 0 Or c > CombatTurn
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAttitude. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureWithTurn.CombatAttitude = bdCombatAttitudeWait2
			End If
			picGrid.Refresh()
			' Check if everyone is dead
			If c > CombatTurn Then
				CombatEnd(False)
				Exit Sub
			End If
			GameDelay(5)
			System.Windows.Forms.Application.DoEvents()
			' Set up for next turn
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn = Turns(TurnNow).Ref
			Target = -1 : LastTarget = -1
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MsgQueTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.MsgQueTop = -1
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatDrawAttack(CreatureWithTurn, CreatureWithTurn, False)
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalAttackRoll = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalArmorRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalArmorRoll = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalDamageRoll = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalHitLocation. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalHitLocation = ""
			For c = 0 To 5 : CombatDiceType(c) = 0 : CombatDiceValue(c) = 0 : Next c
			Combat20Bonus = 0 : CombatDmgBonus = 0
			CombatRectangle()
			' Play the Next Turn tone
			CombatDraw()
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.DMControlled. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.DMControlled = False Then
				'            Call PlaySoundFile(gAppPath & "\data\stock\next.wav", Tome, True)
				Call PlaySoundFile(gDataPath & "\stock\next.wav", Tome, True)
			Else
				'            Call PlaySoundFile(gAppPath & "\data\stock\next2.wav", Tome, True)
				Call PlaySoundFile(gDataPath & "\stock\next2.wav", Tome, True)
			End If
			System.Windows.Forms.Application.DoEvents()
			' Fire Pre-Turn Trigger on CreatureWithTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAttitude. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.CombatAttitude <> bdCombatAttitudeWait2 Then
				' Clear all their stats
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TurnCycleCreatureClear(CreatureWithTurn)
				CreatureNow = CreatureWithTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemNow = CreatureWithTurn.ItemInHand
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(CreatureNow, bdPreTurn)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemNow In CreatureNow.Items
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ItemNow.IsReady = True Then
						CreatureNow = CreatureWithTurn
						'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = FireTriggers(ItemNow, bdPreTurn)
					End If
				Next ItemNow
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAttitude. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureWithTurn.CombatAttitude = 0
			End If
			CombatDraw()
			' Check if no non-DMControlled Creatures are left
			For c = 0 To CombatTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Turns(c).Ref.DMControlled = False Then
					Exit For
				End If
			Next c
			If c > CombatTurn Then
				CombatEnd(False)
				Exit Do
			End If
			' Check to see if Frozen or Resting
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AllowedTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.AllowedTurn = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.Frozen = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CombatMessage(CreatureWithTurn.Name & " already moved!")
					GameDelay(2)
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Unconscious. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.Unconscious = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CombatMessage(CreatureWithTurn.Name & " is unconscious!")
					GameDelay(2)
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Afraid. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.Afraid = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CombatMessage(CreatureWithTurn.Name & " is afraid!")
					GameDelay(2)
					CombatMove(MOVEDIRECTION.bdMoveFlee, MOVEDIRECTION.bdMoveFlee)
				End If
			Else
				' If no Unfriendly left alive, end combat (you won or lost)
				If CombatAllDead = True Then
					Found = True
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each CreatureX In EncounterNow.Creatures
						' [Titi 2.5.1] Inanimate doesn't mean dead!
						' Bug (combat quits abruptly and no XP awarded if the last enemy is inanimate...)
						'                    If CreatureX.HPNow > 0 Then
						If CreatureX.HPNow > 0 And CreatureX.IsInanimate = False Then
							Found = False
							Exit For
						End If
					Next CreatureX
					CombatEnd(Found)
					Exit Do
				Else
					' Play the turn
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.DMControlled. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.DMControlled = True Then
						'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						SorceryInvokeNext(CreatureWithTurn)
						Me.Refresh()
						CombatMonster()
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Frozen = False
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						SorceryInvokeNext(CreatureWithTurn)
						Me.Refresh()
						PlayerTurn = True
						picMap.Focus()
					End If
				End If
			End If
			'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		Loop Until PlayerTurn = True
	End Sub
	
	Private Sub CombatPaintSort()
		Dim Turns As Object
		Dim i, c, k As Short
		' Sort CreatureWithTurn to place in stack
		For c = 0 To CombatTurn
			For i = c + 1 To CombatTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(i)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Turns(Paint_Renamed(c)).Ref.Row < Turns(Paint_Renamed(i)).Ref.Row - CShort(Turns(Paint_Renamed(i)).Ref.HPNow < 1) Then
					k = Paint_Renamed(c)
					Paint_Renamed(c) = Paint_Renamed(i)
					Paint_Renamed(i) = k
				End If
			Next i
		Next c
	End Sub
	
	Private Sub CombatRectangle()
		Dim CreatureTarget As Object
		Dim Turns As Object
		Dim CreatureWithTurn As Object
		Dim c, n As Short
		Dim rc As Integer
		Dim GridWidth As Double
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim X, Height_Renamed, Width_Renamed, Y As Short
		Dim Distance2, Found, Distance1, MaxRange As Short
		Dim Movement As Short
		' Exit this if CreatureWithTurn is DM Controlled
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.DMControlled. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.DMControlled = True Then
			Exit Sub
		End If
		' Find Path
		CursorToGrid(CombatMouseX, CombatMouseY, Y, X)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CombatFindPath(CreatureWithTurn, X, Y)
		' Determine if cursor on Target
		Found = False
		For c = CombatTurn To 0 Step -1
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Turns(Paint_Renamed(c)).Ref.HPNow > 0 Or TargetAllowDead = True Then
				' Get coordinates
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GridToCursor(X, Y, Turns(Paint_Renamed(c)).Ref.Row, Turns(Paint_Renamed(c)).Ref.Col, GridWidth)
				' Get exact dimensions for picture
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				n = Turns(Paint_Renamed(c)).Ref.Pic
				Height_Renamed = Int(picCPic(n).Height / 4)
				Width_Renamed = Int(picCPic(n).Width / 2)
				' Center the picture in the square
				Y = Int(Y - Height_Renamed)
				X = X - (Width_Renamed - GridWidth) / 2
				' Determine if cursor in picture
				If PointIn(CombatMouseX, CombatMouseY, X, Y, Width_Renamed, Height_Renamed) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(Paint_Renamed(c)).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					If GetPixel(picCPic(n).hdc, CombatMouseX - X + Turns(Paint_Renamed(c)).Ref.Facing * Width_Renamed, CombatMouseY - Y + Height_Renamed) = 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureTarget = Turns(Paint_Renamed(c)).Ref
						' Determine if valid to target this creature
						Found = False
						Select Case MenuNow
							Case bdMenuTargetCreature
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If CreatureWithTurn.Friendly <> CreatureTarget.Friendly Then
									Found = True
								End If
							Case bdMenuTargetAny
								Found = True
							Case bdMenuTargetParty
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If CreatureWithTurn.Friendly = CreatureTarget.Friendly Then
									Found = True
								End If
							Case Else
								Found = True
						End Select
						If Found = True Then
							Target = Paint_Renamed(c)
							If Target <> LastTarget Then
								'UPGRADE_WARNING: Untranslated statement in CombatRectangle. Please check source code.
								LastTarget = Paint_Renamed(c)
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								CombatDrawAttack(CreatureWithTurn, CreatureTarget, False)
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								CombatFindPath(CreatureWithTurn, CreatureTarget.Col, CreatureTarget.Row)
								CombatDraw(1)
							End If
						Else
							Target = -1
						End If
						Exit Sub
					End If
				End If
			End If
		Next c
		If LastTarget <> -1 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatDrawAttack(CreatureWithTurn, CreatureWithTurn, False)
		End If
		Target = -1 : LastTarget = -1
		CombatDraw()
	End Sub
	
	Public Sub CombatArrays()
		Dim Turns As Object
		Dim EncounterNow As Object
		Dim i, c, Found As Short
		Dim GridNow(bdCombatWidth, bdCombatHeight) As Short
		Dim HereX(bdCombatWidth * bdCombatHeight) As Short
		Dim HereY(bdCombatWidth * bdCombatHeight) As Short
		'UPGRADE_NOTE: Top was upgraded to Top_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Top_Renamed As Short
		Dim CreatureX As Creature
		Dim GridX As Grid
		' Clear combat pointers
		TurnNow = 0 : Target = -1 : CombatTurn = -1
		' Que all the spaces looking for at least one starting space
		Found = False
		For c = 0 To bdCombatHeight : For i = 0 To bdCombatWidth
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CombatGrid. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GridNow(i, c) = EncounterNow.CombatGrid(i, c)
				If GridNow(i, c) > 1 Then
					Found = True
				End If
			Next i : Next c
		' If no starting spaces, create some
		If Found = False Then
			Select Case Int(Rnd() * 3)
				Case 0 ' Mons Right, Chars Left
					For c = 0 To bdCombatHeight : For i = 0 To bdCombatWidth
							If i < 5 Then
								GridNow(i, c) = 2
							ElseIf i > 5 Then 
								GridNow(i, c) = 3
							End If
						Next i : Next c
				Case 1 ' Monst Top, Chars Bottom
					For c = 0 To bdCombatHeight : For i = 0 To bdCombatWidth
							If c < 3 Then
								GridNow(i, c) = 2
							ElseIf i > 3 Then 
								GridNow(i, c) = 3
							End If
						Next i : Next c
				Case 2 ' Chars Top, Mons Bottom
					For c = 0 To bdCombatHeight : For i = 0 To bdCombatWidth
							If c < 3 Then
								GridNow(i, c) = 3
							ElseIf i > 3 Then 
								GridNow(i, c) = 2
							End If
						Next i : Next c
			End Select
		End If
		' Find spot for all party members
		For	Each CreatureX In Tome.Creatures
			' If not afraid or not on the edge of the combat area
			If (CreatureX.Afraid = False Or IsBetween(CreatureX.Col, 1, bdCombatWidth - 1)) And (CreatureX.IsInanimate = False Or CreatureX.HPNow > 0) Then
				If CreatureX.Initiative = 0 Then
					' Find a spot for it
					Top_Renamed = 0
					For c = 0 To bdCombatHeight : For i = 0 To bdCombatWidth
							If GridNow(i, c) = 2 Then ' Party starting spot
								HereX(Top_Renamed) = i : HereY(Top_Renamed) = c
								Top_Renamed = Top_Renamed + 1
								Found = True
							End If
						Next i : Next c
					' Find random spot
					If Top_Renamed = 0 Then
						' Secondary look is to open spots
						For c = 0 To bdCombatHeight : For i = 0 To bdCombatWidth
								If GridNow(i, c) = 0 Then ' Open starting spot
									HereX(Top_Renamed) = i : HereY(Top_Renamed) = c
									Top_Renamed = Top_Renamed + 1
								End If
							Next i : Next c
					End If
					If Top_Renamed > 0 Then
						CreatureX.Col = HereX(Int(Rnd() * Top_Renamed))
						CreatureX.Row = HereY(Int(Rnd() * Top_Renamed))
						' Set initiative
						CreatureX.Initiative = Int(Rnd() * 6) + 1
					End If
				End If
				If CreatureX.Initiative > 0 And CombatTurn < 48 Then
					' Add to combat que
					CombatTurn = Least(CombatTurn + 1, 48)
					CreatureX.Friendly = True
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Turns(CombatTurn).Ref = CreatureX
					Paint_Renamed(CombatTurn) = CombatTurn
					' Mark grid space occupied
					GridNow(CreatureX.Col, CreatureX.Row) = True
				End If
			End If
		Next CreatureX
		' Find spot for all Monsters
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			' If not afraid or not on the edge of the combat area
			If (CreatureX.Afraid = False Or IsBetween(CreatureX.Col, 1, bdCombatWidth - 1)) And (CreatureX.IsInanimate = False Or CreatureX.HPNow > 0) Then
				If CreatureX.Initiative = 0 Then
					' Find a spot for it
					Top_Renamed = 0
					For c = 0 To bdCombatHeight : For i = 0 To bdCombatWidth
							If GridNow(i, c) = 3 Then ' Monster starting spot
								HereX(Top_Renamed) = i : HereY(Top_Renamed) = c
								Top_Renamed = Top_Renamed + 1
								Found = True
							End If
						Next i : Next c
					' Find random spot
					If Top_Renamed = 0 Then
						' Secondary look is to open spots
						For c = 0 To bdCombatHeight : For i = 0 To bdCombatWidth
								If GridNow(i, c) = 0 Then ' Open starting spot
									HereX(Top_Renamed) = i : HereY(Top_Renamed) = c
									Top_Renamed = Top_Renamed + 1
								End If
							Next i : Next c
					End If
					If Top_Renamed > 0 Then
						CreatureX.Col = HereX(Int(Rnd() * Top_Renamed))
						CreatureX.Row = HereY(Int(Rnd() * Top_Renamed))
						' Set initiative
						CreatureX.Initiative = Int(Rnd() * 6) + 1
					End If
				End If
				If CreatureX.Initiative > 0 And CombatTurn < 48 Then
					' Add to combat que
					CombatTurn = Least(CombatTurn + 1, 48)
					CreatureX.Friendly = False
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Turns(CombatTurn).Ref = CreatureX
					Paint_Renamed(CombatTurn) = CombatTurn
					' Mark grid space occupied
					GridNow(CreatureX.Col, CreatureX.Row) = True
				End If
			ElseIf CreatureX.Afraid = True Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.RemoveCreature. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				EncounterNow.RemoveCreature("X" & CreatureX.Index)
			End If
		Next CreatureX
		' Sort by Initiative
		For c = 0 To CombatTurn
			For i = c + 1 To CombatTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(i).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Turns(c).Ref.Initiative < Turns(i).Ref.Initiative Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object GridX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					GridX = Turns(c)
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Turns(c) = Turns(i)
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Turns(i) = GridX
				End If
			Next i
		Next c
	End Sub
	
	Private Sub PlayMusicState()
		Dim Adventure As Object
		Dim Combat As Object
		Dim PlayMusicRnd As Object
		Dim oGameMusic As Object
		Dim rc As Integer
		GlobalMusicState = 1 - GlobalMusicState
		Select Case GlobalMusicState
			Case 0
				MessageShow("Music is now OFF", 0)
				'MediaPlayerMusic.Stop
				'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.StopPlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				oGameMusic.StopPlay()
				'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.mciClose. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				oGameMusic.mciClose()
			Case 1
				MessageShow("Music is now ON", 0)
				Call PlayMusicRnd(IIf(picGrid.Visible, Combat, Adventure), Me)
		End Select
	End Sub
	
	Private Sub PlaySoundState()
		Dim rc As Integer
		GlobalWAVState = 1 - GlobalWAVState
		Select Case GlobalWAVState
			Case 0
				MessageShow("Sound Effects are now OFF", 0)
			Case 1
				MessageShow("Sound Effects are now ON", 0)
		End Select
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub CombatStart()
		Dim CreatureWithTurn As Object
		Dim FireTriggers As Object
		Dim Combat As Object
		Dim PlayMusicRnd As Object
		Dim DialogShow As Object
		Dim bdMaxMonsPics As Object
		Dim Tome_Renamed As Object
		Dim DialogHide As Object
		Dim DialogDM As Object
		Dim EncounterNow As Object
		Dim DialogSetUp As Object
		Dim LastMons, c, i, Found As Short
		Dim NoFail As Short
		Dim CreatureX As Creature
		' Close down current menu, Convo and Talk (if any) and stop Party
		DialogSetUp(bdDlgNoReply) ' [Titi 2.4.9b] added for display of number of creatures
		picConvo.Visible = False
		picTalk.Visible = False
		tmrMoveParty.Enabled = False
		' Check to see if Combat is allowed in this Encounter: at least one Creature must be
		' alive and the Encounter must allow combat.
		Found = False
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			If CreatureX.HPNow > 0 Then
				Found = True
				Exit For
			End If
		Next CreatureX
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanFight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If EncounterNow.CanFight = False Or Found = False Then
			DialogDM("There's no reason to fight here.")
			DialogHide()
			Exit Sub
		End If
		' [Titi 2.4.9b] redimension array of picture files if too many creatures
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMaxMonsPics. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Tome.Creatures.Count + EncounterNow.Creatures.Count > bdMaxMonsPics Then
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdMaxMonsPics. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			bdMaxMonsPics = Tome.Creatures.Count + EncounterNow.Creatures.Count
			Dim PicFile(bdMaxMonsPics) As String
			Dim PicPortrait(bdMaxMonsPics) As String
			Dim PicFileTime(bdMaxMonsPics) As Double
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each CreatureX In Tome.Creatures
				LoadCreaturePic(CreatureX)
			Next CreatureX
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each CreatureX In EncounterNow.Creatures
				LoadCreaturePic(CreatureX)
			Next CreatureX
		End If
		' [Titi 2.4.9] check how many different creatures there are
		Dim j, CreatureCount As Short
		' [Titi 2.4.9b] Don't count dead creatures!
		' CreatureCount = EncounterNow.Creatures.Count
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			If CreatureX.HPNow > 0 Then CreatureCount = CreatureCount + 1
		Next CreatureX
		If CreatureCount >= 1 Then
			Dim strCreatures(CreatureCount) As String
			Dim intNb(CreatureCount) As Short
			i = 1
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each CreatureX In EncounterNow.Creatures
				' [Titi 2.4.9b] don't count dead creatures!
				If CreatureX.Friendly = False And CreatureX.HPNow > 0 Then
					strCreatures(i) = CreatureX.Name
					i = i + 1
				End If
			Next CreatureX
			' sort alphabetically
			For i = 1 To CreatureCount - 1
				For j = i + 1 To CreatureCount
					If strCreatures(i) > strCreatures(j) Then
						strCreatures(0) = strCreatures(i)
						strCreatures(i) = strCreatures(j)
						strCreatures(j) = strCreatures(0)
					End If
				Next j
			Next i
			' now, count how many of them
			j = 1
			For i = 1 To CreatureCount - 1
				intNb(j) = intNb(j) + 1
				If strCreatures(i) <> strCreatures(i + 1) Then
					j = j + 1
				End If
			Next 
			' don't forget to count the last one!
			intNb(j) = intNb(j) + 1
			' OK, now we have j-1 types, and intNb(1..j-1) each
			strCreatures(0) = "" : i = 0 : intNb(0) = 1
			While i < j
				i = i + 1
				strCreatures(0) = strCreatures(0) & Str(intNb(i)) & " " & strCreatures(intNb(0)) & IIf(intNb(i) > 1, "s,", ",")
				If i = j - 1 Then strCreatures(0) = VB.Left(strCreatures(0), Len(strCreatures(0)) - 1) & " and"
				intNb(0) = intNb(0) + intNb(i)
			End While
			' erase the last ","
			strCreatures(0) = VB.Left(strCreatures(0), Len(strCreatures(0)) - 1)
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.HaveEntered. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DialogShow(EncounterNow.Creatures(1), IIf(EncounterNow.HaveEntered = True, "You fled... But the enemy is still here." & vbCrLf, "") & strCreatures(0) & IIf(CreatureCount = 1, " is", " are") & " getting ready for the battle.")
		End If
		' Load Wallpaper for Combat
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		CombatWallpaper()
		picToHit.Left = (Me.ClientRectangle.Width - picToHit.ClientRectangle.Width) / 2
		' Play combat music
		Call PlayMusicRnd(Combat, Me)
		' Clear Initiative for all Creatures
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In Tome.Creatures
			CreatureX.Initiative = 0
		Next CreatureX
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			CreatureX.Initiative = 0
		Next CreatureX
		' Set up Combat Arrays with Creatures
		CombatTurn = -1
		CombatArrays()
		' If nobody is alive then cancel out
		If CombatTurn < 0 Then
			DialogDM("There's nobody alive to fight.")
			Exit Sub
		End If
		' Fire up Pre-Combat Trigger (if any)
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(Tome, bdPreCombat)
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(EncounterNow, bdPreCombat)
		' Show menu, ToHit slab, Grid and Menu orbs
		picMenu.Visible = False
		picToHit.Visible = True
		picGrid.Visible = True
		picGrid.BringToFront()
		' Blank out CreatureWithTurn while starting combat
		CreatureWithTurn = New Creature
		' No turns or Message at combat start
		DialogHide()
		TurnNow = -1
		CombatDraw()
		BorderDrawButtons(0)
		CombatNextTurn()
		Me.Refresh()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Public Function CombatRollArmor(ByRef Defender As Creature, ByVal RollIt As Short, ByVal SetValue As Object) As Short
		' This rolls armor to hit: flat display, roll and effect. It
		' returns the index of the ArmorChit hit.
		' NOTE: Armor Roll ranges from 0 to 7
		Dim n, rc, c, i, k As Short
		' If in combat, show rolling armor. Else, just set it
		If picGrid.Visible = True Then
			' Show all Armor Chits on Defender: Covered 0, 1-2, 3-4, 5-6 or 7-8
			' If 0-25 = Wooden, 26-74 = Silver, >75 = Golden.
			n = 0 : k = 0
			For c = 0 To 7
				If Defender.ResistanceWithArmor(c) > 0 Then
					n = n + 1
					k = k + Defender.ResistanceWithArmor(c)
				End If
			Next c
			If n > 0 Then
				If (k / n) < 1 Then
					k = -1 ' None
				ElseIf (k / n) < 26 Then 
					k = 0 ' Wooden
				ElseIf (k / n) < 76 Then 
					k = 1 ' Silver
				Else
					k = 2 ' Gold
				End If
			End If
			n = Int(n / 2 + 0.5)
			' Display (c = Number of Shields-1, k = Type of Shield)
			If k > -1 Then
				For c = 0 To n - 1
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picToHit.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picToHit.hdc, 268 + c * 36, 2, 32, 32, picMisc.hdc, 96, 197, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picToHit.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picToHit.hdc, 268 + c * 36, 2, 32, 32, picMisc.hdc, k * 32, 197, SRCPAINT)
				Next c
			End If
			If RollIt Then
				n = Int(Rnd() * 5) + 5
				For i = 0 To n
					'UPGRADE_WARNING: Couldn't resolve default property of object SetValue. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If i = n And SetValue > 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object SetValue. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						c = Least(Greatest(SetValue - 1, 0), 7)
					Else
						c = Int(Rnd() * 8)
					End If
				Next i
			End If
			CombatRollArmor = c
			'UPGRADE_WARNING: Couldn't resolve default property of object SetValue. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf SetValue > 0 Then 
			'UPGRADE_WARNING: Couldn't resolve default property of object SetValue. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatRollArmor = Least(Greatest(SetValue - 1, 0), 7)
		Else
			CombatRollArmor = Int(Rnd() * 8)
		End If
	End Function
	
	Private Sub DiceDraw(ByRef DicePos As Short, ByRef DiceType As Short, ByRef DiceValue As Short, ByRef InCombat As Short)
		Dim rc As Integer
		Dim Y, X, c As Short
		c = DiceValue - 1
		If DiceValue > 0 Then
			Select Case DiceType
				Case 20
					X = (c Mod 8) * 40 : Y = Int(c / 8) * 40
				Case 12
					If DiceValue < 7 Then
						X = 40 * 2 + c * 40 : Y = 7 * 40
					Else
						X = (c - 6) * 40 : Y = 8 * 40
					End If
				Case 10
					If c < 8 Then
						X = c * 40 : Y = 6 * 40
					Else
						X = (c - 8) * 40 : Y = 7 * 40
					End If
				Case 8
					X = c * 40 : Y = 120
				Case 6
					X = c * 40 : Y = 200
				Case 4
					X = 120 + c * 40 : Y = 160
			End Select
		Else
			Select Case DiceType
				Case 20
					X = 40 * 4 + System.Math.Abs(c + 2) * 40 : Y = 2 * 40
				Case 12
					X = 40 * 6 + System.Math.Abs(c + 2) * 40 : Y = 8 * 40
				Case 10
					X = System.Math.Abs(c + 2) * 39 : Y = 4 * 40
				Case 8
					X = System.Math.Abs(c + 2) * 39 : Y = 4 * 40
				Case 6
					X = 40 * 6 + System.Math.Abs(c + 2) * 40 : Y = 5 * 40
				Case 4
					X = 40 * 4 : Y = 4 * 40
			End Select
		End If
		If InCombat = True Then
			If DicePos = 0 Then
				'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picToHit.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picToHit.hdc, 132, 40, 40, 40, picDice.hdc, X + picDice.ClientRectangle.Width / 2, Y, SRCAND)
				'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picToHit.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picToHit.hdc, 132, 40, 40, 40, picDice.hdc, X, Y, SRCPAINT)
			Else
				'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picToHit.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picToHit.hdc, 134 + DicePos * 46, 40, 40, 40, picDice.hdc, X + picDice.ClientRectangle.Width / 2, Y, SRCAND)
				'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picToHit.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picToHit.hdc, 134 + DicePos * 46, 40, 40, 40, picDice.hdc, X, Y, SRCPAINT)
			End If
		Else
			'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picConvo.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picConvo.hdc, 60 + DicePos * 46, picConvo.Height - 52, 40, 40, picDice.hdc, X + picDice.ClientRectangle.Width / 2, Y, SRCAND)
			'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picConvo.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picConvo.hdc, 60 + DicePos * 46, picConvo.Height - 52, 40, 40, picDice.hdc, X, Y, SRCPAINT)
		End If
	End Sub
	
	Public Function DiceRoll(ByRef DiceCnt As Short, ByRef DiceToRoll As Short, ByRef Bonus As Short, ByRef Attack As Short, ByRef InCombat As Short) As Short
		Dim GlobalDieCountRoll As Object
		Dim GlobalDieTypeRoll As Object
		Dim bdFontSmallWhite As Object
		Dim PlaySoundFile As Object
		Dim CreatureWithTurn As Object
		Dim CreatureTarget As Object
		Dim X, c, n, Y As Short
		Dim FinalRoll, MaxTimes, RollNow, TotalDice As Short
		' Check for invalid dice and make valid
		DiceCnt = Greatest(Least(DiceCnt, 5), 1)
		If DiceToRoll <> 4 And DiceToRoll <> 6 And DiceToRoll <> 8 And DiceToRoll <> 10 And DiceToRoll <> 12 And DiceToRoll <> 20 Then
			DiceToRoll = 4
		End If
		' Set up number of times to roll
		If DiceCnt = 1 And Attack = True And InCombat = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = CombatRollArmor(CreatureTarget, False, 0)
		End If
		MaxTimes = Int(Rnd() * 3) + 3
		' Clear out previous rolls if not in combat (in combat, we want to retain our rolls for display)
		If InCombat = False Then
			For n = 0 To 5
				CombatDiceType(n) = 0
			Next n
		End If
		' Bounce until get to final roll
		TotalDice = 0
		Do Until TotalDice > 0
			Sleep(10)
			For c = 1 To DiceCnt
				' Draw either a rolling die or a numbered die
				If Int(Rnd() * 100) < 50 Or MaxTimes < 1 Or GlobalDiceRolling = 0 Then
					FinalRoll = Int(Rnd() * DiceToRoll)
					RollNow = FinalRoll + 1
				Else
					' Roll a spinning die
					Select Case DiceToRoll
						Case 20
							RollNow = -Int(Rnd() * 4)
						Case 12
							RollNow = -Int(Rnd() * 2)
						Case 10
							RollNow = -Int(Rnd() * 3)
						Case 8
							RollNow = -Int(Rnd() * 3)
						Case 6
							RollNow = -Int(Rnd() * 2)
						Case 4
							RollNow = 0
					End Select
				End If
				If DiceCnt = 1 And Attack = True And InCombat = True Then
					CombatDiceType(0) = DiceToRoll : CombatDiceValue(0) = RollNow
				Else
					CombatDiceType(c) = DiceToRoll : CombatDiceValue(c) = RollNow
				End If
				If InCombat = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CombatDrawAttack(CreatureWithTurn, CreatureTarget, True)
				End If
				' Store away the final rolls
				If MaxTimes > 0 And GlobalDiceRolling = 1 Then
					If c = DiceCnt Then
						MaxTimes = MaxTimes - 1
					End If
				Else
					TotalDice = TotalDice + FinalRoll + 1
				End If
			Next c
		Loop 
		' [Titi 2.4.9b] Hide bonuses if using unknown (not examined) equipment
		Dim intDef, intAtt, intDmg As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CalcGearBonus(CreatureWithTurn, intAtt, intDef, intDmg, CBool(InCombat))
		' Draw dice in DialogDice
		If InCombat = False Then
			For n = 0 To 5
				If CombatDiceType(n) <> 0 Then
					DiceDraw(n, CombatDiceType(n), CombatDiceValue(n), False)
				End If
			Next n
			picConvo.Refresh()
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatDrawAttack(CreatureWithTurn, CreatureTarget, True)
		End If
		' Play roll sound
		If GlobalDiceRolling = 1 Then
			If DiceCnt > 1 Then
				Call PlaySoundFile("manydice", Tome,  , IIf(InCombat = True, 5, 0))
			Else
				Call PlaySoundFile("diceroll", Tome,  , IIf(InCombat = True, 5, 0))
			End If
		End If
		' Add Bonus if necessary
		If Bonus <> 0 And InCombat = True Then
			' [Titi 2.4.9b] Monsters always know their equipment!
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.Friendly = False Then
				intAtt = 0 : intDef = 0 : intDmg = 0
			End If
			If Attack = True Then
				' Attack Bonus
				If Bonus < 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picToHit, 132, 40, 40, 10, bdFontSmallWhite, VB6.Format(Bonus + intAtt), 1, False)
				ElseIf Bonus + intAtt > 0 Then 
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picToHit, 132, 40, 40, 10, bdFontSmallWhite, "+" & VB6.Format(Bonus + intAtt), 1, False)
				End If
			Else
				' Damage Bonus
				If Bonus < 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picToHit, 136 + DiceCnt * 46, 40, 40, 10, bdFontSmallWhite, VB6.Format(Bonus + intDmg), 1, False)
				ElseIf Bonus + intDmg > 0 Then 
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picToHit, 136 + DiceCnt * 46, 40, 40, 10, bdFontSmallWhite, "+" & VB6.Format(Bonus + intDmg), 1, False)
				End If
			End If
			picToHit.Refresh()
		End If
		' Set the global dice attributes
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDieTypeRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDieTypeRoll = DiceToRoll
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDieCountRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDieCountRoll = DiceCnt
		If DiceToRoll = 20 Then
			Combat20 = TotalDice
			Combat20Bonus = Bonus
		End If
		' Return number rolled
		DiceRoll = TotalDice + Bonus
	End Function
	
	Public Sub AwardExperienceToParty(ByRef ExpPts As Integer, Optional ByRef bFromCombat As Boolean = False)
		Dim DialogDM As Object
		Dim c As Short
		Dim CreatureX As Creature
		' Find how many Creatures are still alive in the Party
		c = 0
		For	Each CreatureX In Tome.Creatures
			If CreatureX.HPNow > 0 Then
				c = c + 1
			End If
		Next CreatureX
		' If there are live, the divide up the Experience Points
		If c > 0 Then
			ExpPts = Fix(ExpPts / c)
			'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
			DialogDM("Each Party member receives " & ExpPts & " Experience Points!")
			For	Each CreatureX In Tome.Creatures
				AwardExperienceToCreature(CreatureX, ExpPts, bFromCombat)
			Next CreatureX
		End If
	End Sub
	
	Public Sub AwardExperienceToCreature(ByRef CreatureX As Creature, ByRef ExpPts As Integer, Optional ByRef bFromFight As Boolean = False)
		Dim DialogDM As Object
		Dim PlaySoundFile As Object
		Dim NextLevel As Integer
		Dim AwardHP, c, AwardSkill, AwardMagic As Short
		' You can only award experience to live creatues
		If CreatureX.HPNow > 0 Then
			' [Titi 2.5.1] Update information
			If bFromFight Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.RecordXP. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ExpPts > CreatureX.Infos.RecordXP Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.RecordXP. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureX.Infos.RecordXP = ExpPts
				End If
			End If
			NextLevel = CreatureX.ExperiencePoints + ExpPts
			CreatureX.ExperiencePoints = NextLevel
			c = CreatureX.Level : AwardSkill = 0 : AwardHP = 0
			' Keep raising until correct level for ExperiencePoints
			Do 
				If NextLevel > (c * Int(c / 2 + 0.5) + (c / 2) * (1 - (c Mod 2))) * 1000 - 1 Then
					c = c + 1
					AwardSkill = AwardSkill + WorldNow.SkillPtsPerLevel ' 10
					AwardHP = AwardHP + CShort(WorldNow.HPPerLevel * 0.5) '10
					AwardMagic = AwardMagic + CShort(0.5 * WorldNow.MagicPerLevel)
					' [Titi 2.4.9] customize HP and SkillPoints depending on world settings
					If WorldNow.RandomizeHP Then
						AwardHP = AwardHP + CShort(Rnd(1) * 0.5 * WorldNow.HPPerLevel)
					Else
						AwardHP = AwardHP + CShort(WorldNow.HPPerLevel * 0.5)
					End If
					' [Titi 2.4.9b] Magic system
					If WorldNow.RandomizeMagic Then
						AwardMagic = AwardMagic + CShort(Rnd(1) * 0.5 * WorldNow.MagicPerLevel)
					Else
						AwardMagic = AwardMagic + CShort(WorldNow.MagicPerLevel * 0.5)
					End If
				Else
					Exit Do
				End If
			Loop 
			If c > CreatureX.Level Then
				CreatureX.Level = c
				c = CreatureX.SkillPoints + AwardSkill
				CreatureX.SkillPoints = c
				c = CreatureX.HPNow + AwardHP
				CreatureX.HPNow = c
				c = CreatureX.HPMax + AwardHP
				CreatureX.HPMax = c
				' [Titi 2.4.9b] Magic points
				CreatureX.AddEternium = c + CreatureX.AddEternium
				c = CreatureX.Eternium + AwardMagic
				CreatureX.Eternium = c
				'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				Call PlaySoundFile("NewLevel", Tome)
				DialogDM(CreatureX.Name & " is now Level " & CreatureX.Level & " and receives " & AwardSkill & " Skill Points" & IIf(WorldNow.Runes = False, " and ", ", ") & AwardHP & " Health Points" & IIf(WorldNow.Runes = False, "!", " and " & AwardMagic & " " & WorldNow.Magic & " points!"))
			End If
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub CombatEnd(ByRef GetExperience As Short)
		Dim Adventure As Object
		Dim PlayMusicRnd As Object
		Dim MenuParty As Object
		Dim CreatureWithTurn As Object
		Dim Tome_Renamed As Object
		Dim oGameMusic As Object
		Dim DialogBriefSet As Object
		Dim Frozen As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim DialogHide As Object
		Dim DialogDM As Object
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim ConvoAction As Object
		Dim NoFail, TotalLevels, AvgMonsLevel As Short
		Dim ExpPts As Integer
		Dim OldLevel, c, OldSkill As Short
		Dim CreatureX As Creature
		Dim ItemX As Item
		Dim JournalX, JournalLog As Journal
		Dim strCreature As String
		Dim ItemY As Item
		Dim TriggerX As Trigger
		' Apply Experience (if didn't flee)
		'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ConvoAction = -1
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If GetExperience = True And EncounterNow.Creatures.Count > 0 Then
			' Fire Post-Combat Triggers
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(Tome, bdPostCombat)
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(EncounterNow, bdPostCombat)
			' Total up Experience Points and wipe Creatures
			ExpPts = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each CreatureX In EncounterNow.Creatures
				If CreatureX.HPNow < 1 Then
					ExpPts = ExpPts + CreatureX.ExperiencePoints
					CreatureX.ExperiencePoints = 0
					' [Titi 2.6.0] who knows, maybe you'd like to resurrect your enemies?
					'                UpdateCreatureInfo CreatureX, True
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					EncounterNow.Creatures.Remove("X" & CreatureX.Index)
				End If
			Next CreatureX
			' Award Experience Points
			If ExpPts > 0 Then
				AwardExperienceToParty(ExpPts, True)
			Else
				DialogDM("You receive NO Experience Points for winning this combat.")
				DialogHide()
			End If
			'        For Each CreatureX In Tome.Creatures
			'            UpdateCreatureInfo CreatureX, True
			'        Next
			' If there are things to find, offer a search
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If EncounterNow.Items.Count > 0 Then
				DialogSetUp(bdDlgNoReply)
				DialogSetButton(1, "Search")
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If EncounterNow.Items.Count = 1 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogShow("DM", "You notice " & AOrAn(EncounterNow.Items(1).Name) & EncounterNow.Items(1).Name & " in the area.")
				Else
					DialogShow("DM", "You notice several items in the area.")
				End If
				DialogHide()
			End If
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = False
		picToHit.Visible = False
		picMenu.Visible = True
		picGrid.Visible = False
		' Hide any stray DialogBrief and clear buffer
		picDialogBrief.Visible = False
		tmrDialogBrief.Enabled = False
		DialogBriefSet = New Collection
		' Refresh the screen
		Me.Refresh()
		'MediaPlayerMusic.Stop
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.StopPlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oGameMusic.StopPlay()
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.mciClose. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oGameMusic.mciClose()
		' Clear all Creatures casting
		' [Titi 2.4.9b] added the customized magic system
		If WorldNow.Runes = False Then
			' Eternia settings
			For	Each CreatureX In Tome.Creatures
				For c = 0 To 5
					CreatureX.Runes(c) = 0
				Next c
				CreatureX.RuneTop = 0
				CreatureX.RuneQueLimit = 0
			Next CreatureX
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each CreatureX In EncounterNow.Creatures
				For c = 0 To 5
					CreatureX.Runes(c) = 0
				Next c
				CreatureX.RuneTop = 0
				CreatureX.RuneQueLimit = 0
			Next CreatureX
		Else
			' current world doesn't use the runes system
			For	Each CreatureX In Tome.Creatures
				CreatureX.Eternium = CreatureX.Eternium - 1 ' skillpoints instead...
			Next CreatureX
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each CreatureX In EncounterNow.Creatures
				CreatureX.Eternium = CreatureX.Eternium - 1 ' skillpoints instead...
			Next CreatureX
		End If
		' [Titi 2.6.0] update active character
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 0 To Least(4, Tome.Creatures.Count - 1)
			'UPGRADE_WARNING: Couldn't resolve default property of object MenuParty(c).Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.Index = MenuParty(c).Index Then
				SetTurn(c)
			End If
		Next 
		' Refresh screen
		TurnCycle()
		MenuDrawParty()
		BorderDrawButtons(0)
		DrawMapAll()
		c = GameDeath
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Not c And EncounterNow.Items.Count > 0 And GetExperience = True Then
			MenuNow = bdMenuSearch
			DoAction(bdMenuActionDefault)
		End If
		Call PlayMusicRnd(Adventure, Me)
	End Sub
	
	Private Function GameDeath() As Short
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim PlaySoundFile As Object
		Dim CreatureX As Creature
		' Test if all Party is dead
		GameDeath = True
		For	Each CreatureX In Tome.Creatures
			If CreatureX.HPNow > 0 And CreatureX.DMControlled = False Then
				GameDeath = False
				Exit For
			End If
		Next CreatureX
		' If all dead then end game
		If GameDeath Then
			Call PlaySoundFile("partydead", Tome)
			DialogSetUp(bdDlgNoReply)
			DialogSetButton(1, "Ok")
			DialogShow("DM", "Your Party has died.")
			DialogHide()
			GameEnd(False)
		End If
	End Function
	
	Private Sub DialogCredits()
		Dim DialogSetButton As Object
		Dim bdFontSmallWhite As Object
		Dim bdFontNoxiousWhite As Object
		Dim bdFontElixirWhite As Object
		Dim DialogSetUp As Object
		Dim PosY, LastY As Short
		Dim rc As Integer
		' Show the Close Credits
		DialogSetUp(bdDlgCredits)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picConvo, 0, 12, picConvo.Width, 14, bdFontElixirWhite, "Credits and Thanks", True, False)
		LastY = 32
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontElixirWhite, "Original Concept and Design", True, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontNoxiousWhite, "Dan Schnake and Adam West", True, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontNoxiousWhite, "CrossCut Games, Inc.", True, True)
		LastY = LastY + PosY + 10
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontElixirWhite, "Story Weaver and Documentation", True, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontNoxiousWhite, "Dan Schnake", True, True)
		LastY = LastY + PosY + 10
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontElixirWhite, "Programmer and Pixel Slinger", True, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontNoxiousWhite, "Adam West", True, True)
		LastY = LastY + PosY + 10
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontElixirWhite, "Additional Graphic Content", True, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontNoxiousWhite, "Adam Krantz (Sarchimus)", True, True)
		LastY = LastY + PosY + 10
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontElixirWhite, "RuneSword OpenSource Team", True, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Lead Developer & Doc. :", 0, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Titi (Thierry Petitjean)", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Content Management : ", 0, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Monty (Frank Montellano)    ", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "DangNabIt (Daniel Glover)    ", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Project Manager :", 0, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "VampiricDread (J.P. Carvalho)", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Developer :", 0, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Borfaux (Rob Blair)", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Phule (Robert Buchanan)", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Code & Testing :", 0, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Count0 (Todd Alexander)     ", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Lead Tester :", 0, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Darkstar (Michael Fernie)", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Documentation & Testing :", 0, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "PaleoT (Travis Smith)     ", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Graphics Coordination :", 0, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "DangNabIt (Daniel Glover)    ", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Ephestion (Ephestion)", 1, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Manuals :", 0, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 12, LastY, picConvo.Width - 24, 14, bdFontSmallWhite, "Pat1 (Pat Roseinblume)", 1, True)
		LastY = LastY + PosY
		'PosY = ShowText(picConvo, 0, LastY + 10, picConvo.Width, 14, bdFontElixirWhite, "RuneSword on SourceForge : sourceforge.net-projects-runesword, True, True)
		'LastY = LastY + PosY
		LastY = picConvo.ClientRectangle.Height - 75
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontNoxiousWhite, "CrossCut Games : www.crosscutgames.com", True, True)
		LastY = picConvo.ClientRectangle.Height - 48
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 0, LastY, picConvo.Width, 14, bdFontSmallWhite, "RuneSword Community Forums : www.runesword.com", True, True)
		DialogSetButton(1, "Wait")
		ShowButton(picConvo, picConvo.Width - 6 - 96, picConvo.Height - 30, "Wait", False)
		'UPGRADE_ISSUE: PictureBox property picConvoBottom.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property picConvo.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picConvo.hdc, 0, picConvo.Height - 6, picConvo.Width, 6, picConvoBottom.hdc, 0, 0, SRCCOPY)
		picConvo.Top = Greatest((picBox.ClientRectangle.Height - picConvo.ClientRectangle.Height) / 2, 0)
		picConvo.Refresh()
		picConvo.Visible = True
		picConvo.BringToFront()
		picConvo.Focus()
	End Sub
	
	Private Sub GameEndAll()
		Dim modRegistry As Object
		Dim oFileSys As Object
		Dim ConvoAction As Object
		Dim DialogSetButton As Object
		Dim UberWizMaps As Object
		Dim Worlds As Object
		Dim oGameMusic As Object
		Dim OptionsSave As Object
		Dim rc As Integer
		Call OptionsSave()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		'MediaPlayerMusic.Stop
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.StopPlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oGameMusic.StopPlay()
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.mciClose. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call oGameMusic.mciClose(True)
		'    rc = mciSendString("close songnow", 0&, 0, 0)
		picMainMenu.Visible = False
		' Free memory
		'UPGRADE_NOTE: Object Worlds may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		Worlds = Nothing
		'UPGRADE_NOTE: Object WorldNow may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		WorldNow = Nothing
		'UPGRADE_NOTE: Object Tome may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		Tome = Nothing
		'UPGRADE_NOTE: Object UberWizMaps may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		UberWizMaps = Nothing
		'If (Val(GlobalCredits) = 1) Then
		DialogCredits()
		Me.Refresh()
		'Allow click to close
		DialogSetButton(1, "Done")
		ShowButton(picConvo, picConvo.Width - 6 - 96, picConvo.Height - 30, "Done", False)
		picConvo.Visible = True
		picConvo.BringToFront()
		picConvo.Focus()
		picConvo.Refresh()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ConvoAction = -1
		'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Do Until ConvoAction > -1
			System.Windows.Forms.Application.DoEvents()
		Loop 
		ChangeScreenSettings(GlobalScreenX, GlobalScreenY, GlobalScreenColor)
		'End If
		'[borf] prevents PlaySoundFile error during about DoEvents
		'UPGRADE_NOTE: Object oFileSys may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		oFileSys = Nothing
		'UPGRADE_WARNING: Couldn't resolve default property of object modRegistry.UnHookMouseWheel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		modRegistry.UnHookMouseWheel()
		Me.Close()
	End Sub
	
	Private Sub TomeDo(ByRef Action As Short)
		Dim bdTomeOptions As Object
		Dim bdTomeNew As Object
		Dim CreatePCKingdom As Object
		Dim CreatePCLoadMap As Object
		Dim CreatePCReturn As Object
		Dim TomeList As Object
		Dim TomeWizardSize As Object
		Dim TomeWizardStory As Object
		Dim TomeWizardLevel As Object
		Dim TomeWizardParty As Object
		Dim TomeListTop As Object
		Dim ScrollTop As Object
		Dim bdTomeSaveAs As Object
		Dim TomeAction As Object
		Dim bdTomeSaves As Object
		Dim Frozen As Object
		Dim TomeMenu As Object
		Dim c As Short
		Dim rc As Integer
		' [Titi 2.6.0] click sound for worlds and options
		If Action = 7 Or Action = 3 Then
			'UPGRADE_WARNING: Untranslated statement in TomeDo. Please check source code.
		Else
			'UPGRADE_WARNING: Untranslated statement in TomeDo. Please check source code.
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeOptions. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeMenu = bdTomeOptions Then
			Select Case Action
				Case 0 ' Resume
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeMenu = bdNone
					picMainMenu.Visible = False
					picMap.Focus()
					'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Frozen = False
				Case 1 ' Saved Tomes
					TomeSavesLoad()
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaves. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeAction = bdTomeSaves
					TomeSavesList(1)
				Case 2 ' Save a new Tome
					TomeSavesLoad()
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaveAs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeAction = bdTomeSaveAs
					TomeSavesList(0)
				Case 3 ' Options
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollTop = 1
					OptionsShow(1)
				Case 4 ' Main Menu
					GameEnd(True)
			End Select
		Else
			Select Case Action
				Case 0 ' New Tome
					' Get Tome Listing
					TomeLoad()
					bFromMainMenu = False
					'                ' Reset Tome Apprentice
					'                TomeWizardParty = 2
					'                TomeWizardLevel = 0
					'                TomeWizardStory = 0
					'                TomeWizardSize = 1
					' List Tomes
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeListTop = 1
					TomeNewList(1)
				Case 1 ' Saved Tomes
					TomeSavesLoad()
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaves. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeAction = bdTomeSaves
					TomeSavesList(1)
				Case 2 ' Random Tome
					bFromMainMenu = False
					' Reset Tome Apprentice
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeWizardParty = 2
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeWizardLevel = 0
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardStory. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeWizardStory = 0
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeWizardSize = 1
					TomeList = New Collection
					c = 0
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					RandomTome(TomeList, c)
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeListTop = 1
					TomeNewList(1)
					'            Case 2  ' Characters
					'                CreatePCReturn = False
					'                CreatePCLoadMap WorldNow
					'                CreatePCKingdom 1
					'                CreatePCKingdom worldindex
				Case 3 ' Options
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollTop = 1
					bFromMainMenu = False
					OptionsShow(1)
				Case 4 ' Quit
					GameEndAll()
				Case 5 ' New Characters
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatePCReturn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatePCReturn = False
					CreatePCLoadMap(WorldNow)
					CreatePCKingdom(1)
				Case 6 ' Show Roster
					bFromMainMenu = True
					TomeLoadRoster()
					TomeGatherList()
					picTomeNew.Visible = True
				Case 7 ' 5, 6 ' [Titi 2.4.9b] Change world from the main menu
					'                WorldIndex = WorldIndex + IIf(Action = 5, 1, -1)
					'                If WorldIndex > Worlds.Count Then WorldIndex = 1
					'                If WorldIndex < 1 Then WorldIndex = Worlds.Count
					bFromMainMenu = True
					OptionsShow(16)
					'WorldNow.IsCurrent = False
					'Set WorldNow = Worlds(WorldIndex)
					'WorldNow.IsCurrent = True
					'Call PlayMusic(WorldNow.IntroMusic, frmMain, WorldNow.MusicFolder)
				Case 8 ' back to main menu
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeMenu = bdTomeNew
			End Select
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub TomeSavesLoad()
		Dim ScrollTop As Object
		Dim CreateNameNew As Object
		Dim Tome_Renamed As Object
		Dim TomeSavePos As Object
		Dim ScrollList As Object
		' Go to the /world directory and find all subdirectories that are "save*"
		Dim c As Short
		Dim tmpFullPath As String
		Dim FileName As String
		Dim TomeX As Tome
		Dim FactoidX As Factoid
		Dim iNbLines As Short
		' Start new listing of Tomes on disk
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		' Get list of directories where Tomes could be
		ScrollList = New Collection
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeSavePos = 1
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(gAppPath & "\world\" & WorldNow.Name & "\save*", FileAttribute.Directory)
		Do Until FileName = ""
			If FileName <> "." And FileName <> ".." Then
				TomeX = New Tome
				TomeX.FullPath = gAppPath & "\world\" & WorldNow.Name & "\" & FileName
				' Increment the available slot (if can)
				If IsNumeric(Mid(FileName, 5)) = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CShort(Mid(FileName, 5)) >= TomeSavePos Then
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeSavePos = CShort(Mid(FileName, 5)) + 1
					End If
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add(Item:=TomeX)
			End If
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir()
		Loop 
		' Now go find Tomes in those directories
		iNbLines = 0
		For	Each TomeX In ScrollList
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(TomeX.FullPath & "\*.tom")
			iNbLines = iNbLines + 1
			If FileName <> "" Then
				tmpFullPath = TomeX.FullPath
				c = FreeFile
				FileOpen(c, TomeX.FullPath & "\" & FileName, OpenMode.Binary)
				TomeX.ReadFromFileHeader(c)
				FileClose(c)
				TomeX.FullPath = tmpFullPath ' [Titi 2.6.4] correct the path (case of saved games sent by e-mail for example)
				TomeX.FileName = tmpFullPath & "\" & FileName
			Else ' [Titi 2.6.1] let's try to get rid of the empty folders of the list of saved games
				RmDir(TomeX.FullPath)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Remove(iNbLines)
			End If
		Next TomeX
		' [Titi 2.6.0] Now duplicate saves names (same trick as for new tomes)
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Dim fp, rc As Short
		Dim SaveName As String
		If ScrollList.Count > 0 Then
			c = 1
			Do 
				' Load Save Name
				fp = FreeFile
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileOpen(fp, ScrollList(c).FullPath & "\name.dat", OpenMode.Binary)
				'UPGRADE_WARNING: Get was upgraded to FileGet and has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileGet(fp, rc)
				SaveName = Space(rc + 2)
				'UPGRADE_WARNING: Get was upgraded to FileGet and has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileGet(fp, SaveName)
				FileClose(fp)
				iNbLines = Int(Len(SaveName) / 24) + CShort(Len(SaveName) = 24) ' 23 characters per line, including "Save nn"
				Do 
					If iNbLines = 0 Then Exit Do ' no extra lines needed
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollList.Add(Item:=ScrollList(c), Before:=c)
					iNbLines = iNbLines - 1
					c = c + 1
				Loop Until iNbLines = 0
				c = c + 1
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Loop Until c > ScrollList.Count
		End If
		' Set default save name
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreateNameNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreateNameNew = Tome.Name & " Save " & TomeSavePos
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollTop = 1
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Private Sub TomeSavesDelete()
		Dim ConvoAction As Object
		Dim Folder As Object
		Dim File As Object
		Dim oFileSys As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim ScrollList As Object
		Dim ClipPath As Object
		Dim ScrollSelect As Object
		Dim sMsg As String
		' [Titi 2.4.9b]
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ScrollSelect = -1 Then Exit Sub
		Dim fp, iNbLines As Short
		Dim rc As Integer
		Dim SaveName As String
		' Load Save Name
		fp = FreeFile
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ClipPath(ScrollList(ScrollSelect).FileName). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		FileOpen(fp, ClipPath(ScrollList(ScrollSelect).FileName) & "\name.dat", OpenMode.Binary)
		'UPGRADE_WARNING: Get was upgraded to FileGet and has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileGet(fp, rc)
		SaveName = Space(rc)
		'UPGRADE_WARNING: Get was upgraded to FileGet and has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileGet(fp, SaveName)
		FileClose(fp)
		' [Titi 2.6.0] tomes with long names have as many places as lines needed for display
		iNbLines = Int(Len(SaveName) / 24) + CShort(Len(SaveName) = 24) ' 24 characters per line
		DialogSetUp(bdDlgNoReply)
		DialogSetButton(1, "No")
		DialogSetButton(2, "Yes")
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DialogShow("DM", "Do you really wish to delete " & ScrollList(ScrollSelect).Name & "?")
		picConvo.Visible = False
		' If Yes then Remove the Directory and Relist Saves
		'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ConvoAction = 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Delete. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If oFileSys.Delete(ClipPath(ScrollList(ScrollSelect).FileName), Folder, True) Then
				sMsg = "Save deleted."
				Do 
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollList.Remove(ScrollSelect) ' [Titi 2.5.0] moved
					iNbLines = iNbLines - 1
				Loop Until iNbLines = -1
			Else
				' [Titi 2.6.1] check if maybe the save was not removed after all!
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If oFileSys.CheckExists(ScrollList(ScrollSelect).FileName, File, False) = False Then
					' yep, saved game already deleted
					sMsg = "Save deleted, but not directory."
					Do 
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ScrollList.Remove(ScrollSelect) ' [Titi 2.5.0] moved
						iNbLines = iNbLines - 1
					Loop Until iNbLines = -1
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ClipPath(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sMsg = "Failed to remove folder: " & ClipPath(ScrollList(ScrollSelect).FileName)
				End If
			End If
			DialogSetUp(bdDlgNoReply)
			DialogShow("DM", sMsg)
			picConvo.Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeSavesList(Least(ScrollSelect, ScrollList.Count))
		End If
	End Sub
	
	Private Sub InitLockedInTome()
		Dim ScrollList As Object
		Dim TomeRoster As Object
		Dim CreatureX, CreatureY As Creature
		Dim TomeX As Tome
		Dim c, i As Short
		Dim FileName As String
		Dim strTome As Object
		'    On Error GoTo ErrorHandler
		If OnAdventureList(0) <> vbNullString Then
			Exit Sub
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ReDim Preserve OnAdventureListMaster(TomeRoster.Count)
		End If
		TomeSavesLoad() ' initialize list of saved games
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		For	Each strTome In ScrollList
			' Read the Tome file
			c = FreeFile
			TomeX = New Tome
			'UPGRADE_WARNING: Couldn't resolve default property of object strTome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileOpen(c, strTome.FileName, OpenMode.Binary)
			TomeX.ReadFromFile(c)
			FileClose(c)
			i = -1 ' reset counter
			' check if character is in tome
			For	Each CreatureY In TomeRoster
				i = i + 1
				If CreatureY.OnAdventure = True And (OnAdventureList(i) = vbNullString Or OnAdventureList(i) = "deleted savegame!") Then
					OnAdventureList(i) = "deleted savegame!"
					' compare against the party members
					For	Each CreatureX In TomeX.Creatures
						If CreatureX.Name = CreatureY.Name Then
							OnAdventureList(i) = TomeX.Name
							Exit For
						End If
					Next CreatureX
					OnAdventureListMaster(i) = OnAdventureList(i)
				End If
			Next CreatureY
		Next strTome
		If OnAdventureList(0) = vbNullString Then
			OnAdventureList(0) = "InitLockedInTome completed."
			OnAdventureListMaster(0) = "InitLockedInTome completed."
		End If
		Exit Sub
ErrorHandler: 
		'    If Err.Number = 9 Then
		'        ReDim Preserve OnAdventureList(i + 1)
		'        Resume
		'    End If
	End Sub
	
	Private Sub UnlockFromTome(ByRef strName As String, ByRef Index As Short)
		Dim ScrollList As Object
		Dim CreatureX As Creature
		Dim TomeX, TomeZ As Tome
		Dim i, c As Short
		Dim FileName As String
		Dim strTome As Object
		TomeSavesLoad() ' initialize list of saved games
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		i = 0
		For	Each strTome In ScrollList
			' Read the Tome file
			c = FreeFile
			TomeX = New Tome
			'UPGRADE_WARNING: Couldn't resolve default property of object strTome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileOpen(c, strTome.FileName, OpenMode.Binary)
			TomeX.ReadFromFile(c)
			FileClose(c)
			' check if character is in tome
			If OnAdventureList(Index) = TomeX.Name Then
				For	Each CreatureX In TomeX.Creatures
					If CreatureX.Name = strName Then
						i = i + 1 ' count how many saves of the same tome exist!
						ReleaseCharacter(CreatureX)
						' also, remove it from the tome!
						TomeX.RemoveCreature("X" & CreatureX.Index)
						c = FreeFile
						'UPGRADE_WARNING: Couldn't resolve default property of object strTome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						FileOpen(c, strTome.FileName, OpenMode.Binary)
						TomeX.SaveToFile(c)
						FileClose(c)
						i = i - 1
						' same for the \Worlds working version
						If i < 0 Then ' all saved games processed, we can now take care of the working version in \Worlds
							TomeZ = New Tome
							'UPGRADE_WARNING: Couldn't resolve default property of object strTome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							FileOpen(c, gAppPath & "\World\" & WorldNow.Name & Mid(strTome.FileName, InStrRev(strTome.FileName, "\")), OpenMode.Binary)
							TomeZ.ReadFromFile(c)
							FileClose(c)
							TomeZ.RemoveCreature("X" & CreatureX.Index)
							c = FreeFile
							'UPGRADE_WARNING: Couldn't resolve default property of object strTome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							FileOpen(c, gAppPath & "\World\" & WorldNow.Name & Mid(strTome.FileName, InStrRev(strTome.FileName, "\")), OpenMode.Binary)
							TomeZ.SaveToFile(c)
							FileClose(c)
						End If
						Exit For
					End If
				Next CreatureX
			End If
		Next strTome
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Private Sub ReleaseCharacter(ByRef CreatureX As Creature)
		Dim FileName As String
		Dim c As Short
		CreatureX.OnAdventure = False
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc")
		If FileName <> "" Then
			FileName = gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc"
			Kill(FileName)
		Else
			FileName = gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc"
		End If
		c = FreeFile
		FileOpen(c, FileName, OpenMode.Binary)
		CreatureX.SaveToFile(c)
		FileClose(c)
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub TomeSavesList(ByRef Index As Short)
		Dim bdTomeSaveAs As Object
		Dim CreatePCNameEnter As Object
		Dim File As Object
		Dim oFileSys As Object
		Dim bdFontElixirGold As Object
		Dim TomeSavePathName As Object
		Dim CreateNameNew As Object
		Dim bdFontElixirBlack As Object
		Dim ClipPath As Object
		Dim ScrollList As Object
		Dim ScrollTop As Object
		Dim ScrollSelect As Object
		Dim bdTomeSaves As Object
		Dim TomeAction As Object
		Dim bdFontNoxiousBlack As Object
		Dim Tome_Renamed As Object
		Dim bdFontElixirWhite As Object
		Dim fp, c, n, i As Short
		Dim rc As Integer
		Dim SaveName As String
		Dim iNbLines As Short
		' Set up picTmp to hold screen shot
		'UPGRADE_ISSUE: PictureBox method picTmp.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTmp.Cls() : picTmp.Width = 220 : picTmp.Height = 165
		'UPGRADE_ISSUE: PictureBox method picTomeNew.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTomeNew.Cls()
		' Set header correctly
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaves. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeAction = bdTomeSaves Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 30, 12, 519, 14, bdFontElixirWhite, "Choose a Saved Tome to Play", True, False)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 19, 45, 273, 14, bdFontElixirWhite, "Available Saves", True, False)
			picCreateName.Visible = False
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 30, 12, 519, 14, bdFontElixirWhite, "Save Game " & Tome.Name, True, False)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 19, 45, 273, 14, bdFontElixirWhite, "Current Saves", True, False)
			picCreateName.Visible = True
			If Index = 0 Then
				' Display an image of the Map
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = SetStretchBltMode(picTomeNew.hdc, 3)
				'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = StretchBlt(picTomeNew.hdc, 327, 83, 220, 165, picMap.hdc, 0, 0, picBox.Width, picBox.Height, SRCCOPY)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 324, 260, 230, 18, bdFontNoxiousBlack, VB6.Format(Now, "ddd mmm dd yyyy hh:mm AM/PM"), True, False)
			End If
		End If
		' List saved Tomes
		n = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollSelect = -1 '0 [Titi 2.4.9b] grey "Delete" and "Replace" out if nothing selected
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = ScrollTop To Least(ScrollTop + 11, ScrollList.Count)
			' Load Save Name
			fp = FreeFile
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ClipPath(ScrollList(c).FileName). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileOpen(fp, ClipPath(ScrollList(c).FileName) & "\name.dat", OpenMode.Binary)
			'UPGRADE_WARNING: Get was upgraded to FileGet and has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileGet(fp, rc)
			SaveName = ""
			For i = 1 To rc
				SaveName = SaveName & " "
			Next i
			'UPGRADE_WARNING: Get was upgraded to FileGet and has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileGet(fp, SaveName)
			FileClose(fp)
			' [Titi 2.6.0] tomes with long names have as many places as lines needed for display
			iNbLines = Int(Len(SaveName) / 24) + CShort(Len(SaveName) = 24) ' 24 characters per line
			If IsBetween(c, Index - iNbLines, Index) Then
				'If c = Index Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaves. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeAction = bdTomeSaves Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 332, 48, 217, 15, bdFontElixirBlack, ScrollList(c).Name, True, True) 'False
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object CreateNameNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreateNameNew = SaveName
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ClipPath(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePathName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeSavePathName = ClipPath(ScrollList(c).FileName)
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 24, 68 + n * 22, 245, 22 * (1 + iNbLines), bdFontElixirGold, SaveName, True, True) 'False
				' Show Screen Shot
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ClipPath(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If oFileSys.CheckExists(ClipPath(ScrollList(c).FileName) & "\screen.bmp", File) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ClipPath(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					picTmp.Image = System.Drawing.Image.FromFile(ClipPath(ScrollList(c).FileName) & "\screen.bmp")
				Else
					picTmp.Image = System.Drawing.Image.FromFile(gDataPath & "\Stock\NoSuchFile.bmp")
				End If
				'UPGRADE_ISSUE: PictureBox property picTmp.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, 327, 83, 220, 165, picTmp.hdc, 0, 0, SRCCOPY)
				' Show Date/Time Saved
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 324, 260, 230, 18, bdFontNoxiousBlack, VB6.Format(FileDateTime(ScrollList(c).FileName), "ddd mmm dd yyyy hh:mm AM/PM"), True, True) 'False
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollSelect = Index
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 24, 68 + n * 22, 245, 22 * (1 + iNbLines), bdFontElixirWhite, SaveName, True, True) 'False
			End If
			n = n + 1 + iNbLines
			c = c + iNbLines ' [Titi 2.6.0] skip the duplicated saves
		Next c
		' Set up buttons
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
		ScrollBarShow(picTomeNew, 276, 62, 267, ScrollTop, ScrollList.Count - 11, 0)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaves. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeAction = bdTomeSaves Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowButton(picTomeNew, 112, 331, "Delete", False, (ScrollSelect = -1))
			ShowButton(picTomeNew, 380, 364, "Cancel", False)
			ShowButton(picTomeNew, 476, 364, "Play", False)
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowButton(picTomeNew, 112, 331, "Delete", False, (ScrollSelect = -1))
			ShowButton(picTomeNew, 284, 364, "Cancel", False)
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowButton(picTomeNew, 380, 364, "Replace", False, (ScrollSelect = -1))
			ShowButton(picTomeNew, 476, 364, "Save", False)
		End If
		' Refresh the screen
		picTomeNew.Top = (Me.ClientRectangle.Height - picTomeNew.ClientRectangle.Height) / 2
		picTomeNew.Left = (Me.ClientRectangle.Width - picTomeNew.ClientRectangle.Width) / 2
		picTomeNew.Refresh()
		picTomeNew.BringToFront()
		picTomeNew.Visible = True
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaveAs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeAction = bdTomeSaveAs Then
			CreatePCNameEnter(0)
		End If
	End Sub
	
	Private Sub TomeNewList(ByRef Index As Short)
		Dim bdTomeMenu As Object
		Dim TomeMenu As Object
		Dim TomeAction As Object
		Dim bdTomeNew As Object
		Dim BuildMessage As Object
		Dim TomeWizardSize As Object
		Dim UberWizMaps As Object
		Dim TomeWizardLevel As Object
		Dim TomeWizardParty As Object
		Dim bdFontNoxiousBlack As Object
		Dim bdFontElixirBlack As Object
		Dim TomeListTop As Object
		Dim bdFontElixirGold As Object
		Dim TomeList As Object
		Dim bdFontElixirWhite As Object
		Dim TomeIndex As Object
		Dim n, c, i As Short
		Dim rc As Integer
		Dim TomeX As Tome
		Dim FileName As String
		Dim iNbLines As Short ' [Titi 2.6.0] keeps track of the number of lines used for displaying the tomes names, wrapping included
		'    TomeAction = bdTomeNew
		'UPGRADE_ISSUE: PictureBox method picTomeNew.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTomeNew.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeIndex = Index
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 30, 12, 519, 14, bdFontElixirWhite, "Choose a Tome to Play", True, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 19, 45, 273, 14, bdFontElixirWhite, "Available Tomes", True, False)
		n = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 1 To TomeList.Count
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, TomeListTop, Least(TomeListTop + 11, TomeList.Count)) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				iNbLines = Int(Len(TomeList(c).Name) / 25) + CShort(Len(TomeList(c).Name) = 25) ' 25 characters per line
				' [Titi 2.6.0] tomes with long names have as many places as lines needed for display
				If IsBetween(c, Index - iNbLines, Index) Then
					'            If c = Index Then
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 24, 68 + n * 22, 245, 22 * (1 + iNbLines), bdFontElixirGold, TomeList(c).Name, True, True) 'False
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 24, 68 + n * 22, 245, 22 * (1 + iNbLines), bdFontElixirWhite, TomeList(c).Name, True, True) 'False
				End If
				n = n + 1 + iNbLines
				c = c + iNbLines ' [Titi 2.6.0] skip the duplicated tomes
			End If
			' [Titi 2.6.0] tomes with long names have as many places as lines needed for display
			If IsBetween(c, Index, Index + iNbLines) Then
				'If c = Index Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 332, 48, 217, 15, bdFontElixirBlack, TomeList(c).Name, True, False)
				'            If c = 1 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c = 1 And TomeMenu = bdTomeMenu And TomeAction = 2 Then
					' Special stuff for Tome Wizard
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 80, 215, 14, bdFontElixirBlack, "Party Size", True, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 98, 215, 14, bdFontNoxiousBlack, "Solo     2-3     4-6     7-9", True, False)
					For i = 0 To 3
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If TomeWizardParty = i Then
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 347 + i * 55, 114, 18, 18, picMisc.hdc, 18, 18, SRCCOPY)
						Else
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 347 + i * 55, 114, 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
						End If
					Next i
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 146, 215, 14, bdFontElixirBlack, "Experience Level", True, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 332, 164, 215, 14, bdFontNoxiousBlack, "1-3     4-6     7-10     10+", True, False)
					For i = 0 To 3
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If TomeWizardLevel = i Then
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 347 + i * 55, 180, 18, 18, picMisc.hdc, 18, 18, SRCCOPY)
						Else
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 347 + i * 55, 180, 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
						End If
					Next i
					' Show Story Listing
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 212, 215, 14, bdFontElixirBlack, "Story", True, False)
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTomeNew.hdc, 328, 230, 86, 18, picMisc.hdc, 0, 0, SRCCOPY)
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTomeNew.hdc, 414, 230, 82, 18, picMisc.hdc, 4, 0, SRCCOPY)
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTomeNew.hdc, 496, 230, 50, 18, picMisc.hdc, 40, 0, SRCCOPY)
					'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MainMapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If UberWizMaps.MainMapIndex < 1 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 328, 233, 220, 14, bdFontElixirWhite, "Random", True, False)
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MainMapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MapSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 328, 233, 220, 14, bdFontElixirWhite, UberWizMaps.MapSketchs(UberWizMaps.MainMapIndex).MapName, True, False)
					End If
					' Show Size
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 260, 215, 14, bdFontElixirBlack, "Tome Size", True, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 320, 278, 240, 14, bdFontNoxiousBlack, "Small   Medium   Large   Huge", True, False)
					For i = 0 To 3
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If TomeWizardSize = i Then
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 338 + i * 61, 294, 18, 18, picMisc.hdc, 18, 18, SRCCOPY)
						Else
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 338 + i * 61, 294, 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
						End If
					Next i
					' Show Build Message
					'UPGRADE_WARNING: Couldn't resolve default property of object BuildMessage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 328, 220, 14, bdFontNoxiousBlack, BuildMessage, True, False)
				Else
					' Show Tome comments (if applicable)
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Comments. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Len(TomeList(c).Comments) > 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Comments. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 328, 84, 215, 227, bdFontNoxiousBlack, TomeList(c).Comments, False, False)
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 328, 84, 215, 227, bdFontNoxiousBlack, "No comments available for this Tome.", False, False)
					End If
					' Show Reset check box (if applicable)
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(c).OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(c).IsInPlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(c).IsPersistent. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If TomeList(c).IsPersistent = False And TomeList(c).IsInPlay = True And TomeList(c).OnAdventure = True Then ' [Titi 2.6.1]
						'If TomeList(c).IsInPlay = True And TomeList(c).OnAdventure = True Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 358, 328, 220, 18, bdFontNoxiousBlack, "Reset the Tome?", False, False)
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(c).IsReset. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If TomeList(c).IsReset = True Then
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 500, 325, 18, 18, picMisc.hdc, 18, 18, SRCCOPY)
						Else
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 500, 325, 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
						End If
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeAction = bdTomeNew '[Titi 2.6.0]
				End If
			End If
		Next c
		' Set up buttons
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
		ScrollBarShow(picTomeNew, 276, 62, 267, TomeListTop, TomeList.Count - 11, 0)
		ShowButton(picTomeNew, 62, 331, "Delete", False)
		ShowButton(picTomeNew, 158, 331, "Info", False)
		ShowButton(picTomeNew, 380, 364, "Cancel", False)
		ShowButton(picTomeNew, 476, 364, "Play", False)
		' Refresh the screen
		picTomeNew.Top = (Me.ClientRectangle.Height - picTomeNew.ClientRectangle.Height) / 2
		picTomeNew.Left = (Me.ClientRectangle.Width - picTomeNew.ClientRectangle.Width) / 2
		picTomeNew.Refresh()
		picTomeNew.BringToFront()
		picTomeNew.Visible = True
	End Sub
	
	Private Function TomeGatherCheck() As Short
		Dim CreatureX As Creature
		'Checks to see if there's at least one non-DM Controlled character in the Party.
		TomeGatherCheck = False
		For	Each CreatureX In Tome.Creatures
			If CreatureX.DMControlled = False Then
				TomeGatherCheck = True
				Exit For
			End If
		Next CreatureX
	End Function
	
	'Private Sub TomeGatherList()
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub TomeGatherList()
		Dim bdFontNoxiousWhite As Object
		Dim bdFontSmallWhite As Object
		Dim bdFaceSelect As Object
		Dim bdFaceMin As Object
		Dim bdFaceScroll As Object
		Dim Tome_Renamed As Object
		Dim bdFontNoxiousBlack As Object
		Dim CreatureNow As Object
		Dim TomeRosterSelect As Object
		Dim TomeRosterTop As Object
		Dim bdFontElixirBlack As Object
		Dim bdFontElixirWhite As Object
		Dim TomeAction As Object
		Dim bdTomeGather As Object
		Dim TomeRoster As Object
		Dim rc As Integer
		Dim i, X, c, Y, n As Short
		Dim CreatureX As Creature
		Dim TriggerX As Trigger
		Dim sTriggerList() As String
		Dim ItemX As Item
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ReDim Preserve OnAdventureList(TomeRoster.Count)
		InitLockedInTome()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeGather. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeAction = bdTomeGather
		'UPGRADE_ISSUE: PictureBox method picTomeNew.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTomeNew.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 30, 12, 519, 14, bdFontElixirWhite, IIf(bFromMainMenu, "Roster for " & WorldNow.Name, "Gather your Party"), True, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 19, 45, 273, 14, bdFontElixirWhite, "Available Characters", True, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 332, 48, 217, 15, bdFontElixirBlack, IIf(bFromMainMenu, "Character details", "Chosen Characters"), True, False)
		' [Titi 2.6.0] special display if reached from Characters menu
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If bFromMainMenu And TomeRoster.Count > 0 Then
			'ShowText picTomeNew, 328, 80, 220, 190, bdFontNoxiousBlack, "Clicking on a character picture at the left will display his skills, stats, and many other details", False, False
			' [Titi 2.4.9] display character's stats and equipment
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Not IsBetween(TomeRosterSelect, TomeRosterTop + c, TomeRosterTop + c + 3) Then TomeRosterSelect = TomeRosterTop + c
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureNow = TomeRoster(TomeRosterSelect + (TomeRosterSelect > TomeRoster.Count))
			If HiddenBonus = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ReDim sTriggerList(CreatureNow.Triggers.Count)
				sHint = "Equip." ' [Titi 2.6.0] Used global string to keep track of the button caption
				iItemTop = 1
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each TriggerX In CreatureNow.Triggers
					If TriggerX.IsSkill Or TriggerX.TriggerType = bdOnCast Or TriggerX.TriggerType = bdOnCastTarget Then
						n = n + 1
						sTriggerList(n) = TriggerX.Name & IIf(TriggerX.IsSkill, "", " (spell)")
						If IsBetween(n - iItemTop, 0, 16) Then
							'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ShowText(picTomeNew, 332, 74 + 14 * (n - iItemTop), 217, 15, bdFontNoxiousBlack, sTriggerList(n), False, False)
						End If
					End If
				Next TriggerX
				If n > 16 Then ' bottom of the list reached
					'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
					ScrollBarShow(picTomeNew, 549, 74, 248, iItemTop, n - 16, 0)
				End If
				If n = 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 332, 90, 217, 15, bdFontNoxiousBlack, "No skills!", True, False)
				End If
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ReDim sTriggerList(CreatureNow.Items.Count)
				sHint = "Skills"
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemX In CreatureNow.Items
					n = n + 1
					sTriggerList(n) = ItemX.Name & IIf(ItemX.IsReady, " (worn)", "")
					If IsBetween(n - iItemTop, 0, 16) Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 332, 74 + 14 * (n - iItemTop), 217, 15, bdFontNoxiousBlack, sTriggerList(n), False, False)
					End If
				Next ItemX
				If n > 16 Then ' bottom of the list reached
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
					ScrollBarShow(picTomeNew, 549, 74, 248, iItemTop, CreatureNow.Items.Count - 16, 0)
				End If
				If n = 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 332, 90, 217, 15, bdFontNoxiousBlack, "No equipment!", True, False)
				End If
			End If
			picTomeNew.Refresh()
		Else
			' Show available slots in the Tome
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.PartySize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Tome.PartySize = 0 Then
				'        Tome.PartySize = 5 [Titi 2.4.9b] 0 means solo
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.PartySize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.PartySize = 1
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.PartySize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For c = 1 To Least(Tome.PartySize, 9)
				X = 331 + ((c - 1) Mod 3) * 72
				Y = 79 + Int((c - 1) / 3) * 82
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceScroll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, X, Y, 66, 76, picFaces.hdc, bdFaceScroll, 0, SRCCOPY)
			Next c
			' Show Characters in the Tome (NPCs)
			c = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each CreatureX In Tome.Creatures
				LoadCreaturePic(CreatureX)
				c = c + 1
				X = 331 + ((c - 1) Mod 3) * 74
				Y = 79 + Int((c - 1) / 3) * 84
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, X - 4, Y - 4, 74, 84, picMisc.hdc, 0, 36, SRCCOPY)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, X, Y, 66, 76, picFaces.hdc, bdFaceMin + CreatureX.Pic * 66, 0, SRCCOPY)
			Next CreatureX
		End If
		' List available in Roster
		n = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeRosterSelect = Least(Greatest(TomeRosterSelect, 1), TomeRoster.Count)
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 0 To Least(2, TomeRoster.Count - TomeRosterTop)
			n = n + 1
			' Load and show picture
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			LoadCreaturePic(TomeRoster(TomeRosterTop + c))
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picTomeNew.hdc, 24, n * 86 - 17, 74, 84, picMisc.hdc, 0, 36, SRCCOPY)
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Pic. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picTomeNew.hdc, 28, n * 86 - 13, 66, 76, picFaces.hdc, bdFaceMin + TomeRoster(TomeRosterTop + c).Pic * 66, 0, SRCCOPY)
			' If selected, show box
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TomeRosterTop + c = TomeRosterSelect Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, 28, n * 86 - 13, 66, 76, picFaces.hdc, bdFaceSelect + 66, 0, SRCAND)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, 28, n * 86 - 13, 66, 76, picFaces.hdc, bdFaceSelect, 0, SRCPAINT)
			End If
			' If unavailable, grey out
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterTop + c).OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TomeRoster(TomeRosterTop + c).OnAdventure = True Then
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, 28, n * 86 - 13, 66, 76, picFaces.hdc, 66, 0, SRCAND)
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, 28, n * 86 - 13, 66, 76, picFaces.hdc, 0, 0, SRCPAINT)
				'            ShowText picTomeNew, 28, n * 86 + 50, 66, 76, bdFontSmallWhite, "In Tome", True, False
				'            ShowText picTomeNew, 22, n * 86 + 35, 76, 76, bdFontSmallWhite, "In " & LockedInTome(TomeRoster(TomeRosterTop + c).Name), True, False
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 22, n * 86 + 35, 76, 76, bdFontSmallWhite, "In " & OnAdventureList(TomeRosterTop + c - 1), True, False)
			End If
			' Show name and stats
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 102, n * 86 - 16, 166, 14, bdFontElixirWhite, TomeRoster(TomeRosterTop + c).Name, True, False)
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterTop + c).HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TomeRoster(TomeRosterTop + c).HPNow < 1 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 102, n * 86, 166, 14, bdFontNoxiousWhite, "Level " & TomeRoster(TomeRosterTop + c).Level & " * DEAD", True, False)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterTop + c).HPMax. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterTop + c).HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 102, n * 86, 166, 14, bdFontNoxiousWhite, "Level " & TomeRoster(TomeRosterTop + c).Level & " * " & TomeRoster(TomeRosterTop + c).HPNow & " of " & TomeRoster(TomeRosterTop + c).HPMax, True, False)
			End If
			If WorldNow.Runes = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterTop + c).EterniumMax. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Eternium. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 102, n * 86 + 16, 166, 14, bdFontNoxiousWhite, WorldNow.Magic & " * " & TomeRoster(TomeRosterTop + c).Eternium & " of " & TomeRoster(TomeRosterTop + c).EterniumMax, True, False)
			End If
			' [Titi 2.4.9b] No need to show the first three skills any more (right-click on the character's picture to get the full list), so replace them with XP and spell casting ability
			' Show 3 skills
			'i = 1
			'For Each TriggerX In TomeRoster(TomeRosterTop + c).Triggers
			'    If TriggerX.IsSkill = True Then
			'        ShowText picTomeNew, 102, n * 86 + i * 16, 166, 14, bdFontNoxiousWhite, TriggerX.Name, True, False
			'        i = i + 1
			'        If i > 3 Then
			'            Exit For
			'        End If
			'    End If
			'Next TriggerX
			'If i = 1 Then
			'    ShowText picTomeNew, 102, n * 86 + 16, 166, 14, bdFontNoxiousWhite, "No Skills", True, False
			'End If
			i = 1 - CShort(WorldNow.Runes)
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			X = TomeRoster(TomeRosterTop + c).Level
			rc = (X * Int(X / 2 + 0.5) + (X / 2) * (1 - (X Mod 2))) * 1000
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().ExperiencePoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 102, n * 86 + i * 16, 166, 14, bdFontNoxiousWhite, "Exp pts " & TomeRoster(TomeRosterTop + c).ExperiencePoints, True, False)
			i = i + 1
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 102, n * 86 + i * 16, 166, 14, bdFontNoxiousWhite, "Next lvl " & rc, True, False)
			i = i + 1
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().IsSpellCaster. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If i = 3 Then ShowText(picTomeNew, 102, n * 86 + i * 16, 166, 14, bdFontNoxiousWhite, IIf(TomeRoster(TomeRosterTop + c).IsSpellCaster, "Spellcaster", "Cannot cast spells"), True, False)
		Next c
		' Set up buttons
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
		ScrollBarShow(picTomeNew, 276, 62, 267, TomeRosterTop, TomeRoster.Count - 2, 0)
		' [Titi 2.4.6] If character is already adventuring, delete button shouldn't show
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeRoster.Count > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TomeRoster(TomeRosterSelect).OnAdventure = False Then
				ShowButton(picTomeNew, 62, 331, "Delete", False)
			Else
				'            ShowButton picTomeNew, 62, 331, "Delete", False, True
				' [Titi 2.4.9] propose to release the character instead
				ShowButton(picTomeNew, 62, 331, "Release", False)
			End If
		Else
			ShowButton(picTomeNew, 62, 331, "Delete", False, True)
		End If
		ShowButton(picTomeNew, 158, 331, "Create", False)
		ShowButton(picTomeNew, 380, 364, "Cancel", False)
		ShowButton(picTomeNew, 476, 364, IIf(bFromMainMenu, sHint, "Play"), False)
		' Refresh the screen
		picTomeNew.Refresh()
		picTomeNew.BringToFront()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Private Sub TomeNewBuild()
		Dim TomeIndex As Object
		Dim TomeList As Object
		Dim Folder As Object
		Dim oFileSys As Object
		Dim DialogDM As Object
		Dim UberWizMaps As Object
		Dim TomeWizardSize As Object
		Dim TomeWizardLevel As Object
		Dim TomeWizardParty As Object
		Dim BuildMessage As Object
		Dim UberWiz As UberWizard
		Dim FileName As String
		Dim k, c, i, j As Short
		Dim Found As Short
		Dim MapSketchX As MapSketch
		Dim TomeX As Tome
		Dim AreaX As Area
		Dim MapX As Map
		Dim TomeZ As Tome
		Dim TomeSketchX As TomeSketch
		Dim CreatureX As Creature
		Dim TriggerX As Trigger
		Dim JournalX As Journal
		Dim FactoidX As Factoid
		' Generate an UberWiz
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		'UPGRADE_WARNING: Couldn't resolve default property of object BuildMessage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		BuildMessage = "Scanning Library"
		TomeNewList(1)
		UberWiz = New UberWizard
		' Set Size, Party Level and Party Size
		' [Titi 2.4.9b] Set correct Party Size
		'UberWiz.TomePartySize = TomeWizardParty
		Select Case TomeWizardParty
			Case 0
				UberWiz.TomePartySize = 1
			Case 1
				UberWiz.TomePartySize = 2 + Int(Rnd() + 0.5) ' 2-3 characters
			Case 2
				UberWiz.TomePartySize = 4 + Int(Rnd() * 2 + 0.5) ' 4-6 characters
			Case 3
				UberWiz.TomePartySize = 7 + Int(Rnd() * 2 + 0.5) ' 7-9 characters
			Case Else
				UberWiz.TomePartySize = 10 + Int(Rnd() * 2 + 0.5) ' 10-12 characters
		End Select
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		UberWiz.TomePartyAvgLevel = TomeWizardLevel
		Select Case TomeWizardSize
			Case 0 ' Small / 8,000 Sq
				UberWiz.TotalSize = 10000 - Int(Rnd() * 4000)
			Case 1 ' Medium / 20,000 Sq
				UberWiz.TotalSize = 25000 - Int(Rnd() * 10000)
			Case 2 ' Large / 40,000 Sq
				UberWiz.TotalSize = 45000 - Int(Rnd() * 10000)
			Case 3 ' Huge / 60,000+
				UberWiz.TotalSize = 70000 - Int(Rnd() * 20000)
		End Select
		' Finish off UberWiz parts and pieces
		'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MainMapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If UberWizMaps.MainMapIndex > 0 Then
			modDungeonMaker.InitUberWizMaps(UberWiz)
			modDungeonMaker.InitUberWizThemes(UberWiz)
			modDungeonMaker.InitUberWizCreatures(UberWiz)
			modDungeonMaker.InitUberWizItems(UberWiz)
			'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MainMapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MapSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			modDungeonMaker.UberWizMainMap(UberWiz, UberWizMaps.MapSketchs(UberWizMaps.MainMapIndex).Index)
			modDungeonMaker.UberWizFinish(UberWiz, 2, False)
		Else
			modDungeonMaker.UberWizFinish(UberWiz, 0, False)
		End If
		' If no maps, then cannot continue
		If UberWiz.MapSketchs.Count() < 1 Then
			DialogDM("There are no maps available in the library.")
			'UPGRADE_WARNING: Couldn't resolve default property of object BuildMessage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			BuildMessage = "No Library Available"
			TomeNewList(1)
			'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
			Exit Sub
		End If
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		' Configure new Tome
		TomeX = New Tome
		TomeX.Name = UberWiz.TomeName
		TomeX.Comments = UberWiz.TomeComments
		TomeX.AreaIndex = UberWiz.AreaIndex
		TomeX.MapIndex = UberWiz.MapIndex
		TomeX.EntryIndex = UberWiz.EntryIndex
		'    TomeX.PartySize = 9 [Titi 2.4.9b] changed to selected party size!
		TomeX.PartySize = UberWiz.TomePartySize
		' Copy Tome Creatures, Triggers, Journals and Factoids (if have them)
		If UberWiz.MainMap.TomeIndex > 0 Then
			TomeSketchX = UberWiz.TomeSketchs.Item("T" & UberWiz.MainMap.TomeIndex)
			For	Each CreatureX In TomeSketchX.Creatures
				TomeX.AddCreature.Copy(CreatureX)
			Next CreatureX
			For	Each TriggerX In TomeSketchX.Triggers
				TomeX.AddTrigger.Copy(TriggerX)
			Next TriggerX
			For	Each JournalX In TomeSketchX.Journals
				TomeX.AddJournal.Copy(JournalX)
			Next JournalX
			For	Each FactoidX In TomeSketchX.Factoids
				TomeX.AddFactoid.Copy(FactoidX)
			Next FactoidX
		End If
		' Set up real average level based on selected average level
		Select Case UberWiz.TomePartyAvgLevel
			Case 0
				TomeX.PartyAvgLevel = 2
			Case 1
				TomeX.PartyAvgLevel = 5
			Case 2
				TomeX.PartyAvgLevel = 9
			Case 3
				TomeX.PartyAvgLevel = 12
		End Select
		UberWiz.MainMap.PartySize = UberWiz.TomePartySize
		UberWiz.MainMap.PartyAvgLevel = UberWiz.TomePartyAvgLevel
		' Make Maps
		modDungeonMaker.UberWizConnectMap(UberWiz, (UberWiz.MainMap), (UberWiz.TotalSize), 0, 0)
		modDungeonMaker.UberWizScatterQuests(UberWiz)
		AreaX = TomeX.AddArea
		For	Each MapSketchX In UberWiz.MapSketchs
			If MapSketchX.IsUsed = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object BuildMessage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				BuildMessage = "Making " & MapSketchX.MapName
				TomeNewList(1)
				modDungeonMaker.UberWizMakeMap(UberWiz, MapSketchX, AreaX)
			End If
		Next MapSketchX
		' Fill Maps
		For	Each MapX In AreaX.Plot.Maps
			'UPGRADE_WARNING: Couldn't resolve default property of object BuildMessage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			BuildMessage = "Filling " & MapX.Name
			TomeNewList(1)
			modDungeonMaker.FillMap(MapX)
		Next MapX
		' Save to a Folder
		'UPGRADE_WARNING: Couldn't resolve default property of object BuildMessage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		BuildMessage = "Saving Tome"
		TomeNewList(1)
		FileName = "TomeWizard" & VB6.Format(Today, "YYMMDD") & VB6.Format(TimeOfDay, "HHMMSS")
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeX.Areas().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeX.Areas.Item(1).FileName = FileName & "1.rsa"
		'TomeX.FullPath = gAppPath & "\tomes"
		TomeX.FullPath = gAppPath & "\tomes\" & WorldNow.Name & "\"
		TomeX.FileName = FileName & ".tom"
		' [Titi 2.4.9b] Check if the \world folder under the \tomes exists. If not, create it.
		'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		c = oFileSys.CheckExists(gAppPath & "\tomes\" & WorldNow.Name, Folder, True)
		c = FreeFile
		'Open gAppPath & "\tomes\" & FileName & ".tom" For Binary As c
		FileOpen(c, gAppPath & "\tomes\" & WorldNow.Name & "\" & FileName & ".tom", OpenMode.Binary)
		TomeX.SaveToFile(c)
		FileClose(c)
		c = FreeFile
		'Open gAppPath & "\tomes\" & FileName & "1.rsa" For Binary As c
		FileOpen(c, gAppPath & "\tomes\" & WorldNow.Name & "\" & FileName & "1.rsa", OpenMode.Binary)
		AreaX.Plot.SaveToFile(c)
		FileClose(c)
		' Add Tome to the List of Tomes
		i = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 1 To TomeList.Count
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(c).Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TomeList(c).Index >= i Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				i = TomeList(c).Index + 1
			End If
		Next c
		TomeX.Index = i
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeList.Add(Item:=TomeX, Key:="T" & TomeX.Index)
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeIndex = TomeList.Count
		'UPGRADE_WARNING: Couldn't resolve default property of object BuildMessage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		BuildMessage = ""
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Private Sub TomeSavesClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short)
		Dim ScrollTop As Object
		Dim TomeIndex As Object
		Dim ScrollList As Object
		Dim ScrollSelect As Object
		Dim bdTomeSaveAs As Object
		Dim bdTomeSaves As Object
		Dim TomeAction As Object
		Dim c As Short
		Dim rc As Integer
		Dim CreatureX As Creature
		If PointIn(AtX, AtY, 380, 364, 90, 18) Then
			' Cancel/Replace
			If ButtonDown Then
				Select Case TomeAction
					Case bdTomeSaves
						ShowButton(picTomeNew, 380, 364, "Cancel", True)
					Case bdTomeSaveAs
						' [Titi 2.4.9b]
						'    ShowButton picTomeNew, 380, 364, "Replace", True
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If ScrollSelect <> -1 Then ShowButton(picTomeNew, 380, 364, "Replace", True)
				End Select
				picTomeNew.Refresh()
			Else
				Select Case TomeAction
					Case bdTomeSaves
						ShowButton(picTomeNew, 380, 364, "Cancel", False)
						picTomeNew.Refresh()
						'UPGRADE_WARNING: Untranslated statement in TomeSavesClick. Please check source code.
						picCreateName.Visible = False
						picTomeNew.Visible = False
						If picMap.Visible = True Then
							picMap.Focus()
						End If
					Case bdTomeSaveAs
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowButton(picTomeNew, 380, 364, "Replace", False, (ScrollSelect = -1))
						picTomeNew.Refresh()
						'UPGRADE_WARNING: Untranslated statement in TomeSavesClick. Please check source code.
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If ScrollSelect > 0 Then
							TomeSave(False)
							picCreateName.Visible = False
							picTomeNew.Visible = False
						End If
				End Select
			End If
		ElseIf PointIn(AtX, AtY, 476, 364, 90, 18) Then 
			' Play
			If ButtonDown Then
				Select Case TomeAction
					Case bdTomeSaves
						ShowButton(picTomeNew, 476, 364, "Play", True)
					Case bdTomeSaveAs
						ShowButton(picTomeNew, 476, 364, "Save", True)
				End Select
				picTomeNew.Refresh()
			Else
				Select Case TomeAction
					Case bdTomeSaves
						ShowButton(picTomeNew, 476, 364, "Play", False)
						picTomeNew.Refresh()
						'UPGRADE_WARNING: Untranslated statement in TomeSavesClick. Please check source code.
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If ScrollSelect > 0 Then
							picTomeNew.Visible = False
							picMainMenu.Visible = False
							'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TomeRestore(ScrollList(ScrollSelect).FileName)
						End If
					Case bdTomeSaveAs
						ShowButton(picTomeNew, 476, 364, "Save", False)
						picTomeNew.Refresh()
						'UPGRADE_WARNING: Untranslated statement in TomeSavesClick. Please check source code.
						TomeSave(True)
						picCreateName.Visible = False
						picTomeNew.Visible = False
				End Select
			End If
		ElseIf PointIn(AtX, AtY, 284, 364, 90, 18) Then 
			' Cancel/Replace
			If ButtonDown Then
				Select Case TomeAction
					Case bdTomeSaves
					Case bdTomeSaveAs
						ShowButton(picTomeNew, 284, 364, "Cancel", True)
				End Select
				picTomeNew.Refresh()
			Else
				Select Case TomeAction
					Case bdTomeSaves
					Case bdTomeSaveAs
						'UPGRADE_WARNING: Untranslated statement in TomeSavesClick. Please check source code.
						ShowButton(picTomeNew, 284, 364, "Cancel", False)
						picTomeNew.Refresh()
						picCreateName.Visible = False
						picTomeNew.Visible = False
						If picMap.Visible = True Then
							picMap.Focus()
						End If
				End Select
			End If
		ElseIf PointIn(AtX, AtY, 276, 62, 18, 267) Then 
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
			If ScrollBarClick(AtX, AtY, ButtonDown, picTomeNew, 276, 62, 267, ScrollTop, ScrollList.Count, 11) = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeSavesList(TomeIndex)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 112, 331, 90, 18) And ScrollSelect > 0 Then 
			' Delete Save
			If ButtonDown Then
				ShowButton(picTomeNew, 112, 331, "Delete", True)
				picTomeNew.Refresh()
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowButton(picTomeNew, 112, 331, "Delete", False, (ScrollSelect = -1))
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in TomeSavesClick. Please check source code.
				TomeSavesDelete()
			End If
		ElseIf PointIn(AtX, AtY, 24, 68, 245, 266) And ButtonDown = False Then 
			' Saves Listed
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = CShort((AtY - 76) / 22) + ScrollTop
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, 1, ScrollList.Count) Then
				TomeSavesList(c)
				'UPGRADE_WARNING: Untranslated statement in TomeSavesClick. Please check source code.
			End If
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub TomeNewClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short, Optional ByRef btnRight As Boolean = False)
		Dim UberWizMaps As Object
		Dim TomeWizardSize As Object
		Dim TomeWizardLevel As Object
		Dim TomeWizardParty As Object
		Dim TomeRosterDragY As Object
		Dim TomeRosterDragX As Object
		Dim bdFaceMin As Object
		Dim frmMonsExplorerPlayer As Object
		Dim CreatePCKingdom As Object
		Dim CreatePCLoadMap As Object
		Dim CreatePCReturn As Object
		Dim DialogBrief As Object
		Dim ConvoAction As Object
		Dim DialogHide As Object
		Dim CreatePCDelete As Object
		Dim ScrollTop As Object
		Dim TomeListTop As Object
		Dim InstallPackage As Object
		Dim bdTomeSaveAs As Object
		Dim ScrollSelect As Object
		Dim ScrollList As Object
		Dim bdTomeSaves As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim BuildMessage As Object
		Dim bdTomeNew As Object
		Dim bdFontNoxiousBlack As Object
		Dim TomeRosterSelect As Object
		Dim bdCreatePCKingdom As Object
		Dim bdTomePackage As Object
		Dim bdTomeGather As Object
		Dim TomeAction As Object
		Dim bdCharacterMenu As Object
		Dim TomeMenu As Object
		Dim bdTomeMenu As Object
		Dim TomeIndex As Object
		Dim TomeRosterTop As Object
		Dim CreatureNow As Object
		Dim Tome_Renamed As Object
		Dim TomeRosterDrag As Object
		Dim TomeList As Object
		Dim TomeRoster As Object
		Dim c As Short
		Dim rc As Integer
		Dim strName As String
		Dim CreatureX As Creature
		Dim ItemX As Item
		Dim n As Short
		Dim TriggerX As Trigger
		Dim TomeName As String
		Dim sItemList() As String
		Dim iCount As Short
		If bFromMainMenu Then ' [Titi 2.6.0] Equip/Play should be inactive if nothing to show!
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			iCount = TomeRoster.Count
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			iCount = TomeList.Count
		End If
		' [Titi 2.6.0] if no tome in the list, nothing to do except cancel!
		If iCount = 0 And Not PointIn(AtX, AtY, 380, 364, 90, 18) Then Exit Sub
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeRosterDrag > 0 And ButtonDown = False Then
			' Dropping into the Tome
			If PointIn(AtX, AtY, 331, 79, 210, 240) Then
				c = Int((AtX - 331) / 72) + Int((AtY - 79) / 82) * 3 + 1
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c <= Tome.Creatures.Count Then
					' Replacing a Creature (check if required in Tome)
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Tome.Creatures(c).RequiredInTome = False Then
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeRoster.Remove(TomeRosterDrag)
						' [Titi 2.6.0] also delete the OnAdventure info
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						For n = TomeRosterDrag To TomeRoster.Count
							OnAdventureList(n) = OnAdventureList(n + 1)
						Next 
						CreatureX = New Creature
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureX.Copy(Tome.Creatures(c))
						TomeAddRoster(CreatureX)
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Tome.Creatures(c).Copy(CreatureNow)
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If TomeRosterTop + 2 > TomeRoster.Count Then
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TomeRosterTop = Greatest(1, TomeRoster.Count - 2)
						End If
						TomeGatherList()
						'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
						picTomeNew.Refresh()
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.PartySize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf c <= Tome.PartySize Then 
					' [Titi 2.4.9b] CreatureNow is not set for a newly created character
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Item. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureNow = TomeRoster.Item(TomeRosterDrag)
					' Adding a new character
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeRoster.Remove(TomeRosterDrag)
					' [Titi 2.6.0] also delete the OnAdventure info
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For n = TomeRosterDrag To TomeRoster.Count
						OnAdventureList(n - 1) = OnAdventureList(n)
					Next 
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.AppendCreature. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Tome.AppendCreature(CreatureNow)
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If TomeRosterTop + 2 > TomeRoster.Count Then
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeRosterTop = Greatest(1, TomeRoster.Count - 2)
					End If
					TomeGatherList()
					'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
					picTomeNew.Refresh()
				End If
			End If
			picInvDrag.Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeRosterDrag = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf TomeRosterDrag < 0 And ButtonDown = False Then 
			' Dropping back into the Roster
			If PointIn(AtX, AtY, 20, 63, 254, 266) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.Creatures.Remove(System.Math.Abs(TomeRosterDrag))
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeAddRoster(CreatureNow)
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
				TomeGatherList()
				picTomeNew.Refresh()
			End If
			picInvDrag.Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeRosterDrag = 0
		ElseIf PointIn(AtX, AtY, 380, 364, 90, 18) Then 
			' Cancel
			If ButtonDown Then
				ShowButton(picTomeNew, 380, 364, "Cancel", True)
				picTomeNew.Refresh()
			Else
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
				ShowButton(picTomeNew, 380, 364, "Cancel", False)
				picTomeNew.Refresh()
				' Remove characters from current tome
				'            If TomeAction = bdTomeGather Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdCharacterMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeGather. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeAction = bdTomeGather And TomeMenu <> bdCharacterMenu And iCount > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(TomeIndex).Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each CreatureX In TomeList(TomeIndex).Creatures
						If CreatureX.RequiredInTome = False Then
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().RemoveCreature. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TomeList(TomeIndex).RemoveCreature("X" & CreatureX.Index)
						End If
					Next CreatureX
					TomeNewList(1)
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeGather. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If TomeAction = bdTomeGather And iCount > 0 Then
						' [Titi 2.6.0] RT 91 if cancelling from the character's menu (as TomeNewList would not be set)
						'UPGRADE_WARNING: Couldn't resolve default property of object bdCharacterMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If TomeMenu = bdCharacterMenu Then
							picTomeNew.Visible = False
							picMainMenu_MouseMove(picMainMenu, New System.Windows.Forms.MouseEventArgs(0 * &H100000, 0, 0, 177, 0))
							picMainMenu.Visible = True
						Else
							'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TomeMenu = bdTomeMenu
							TomeNewList(1)
						End If
					Else
						picTomeNew.Visible = False
					End If
				End If
			End If
		ElseIf PointIn(AtX, AtY, 476, 364, 90, 18) Then 
			' Play
			If ButtonDown Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdCreatePCKingdom. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeAction <> bdCreatePCKingdom Then ' [Titi 2.6.0] if create character, button should read "Next"
					' ShowButton picTomeNew, 476, 364, "Play", True
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomePackage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowButton(picTomeNew, 476, 364, IIf(TomeAction = bdTomePackage, "Install", IIf(bFromMainMenu, sHint, "Play")), True, (iCount = 0))
					sHint = IIf(sHint = "Equip.", "Skills", "Equip.")
					picTomeNew.Refresh()
				Else ' [Titi 2.6.0] switch to create character
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If TomeMenu <> bdTomeMenu And TomeAction <> 2 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdCharacterMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeMenu = bdCharacterMenu
					End If
					ShowButton(picTomeNew, 476, 364, "Next", True)
					picTomeNew.Refresh()
				End If
			Else
				' ShowButton picTomeNew, 476, 364, "Play", False
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomePackage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowButton(picTomeNew, 476, 364, IIf(TomeAction = bdTomePackage, "Install", IIf(bFromMainMenu, sHint, "Play")), False, (iCount = 0))
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
				'            If bFromMainMenu And TomeRoster.Count > 0 Then
				If bFromMainMenu And iCount > 0 Then
					' clear the right half of the screen
					picMisc.Image = System.Drawing.Image.FromFile(gDataPath & "\Interface\" & GlobalInterfaceName & "\TomeMenu.bmp")
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTomeNew.hdc, 332, 72, 217, 248, picMisc.hdc, 332, 72, SRCCOPY)
					picMisc.Image = System.Drawing.Image.FromFile(gDataPath & "\Interface\" & GlobalInterfaceName & "\Misc.bmp")
					n = 0
					If TurnsBeforeNextCamp = 0 Then
						TurnsBeforeNextCamp = 1 ' used as to keep track of the list of info to display (toggle)
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ReDim sItemList(TomeRoster(TomeRosterSelect).Items.Count)
						iItemTop = 1
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						For	Each ItemX In TomeRoster(TomeRosterSelect).Items
							n = n + 1
							sItemList(n) = ItemX.Name & IIf(ItemX.IsReady, " (worn)", "")
							If IsBetween(n - iItemTop, 0, 16) Then
								'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								ShowText(picTomeNew, 332, 74 + 14 * (n - iItemTop), 217, 15, bdFontNoxiousBlack, sItemList(n), False, False)
							End If
						Next ItemX
					Else
						TurnsBeforeNextCamp = 0
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ReDim sItemList(TomeRoster(TomeRosterSelect).Triggers.Count)
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						For	Each TriggerX In TomeRoster(TomeRosterSelect).Triggers
							If TriggerX.IsSkill Or TriggerX.TriggerType = bdOnCast Or TriggerX.TriggerType = bdOnCastTarget Then
								n = n + 1
								sItemList(n) = TriggerX.Name & IIf(TriggerX.IsSkill, "", " (spell)")
								If IsBetween(n - iItemTop, 0, 16) Then
									'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									ShowText(picTomeNew, 332, 74 + 14 * (n - iItemTop), 217, 15, bdFontNoxiousBlack, sItemList(n), False, False)
								End If
							End If
						Next TriggerX
					End If
					If n > 16 Then ' bottom of the list reached
						'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
						ScrollBarShow(picTomeNew, 549, 74, 248, iItemTop, n - 16, 0)
					End If
					If n = 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 332, 90, 217, 15, bdFontNoxiousBlack, IIf(TurnsBeforeNextCamp = 0, "No equipment!", "No skills!"), False, False)
					End If
					picTomeNew.Refresh()
				Else
					Select Case TomeAction
						Case bdTomeNew, 2 ' [Titi 2.6.0] random tomes have a different action number as of 2.6.0
							' If TomeIndex = 1 Then
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If TomeIndex = 1 And TomeMenu = bdTomeMenu And TomeAction = 2 Then
								TomeNewBuild() ' Create random tome
								'UPGRADE_WARNING: Couldn't resolve default property of object BuildMessage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If BuildMessage = "No Library Available" Then
									Exit Sub
								End If
							End If
							' Load the Tome file and Party members
							'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
							System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TomeLoadParty(TomeList(TomeIndex))
							' If has party members then skip to the end
							'UPGRADE_WARNING: Couldn't resolve default property of object Tome.OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If Tome.OnAdventure = True Then
								picMainMenu.Visible = False
								picTomeNew.Visible = False
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								TomeCopy(TomeList(TomeIndex))
								'UPGRADE_WARNING: Couldn't resolve default property of object Tome. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								TomeStart(Tome)
							Else
								TomeLoadRoster()
								TomeGatherList()
							End If
							'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
							System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						Case bdTomeGather
							If TomeGatherCheck = True Then
								picMainMenu.Visible = False
								picTomeNew.Visible = False
								'UPGRADE_WARNING: Couldn't resolve default property of object Tome. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								TomeCopy(Tome)
								'UPGRADE_WARNING: Couldn't resolve default property of object Tome. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								TomeStart(Tome)
							Else
								DialogSetUp(bdDlgNoReply)
								DialogSetButton(1, "Done")
								DialogShow("DM", IIf(bFromMainMenu, "There is nobody in the roster!", "You must have at least one human controlled Character in the Party."))
								picConvo.Visible = False
							End If
						Case bdTomeSaves
							'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If ScrollSelect > 0 Then
								picTomeNew.Visible = False
								picMainMenu.Visible = False
								'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								TomeRestore(ScrollList(ScrollSelect).FileName)
							End If
						Case bdTomeSaveAs
							'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If ScrollSelect > 0 Then
							End If
						Case bdTomePackage
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If TomeIndex > 0 Then
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Item. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object InstallPackage(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								c = InstallPackage(TomeList.Item(TomeIndex).Text)
								If c <> 0 Then
									DialogSetUp(bdDlgNoReply)
									DialogSetButton(1, "Done")
									'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Item. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									strName = Mid(TomeList.Item(TomeIndex).Text, InStrRev(TomeList.Item(TomeIndex).Text, "\") + 1) ' keep only the name (remove the path)
									strName = Replace(VB.Left(strName, Len(strName) - 4), "_", " ") ' don't show extension nor undescores
									DialogShow("DM", strName & " has been successfully installed!")
									picConvo.Visible = False
								End If
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								TomeList.Remove(TomeIndex)
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If TomeList.Count <> 0 Then
									PackageLoad()
									PackageList(1)
								Else
									picTomeNew.Visible = False
									picMainMenu.Visible = True
								End If
							End If
					End Select
				End If
			End If
		ElseIf PointIn(AtX, AtY, 276, 62, 18, 267) Then 
			' ScrollBar Click
			Select Case TomeAction
				Case bdTomeGather
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
					If ScrollBarClick(AtX, AtY, ButtonDown, picTomeNew, 276, 62, 267, TomeRosterTop, TomeRoster.Count, 2) = True Then
						HiddenBonus = False
						TomeGatherList()
					End If
				Case bdTomeNew
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
					If ScrollBarClick(AtX, AtY, ButtonDown, picTomeNew, 276, 62, 267, TomeListTop, TomeList.Count, 11) = True Then
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeNewList(TomeIndex)
					End If
				Case bdTomeSaves, bdTomeSaveAs
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
					If ScrollBarClick(AtX, AtY, ButtonDown, picTomeNew, 276, 62, 267, ScrollTop, ScrollList.Count, 11) = True Then
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeSavesList(TomeIndex)
					End If
				Case bdTomePackage
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
					If ScrollBarClick(AtX, AtY, ButtonDown, picTomeNew, 276, 62, 267, TomeListTop, TomeList.Count, 11) = True Then
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						PackageList(TomeIndex)
					End If
			End Select
		ElseIf PointIn(AtX, AtY, 549, 74, 18, 267) Then 
			' Character's details' ScrollBar Click
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeGather. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TomeAction = bdTomeGather And iItemTop > 0 Then
				HiddenBonus = True ' reuse of a global var to keep track of what list to display
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
				If ScrollBarClick(AtX, AtY, ButtonDown, picTomeNew, 549, 74, 248, iItemTop, IIf(TurnsBeforeNextCamp = 0, TomeRoster(TomeRosterSelect).Triggers.Count, TomeRoster(TomeRosterSelect).Items.Count), 15) = True Then
					TomeGatherList()
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeGather. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 62, 331, 90, 18) And TomeAction = bdTomeGather Then 
			' Delete Character
			' [Titi 2.4.6] Not allowed if character is already in tome!
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TomeRoster.Count > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Not TomeRoster(TomeRosterSelect).OnAdventure Then
					ShowButton(picTomeNew, 62, 331, "Delete", ButtonDown)
					picTomeNew.Refresh()
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ButtonDown = False And TomeRosterSelect > 0 Then
						'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
						CreatePCDelete()
					End If
				Else
					' Put Character back into roster
					' [Titi 2.4.9] only if character is already in tome!
					ShowButton(picTomeNew, 62, 331, "Release", ButtonDown)
					picTomeNew.Refresh()
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ButtonDown = False And TomeRosterSelect > 0 Then
						'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
						DialogSetUp(bdDlgNoReply)
						DialogSetButton(1, "No")
						DialogSetButton(2, "Yes")
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogShow("DM", "You're about to free " & TomeRoster(TomeRosterSelect).Name & ".")
						DialogHide()
						'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If ConvoAction = 0 Then
							' confirmation to release given!
							'Dim strInTome As String
							'strInTome = LockedInTome(TomeRoster(TomeRosterSelect).Name)
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If OnAdventureList(TomeRosterSelect - 1) <> "deleted savegame!" Then
								DialogSetUp(bdDlgNoReply)
								DialogSetButton(1, "Tome")
								DialogSetButton(2, "Roster")
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Male. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								DialogShow("DM", TomeRoster(TomeRosterSelect).Name & " may have gained XP and items already." & Chr(13) & "Do you want to release " & IIf(TomeRoster(TomeRosterSelect).Male, "him", "her") & " as " & IIf(TomeRoster(TomeRosterSelect).Male, "he", "she") & " was before entering " & OnAdventureList(TomeRosterSelect - 1) & " (click " & Chr(34) & "Roster" & Chr(34) & ") or do you wish " & IIf(TomeRoster(TomeRosterSelect).Male, "him", "her") & " to keep " & IIf(TomeRoster(TomeRosterSelect).Male, "his", "her") & " present status (click " & Chr(34) & "Tome" & Chr(34) & ")?")
								DialogHide()
								'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If ConvoAction = 0 Then
									' roster precedes
									' but first, remove character from the tome
									'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									UnlockFromTome(TomeRoster(TomeRosterSelect).Name, TomeRosterSelect - 1)
									' now, overwrite with the roster version
									'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									ReleaseCharacter(TomeRoster(TomeRosterSelect))
								Else
									' tome version precedes
									'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									UnlockFromTome(TomeRoster(TomeRosterSelect).Name, TomeRosterSelect - 1)
								End If
								DialogSetUp(bdDlgNoReply)
								'[Titi 2.6.3] changed to BriefBox
								'DialogShow "DM", TomeRoster(TomeRosterSelect).Name & " has now left " & OnAdventureList(TomeRosterSelect - 1) & "..."
								'DialogHide
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								DialogBrief(TomeRoster(TomeRosterSelect), TomeRoster(TomeRosterSelect).Name & " has now left " & OnAdventureList(TomeRosterSelect - 1) & "...")
							Else
								' no more saved game, roster version only
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								ReleaseCharacter(TomeRoster(TomeRosterSelect))
							End If
							DialogSetUp(bdDlgNoReply)
							'[Titi 2.6.3] changed to BriefBox
							'DialogShow "DM", TomeRoster(TomeRosterSelect).Name & " is now available for other adventures!"
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							DialogBrief(TomeRoster(TomeRosterSelect), TomeRoster(TomeRosterSelect).Name & " is now available for other adventures!")
							'DialogHide
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TomeRoster(TomeRosterSelect).OnAdventure = False
						End If
						TomeGatherList()
					End If
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeGather. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 158, 331, 90, 18) And TomeAction = bdTomeGather Then 
			' Create Character
			ShowButton(picTomeNew, 158, 331, "Create", ButtonDown)
			' [Titi 2.6.0] if a random tome has just been built, TomeMenu is not set
			'UPGRADE_WARNING: Couldn't resolve default property of object bdCharacterMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeMenu = bdCharacterMenu
			picTomeNew.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatePCReturn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatePCReturn = True
				CreatePCLoadMap(WorldNow)
				CreatePCKingdom(1)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 500, 325, 18, 18) And TomeAction = bdTomeNew And TomeIndex > 1 And ButtonDown = True Then 
			' Click to reset the Tome [only if not a persistent tome - added for 2.6.0]
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(TomeIndex).IsPersistent. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(TomeIndex).OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(TomeIndex).IsInPlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TomeList(TomeIndex).IsInPlay = True And TomeList(TomeIndex).OnAdventure = True And TomeList(TomeIndex).IsPersistent = False Then
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(TomeIndex).IsReset. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().IsReset. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeList(TomeIndex).IsReset = Not TomeList(TomeIndex).IsReset
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeNewList(TomeIndex)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomePackage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 62, 331, 90, 18) And (TomeAction = bdTomeNew Or TomeAction = bdTomePackage) And TomeIndex > 1 Then 
			' Delete Tome
			If ButtonDown Then
				ShowButton(picTomeNew, 62, 331, "Delete", True)
				picTomeNew.Refresh()
			Else
				ShowButton(picTomeNew, 62, 331, "Delete", False)
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeAction = bdTomeNew Then
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeDelete(TomeList(TomeIndex))
				Else ' [Titi 2.6.0] delete package
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Text. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Kill(TomeList(TomeIndex).Text)
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeList.Remove(TomeIndex)
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeIndex = TomeIndex + (TomeIndex > TomeList.Count)
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					PackageList(TomeIndex)
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 158, 331, 90, 18) And TomeAction = bdTomeNew And TomeIndex > 1 Then 
			' Info Tome
			If ButtonDown Then
				ShowButton(picTomeNew, 158, 331, "Info", True)
				picTomeNew.Refresh()
			Else
				ShowButton(picTomeNew, 158, 331, "Info", False)
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeInfo(TomeList(TomeIndex))
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeGather. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 25, 70, 72, 250) And TomeAction = bdTomeGather Then 
			' Drag from Roster
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = Int((AtY - 70) / 86) + TomeRosterTop
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If c <= TomeRoster.Count And c > 0 And ButtonDown = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeRosterSelect = c
				HiddenBonus = False
				TomeGatherList()
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
				' [Titi 2.4.9] display character's stats and equipment
				If btnRight Then
					CreatureNow = TomeRoster(c)
					'UPGRADE_WARNING: Couldn't resolve default property of object frmMonsExplorerPlayer.Show. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					frmMonsExplorerPlayer.Show()
				End If
				If bFromMainMenu Then ' [Titi 2.6.0] show info about the selected character
					' clear the right half of the screen
					HiddenBonus = False
					picMisc.Image = System.Drawing.Image.FromFile(gDataPath & "\Interface\" & GlobalInterfaceName & "\TomeMenu.bmp")
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTomeNew.hdc, 332, 72, 217, 248, picMisc.hdc, 332, 72, SRCCOPY)
					picMisc.Image = System.Drawing.Image.FromFile(gDataPath & "\Interface\" & GlobalInterfaceName & "\Misc.bmp")
					n = 0
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ReDim sItemList(TomeRoster(TomeRosterSelect).Triggers.Count)
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(TomeRosterSelect).Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each TriggerX In TomeRoster(TomeRosterSelect).Triggers
						If TriggerX.IsSkill Or TriggerX.TriggerType = bdOnCast Or TriggerX.TriggerType = bdOnCastTarget Then
							n = n + 1
							sItemList(n) = TriggerX.Name & IIf(TriggerX.IsSkill, "", " (spell)")
							If IsBetween(n - iItemTop, 0, 16) Then
								'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								ShowText(picTomeNew, 332, 74 + 14 * (n - iItemTop), 217, 15, bdFontNoxiousBlack, sItemList(n), False, False)
							End If
						End If
					Next TriggerX
					If n > 16 Then ' bottom of the list reached
						'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
						ScrollBarShow(picTomeNew, 549, 74, 248, iItemTop, n - 16, 0)
					End If
					If n = 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 332, 90, 217, 15, bdFontNoxiousBlack, "No skills!", False, False)
					End If
					picTomeNew.Refresh()
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster(c).OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeRoster(c).OnAdventure = False Then
					CreatureNow = TomeRoster(c)
					'UPGRADE_ISSUE: PictureBox method picInvDrag.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					picInvDrag.Cls() : picInvDrag.Width = 72 : picInvDrag.Height = 84
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Pic. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picInvDrag.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picInvDrag.hdc, 3, 3, 66, 76, picFaces.hdc, bdFaceMin + CreatureNow.Pic * 66, 0, SRCCOPY)
					picInvDrag.Refresh()
					picInvDrag.BringToFront()
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeRosterDrag = c
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDragX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeRosterDragX = AtX - 25
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDragY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeRosterDragY = (AtY - 70) Mod 86
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeGather. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 331, 79, 210, 240) And TomeAction = bdTomeGather And ButtonDown = True Then 
			' Drag from Tome
			c = Int((AtX - 331) / 72) + Int((AtY - 79) / 82) * 3 + 1
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If c <= Tome.Creatures.Count Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureNow = Tome.Creatures(c)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.RequiredInTome. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureNow.RequiredInTome = False Then
					'UPGRADE_ISSUE: PictureBox method picInvDrag.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					picInvDrag.Cls() : picInvDrag.Width = 72 : picInvDrag.Height = 84
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Pic. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picInvDrag.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picInvDrag.hdc, 3, 3, 66, 76, picFaces.hdc, bdFaceMin + CreatureNow.Pic * 66, 0, SRCCOPY)
					picInvDrag.Refresh()
					picInvDrag.BringToFront()
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeRosterDrag = -c
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDragX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeRosterDragX = (AtX - 331) Mod 72
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDragY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeRosterDragY = (AtY - 79) Mod 82
				End If
			End If
			'    ElseIf PointIn(AtX, AtY, 326, 97, 220, 36) And TomeAction = bdTomeNew And TomeIndex = 1 And ButtonDown = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 326, 97, 220, 36) And TomeAction = 2 And TomeMenu = bdTomeMenu And TomeIndex = 1 And ButtonDown = True Then 
			' Click on Wizard Party
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeWizardParty = Int((AtX - 326) / 55)
			TomeNewList(1)
			'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
			'    ElseIf PointIn(AtX, AtY, 326, 163, 220, 36) And TomeAction = bdTomeNew And TomeIndex = 1 And ButtonDown = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 326, 163, 220, 36) And TomeAction = 2 And TomeMenu = bdTomeMenu And TomeIndex = 1 And ButtonDown = True Then 
			' Click on Wizard Level
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeWizardLevel = Int((AtX - 326) / 55)
			TomeNewList(1)
			'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
			'    ElseIf PointIn(AtX, AtY, 326, 278, 220, 36) And TomeAction = bdTomeNew And TomeIndex = 1 And ButtonDown = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 326, 278, 220, 36) And TomeAction = 2 And TomeMenu = bdTomeMenu And TomeIndex = 1 And ButtonDown = True Then 
			' Click on Wizard Size
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeWizardSize = Int((AtX - 326) / 55)
			TomeNewList(1)
			'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
			'    ElseIf PointIn(AtX, AtY, 328, 233, 220, 14) And TomeAction = bdTomeNew And TomeIndex = 1 And ButtonDown = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 328, 233, 220, 14) And TomeAction = 2 And TomeMenu = bdTomeMenu And TomeIndex = 1 And ButtonDown = True Then 
			' Click on Wizard Story
			'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MapSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If UberWizMaps.MapSketchs.Count > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MainMapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MapSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				UberWizMaps.MainMapIndex = LoopNumber(1, UberWizMaps.MapSketchs.Count, UberWizMaps.MainMapIndex, 1)
				'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MainMapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MapSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.TomeSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Select Case UberWizMaps.TomeSketchs("T" & UberWizMaps.MapSketchs(UberWizMaps.MainMapIndex).TomeIndex).PartySize
					Case 1
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeWizardParty = 0
					Case 2 To 3
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeWizardParty = 1
					Case 4 To 6
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeWizardParty = 2
					Case Else
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeWizardParty = 3
				End Select
				'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MainMapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MapSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.TomeSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Select Case UberWizMaps.TomeSketchs("T" & UberWizMaps.MapSketchs(UberWizMaps.MainMapIndex).TomeIndex).PartyAvgLevel
					Case 1 To 3
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeWizardLevel = 0
					Case 4 To 6
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeWizardLevel = 1
					Case 7 To 10
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeWizardLevel = 2
					Case Else
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeWizardLevel = 3
				End Select
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeWizardParty = 2
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeWizardLevel = 0
			End If
			TomeNewList(1)
			'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomePackage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 24, 68, 245, 266) And (TomeAction = bdTomeNew Or TomeAction = bdTomePackage) And ButtonDown = False Then 
			' Item in ListBox
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = CShort((AtY - 76) / 22) + TomeListTop
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, 1, TomeList.Count) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeAction = bdTomeNew Then
					TomeNewList(c)
				Else
					PackageList(c)
				End If
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaveAs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaves. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 24, 68, 245, 266) And (TomeAction = bdTomeSaves Or TomeAction = bdTomeSaveAs) And ButtonDown = False Then 
			' Saves Listed
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = CShort((AtY - 76) / 22) + ScrollTop
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, 1, ScrollList.Count) Then
				TomeSavesList(c)
				'UPGRADE_WARNING: Untranslated statement in TomeNewClick. Please check source code.
			End If
		End If
	End Sub
	
	'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub ShowButton(ByRef picBox As Object, ByRef X As Short, ByRef Y As Short, ByRef Text_Renamed As String, ByRef Down As Short, Optional ByRef NotAvailable As Boolean = False)
		Dim bdFontElixirWhite As Object
		Dim bdFontElixirGrey As Object
		Dim rc As Integer
		' [Titi 2.4.6] added the greyed out display
		If NotAvailable = True Then
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object picBox.hdc. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rc = BitBlt(picBox.hdc, X, Y, 90, 18, picMisc.hdc, 0, 0, SRCCOPY)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirGrey. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picBox, X, Y + 2, 90, 18, bdFontElixirGrey, Text_Renamed, True, False)
		Else
			If Down = True Then
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_WARNING: Couldn't resolve default property of object picBox.hdc. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rc = BitBlt(picBox.hdc, X, Y, 90, 18, picMisc.hdc, 90, 0, SRCCOPY)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picBox, X + 2, Y + 4, 90, 18, bdFontElixirWhite, Text_Renamed, True, False)
			Else
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_WARNING: Couldn't resolve default property of object picBox.hdc. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rc = BitBlt(picBox.hdc, X, Y, 90, 18, picMisc.hdc, 0, 0, SRCCOPY)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picBox, X, Y + 2, 90, 18, bdFontElixirWhite, Text_Renamed, True, False)
			End If
		End If
	End Sub
	
	'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function ScrollBarClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short, ByRef picBox As System.Windows.Forms.PictureBox, ByRef X As Short, ByRef Y As Short, ByRef Height_Renamed As Short, ByRef Index As Short, ByRef Count As Short, ByRef ScrollSize As Short) As Short
		Dim ThumbY As Short
		' Find scroll thumb position (distance in pixels down from scroll top button)
		ThumbY = Int(((Height_Renamed - 54) / Greatest(Count - ScrollSize - 1, 1)) * (Index - 1))
		' Check where click
		If PointIn(AtX, AtY, X, Y, 18, 18) And Index > 1 Then
			' Scroll Up
			If ButtonDown = True Then
				ScrollBarShow(picBox, X, Y, Height_Renamed, Index, Count - ScrollSize, 1)
				picBox.Refresh()
				ScrollBarClick = False
				TargetAllowDead = -1
			Else
				Index = Index - 1
				'UPGRADE_WARNING: Untranslated statement in ScrollBarClick. Please check source code.
				ScrollBarClick = True
			End If
		ElseIf PointIn(AtX, AtY, X, Y + Height_Renamed - 18, 18, 18) And Index < Count - ScrollSize Then 
			' Scroll Down
			If ButtonDown = True Then
				ScrollBarShow(picBox, X, Y, Height_Renamed, Index, Count - ScrollSize, 2)
				picBox.Refresh()
				ScrollBarClick = False
				TargetAllowDead = 1 ' [Titi 2.6.0] Variable used to tell which page of the world description to display
			Else
				Index = Index + 1
				'UPGRADE_WARNING: Untranslated statement in ScrollBarClick. Please check source code.
				ScrollBarClick = True
			End If
		ElseIf PointIn(AtX, AtY, X, Y + 18, 18, ThumbY) And ButtonDown And Index > 1 Then 
			' Big Scroll Up
			Index = Greatest(Index - ScrollSize, 1)
			'UPGRADE_WARNING: Untranslated statement in ScrollBarClick. Please check source code.
			ScrollBarClick = True
			TargetAllowDead = -15
		ElseIf PointIn(AtX, AtY, X, Y + 36 + ThumbY, 18, Height_Renamed - ThumbY - 54) And ButtonDown And Index < Count - ScrollSize Then 
			' Big Scroll Down
			Index = Least(Index + ScrollSize, Count - ScrollSize)
			'UPGRADE_WARNING: Untranslated statement in ScrollBarClick. Please check source code.
			ScrollBarClick = True
			TargetAllowDead = 15 ' [Titi 2.6.0] Variable used to tell which page of the world description to display
		End If
	End Function
	
	'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function ScrollBarShow(ByRef picBox As System.Windows.Forms.PictureBox, ByRef X As Short, ByRef Y As Short, ByRef Height_Renamed As Short, ByRef Index As Short, ByRef Count As Short, ByRef ButtonDown As Short) As Short
		' ButtonDown = 1 for top scroll, ButtonDown = 2 for bottom scroll, 0 is no scroll
		Dim rc As Integer
		Dim ThumbY As Short
		' Show top and bottom scroll buttons
		Select Case ButtonDown
			Case 0 ' No Scroll
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y, 18, 18, picMisc.hdc, 72, 18, SRCCOPY)
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y + Height_Renamed - 18, 18, 18, picMisc.hdc, 36, 18, SRCCOPY)
			Case 1 ' Scroll Up
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y, 18, 18, picMisc.hdc, 90, 18, SRCCOPY)
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y + Height_Renamed - 18, 18, 18, picMisc.hdc, 36, 18, SRCCOPY)
			Case 2 ' Scroll Down
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y, 18, 18, picMisc.hdc, 72, 18, SRCCOPY)
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y + Height_Renamed - 18, 18, 18, picMisc.hdc, 54, 18, SRCCOPY)
		End Select
		' Position Thumb Button
		ThumbY = Int(((Height_Renamed - 54) / Greatest(Count - 1, 1)) * (Index - 1))
		' [Titi 2.4.9] negative offset if last item removed in the calling proc
		If ThumbY < 0 Then ThumbY = 0
		If ThumbY > Height_Renamed - 54 Then ThumbY = Height_Renamed - 54
		ScrollBarShow = Y + 18 + ThumbY
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picBox.hdc, X, ScrollBarShow, 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
	End Function
	
	'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function WorldScrollBarClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short, ByRef picBox As System.Windows.Forms.PictureBox, ByRef X As Short, ByRef Y As Short, ByRef Height_Renamed As Short, ByRef Index As Short, ByRef Count As Short, ByRef ScrollSize As Short) As Short
		Dim ThumbY As Short
		' Find scroll thumb position (distance in pixels down from scroll top button)
		ThumbY = Int((Height_Renamed - 54) / Count) * (Index - 1)
		' Check where click
		If PointIn(AtX, AtY, X, Y, 18, 18) And Index > 0 Then
			' Scroll Up
			If ButtonDown = True Then
				WorldScrollBarShow(picBox, X, Y, Height_Renamed, Index, Count - ScrollSize, 1)
				picBox.Refresh()
				WorldScrollBarClick = False
			Else
				Index = Index - 1
				'UPGRADE_WARNING: Untranslated statement in WorldScrollBarClick. Please check source code.
				WorldScrollBarClick = True
			End If
		ElseIf PointIn(AtX, AtY, X, Y + Height_Renamed - 18, 18, 18) And Index < Count - ScrollSize Then 
			' Scroll Down
			If ButtonDown = True Then
				WorldScrollBarShow(picBox, X, Y, Height_Renamed, Index, Count - ScrollSize, 2)
				picBox.Refresh()
				WorldScrollBarClick = False
			Else
				Index = Index + 1
				'UPGRADE_WARNING: Untranslated statement in WorldScrollBarClick. Please check source code.
				WorldScrollBarClick = True
			End If
		ElseIf PointIn(AtX, AtY, X, Y + 18, 18, ThumbY) And ButtonDown And Index > 0 Then 
			' Big Scroll Up
			Index = Greatest(Index - ScrollSize, 1)
			'UPGRADE_WARNING: Untranslated statement in WorldScrollBarClick. Please check source code.
			WorldScrollBarClick = True
		ElseIf PointIn(AtX, AtY, X, Y + 36 + ThumbY, 18, Height_Renamed - ThumbY - 54) And ButtonDown And Index < Count - ScrollSize Then 
			' Big Scroll Down
			Index = Least(Index + ScrollSize, Count - ScrollSize)
			'UPGRADE_WARNING: Untranslated statement in WorldScrollBarClick. Please check source code.
			WorldScrollBarClick = True
		End If
	End Function
	
	'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function WorldScrollBarShow(ByRef picBox As System.Windows.Forms.PictureBox, ByRef X As Short, ByRef Y As Short, ByRef Height_Renamed As Short, ByRef Index As Short, ByRef Count As Short, ByRef ButtonDown As Short) As Short
		' ButtonDown = 1 for top scroll, ButtonDown = 2 for bottom scroll, 0 is no scroll
		Dim rc As Integer
		Dim ThumbY As Short
		' Show top and bottom scroll buttons
		Select Case ButtonDown
			Case 0 ' No Scroll
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y, 18, 18, picMisc.hdc, 72, 18, SRCCOPY)
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y + Height_Renamed - 18, 18, 18, picMisc.hdc, 36, 18, SRCCOPY)
			Case 1 ' Scroll Up
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y, 18, 18, picMisc.hdc, 90, 18, SRCCOPY)
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y + Height_Renamed - 18, 18, 18, picMisc.hdc, 36, 18, SRCCOPY)
			Case 2 ' Scroll Down
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y, 18, 18, picMisc.hdc, 72, 18, SRCCOPY)
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picBox.hdc, X, Y + Height_Renamed - 18, 18, 18, picMisc.hdc, 54, 18, SRCCOPY)
		End Select
		' Position Thumb Button
		ThumbY = Int((Height_Renamed - 54) / Greatest(1, Count - 1)) * (Index - 1)
		WorldScrollBarShow = Y + 18 + ThumbY
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property picBox.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picBox.hdc, X, WorldScrollBarShow, 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
	End Function
	
	'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function ShowText(ByRef picBox As Object, ByVal X As Short, ByVal Y As Short, ByVal Width_Renamed As Short, ByVal Height_Renamed As Short, ByRef FontNum As Short, ByRef Text_Renamed As String, ByRef Center As Short, ByRef ReturnRows As Short) As Short
		Dim aY As Object
		Dim aX As Object
		Dim aW As Object
		Dim bdFontLargeWhite As Object
		Dim bdFontElixirBlack As Object
		Dim bdFontElixirGrey As Object
		Dim bdFontElixirGold As Object
		Dim bdFontElixirWhite As Object
		Dim bdFontNoxiousBlack As Object
		Dim bdFontNoxiousGrey As Object
		Dim bdFontNoxiousGold As Object
		Dim bdFontNoxiousWhite As Object
		Dim bdFontSmallWhite As Object
		' IF Center = True (-1), then Center Text
		' IF Center = False (0), then Left Justify Text
		' IF Center = 1, then Right Justify Text
		Dim LastSpace, PosX, PosY, LastPixels As Short
		'UPGRADE_NOTE: FontHeight was upgraded to FontHeight_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim FontIndex, FontSpace, FontTop, FontMask, FontHeight_Renamed, FontLine As Short
		Dim TextLen, TextPos, TextPixels As Short
		Dim c, n As Short
		Dim rc As Integer
		' Set up Font
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontLargeWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirGrey. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousGrey. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Select Case FontNum
			Case bdFontSmallWhite
				FontIndex = 0 : FontTop = 0 : FontMask = 20 : FontSpace = 6 : FontHeight_Renamed = 10 : FontLine = 1
			Case bdFontNoxiousWhite
				FontIndex = 1 : FontTop = 40 : FontMask = 208 : FontSpace = 6 : FontHeight_Renamed = 14 : FontLine = 2
			Case bdFontNoxiousGold
				FontIndex = 1 : FontTop = 82 : FontMask = 208 : FontSpace = 6 : FontHeight_Renamed = 14 : FontLine = 2
			Case bdFontNoxiousGrey
				FontIndex = 1 : FontTop = 124 : FontMask = 208 : FontSpace = 6 : FontHeight_Renamed = 14 : FontLine = 2
			Case bdFontNoxiousBlack
				FontIndex = 1 : FontTop = 166 : FontMask = 208 : FontSpace = 6 : FontHeight_Renamed = 14 : FontLine = 2
			Case bdFontElixirWhite
				FontIndex = 2 : FontTop = 250 : FontMask = 362 : FontSpace = 8 : FontHeight_Renamed = 14 : FontLine = 2
			Case bdFontElixirGold
				FontIndex = 2 : FontTop = 278 : FontMask = 362 : FontSpace = 8 : FontHeight_Renamed = 14 : FontLine = 2
			Case bdFontElixirGrey
				FontIndex = 2 : FontTop = 306 : FontMask = 362 : FontSpace = 8 : FontHeight_Renamed = 14 : FontLine = 2
			Case bdFontElixirBlack
				FontIndex = 2 : FontTop = 334 : FontMask = 362 : FontSpace = 8 : FontHeight_Renamed = 14 : FontLine = 2
			Case bdFontLargeWhite
				FontIndex = 3 : FontTop = 390 : FontMask = 408 : FontSpace = 17 : FontHeight_Renamed = 18 : FontLine = 2
		End Select
		' Initialize positions
		TextLen = LenStr(Text_Renamed) : TextPos = 1 : PosX = X : PosY = Y
		' Loop until reach end of Text
		Do Until TextPos > TextLen Or PosY > Y + Height_Renamed
			' Length of Next Line (in Pixels)
			TextPixels = 0 : c = TextPos : LastSpace = TextPos : LastPixels = 0
			Do 
				If c > TextLen Then
					LastSpace = c
					LastPixels = TextPixels
					Exit Do
				End If
				n = Least(Asc(Mid(Text_Renamed, c, 1)) - 33, 89)
				If n = 59 Then
					TextPixels = TextPixels + 18
				ElseIf n > -1 Then 
					'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TextPixels = TextPixels + aW(FontIndex, n)
				Else
					LastSpace = c
					LastPixels = TextPixels
					TextPixels = TextPixels + FontSpace
				End If
				c = c + 1
			Loop Until (TextPixels > Width_Renamed Or n = -20)
			' [Titi 2.6.0] what if the word is longer than the line? No space found => adjust positions
			If LastPixels = 0 And n <> -20 Then
				LastSpace = c
				LastPixels = TextPixels + FontSpace
			End If
			' If centering, then adjust PosX
			If Center = True Then
				PosX = PosX + (Width_Renamed - LastPixels) / 2
			ElseIf Center = 1 Then 
				PosX = PosX + (Width_Renamed - LastPixels)
			End If
			' Print Next Line
			For c = TextPos To LastSpace - 1
				n = Asc(Mid(Text_Renamed, c, 1)) - 33
				If n = 59 Then ' Special Box as back slash
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_WARNING: Couldn't resolve default property of object picBox.hdc. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rc = BitBlt(picBox.hdc, PosX + 2, PosY - 1, 16, 16, picMisc.hdc, 1, 19, SRCCOPY)
					PosX = PosX + 18
				ElseIf n > -1 And n < 90 Then 
					'UPGRADE_WARNING: Couldn't resolve default property of object aY(FontIndex, n). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object aX(FontIndex, n). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: PictureBox property picFonts.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object picBox.hdc. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rc = BitBlt(picBox.hdc, PosX, PosY, aW(FontIndex, n), FontHeight_Renamed, picFonts.hdc, aX(FontIndex, n), aY(FontIndex, n) + FontMask, SRCAND)
					'UPGRADE_WARNING: Couldn't resolve default property of object aY(FontIndex, n). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object aX(FontIndex, n). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_ISSUE: PictureBox property picFonts.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object picBox.hdc. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rc = BitBlt(picBox.hdc, PosX, PosY, aW(FontIndex, n), FontHeight_Renamed, picFonts.hdc, aX(FontIndex, n), aY(FontIndex, n) + FontTop, SRCPAINT)
					'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					PosX = PosX + aW(FontIndex, n)
				Else
					PosX = PosX + FontSpace
				End If
			Next c
			' Bump a space
			PosY = PosY + FontHeight_Renamed + FontLine
			PosX = X
			TextPos = LastSpace + 1
		Loop 
		If ReturnRows = True Then
			ShowText = PosY - Y
		Else
			ShowText = TextLen - TextPos
		End If
	End Function
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Area was upgraded to Area_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function TomeSaveArea(ByRef sPath As String) As Boolean
		Dim oErr As Object
		Dim Area_Renamed As Object
		Dim Tome_Renamed As Object
		Dim c As Short
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		On Error GoTo Err_Handler
		' Save Tome
		c = FreeFile
		FileOpen(c, sPath & "\" & Tome.FileName, OpenMode.Binary)
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.SaveToFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.SaveToFile(c)
		FileClose(c)
		' Save Area
		c = FreeFile
		FileOpen(c, sPath & "\" & Area.FileName, OpenMode.Binary)
		'UPGRADE_WARNING: Couldn't resolve default property of object Area.Plot. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Area.Plot.SaveToFile(c)
		FileClose(c)
		TomeSaveArea = True
Exit_Function: 
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		Exit Function
Err_Handler: 
		TomeSaveArea = False
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("TomeSaveArea")
		Resume Exit_Function
	End Function
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub TomeSave(ByRef SaveAsNew As Short, Optional ByRef ShowMessage As Boolean = True)
		Dim DialogDM As Object
		Dim File As Object
		Dim Tome_Renamed As Object
		Dim CreateNameNew As Object
		Dim Folder As Object
		Dim oFileSys As Object
		Dim TomeSavePathName As Object
		Dim TomeSavePos As Object
		Dim FileName, PathName As String
		Dim c As Short
		Dim rc As Integer
		Dim sMsg As String
		Dim i As Short
		Dim EncounterX As Encounter
		On Error GoTo ErrorHandler ' [Titi 2.4.9]
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		' Save as new folder or over existing
		If SaveAsNew = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PathName = gAppPath & "\world\" & WorldNow.Name & "\save" & VB6.Format(TomeSavePos)
			MkDir(PathName)
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.AssignTmpName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePathName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PathName = TomeSavePathName & "\" & oFileSys.AssignTmpName(Folder)
			'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Call oFileSys.CheckExists(PathName, Folder, True)
		End If
		' Setup an image of the Map
		'UPGRADE_ISSUE: PictureBox method picTmp.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTmp.Cls() : picTmp.Width = 220 : picTmp.Height = 165
		'UPGRADE_ISSUE: PictureBox property picTmp.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picTmp.hdc, 3)
		'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property picTmp.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picTmp.hdc, 0, 0, 220, 165, picMap.hdc, 0, 0, picBox.Width, picBox.Height, SRCCOPY)
		' Save screen shot
		'UPGRADE_WARNING: SavePicture was upgraded to System.Drawing.Image.Save and has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		picTmp.Image.Save(PathName & "\screen.bmp")
		' Save description
		c = FreeFile
		FileOpen(c, PathName & "\name.dat", OpenMode.Binary)
		'UPGRADE_WARNING: Put was upgraded to FilePut and has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FilePut(c, Len(CreateNameNew))
		'UPGRADE_WARNING: Put was upgraded to FilePutObject and has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FilePutObject(c, CreateNameNew)
		FileClose(c)
		' Save Area
		' [borf] Copy all files from saved as folder or temp folder
		sMsg = "Problem! Tome NOT saved."
		If TomeSaveArea(PathName) Then
			' [Titi 2.4.9] why copy FROM the saved as or temp folder TO the world folder?
			'        Call oFileSys.Copy(PathName & "\*.*", gAppPath & "\world\" & WorldNow.Name, File, True)
			'    End If
			If Not SaveAsNew Then
				' [Titi 2.6.0] Make sure all areas are saved in the \Roster\Home folder if required
				If InStr(PathName, "Roster") > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Copy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Call oFileSys.Copy(gAppPath & "\world\" & WorldNow.Name & "\" & Mid(Tome.FileName, 1, Len(Tome.FileName) - 4) & "*.*", PathName, File, True)
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Copy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call oFileSys.Copy(PathName & "\*.*", TomeSavePathName, File, True)
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Delete. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call oFileSys.Delete(PathName, Folder, True)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Copy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call oFileSys.Copy(gAppPath & "\world\" & WorldNow.Name & "\" & Mid(Tome.FileName, 1, Len(Tome.FileName) - 4) & "*.*", PathName, File, True)
				TomeSaveArea(PathName)
			End If
			' [Titi 2.5.1] now, save the encounters which are likely to change (TargetEncounterInArea)
			If intCountEncounterTarget >= 0 Then
				For	Each EncounterX In Map.Encounters
					For c = 0 To intCountEncounterTarget
						i = FreeFile
						'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If oFileSys.CheckExists(ListEncounterTarget(c).Name & ".rse", File, False) = True Then
							'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Delete. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							Call oFileSys.Delete(ListEncounterTarget(c).Name & ".rse", File, True)
						End If
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePathName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						FileOpen(i, TomeSavePathName & "\" & ListEncounterTarget(c).Name & ".rse", OpenMode.Binary)
						ListEncounterTarget(c).SaveToFile(i)
						FileClose(i)
					Next 
				Next EncounterX
			End If
			sMsg = "Tome saved."
		End If
Exit_Sub: 
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		If ShowMessage Then
			DialogDM(sMsg)
		End If
		Exit Sub
ErrorHandler: 
		If Not SaveAsNew Then
			'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Delete. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Call oFileSys.Delete(PathName, Folder, True)
		End If
		sMsg = "Failed to save tome."
		Resume Exit_Sub
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub TomeRestore(ByRef FromFile As String, Optional ByRef blnHome As Boolean = False)
		Dim DialogDM As Object
		Dim Tome_Renamed As Object
		Dim File As Object
		Dim oFileSys As Object
		Dim ClipPath As Object
		Dim FileName As String
		Dim c As Short
		Dim FromDir As String
		Dim EncounterX As Encounter
		' End current Combat (if any)
		If picGrid.Visible = True Then
			CombatEnd(False)
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object ClipPath(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		FromDir = ClipPath(FromFile)
		' Copy all the files from the Save to World
		'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Copy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call oFileSys.Copy(FromDir & "\*.tom", gAppPath & "\world\" & WorldNow.Name, File, True)
		'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Copy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call oFileSys.Copy(FromDir & "\*.rsa", gAppPath & "\world\" & WorldNow.Name, File, True)
		' Clear current game
		GameClear()
		' Read in the new Tome
		'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If oFileSys.CheckExists(FromFile, File) Then
			c = FreeFile
			FileOpen(c, FromFile, OpenMode.Binary)
			Tome = New Tome
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.ReadFromFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.ReadFromFile(c)
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.FileName = Mid(FromFile, InStrRev(FromFile, "\") + 1)
			FileClose(c)
			' [Titi 2.5.1] now, load the encounters which are likely to change (TargetEncounterInArea)
			'        intCountEncounterTarget = -1
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(FromDir & "\*.rse")
			Do Until FileName = ""
				If FileName <> "." And FileName <> ".." Then
					If FileName <> "" Then
						EncounterX = New Encounter
						c = FreeFile
						FileOpen(c, FromDir & "\" & FileName, OpenMode.Binary)
						EncounterX.ReadFromFile(c)
						FileClose(c)
						UpdateListEncounterTarget(EncounterX)
					End If
				End If
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir()
			Loop 
			' Start the tome
			DialogDM("Game Restored.")
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If blnHome = False Then TomeStart(Tome)
		Else
			DialogDM("ERROR: unable to find the saved Tome file in " & FromDir & ".")
		End If
	End Sub
	
	Public Sub TomeAddRoster(ByRef CreatureX As Creature)
		Dim TomeRoster As Object
		Dim c, i As Short
		Dim CreatureZ As Creature
		' Find new available unused index identifier
		c = 1
		For	Each CreatureZ In TomeRoster
			If CreatureZ.Index >= c Then
				c = CreatureZ.Index + 1
			End If
		Next CreatureZ
		CreatureX.Index = c
		' Find alphabetical spot in list
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 1 To TomeRoster.Count
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If UCase(TomeRoster(c).Name) > UCase(CreatureX.Name) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeRoster.Add(Item:=CreatureX, Key:="X" & CreatureX.Index, Before:=c)
				' [Titi 2.6.0] put OnAdventure info back
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ReDim Preserve OnAdventureList(TomeRoster.Count)
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ReDim Preserve OnAdventureListMaster(TomeRoster.Count) ' RT 9 otherwise
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For i = c - 1 To TomeRoster.Count
					OnAdventureList(i) = OnAdventureListMaster(i)
				Next 
				Exit For
			End If
		Next c
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If c > TomeRoster.Count Then
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeRoster.Add(Item:=CreatureX, Key:="X" & CreatureX.Index)
		End If
	End Sub
	
	Public Sub TomeLoadRoster()
		Dim TomeRosterTop As Object
		Dim TomeRoster As Object
		Dim CreatureX, CreatureZ As Creature
		Dim FileName, sPath As String
		Dim c As Short
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		TomeRoster = New Collection
		sPath = gAppPath & "\roster\" & WorldNow.Name & "\"
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(sPath & "*.rsc")
		Do Until FileName = ""
			CreatureX = New Creature
			c = FreeFile
			FileOpen(c, sPath & FileName, OpenMode.Binary)
			CreatureX.ReadFromFile(c)
			FileClose(c)
			TomeAddRoster(CreatureX)
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir()
		Loop 
		' Remove from Roster any Creature already in the Tome
		For	Each CreatureX In Tome.Creatures
			For	Each CreatureZ In TomeRoster
				If CreatureX.Name = CreatureZ.Name Then
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRoster.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeRoster.Remove("X" & CreatureZ.Index)
				End If
			Next CreatureZ
		Next CreatureX
		' Set the top of the Roster
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeRosterTop = 1
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Public Sub TomeLoad()
		Dim TomeListTop As Object
		Dim Folder As Object
		Dim oFileSys As Object
		Dim oErr As Object
		Dim TomeList As Object
		Dim FileName As String
		Dim c, i As Short
		Dim TomeX, TomeZ As Tome
		Dim DirList As Collection
		Dim FactoidX As Factoid
		Dim iNbLines As Short
		On Error GoTo ErrorHandler
		' Start new listing of Tomes on disk
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		' Add default \tomes folder
		DirList = New Collection
		FactoidX = New Factoid
		FactoidX.Text = gAppPath & "\tomes\" & WorldNow.Name
		i = i + 1
		FactoidX.Index = 0
		DirList.Add(FactoidX, "F" & FactoidX.Index)
		' Get list of directories where Tomes could be
		i = 0 : c = 0
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(gAppPath & "\tomes\" & WorldNow.Name & "\*.*", FileAttribute.Directory)
		Do Until FileName = ""
			If FileName <> "." And FileName <> ".." Then
				'[Titi 2.4.9a] skip all files (entries that are NOT directories)
				If (GetAttr(gAppPath & "\tomes\" & WorldNow.Name & "\" & FileName) And FileAttribute.Directory) = FileAttribute.Directory Then
					FactoidX = New Factoid
					FactoidX.Text = gAppPath & "\tomes\" & WorldNow.Name & "\" & FileName
					i = i + 1
					FactoidX.Index = i
					DirList.Add(FactoidX, "F" & FactoidX.Index)
				Else
					' [Titi 2.4.9] but include tome files anyway
					If VB.Right(FileName, 4) = ".tom" And c = 0 Then
						FactoidX = New Factoid
						FactoidX.Text = gAppPath & "\tomes\" & FileName
						i = i + 1
						FactoidX.Index = i
						DirList.Add(FactoidX, "F" & FactoidX.Index)
						c = 1 ' even if there are several tomes in the folder, no need to list it more than once!
					End If
				End If
			End If
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir()
		Loop 
		' Now go find Tomes in those directories
		i = 0
		TomeList = New Collection
		For	Each FactoidX In DirList
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(FactoidX.Text & "\*.tom")
			Do Until FileName = ""
				' Read the Tome file
				c = FreeFile
				TomeX = New Tome
				FileOpen(c, FactoidX.Text & "\" & FileName, OpenMode.Binary)
				TomeX.ReadFromFileHeader(c)
				FileClose(c)
				' [Titi 2.4.9a] get rid of wrong files
				If TomeX.Name = vbNullString Then
					'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					oErr.logError("TomeLoad (" & FactoidX.Text & "\" & FileName & " is not a valid tome.)")
				Else
					' Set to directory and file name pulled, set to Not on Adventure
					TomeX.FullPath = FactoidX.Text
					TomeX.FileName = FileName
					TomeX.OnAdventure = False
					' Index the Tome
					i = i + 1
					TomeX.Index = i
					' Que the Tome into the List alphabetically
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For c = 1 To TomeList.Count
						' [Titi 2.6.0] problem with tomes not starting with a Capital letter!
						'If TomeList(c).Name > TomeX.Name Then
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If UCase(TomeList(c).Name) > UCase(TomeX.Name) Then
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TomeList.Add(Item:=TomeX, Key:="T" & TomeX.Index, Before:="T" & TomeList(c).Index)
							' [Titi 2.6.0] duplicate tome as many times as lines are needed for display (will allow to click anywhere in the 'range of lines' to select the correct index
							iNbLines = Int(Len(TomeX.Name) / 25) + CShort(Len(TomeX.Name) = 25) ' 25 characters per line
							Do 
								If iNbLines = 0 Then Exit Do ' no extra lines needed
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								TomeList.Add(Item:=TomeX, Before:="T" & TomeList(c).Index)
								iNbLines = iNbLines - 1
							Loop Until iNbLines = 0
							Exit For
						End If
					Next c
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If c > TomeList.Count Then
						'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						TomeList.Add(Item:=TomeX, Key:="T" & TomeX.Index)
						' [Titi 2.6.0] duplicate tome as many times as lines are needed for display (will allow to click anywhere in the 'range of lines' to select the correct index
						iNbLines = Int(Len(TomeX.Name) / 25) + CShort(Len(TomeX.Name) = 25) ' 25 characters per line
						Do 
							If iNbLines = 0 Then Exit Do ' no extra lines needed
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TomeList.Add(Item:=TomeX)
							iNbLines = iNbLines - 1
						Loop Until iNbLines = 0
					End If
				End If
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir()
			Loop 
		Next FactoidX
		' Check if Tomes exists in \World folder. If so, get correct OnAdventure indicator.
		For	Each TomeX In TomeList
			'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If oFileSys.CheckExists(gAppPath & "\World\" & WorldNow.Name, Folder, True) Then
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gAppPath & "\World\" & WorldNow.Name & "\" & TomeX.FileName)
				If FileName <> "" Then
					TomeX.IsInPlay = True
					' Read the Tome file
					c = FreeFile
					TomeZ = New Tome
					FileOpen(c, gAppPath & "\World\" & WorldNow.Name & "\" & FileName, OpenMode.Binary)
					TomeZ.ReadFromFileHeader(c)
					FileClose(c)
					TomeX.OnAdventure = TomeZ.OnAdventure
				End If
			End If
		Next TomeX
		'    ' Add Tome Wizard to top
		'    Set TomeX = New Tome
		'    i = i + 1
		'    TomeX.Name = "Create a new Tome"
		'    TomeX.Index = i
		'    If UberWizMaps.MapSketchs.Count > 0 Then
		'        UberWizMaps.MainMapIndex = 1
		'    End If
		'    If TomeList.Count > 0 Then
		'        TomeList.Add Item:=TomeX, Key:="T" & TomeX.Index, Before:=1
		'    Else
		'        TomeList.Add Item:=TomeX, Key:="T" & TomeX.Index
		'    End If
		' Set to top
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeListTop = 1
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		Exit Sub
ErrorHandler: 
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("TomeLoad (" & FactoidX.Text & " is not a valid tome file/folder.)")
		Resume Next
	End Sub
	
	Private Sub RandomTome(ByRef TomeList As Collection, ByRef i As Short)
		Dim UberWizMaps As Object
		Dim TomeX As Tome
		' Add Tome Wizard to top
		TomeX = New Tome
		i = i + 1
		TomeX.Name = "Create a new Tome"
		TomeX.Index = i
		'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MapSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If UberWizMaps.MapSketchs.Count > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MainMapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			UberWizMaps.MainMapIndex = 1
		End If
		If TomeList.Count() > 0 Then
			TomeList.Add(TomeX, "T" & TomeX.Index, 1)
		Else
			TomeList.Add(TomeX, "T" & TomeX.Index)
		End If
	End Sub
	
	Private Sub PackageLoad()
		Dim TomeList As Object
		' [Titi 2.6.0] automatic installation of new or revised worlds and tomes
		Dim iNbLines, c As Short
		Dim sName As String
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		TomeList = New Collection
		' Find all the packages files available
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		SearchFolders("*.rsp", gAppPath, TomeList)
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeList.Count > 0 Then
			' [Titi 2.6.0] duplicate packages with long names (same trick as for new tomes)
			c = 1
			Do 
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeList().Text. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sName = VB.Left(TomeList(c).Text, Len(TomeList(c).Text) - 4) ' get rid of the .rsp extension
				sName = VB.Right(sName, Len(sName) - InStrRev(sName, "\")) ' get rid of the path
				iNbLines = Int(Len(sName) / 25) + CShort(Len(sName) = 25) ' 25 characters per line, including "Save nn"
				Do 
					If iNbLines = 0 Then Exit Do ' no extra lines needed
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeList.Add(Item:=TomeList(c), Before:=c)
					iNbLines = iNbLines - 1
					c = c + 1
				Loop Until iNbLines = 0
				c = c + 1
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Loop Until c > TomeList.Count
		End If
	End Sub
	
	Private Sub PackageList(ByRef Index As Short)
		Dim bdFontElixirBlack As Object
		Dim TomeListTop As Object
		Dim bdFontElixirGold As Object
		Dim TomeList As Object
		Dim bdFontElixirWhite As Object
		Dim TomeIndex As Object
		Dim TomeAction As Object
		Dim bdTomePackage As Object
		Dim n, c, iNbLines As Short
		Dim strName As String
		' [Titi 2.6.0] automatic installation of new or revised worlds and tomes
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomePackage. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeAction = bdTomePackage
		'UPGRADE_ISSUE: PictureBox method picTomeNew.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTomeNew.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeIndex = Index
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 30, 12, 519, 14, bdFontElixirWhite, "Choose a Package to install", True, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 19, 45, 273, 14, bdFontElixirWhite, "Available Packages", True, False)
		n = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 1 To TomeList.Count
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Item. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			strName = Mid(TomeList.Item(c).Text, InStrRev(TomeList.Item(c).Text, "\") + 1) ' keep only the name (remove the path)
			strName = Replace(VB.Left(strName, Len(strName) - 4), "_", " ") ' don't show extension nor undescores
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, TomeListTop, Least(TomeListTop + 11, TomeList.Count)) Then
				iNbLines = Int(Len(strName) / 25) + CShort(Len(strName) = 25) ' 25 characters per line
				' [Titi 2.6.0] tomes with long names have as many places as lines needed for display
				If IsBetween(c, Index - iNbLines, Index) Then
					'If c = Index Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 24, 68 + n * 22, 245, 22 * (iNbLines + 1), bdFontElixirGold, strName, True, True) 'False
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 24, 68 + n * 22, 245, 22 * (iNbLines + 1), bdFontElixirWhite, strName, True, True) 'False
				End If
				n = n + 1 + iNbLines
				c = c + iNbLines ' skip the duplicated packages
			End If
			' [Titi 2.6.0] packages with long names have as many places as lines needed for display
			If IsBetween(c, Index, Index + iNbLines) Then
				'If c = Index Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 332, 48, 217, 15, bdFontElixirBlack, strName, True, False)
			End If
		Next c
		' Set up buttons
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
		ScrollBarShow(picTomeNew, 276, 62, 267, TomeListTop, TomeList.Count - 11, 0)
		ShowButton(picTomeNew, 62, 331, "Delete", False)
		'    ShowButton picTomeNew, 158, 331, "Info", False
		ShowButton(picTomeNew, 380, 364, "Cancel", False)
		ShowButton(picTomeNew, 476, 364, "Install", False)
		' Refresh the screen
		picTomeNew.Top = (Me.ClientRectangle.Height - picTomeNew.ClientRectangle.Height) / 2
		picTomeNew.Left = (Me.ClientRectangle.Width - picTomeNew.ClientRectangle.Width) / 2
		picTomeNew.Refresh()
		picTomeNew.BringToFront()
		picTomeNew.Visible = True
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub LayerTileMicro(ByRef Layer As Short, ByRef XMap As Short, ByRef YMap As Short, ByRef AtX As Short, ByRef AtY As Short, ByRef AtWidth As Short, ByRef AtHeight As Short, ByRef AtOffX As Short, ByRef AtOffY As Short, ByRef Gray As Short)
		Dim Map_Renamed As Object
		Dim c, Flip As Short
		Select Case Layer
			Case bdMapBottom
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.BottomTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				c = Map.BottomTile(XMap, YMap)
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c > 0 And Map.Hidden(XMap, YMap) = False Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = Map.Tiles("L" & c).Pic
				Else
					c = -1
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.BottomFlip. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Flip = Map.BottomFlip(XMap, YMap)
				PlotTileMicro(c, AtX, AtY, AtWidth, AtHeight, AtOffX, AtOffY, Flip)
			Case bdMapMiddle
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.MiddleTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				c = Map.MiddleTile(XMap, YMap)
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c > 0 And (Map.Hidden(XMap, YMap) = False Or Map.Hidden(Least(XMap + 1, Map.Width), YMap) = False Or Map.Hidden(XMap, Greatest(YMap - 1, 0)) = False) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = Map.Tiles("L" & c).Pic
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.MiddleFlip. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Flip = Map.MiddleFlip(XMap, YMap)
					PlotTileMicro(c, AtX, AtY, AtWidth, AtHeight, AtOffX, AtOffY, Flip)
				End If
			Case bdMapTop
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.TopTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				c = Map.TopTile(XMap, YMap)
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c > 0 And (Map.Hidden(XMap, YMap) = False Or Map.Hidden(Least(XMap + 1, Map.Width), YMap) = False Or Map.Hidden(XMap, Greatest(YMap - 1, 0)) = False) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = Map.Tiles("L" & c).Pic
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.TopFlip. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Flip = Map.TopFlip(XMap, YMap)
					PlotTileMicro(c, AtX, AtY, AtWidth, AtHeight, AtOffX, AtOffY, Flip)
				End If
		End Select
	End Sub
	
	Public Sub DrawTileMicro(ByRef AtX As Short, ByRef AtY As Short, ByRef Side As Short)
		Dim bdTileBlack As Object
		Dim bdSideRight As Object
		Dim bdSideSecondBottom As Object
		Dim bdSideFirstBottom As Object
		Dim bdSideLeft As Object
		Dim bdSideTop As Object
		Dim bdTileHeight As Object
		Dim bdTileWidth As Object
		Dim MicroMapTop As Object
		Dim MicroMapLeft As Object
		' AtX is a Pixel / (bdTileWidth/ 2), AtY is Pixel / (bdTileHeight / 3)
		'UPGRADE_NOTE: my was upgraded to my_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim mx, c, my_Renamed As Short
		Dim X, Y As Short
		Dim rc As Integer
		Dim OffX, OffY As Short
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		Dim XMap, YMap As Short
		' Convert AtX and AtY to Map Coordinates
		'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapLeft. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		XMap = MicroMapLeft + AtX - Int(AtY / 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		YMap = MicroMapTop + AtX + Int((AtY + 1) / 2) - 1
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTileWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		X = (AtX * 2 - 1 + (AtY Mod 2)) * (bdTileWidth / 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTileHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Y = (AtY - 2) * (bdTileHeight / 3)
		' The calc above is spot on. I've double checked it.
		OffX = 0 : OffY = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTileHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Height_Renamed = bdTileHeight
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTileWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Width_Renamed = bdTileWidth
		' Set Offsets and Width/Height
		If (Side And bdSideTop) > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			OffY = (bdTileHeight / 3) * 2
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Height_Renamed = (bdTileHeight / 3)
		End If
		If (Side And bdSideLeft) > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			OffX = (bdTileWidth / 2)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Width_Renamed = (bdTileWidth / 2)
		End If
		If (Side And bdSideFirstBottom) > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Height_Renamed = (bdTileHeight / 3) * 2
		End If
		If (Side And bdSideSecondBottom) > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Height_Renamed = (bdTileHeight / 3)
		End If
		If (Side And bdSideRight) > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Width_Renamed = (bdTileWidth / 2)
		End If
		' LayerTile: XMap, YMap, x, y, width, height, offx, offy
		' Plot blank tile if out of bounds
		If XMap < 0 Or YMap < 0 Or XMap > Map.Width Or YMap > Map.Height Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PlotTileMicro(bdTileBlack, X + OffX, Y + OffY, Width_Renamed, Height_Renamed, OffX, OffY, 0)
		Else
			LayerTileMicro(bdMapBottom, XMap, YMap, X + OffX, Y + OffY, Width_Renamed, Height_Renamed, OffX, OffY, 0)
			LayerTileMicro(bdMapMiddle, XMap, YMap, X + OffX, Y + OffY, Width_Renamed, Height_Renamed, OffX, OffY, 0)
			LayerTileMicro(bdMapTop, XMap, YMap, X + OffX, Y + OffY, Width_Renamed, Height_Renamed, OffX, OffY, 0)
			DrawTileAnnotate(XMap, YMap)
		End If
	End Sub
	
	Private Sub PlotTileMicro(ByRef TileToPlot As Short, ByRef X As Short, ByRef Y As Short, ByRef XWidth As Short, ByRef YWidth As Short, ByRef XSrcOff As Short, ByRef YSrcOff As Short, ByRef XFlip As Short)
		Dim bdTileWidth As Object
		Dim bdTileHeight As Object
		Dim rc As Short
		Dim MaxHeight, MaxWidth As Short
		Dim TileX, TileY As Short
		' Draw tile
		If TileToPlot < 0 Then
			'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMicroMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMicroMap.hdc, X, Y, XWidth, YWidth, picBlack.hdc, bdBlackWidth + XSrcOff, YSrcOff, SRCAND)
			'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMicroMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMicroMap.hdc, X, Y, XWidth, YWidth, picBlack.hdc, bdBlackWidth + XSrcOff, picBlackHeightSmall + YSrcOff, SRCPAINT)
		Else
			' Set height, width and location of tile in bmp
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MaxHeight = (picTSmall.Height / (bdTileHeight * 2))
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MaxWidth = (picTSmall.Width / (bdTileWidth * 2))
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TileX = bdTileWidth * Int(TileToPlot / MaxHeight)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TileY = bdTileHeight * (TileToPlot Mod MaxHeight)
			If XFlip = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTileWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TileX = picTSmall.Width - bdTileWidth * (TileX / bdTileWidth) - bdTileWidth
			End If
			'UPGRADE_ISSUE: PictureBox property picTSmall.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMicroMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMicroMap.hdc, X, Y, XWidth, YWidth, picTSmall.hdc, TileX + XSrcOff, TileY + YSrcOff + (picTSmall.Height / 2), SRCAND)
			'UPGRADE_ISSUE: PictureBox property picTSmall.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMicroMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMicroMap.hdc, X, Y, XWidth, YWidth, picTSmall.hdc, TileX + XSrcOff, TileY + YSrcOff, SRCPAINT)
		End If
	End Sub
	
	Private Sub MenuSkillPostRaise()
		Dim FireTriggers As Object
		Dim CreatureNow As Object
		Dim GlobalSkillLevel As Object
		Dim CreatureWithTurn As Object
		Dim TriggerX As Trigger
		Dim c As Short
		Dim NoFail As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each TriggerX In CreatureWithTurn.Triggers
			' For each Skill which has gone up a level, fire Triggers
			If TriggerX.Style(0) = True And TriggerX.SkillPoints > TriggerX.TempSkill Then
				For c = Int(TriggerX.TempSkill / TriggerX.Turns) + 1 To Int(TriggerX.SkillPoints / TriggerX.Turns)
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSkillLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					GlobalSkillLevel = c
					CreatureNow = CreatureWithTurn
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(TriggerX, bdPostRaiseSkill)
				Next c
			End If
		Next TriggerX
	End Sub
	
	Private Sub MenuSkillClose()
		Dim Frozen As Object
		MenuSkillPostRaise()
		picTomeNew.Visible = False
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = False
		If picGrid.Visible = True Then
			picGrid.Focus()
		Else
			picMap.Focus()
		End If
	End Sub
	
	Private Sub MenuSkillClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short)
		Dim CombatAction2 As Object
		Dim ScrollList2 As Object
		Dim CombatAction1 As Object
		Dim ScrollList3 As Object
		Dim ScrollTop As Object
		Dim CreatureWithTurn As Object
		Dim CreatureTarget As Object
		Dim Frozen As Object
		Dim ScrollList As Object
		Dim CreateSkillsIndex As Object
		Dim bdInvStatus As Object
		Dim InvTopIndex As Object
		Dim bdInvItems As Object
		Dim InvNowShow As Object
		Dim c, i As Short
		Dim rc As Integer
		Dim TriggerX As Trigger
		'[Titi 2.6.0] Fixes RT 424 when checking a skill description after display of Equip/Status window
		If TargetAllowDead = 32000 Then
			MenuSkillLoad()
			TargetAllowDead = 0
		End If
		If PointIn(AtX, AtY, picTomeNew.ClientRectangle.Width - 102, 364, 90, 18) Then
			' Done
			If ButtonDown Then
				ShowButton(picTomeNew, picTomeNew.ClientRectangle.Width - 102, 364, "Done", True)
				picTomeNew.Refresh()
			Else
				ShowButton(picTomeNew, picTomeNew.ClientRectangle.Width - 102, 364, "Done", False)
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in MenuSkillClick. Please check source code.
				MenuSkillClose()
				InventoryClose() ' [Titi 2.5.1]
			End If
		ElseIf PointIn(AtX, AtY, picTomeNew.ClientRectangle.Width - 294, 364, 90, 18) Then 
			' [Titi 2.5.1] Open the Equip/Status screen
			If ButtonDown Then
				'            ShowButton picTomeNew, picTomeNew.ScaleWidth - 294, 364, "Equip", True '[Titi 2.6.0] Fixes button "Equip" not responding
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowButton(picTomeNew, picTomeNew.ClientRectangle.Width - 294, 364, IIf(InvNowShow = bdInvItems, "Equip", "Status"), True)
				picTomeNew.Refresh()
			Else
				'            ShowButton picTomeNew, picTomeNew.ScaleWidth - 294, 364, "Equip", False '[Titi 2.6.0] Fixes button "Equip" not responding
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowButton(picTomeNew, picTomeNew.ClientRectangle.Width - 294, 364, IIf(InvNowShow = bdInvItems, "Equip", "Status"), False)
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in MenuSkillClick. Please check source code.
				'UPGRADE_WARNING: Couldn't resolve default property of object InvTopIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvTopIndex = 0
				'            InventoryShow InvNowShow '[Titi 2.6.0] Fixes button "Equip" not responding
				If picInventory.Visible = False Then
					'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InventoryShow(InvNowShow)
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InventoryShow(IIf(InvNowShow = bdInvItems, bdInvStatus, bdInvItems))
				End If
				picInventory.Visible = True
			End If
		ElseIf PointIn(AtX, AtY, 30, 353, 18, 18) Then 
			' [Titi 2.5.1] Filter the skills displayed: always on
			If ButtonDown Then FilterStatus(0) = Not FilterStatus(0)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MenuSkillShow(CreateSkillsIndex)
		ElseIf PointIn(AtX, AtY, 170, 353, 18, 18) Then 
			' [Titi 2.5.1] Filter the skills displayed: spells
			If ButtonDown Then FilterStatus(1) = Not FilterStatus(1)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MenuSkillShow(CreateSkillsIndex)
		ElseIf PointIn(AtX, AtY, 30, 373, 18, 18) Then 
			' [Titi 2.5.1] Filter the skills displayed: on call
			If ButtonDown Then FilterStatus(2) = Not FilterStatus(2)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MenuSkillShow(CreateSkillsIndex)
		ElseIf PointIn(AtX, AtY, 170, 373, 18, 18) Then 
			' [Titi 2.5.1] Filter the skills displayed: special
			If ButtonDown Then FilterStatus(3) = Not FilterStatus(3)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MenuSkillShow(CreateSkillsIndex)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, picTomeNew.ClientRectangle.Width - 198, 364, 90, 18) And ScrollList.Count > 0 And CreateSkillsIndex > 0 Then 
			' Use
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().TriggerType. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = ScrollList(CreateSkillsIndex).TriggerType
			Select Case c
				Case bdOnCast, bdOnSkillUse, bdOnCastTarget, bdOnSkillTarget
					If ButtonDown Then
						ShowButton(picTomeNew, picTomeNew.ClientRectangle.Width - 198, 364, "Use", True)
						picTomeNew.Refresh()
					Else
						ShowButton(picTomeNew, picTomeNew.ClientRectangle.Width - 198, 364, "Use", False)
						picTomeNew.Refresh()
						'UPGRADE_WARNING: Untranslated statement in MenuSkillClick. Please check source code.
						picTomeNew.Visible = False
						' If targeting, acquire target
						Select Case c
							Case bdOnCastTarget, bdOnSkillTarget
								' Range is 99, you can target anything, yes-dead too
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If TargetCreature(CreatureTarget, 99, 0, 1) = False Then
									'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									Frozen = False
									Exit Sub
								End If
						End Select
						'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Frozen = False
						MenuSkillUse(False)
					End If
			End Select
			'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 60, 331, 90, 18) And CreateSkillsIndex > 0 Then 
			' Lower Skill
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(CreateSkillsIndex).TempSkill. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(CreateSkillsIndex).SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(CreateSkillsIndex).Turns. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.SkillPoints >= ScrollList(CreateSkillsIndex).Turns Or ScrollList(CreateSkillsIndex).SkillPoints <> ScrollList(CreateSkillsIndex).TempSkill Then
				If ButtonDown Then
					ShowButton(picTomeNew, 60, 331, "Lower", True)
					picTomeNew.Refresh()
				Else
					ShowButton(picTomeNew, 60, 331, "Lower", False)
					picTomeNew.Refresh()
					'UPGRADE_WARNING: Untranslated statement in MenuSkillClick. Please check source code.
					MenuSkillSpend(False)
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 156, 331, 90, 18) And CreateSkillsIndex > 0 Then 
			' Raise Skill
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(CreateSkillsIndex).TempSkill. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(CreateSkillsIndex).SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(CreateSkillsIndex).Turns. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.SkillPoints >= ScrollList(CreateSkillsIndex).Turns Or ScrollList(CreateSkillsIndex).SkillPoints <> ScrollList(CreateSkillsIndex).TempSkill Then
				If ButtonDown Then
					ShowButton(picTomeNew, 156, 331, "Raise", True)
					picTomeNew.Refresh()
				Else
					ShowButton(picTomeNew, 156, 331, "Raise", False)
					picTomeNew.Refresh()
					'UPGRADE_WARNING: Untranslated statement in MenuSkillClick. Please check source code.
					MenuSkillSpend(True)
				End If
			End If
		ElseIf PointIn(AtX, AtY, 276, 62, 18, 267) Then 
			' ScrollBar Click
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
			If ScrollBarClick(AtX, AtY, ButtonDown, picTomeNew, 276, 62, 267, ScrollTop, ScrollList.Count, 9) = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MenuSkillShow(ScrollTop) 'CreateSkillsIndex
			End If
		ElseIf PointIn(AtX, AtY, 26, 73, 276, 250) And ButtonDown = True Then 
			' Describe Skills
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = Int((AtY - 73) / 25) + ScrollTop
			' [Titi 2.5.1] if the list is filtered, the above calculation won't give the correct result
			'        If ScrollList3.Count > 0 Then c = ScrollList3(c - ScrollTop + 1)
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList3.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ScrollList3.Count > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList3.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c - ScrollTop + 1 <= ScrollList3.Count Then ' [Titi 2.6.1] clicking below the last skill would cause RT9
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList3(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = ScrollList3(c - ScrollTop + 1)
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If c <= ScrollList.Count Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CombatAction1 = ScrollList(c).Index
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList2(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CombatAction2 = ScrollList2(c)
				'UPGRADE_WARNING: Untranslated statement in MenuSkillClick. Please check source code.
				MenuSkillShow(c)
			End If
		ElseIf PointIn(AtX, AtY, 358, 325, 160, 18) And ButtonDown = True Then 
			' Click the Right-Click Action check box
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(CreateSkillsIndex).TriggerType. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Select Case ScrollList(CreateSkillsIndex).TriggerType
				Case bdOnCastTarget, bdOnCast, bdOnSkillUse, bdOnSkillTarget
					' Set Right-Click Action or clear
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(CreateSkillsIndex).Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.CombatAction1 = ScrollList(CreateSkillsIndex).Index And CreatureWithTurn.CombatAction2 = ScrollList2(CreateSkillsIndex) Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.CombatAction1 = 0
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.CombatAction2 = 0
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.CombatAction1 = ScrollList(CreateSkillsIndex).Index
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList2(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.CombatAction2 = ScrollList2(CreateSkillsIndex)
					End If
			End Select
			'UPGRADE_WARNING: Untranslated statement in MenuSkillClick. Please check source code.
			'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MenuSkillShow(CreateSkillsIndex)
		End If
	End Sub
	
	Private Sub MenuSkillLoad(Optional ByRef bResetScrollTop As Boolean = False)
		Dim CombatAction2 As Object
		Dim CombatAction1 As Object
		Dim CreatureWithTurn As Object
		Dim ScrollTop As Object
		Dim ScrollList2 As Object
		Dim ScrollList As Object
		Dim TriggerX, TriggerZ As Trigger
		' Load up the current creature's skills into our ScrollList.
		' ScrollList2 holds the Trigger's Index. TempSkill = -1 if the "Skill" is really a Spell.
		ScrollList = New Collection
		ScrollList2 = New Collection
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollTop = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each TriggerX In CreatureWithTurn.Triggers
			If TriggerX.TriggerType = bdOnSkillUse Or TriggerX.TriggerType = bdOnSkillTarget Or TriggerX.IsSkill = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add(Item:=TriggerX)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList2.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList2.Add(Item:=0)
				TriggerX.TempSkill = TriggerX.SkillPoints
			End If
		Next TriggerX
		' Load up the current creature's spells
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each TriggerX In CreatureWithTurn.Triggers
			' Show Creature based spells
			' [Titi 2.4.9b] prevent doubling of skill if also a spell
			'If TriggerX.TriggerType = bdOnCast Or TriggerX.TriggerType = bdOnCastTarget Then
			If (TriggerX.TriggerType = bdOnCast And TriggerX.IsSkill = False) Or TriggerX.TriggerType = bdOnCastTarget Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add(Item:=TriggerX)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList2.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList2.Add(Item:=0)
				TriggerX.TempSkill = 0
			End If
			' Show Skill based spells
			If TriggerX.IsSkill = True Then
				For	Each TriggerZ In TriggerX.Triggers
					If TriggerZ.TriggerType = bdOnCast Or TriggerZ.TriggerType = bdOnCastTarget Then
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ScrollList.Add(Item:=TriggerZ)
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList2.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ScrollList2.Add(Item:=TriggerX.Index)
						TriggerZ.TempSkill = 0
					End If
				Next TriggerZ
			End If
		Next TriggerX
		' Default to first in list
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ScrollList.Count > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatAction1 = ScrollList(1).Index
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList2(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CombatAction2 = ScrollList2(1)
		End If
	End Sub
	
	Private Sub MenuSkillUse(ByRef WithTarget As Short)
		Dim CreatureTarget As Object
		Dim GlobalSaveStyle As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim CombatAction1 As Object
		Dim CombatAction2 As Object
		Dim CreatureWithTurn As Object
		Dim DialogDM As Object
		Dim Found, Action1, Action2, c As Short
		Dim TriggerX, TriggerZ As Trigger
		Dim StatementX As Statement
		Const bdRuneStatement As Short = 23
		' Check if CreatureWithTurn is dead
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.AllowedTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.AllowedTurn = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DialogDM(CreatureWithTurn.Name & " can't use any skills!")
			Exit Sub
		End If
		' Use either Right-Click Action or last selection
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.CombatAction1 > 0 And WithTarget = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.CombatAction2 > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Action1 = CreatureWithTurn.CombatAction2
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Action2 = CreatureWithTurn.CombatAction1
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Action1 = CreatureWithTurn.CombatAction1
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Action2 = CreatureWithTurn.CombatAction2
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf CombatAction1 > 0 And WithTarget = False Then 
			'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CombatAction2 > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Action1 = CombatAction2
				'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Action2 = CombatAction1
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Action1 = CombatAction1
				'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Action2 = CombatAction2
			End If
		Else
			Action1 = 0
			Action2 = 0
		End If
		' If not doing default then execute Trigger
		Dim Runes(5) As Byte
		If Action1 > 0 Then
			Found = False
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each TriggerX In CreatureWithTurn.Triggers
				If TriggerX.Index = Action1 Then
					Found = True
					Exit For
				End If
			Next TriggerX
			If Found = True Then
				If Action2 > 0 Then
					Found = False
					For	Each TriggerZ In TriggerX.Triggers
						If TriggerZ.Index = Action2 Then
							TriggerX = TriggerZ
							Found = True
							Exit For
						End If
					Next TriggerZ
				End If
				' Fire Skill if non-targeting type
				Select Case TriggerX.TriggerType
					Case bdOnSkillUse, bdOnSkillTarget, bdShowNewStat
						CreatureNow = CreatureWithTurn
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ItemNow = CreatureWithTurn.ItemInHand
						FireTrigger(CreatureWithTurn, TriggerX)
					Case bdOnCast, bdOnCastTarget
						' [Titi 2.4.9b] If the world doesn't use runes to cast spells, runes(c) is to be understood as reagents(c)
						' Acquire Runes to match
						Found = False
						For	Each StatementX In TriggerX.Statements
							If StatementX.Statement = bdRuneStatement Then
								For c = 0 To 5
									Runes(c) = StatementX.B(c)
								Next c
								Found = True
								Exit For
							End If
						Next StatementX
						' If found Runes, then invoke it
						If Found = True Then
							' If Targeting, check for Saving Throw
							If TriggerX.TriggerType = bdOnCastTarget And WithTarget = False Then
								' Set GlobalSaveStyle value if the Trigger has the Rune Statement with Save Checked
								If (StatementX.B(6) And &H2) > 0 Then
									'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSaveStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									GlobalSaveStyle = TriggerX.Styles
								Else
									'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSaveStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									GlobalSaveStyle = 0
								End If
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								Found = Not TargetCreatureSave(CreatureTarget)
							End If
							If Found = True Then
								' If have Runes, then Cast it. Else declare no match.
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If SorceryMatchRunes(CreatureWithTurn, Runes, False) = 0 Then
									' [Titi 2.4.9b] deduct magic points accordingly
									'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Eternium. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									If CreatureWithTurn.Eternium >= TriggerX.SkillPoints And WorldNow.Runes = True Then
										'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										SorceryMatchRunes(CreatureWithTurn, Runes, True)
										'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Eternium. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										CreatureWithTurn.Eternium = CreatureWithTurn.Eternium - TriggerX.SkillPoints
									ElseIf WorldNow.Runes = False Then 
										'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										SorceryMatchRunes(CreatureWithTurn, Runes, True)
									Else
										MessageShow("Not enough " & WorldNow.Magic & "!", 0)
									End If
								Else
									' [Titi 2.4.9b] if the world doesn't use runes, show a different message!
									' MessageShow "No Runes!", 0
									MessageShow(IIf(WorldNow.Runes, "Problem with reagents!", "No Runes!"), 0)
								End If
							End If
						Else
							' This is a non-Rune Spell Trigger
							CreatureNow = CreatureWithTurn
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ItemNow = CreatureWithTurn.ItemInHand
							FireTrigger(CreatureWithTurn, TriggerX)
						End If
				End Select
			Else
				' Previous default no longer exists
				DialogDM("No Skill Selected! Click the Skill button to choose a Skill.")
			End If
		Else
			' Do default action (none was selected)
		End If
		' Clear last selection
		'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CombatAction1 = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CombatAction2 = 0
		' If out of Action Points in Combat, next turn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If picGrid.Visible = True And CreatureWithTurn.ActionPoints < 1 Then
			CombatNextTurn()
		End If
	End Sub
	
	Private Function DontDisplaySkill(ByRef Skill As Trigger) As Boolean
		Select Case Skill.TriggerType
			Case bdOnSkillUse, bdOnSkillTarget
				DontDisplaySkill = Not FilterStatus(1)
			Case bdOnCast, bdOnCastTarget
				DontDisplaySkill = Not FilterStatus(2)
			Case bdNone
				DontDisplaySkill = Not FilterStatus(3)
			Case Else
				DontDisplaySkill = Not FilterStatus(0)
		End Select
	End Function
	
	Private Sub MenuSkillShow(ByRef Index As Short)
		Dim oErr As Object
		Dim ScrollTop As Object
		Dim bdFontNoxiousWhite As Object
		Dim bdFontNoxiousGold As Object
		Dim ScrollList2 As Object
		Dim bdFontNoxiousBlack As Object
		Dim bdFontElixirBlack As Object
		Dim ScrollList As Object
		Dim bdFontSmallWhite As Object
		Dim ScrollList3 As Object
		Dim CreatureWithTurn As Object
		Dim bdFontElixirWhite As Object
		Dim CreateSkillsIndex As Object
		Dim TomeAction As Object
		Dim bdMenuSkill As Object
		Dim Frozen As Object
		On Error GoTo ErrorHandler
		Dim i, c, n, SkillLevel As Short
		Dim SkillLevelName As String
		Dim StatementX As Statement
		Dim TriggerX As Trigger
		Dim rc As Integer
		'UPGRADE_WARNING: Arrays in structure bmMons may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMons As BITMAPINFO
		Dim hMemMons As Integer
		'UPGRADE_WARNING: Arrays in structure bmBlack may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmBlack As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmMask may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMask As BITMAPINFO
		Dim lpMem, TransparentRGB As Integer
		Dim FileName As String
		Const bdRuneStatement As Short = 23
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = True
		'UPGRADE_ISSUE: PictureBox method picTomeNew.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTomeNew.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMenuSkill. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeAction = bdMenuSkill
		'UPGRADE_WARNING: Couldn't resolve default property of object CreateSkillsIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		CreateSkillsIndex = Index
		'UPGRADE_ISSUE: PictureBox method picTomeNew.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTomeNew.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 30, 12, 519, 14, bdFontElixirWhite, CreatureWithTurn.Name & " Skills", True, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 28, 45, 255, 14, bdFontElixirWhite, "Skill Points " & CreatureWithTurn.SkillPoints, False, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 212, 45, 64, 14, bdFontElixirWhite, "Level", True, False)
		' [Titi 2.5.1] add filtering options
		ScrollList3 = New Collection ' [Titi 2.5.1] ScrollList3 will hold the position of the skill in ScrollList
		For i = 0 To 3
			' Show clicked if ON
			If FilterStatus(i) Then
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, 30 + 140 * (i Mod 2), 353 + 20 * Int(i / 2), 18, 18, picMisc.hdc, 18, 18, SRCCOPY)
			Else
				'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTomeNew.hdc, 30 + 140 * (i Mod 2), 353 + 20 * Int(i / 2), 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 60 + 140 * (i Mod 2), 353 + 20 * Int(i / 2), 125, 14, bdFontSmallWhite, IIf(i = 0, "Always on", IIf(i = 1, "On call", IIf(i = 2, "Spells", "Special"))), False, False)
		Next 
		' List available and selected skills
		n = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 1 To ScrollList.Count
			' Show selected Skill
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If c = Index And DontDisplaySkill(ScrollList(c)) = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 332, 48, 217, 15, bdFontElixirBlack, ScrollList(c).Name, True, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Comments. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 328, 80, 220, 190, bdFontNoxiousBlack, ScrollList(c).Comments, False, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).IsSkill. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ScrollList(c).IsSkill = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Turns. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 300, 220, 14, bdFontNoxiousBlack, "Cost: " & ScrollList(c).Turns, True, False)
				End If
				' [Titi 2.5.0] Show skill icon (borrowing picTmp)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = gDataPath & "\Graphics\Skills\" & ScrollList(c).Name & ".bmp"
				Me.picTmp.Image = System.Drawing.Image.FromFile(FileName)
				ReadBitmapFile(FileName, bmMons, hMemMons, TransparentRGB)
				' Make a copy of the current palette for the picture
				'UPGRADE_WARNING: Couldn't resolve default property of object bmBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				bmBlack = bmMons
				' Then change Pure Blue to Pure Black
				ChangeColor(bmBlack, TransparentRGB, 0, 0, 0)
				MakeMask(bmMons, bmMask, TransparentRGB)
				' Paint bitmap to picture box using converted palette
				lpMem = GlobalLock(hMemMons)
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = SetStretchBltMode(Me.picTomeNew.hdc, 3)
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = StretchDIBits(Me.picTomeNew.hdc, 406, 186, Me.picTmp.Width, Me.picTmp.Height, 0, 0, bmMons.bmiHeader.biWidth, bmMons.bmiHeader.biHeight, lpMem, bmMask, DIB_RGB_COLORS, SRCAND)
				'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = StretchDIBits(Me.picTomeNew.hdc, 406, 186, Me.picTmp.Width, Me.picTmp.Height, 0, 0, bmMons.bmiHeader.biWidth, bmMons.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCPAINT)
				' Release memory
				rc = GlobalUnlock(hMemMons)
				rc = GlobalFree(hMemMons)
				' Show Right-Click Action check box
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).TriggerType. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Select Case ScrollList(c).TriggerType
					Case bdOnCast, bdOnSkillUse, bdOnCastTarget, bdOnSkillTarget
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 358, 328, 220, 18, bdFontNoxiousBlack, "Right-Click Action?", False, False)
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction2. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CombatAction1. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CreatureWithTurn.CombatAction1 = ScrollList(c).Index And CreatureWithTurn.CombatAction2 = ScrollList2(c) Then
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 500, 325, 18, 18, picMisc.hdc, 18, 18, SRCCOPY)
						Else
							'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = BitBlt(picTomeNew.hdc, 500, 325, 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
						End If
						ShowButton(picTomeNew, picTomeNew.ClientRectangle.Width - 198, 364, "Use", False)
					Case Else
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 332, 328, 217, 18, bdFontNoxiousBlack, "Always On", True, False)
				End Select
				' Show Runes (if a Spell)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).TriggerType. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ScrollList(c).TriggerType = bdOnCast Or ScrollList(c).TriggerType = bdOnCastTarget Then
					' [Titi 2.4.9b] Don't show runes if the world doesn't need them
					If WorldNow.Runes = False Then
						' Find a Rune Statement (if exists)
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).Statements. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						For	Each StatementX In ScrollList(c).Statements
							If StatementX.Statement = bdRuneStatement Then
								For i = 0 To 5
									If StatementX.B(i) > 0 Then
										' If available in Map.Runes, show it. Else, show it grey
										'UPGRADE_WARNING: Untranslated statement in MenuSkillShow. Please check source code.
									End If
								Next i
								Exit For
							End If
						Next StatementX
					End If
					' If out of Action Points, say so
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.ActionPoints < 10 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 328, 308, 220, 15, bdFontNoxiousBlack, "Not Enough Action Points!", True, False)
					End If
				Else
					' Show Raise/Lower if applicable
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).TempSkill. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).Turns. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.SkillPoints >= ScrollList(c).Turns Or ScrollList(c).SkillPoints <> ScrollList(c).TempSkill Then
						ShowButton(picTomeNew, 60, 331, "Lower", False)
						ShowButton(picTomeNew, 156, 331, "Raise", False)
					End If
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, ScrollTop, Least(ScrollTop + 9, ScrollList.Count)) Then
				' Set Skill Level
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).Turns. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ScrollList(c).Turns > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).Turns. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().SkillPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					SkillLevel = Int(ScrollList(c).SkillPoints / ScrollList(c).Turns)
					Select Case SkillLevel
						Case 0, 1 : SkillLevelName = "Novice"
						Case 2 : SkillLevelName = "Adept"
						Case 3 : SkillLevelName = "Expert"
						Case 4 : SkillLevelName = "Master"
						Case Else : SkillLevelName = "Master+" & SkillLevel - 4
					End Select
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(c).TriggerType. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf ScrollList(c).TriggerType = bdOnCast Or ScrollList(c).TriggerType = bdOnCastTarget Then 
					SkillLevelName = "*"
				Else
					SkillLevelName = "Weakness"
				End If
				' [Titi 2.5.1] Only display it if not filtered
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If DontDisplaySkill(ScrollList(c)) = False Then
					If c = Index Then
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 26, 76 + n * 25, 240, 14, bdFontNoxiousGold, ScrollList(c).Name, False, False)
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 26, 76 + n * 25, 240, 14, bdFontNoxiousGold, SkillLevelName, 1, False)
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 26, 76 + n * 25, 240, 14, bdFontNoxiousWhite, ScrollList(c).Name, False, False)
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picTomeNew, 26, 76 + n * 25, 240, 14, bdFontNoxiousWhite, SkillLevelName, 1, False)
					End If
					n = n + 1
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList3.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollList3.Add(c) ' item #n in this list refers to item #c in main list
				End If
			End If
		Next c
		' Set up buttons
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
		ScrollBarShow(picTomeNew, 276, 62, 267, ScrollTop, ScrollList.Count - 9, 0)
		ShowButton(picTomeNew, picTomeNew.ClientRectangle.Width - 102, 364, "Done", False)
		' [Titi 2.5.1] added the status/equip link
		ShowButton(picTomeNew, picTomeNew.ClientRectangle.Width - 294, 364, "Status", False)
		' Refresh the screen
		picTomeNew.Refresh()
		picTomeNew.BringToFront()
		picTomeNew.Top = Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - picTomeNew.ClientRectangle.Height - 48
		picTomeNew.Left = Me.ClientRectangle.Width - picTomeNew.ClientRectangle.Width
		picTomeNew.Visible = True
		Exit Sub
ErrorHandler: 
		If Err.Number = 53 Then
			FileName = gDataPath & "\Graphics\Skills\NoIcon.bmp"
			Me.picTmp.Image = System.Drawing.Image.FromFile(FileName)
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			oErr.logError("CreatePCSkills:" & Err.Description & " (" & Err.Number & ")")
		End If
		Resume Next
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub MenuAction(ByRef X As Short, ByRef Y As Short, ByRef IsDown As Short)
		Dim JournalShow As Object
		Dim JournalEntryLoad As Object
		Dim JournalCombatLoad As Object
		Dim JournalQuestsLoad As Object
		Dim JournalMode As Object
		Dim CreatureWithTurn As Object
		Dim DialogDM As Object
		Dim Tome_Renamed As Object
		Dim InvNowShow As Object
		Dim InvTopIndex As Object
		Dim bdIntHeight As Object
		Dim Frozen As Object
		Dim c, Button As Short
		' If Frozen or not in game, then exit
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Frozen = True Or picMap.Visible = False Then
			Exit Sub
		End If
		' Else you can try to click
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		c = Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 3 + 7
		If IsBetween(Y, c, c + 32) Then
			Select Case X
				Case 0 To 24 ' Menu
					Button = 7
				Case 40 To 130 ' Inventory
					Button = 1
				Case 138 To 228 ' Talk
					Button = 2
				Case 236 To 326 ' Search/Defend
					Button = 3
				Case 334 To 424 ' Listen/Wait
					Button = 4
				Case 432 To 522 ' Open/Flee
					Button = 5
				Case Me.ClientRectangle.Width - 130 To Me.ClientRectangle.Width - 40 ' Skills
					Button = 6
				Case Me.ClientRectangle.Width - 24 To Me.ClientRectangle.Width ' Journal
					Button = 8
					' [Titi 2.5.1] Camp button added, replaced by Guard in combat
				Case 530 To 620 ' Camp/Guard
					Button = 9
				Case Else
					Button = 0
			End Select
			If IsDown = True Then
				BorderDrawButtons(Button)
				Me.Refresh()
			ElseIf Button > 0 Then 
				BorderDrawButtons(0)
				Me.Refresh()
				'UPGRADE_WARNING: Untranslated statement in MenuAction. Please check source code.
				Select Case Button
					Case 1 ' Inventory
						'UPGRADE_WARNING: Couldn't resolve default property of object InvTopIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InvTopIndex = 0
						'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						InventoryShow(InvNowShow)
						picInventory.Visible = True
						picInventory.BringToFront()
						picInventory.Focus()
					Case 2 ' Talk
						TalkSetup()
					Case 3 ' Search/Defend
						If picGrid.Visible = True Then
							CombatDefend()
						Else
							Search()
						End If
					Case 4 ' Listen/Wait
						If picGrid.Visible = True Then
							CombatWait()
						Else
							DoorListen()
						End If
					Case 5 ' Open/Flee
						If picGrid.Visible = True Then
							CombatFlee()
						Else
							'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							DoorOpen(Tome.MapX, Tome.MapY)
						End If
					Case 6 ' Skills
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If CreatureWithTurn.HPNow > 0 Then
							MenuSkillLoad()
							MenuSkillShow(1)
						Else
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							DialogDM(CreatureWithTurn.Name & " is dead.")
						End If
					Case 7 ' Menu
						MenuShow()
					Case 8 ' Journal
						Select Case JournalMode
							Case 1 ' Quests
								JournalQuestsLoad()
							Case 2 ' Map
							Case 3 ' Combat Log
								JournalCombatLoad(False)
							Case Else ' Journal Entries
								JournalEntryLoad()
						End Select
						JournalShow()
					Case 9 ' Camp/Guard
						If picGrid.Visible = True Then
							CombatGuard()
						Else
							Camp()
						End If
				End Select
			End If
		Else
			BorderDrawButtons(0)
			Me.Refresh()
		End If
	End Sub
	
	Public Sub DoAction(ByRef Action As Short)
		Dim CreatureWithTurn As Object
		Dim Frozen As Object
		Dim ButtonList As Object
		Dim bdInvItems As Object
		Dim InvTopIndex As Object
		Dim c, ButtonCnt As Short
		Dim TriggerX As Trigger
		Dim SkipTurn As Short
		SkipTurn = False
		Select Case MenuNow
			Case bdMenuInventory
				If Action = bdMenuActionDefault Then
					'UPGRADE_WARNING: Couldn't resolve default property of object InvTopIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvTopIndex = 0
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InventoryShow(bdInvItems)
					picInventory.Visible = True
					picInventory.BringToFront()
					picInventory.Focus()
				End If
			Case bdMenuSearch
				Search()
			Case bdMenuEncounter
				For c = 0 To 4
					'UPGRADE_WARNING: Couldn't resolve default property of object ButtonList(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ButtonList(c) <> "" Then
						ButtonCnt = c
					End If
				Next c
				'            ' [Titi 2.6.0] double-click doesn't set Action
				If Action > ButtonCnt Then Action = 0
				Select Case ButtonList(ButtonCnt - Action)
					Case "Talk"
						TalkSetup()
					Case "Flee"
						CombatFlee()
					Case "Fight"
						CombatStart()
					Case "Ignore"
						EncounterIgnore()
					Case "Done"
				End Select
		End Select
		' Show action menu if count is there
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.ActionPoints < 1 Or SkipTurn = True Then
			' If in combat then take a turn
			'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If picGrid.Visible = True And Frozen = False Then
				CombatNextTurn()
			End If
			' If outside of combat, count as a step
			If picGrid.Visible = False Then
				TotalStepsTaken = TotalStepsTaken + 1
				If TotalStepsTaken > 9 Then
					Do Until TotalStepsTaken < 10
						TurnCycle()
						TotalStepsTaken = TotalStepsTaken - 10
					Loop 
				End If
			End If
		End If
	End Sub
	
	Private Sub MenuShow()
		Dim TomeAction As Object
		Dim bdFontElixirWhite As Object
		Dim TomeMenu As Object
		Dim bdTomeOptions As Object
		Dim Frozen As Object
		Dim rc As Integer
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = True
		'UPGRADE_ISSUE: PictureBox method picMainMenu.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picMainMenu.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeOptions. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeMenu = bdTomeOptions
		'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property picMainMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picMainMenu.hdc, 122, 103, 288, 195, picBlack.hdc, 0, 340, SRCCOPY)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picMainMenu, 30, 12, 519, 14, bdFontElixirWhite, "Show which game World is active.", True, False)
		picMainMenu.Visible = True
		picMainMenu.BringToFront()
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeAction = 1
		picMainMenu_MouseMove(picMainMenu, New System.Windows.Forms.MouseEventArgs(0 * &H100000, 0, 0, 128, 0))
	End Sub
	
	Private Sub OptionsShow(ByRef Index As Short)
		Dim TomeListTop As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim File As Object
		Dim oFileSys As Object
		Dim PlayMusic As Object
		Dim fReadValue As Object
		Dim GlobalInterfaceIndex As Object
		Dim GlobalInterfaceList As Object
		Dim CreatePCLoadWorlds As Object
		Dim Worlds As Object
		Dim bdFontSmallWhite As Object
		Dim bdKey As Object
		Dim KingdomIndex As Object
		Dim ScrollTop As Object
		Dim bdFontNoxiousWhite As Object
		Dim bdFontNoxiousGold As Object
		Dim bdFontNoxiousBlack As Object
		Dim bdFontElixirBlack As Object
		Dim GlobalAutoCenter As Object
		Dim bdFontElixirWhite As Object
		Dim TomeMenu As Object
		Dim bdOptionsCount As Object
		Dim ScrollSelect As Object
		Dim TomeAction As Object
		Dim bdTomeOptions As Object
		Dim n, c, Status As Short
		Dim rc As Integer
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Text_Renamed, Explain As String
		Dim WorldTemp As World
		Dim k As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeOptions. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeAction = bdTomeOptions
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollSelect = Index
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeOptions. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeMenu = bdTomeOptions Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdOptionsCount. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			k = bdOptionsCount - 2
			bFromMainMenu = False
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object bdOptionsCount. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			k = bdOptionsCount
		End If
		' Center picTome picture
		picTomeNew.Top = (Me.ClientRectangle.Height - picTomeNew.ClientRectangle.Height) / 2
		picTomeNew.Left = (Me.ClientRectangle.Width - picTomeNew.ClientRectangle.Width) / 2
		'UPGRADE_ISSUE: PictureBox method picTomeNew.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTomeNew.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 30, 12, 519, 14, bdFontElixirWhite, IIf(bFromMainMenu, "World description", "Set Game Options"), True, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTomeNew, 19, 45, 273, 14, bdFontElixirWhite, IIf(bFromMainMenu, "World details", "Options"), True, False)
		n = 0
		For c = 1 To k
			Select Case c
				Case 1 ' Music
					Text_Renamed = "Play Music"
					Explain = "Turn this on if you want to hear music play during the adventure and combat. The default mode is ON." & Chr(13) & Chr(13) & "Music Playing Now: " & Chr(13) & GlobalMusicName
					Status = GlobalMusicState
				Case 2 ' Random Music
					Text_Renamed = "Play Random Music"
					Explain = "Turn this on if you want the system to randomly pick music to play during adventure and combat. The default mode is ON."
					Status = GlobalMusicRandom
				Case 3 ' Right-Click Menu
					Text_Renamed = "Right-Click Skills"
					Explain = "Turn this on if you want to be able to right-click and hold to select an option. OFF means you have to right click, release and then choose an option. The default mode is ON."
					Status = GlobalRightClick
				Case 4 ' Game Speed
					Text_Renamed = "Set Game Speed"
					Explain = "Click this option to cycle through the game speeds. Slow is 1, Fast is 20. The default speed is 12." & Chr(13) & Chr(13) & "Game Speed now is " & GlobalGameSpeed
					Status = GlobalGameSpeed
				Case 5 ' Dice Rolling
					Text_Renamed = "Show Dice Rolling"
					Explain = "Turn this option on if you want to see dice rolling during combat. Turning it off will speed up combat slightly. Either way you'll still see the resulting amount of damage. The default is ON."
					Status = GlobalDiceRolling
				Case 6 ' Sound Effects
					Text_Renamed = "Play Sound Effects"
					Explain = "Turn this on to hear sound effects in combat and while adventuring. This does not effect the audible click when using the mouse. The default is ON."
					Status = GlobalWAVState
				Case 7 ' Debug Mode
					Text_Renamed = "Use Debug Mode"
					Explain = "Turn this on if you want to see the Trigger Statements right after they fire. This helps in debugging what is happening in your Tome. The default is OFF."
					Status = GlobalDebugMode
				Case 8 ' Overswing
					Text_Renamed = "Over swing Penalty"
					Explain = "Turning this on means your characters get a parting shot in combat which ends their turn even if they don't have enough Action Points. There is a penalty to their ToHit roll, however. The default is ON."
					Status = GlobalOverSwing
				Case 9 ' Mouse Click
					Text_Renamed = "Play MouseClick Sound"
					Explain = "Turning this on means you'll hear a sound when you click the mouse. The default is ON."
					Status = GlobalMouseClick
				Case 10 ' Auto End Turn
					Text_Renamed = "Auto End Turn"
					Explain = "Turning this on means a Character's turn will automatically end when there is no one left in weapon range. The default is OFF."
					Status = GlobalAutoEndTurn
				Case 11 ' Fast Move
					Text_Renamed = "Fast Move"
					Explain = "Fast Move ON means the party on the map will move faster than normal (skipping frames of animation). Default is OFF."
					Status = GlobalFastMove
				Case 12 ' Auto Center Map
					Text_Renamed = "Auto Center Map"
					Explain = "Auto Center Map ON means the map will be centered on the party after their move. Default is OFF."
					'Status = GlobalAutoCenter And 1
					Status = GlobalAutoCenter And 1 '[Titi 2.6.0]
				Case 13 ' Interface
					Text_Renamed = "Interface Settings"
					Explain = "You can change the look of the interface to one of several selections. Default Interface is WOOD WEAVE." & Chr(13) & Chr(13) & "Interface: " & UCase(GlobalInterfaceName)
					Status = 0
				Case 14 ' Dice Set
					Text_Renamed = "Dice Set"
					'Explain = "You can change the look of the dice to one of several selections. Default Interface is BONE WHITE." & Chr(13) & Chr(13) & "Dice Set: " & UCase$(Left$(GlobalDiceName, Len(GlobalDiceName) - 4))
					Explain = "You can change the look of the dice to one of several selections. Default Interface is BONE WHITE." & Chr(13) & Chr(13) & "Dice Set: " & VB.Left(GlobalDiceName, Len(GlobalDiceName) - 4)
					Status = 0
				Case 15 ' change keyboard shortcuts [Titi 2.4.9]
					Text_Renamed = "Keyboard Shortcuts"
					Explain = "You can change the assignment of the keys used as shortcuts: "
				Case 16 ' Change World  --> moved to the main menu; now used to install packages [Titi 2.6.0]
					'                Text = "Change World"
					'                Explain = "You can change entire worlds settings. " & Chr(13) & "Current: " & Worlds(WorldIndex).Name
					'                Status = 0
					Text_Renamed = "Install package"
					Explain = "You can automatically add new tomes or worlds (.rsp packages)."
					Status = 0
				Case 17 ' toggle splash and credits screen
					Text_Renamed = "Toggle Splash screen"
					'Explain = "Display splash screens on startup and credits on closing. Default is OFF."
					Explain = "Display splash screens on startup. Default is OFF."
					If Val(GlobalCredits) = 1 Then
						Status = 1
					Else
						Status = 0
					End If
			End Select
			If c = Index Then
				' Show text
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 332, 48, 217, 15, bdFontElixirBlack, Text_Renamed, True, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 328, 80, 220, 190, bdFontNoxiousBlack, Explain, False, False)
				'            If Index = 12 Or Index = 13 Or Index = 14 Then
				If Index >= 13 And Index <= 16 Then
					'                ShowButton picTomeNew, 340, 200, "Back", False
					'                ShowButton picTomeNew, 435, 200, "Next", False
					' [Titi 2.4.9] moved to the bottom to give more space to show the world's details
					ShowButton(picTomeNew, 340, 298, "Back", False)
					ShowButton(picTomeNew, 435, 298, "Next", False)
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object bdOptionsCount. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If IsBetween(c, ScrollTop, Least(ScrollTop + 9, bdOptionsCount)) And Not bFromMainMenu Then
				If c = Index Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 53, 76 + n * 25, 176, 14, bdFontNoxiousGold, Text_Renamed, False, False)
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 53, 76 + n * 25, 176, 14, bdFontNoxiousWhite, Text_Renamed, False, False)
				End If
				' Show clicked if ON
				If Status > 0 Then
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTomeNew.hdc, 26, 73 + n * 25, 18, 18, picMisc.hdc, 18, 18, SRCCOPY)
				Else
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTomeNew.hdc, 26, 73 + n * 25, 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
				End If
				n = n + 1
			End If
		Next c
		Dim FileName As String
		Dim X2, Y2 As Short
		Dim Size2 As Single
		Dim blnShow2 As Boolean
		Dim X1, Y1 As Short
		Dim Size1 As Single
		Dim blnShow1 As Boolean
		If Index = 14 Then ' [Titi 2.4.9] show an example of the dice set
			'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picTomeNew.hdc, 365, 210, 40, 40, picDice.hdc, picDice.ClientRectangle.Width / 2, 0, SRCAND)
			'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picTomeNew.hdc, 365, 210, 40, 40, picDice.hdc, 0, 0, SRCPAINT)
			'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picTomeNew.hdc, 460, 210, 40, 40, picDice.hdc, picDice.ClientRectangle.Width / 2, 200, SRCAND)
			'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picTomeNew.hdc, 460, 210, 40, 40, picDice.hdc, 0, 200, SRCPAINT)
			'        rc = BitBlt(picTomeNew.hdc, 365, 230, picDice.Width / 16, picDice.Height / 9, picDice.hdc, 0, 0, SRCCOPY)
			'        rc = BitBlt(picTomeNew.hdc, 460, 230, picDice.Width / 16, picDice.Height / 9, picDice.hdc, 0, picDice.Height / 9 * 5, SRCCOPY)
		ElseIf Index = 15 Then  ' [Titi 2.4.9] display current shortcuts keys
			Select Case KingdomIndex
				Case 0
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 143, 200, 15, bdFontNoxiousBlack, "In & Out keys", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 150, 200, 15, bdFontNoxiousBlack, "---------------------", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 169, 80, 15, bdFontNoxiousBlack, "Debug:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 169, 80, 15, IIf(Len(ShowShortcuts(bdKey(1))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(1)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 169, 80, 15, bdFontNoxiousBlack, "Quit:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 169, 80, 15, IIf(Len(ShowShortcuts(bdKey(2))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(2)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 186, 80, 15, bdFontNoxiousBlack, "Exit:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 186, 80, 15, IIf(Len(ShowShortcuts(bdKey(3))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(3)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 186, 80, 15, bdFontNoxiousBlack, "Speed:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 186, 80, 15, IIf(Len(ShowShortcuts(bdKey(4))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(4)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 203, 80, 15, bdFontNoxiousBlack, "Load:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 203, 80, 15, IIf(Len(ShowShortcuts(bdKey(5))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(5)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 203, 80, 15, bdFontNoxiousBlack, "Save:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 203, 80, 15, IIf(Len(ShowShortcuts(bdKey(6))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(6)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 220, 80, 15, bdFontNoxiousBlack, "Music:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 220, 80, 15, IIf(Len(ShowShortcuts(bdKey(7))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(7)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 220, 80, 15, bdFontNoxiousBlack, "Sound:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 220, 80, 15, IIf(Len(ShowShortcuts(bdKey(8))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(8)), False, False)
				Case 1
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 143, 200, 15, bdFontNoxiousBlack, "Map Scrolling", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 150, 200, 15, bdFontNoxiousBlack, "-------------------", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 169, 80, 15, bdFontNoxiousBlack, "Left:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 169, 80, 15, IIf(Len(ShowShortcuts(bdKey(9))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(9)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 169, 80, 15, bdFontNoxiousBlack, "Right:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 169, 80, 15, IIf(Len(ShowShortcuts(bdKey(10))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(10)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 186, 80, 15, bdFontNoxiousBlack, "Up:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 186, 80, 15, IIf(Len(ShowShortcuts(bdKey(11))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(11)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 186, 80, 15, bdFontNoxiousBlack, "Down:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 186, 80, 15, IIf(Len(ShowShortcuts(bdKey(12))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(12)), False, False)
				Case 2
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 143, 200, 15, bdFontNoxiousBlack, "Party Actions", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 150, 200, 15, bdFontNoxiousBlack, "-------------------", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 169, 80, 15, bdFontNoxiousBlack, "Left:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 169, 80, 15, IIf(Len(ShowShortcuts(bdKey(13))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(13)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 169, 80, 15, bdFontNoxiousBlack, "Right:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 169, 80, 15, IIf(Len(ShowShortcuts(bdKey(14))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(14)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 186, 80, 15, bdFontNoxiousBlack, "Up:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 186, 80, 15, IIf(Len(ShowShortcuts(bdKey(15))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(15)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 186, 80, 15, bdFontNoxiousBlack, "Down:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 186, 80, 15, IIf(Len(ShowShortcuts(bdKey(16))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(16)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 211, 160, 15, bdFontNoxiousBlack, "Journal & Quests:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 211, 80, 15, IIf(Len(ShowShortcuts(bdKey(17))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(17)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 228, 80, 15, bdFontNoxiousBlack, "Listen:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 228, 80, 15, IIf(Len(ShowShortcuts(bdKey(18))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(18)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 228, 80, 15, bdFontNoxiousBlack, "Talk:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 228, 80, 15, IIf(Len(ShowShortcuts(bdKey(19))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(19)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 245, 80, 15, bdFontNoxiousBlack, "Skills:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 245, 80, 15, IIf(Len(ShowShortcuts(bdKey(20))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(20)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 245, 80, 15, bdFontNoxiousBlack, "Status:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 245, 80, 15, IIf(Len(ShowShortcuts(bdKey(21))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(21)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 262, 80, 15, bdFontNoxiousBlack, "Search:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 262, 80, 15, IIf(Len(ShowShortcuts(bdKey(22))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(22)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 262, 80, 15, bdFontNoxiousBlack, "Open:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 262, 80, 15, IIf(Len(ShowShortcuts(bdKey(23))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(23)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 328, 279, 80, 15, bdFontNoxiousBlack, "Inventory:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 398, 279, 80, 15, IIf(Len(ShowShortcuts(bdKey(24))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(24)), False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 444, 279, 80, 15, bdFontNoxiousBlack, "Equip:", False, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(picTomeNew, 510, 279, 80, 15, IIf(Len(ShowShortcuts(bdKey(25))) > 2, bdFontSmallWhite, bdFontNoxiousBlack), ShowShortcuts(bdKey(25)), False, False)
			End Select
			' [Titi 2.6.0] worlds selection now from the main menu
		ElseIf Index = 16 Then  ' [Titi 2.4.9] display world details
			blnShow1 = True : blnShow2 = True
			WorldTemp = Worlds(WorldIndex)
			Call CreatePCLoadWorlds(WorldTemp) 'too long delay!
			' [Titi 2.6.0] Use the world's preferred interface (can be overridden through the options anyway)
			Do 
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalInterfaceIndex = LoopNumber(1, GlobalInterfaceList.Count, GlobalInterfaceIndex, 1)
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalInterfaceName = GlobalInterfaceList(GlobalInterfaceIndex)
			Loop Until GlobalInterfaceName = strInterfaceName
			' Reload and refesh the entire screen
			GameInterfaceLoad(False)
			BorderDrawAll(False)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 30, 12, 519, 14, bdFontElixirWhite, IIf(bFromMainMenu, "World description", "Set Game Options"), True, False)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 19, 45, 273, 14, bdFontElixirWhite, IIf(bFromMainMenu, "World details", "Options"), True, False)
			Text_Renamed = "Change World"
			'UPGRADE_WARNING: Couldn't resolve default property of object Worlds(WorldIndex).Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Explain = "You can change entire worlds settings. " & Chr(13) & "Current: " & Worlds(WorldIndex).Name
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 332, 48, 217, 15, bdFontElixirBlack, Text_Renamed, True, False)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTomeNew, 328, 80, 220, 190, bdFontNoxiousBlack, Explain, False, False)
			ShowButton(picTomeNew, 340, 298, "Back", False)
			ShowButton(picTomeNew, 435, 298, "Next", False)
			'        frmMain.Refresh
			FileName = gAppPath & "\roster\" & WorldTemp.Name & "\" & WorldTemp.Name & ".ini"
			' [Titi 2.4.9] Get the World Description from the *.ini file
			'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rc = fReadValue(FileName, "World", "DescriptionLines", "S", "1", Text_Renamed)
			X1 = Val(Text_Renamed)
			'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rc = fReadValue(FileName, "World", "Description" & Trim(Str(ScrollWorldDesc + 1)), "S", "No description available", Text_Renamed)
			WorldTemp.Description = Text_Renamed
			'        WorldTemp.Description = Mid$(Text & Space(100), 100 * ScrollWorldDesc + 1, 100)
			'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
			If X1 > 1 And Not bFromMainMenu Then WorldScrollBarShow(picTomeNew, 533, 135, 72, ScrollWorldDesc + 1, X1, 1)
			'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rc = fReadValue(FileName, "World", "PicDesc", "S", gDataPath & "\Stock\blankmap.bmp|" & gDataPath & "\Stock\blankmap.bmp", Text_Renamed)
			If InStr(Text_Renamed, "|") = 0 Then Text_Renamed = Text_Renamed & "|" & gDataPath & "\Stock\blankmap.bmp"
			WorldTemp.PicDesc = Text_Renamed
			Call PlayMusic(WorldTemp.IntroMusic, Me, WorldTemp.MusicFolder)
			If bFromMainMenu Then
				' if we change the world from the opening page, we can use the space usually reserved for the other options
				For c = 2 To X1
					'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rc = fReadValue(FileName, "World", "Description" & Trim(Str(c)), "S", "No description available", Text_Renamed)
					WorldTemp.Description = WorldTemp.Description & " " & Text_Renamed
				Next 
				' [Titi 2.6.0] display only what fits in the window (about 5 lines of text)
				' Some global variables are used for: starting line (CombatTurn), starting character (iItemTop), number of lines to scroll (TurnNow), total number of lines (LastTarget)
				Text_Renamed = WorldTemp.Description
				Y2 = 460 '(about 460 characters can be displayed in the picture box)
				X2 = 30 ' about 30 characters per line
				LastTarget = Int(Len(Text_Renamed) / X2 + 0.5) ' total lines number for the picture box
				If TargetAllowDead = 0 Then ' first time here for the current world
					CombatTurn = -14
					iItemTop = 0
					TargetAllowDead = 15
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ScrollTop = ScrollTop - TargetAllowDead
				End If
				CombatTurn = CombatTurn + TargetAllowDead ' line number in the picture box
				If CombatTurn < 1 Then
					CombatTurn = 1
				ElseIf CombatTurn > LastTarget Then 
					CombatTurn = CombatTurn - TargetAllowDead
				End If
				iItemTop = (CombatTurn - 1) * X2 + 1 ' equivalent number of characters to display
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollTop = Least(Greatest(CombatTurn, 1), LastTarget)
				Y1 = InStrRev(Text_Renamed, " ", iItemTop + Y2) ' make sure we don't cut the final word
				If Y1 = 0 Then Y1 = Len(Text_Renamed) ' if no space found then show all (means one word only!)
				Text_Renamed = Mid(Text_Renamed, InStrRev(Text_Renamed, " ", Greatest(iItemTop, 1)) + 1, Y1)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 32, 76, 236, 233, bdFontNoxiousWhite, Text_Renamed, False, True)
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowText(picTomeNew, 328, 135, 207, 72, bdFontNoxiousBlack, (WorldTemp.Description), False, False)
			End If
			' picTmp and picToHit are "borrowed" to store the world's pictures (if any)
			'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If oFileSys.CheckExists(gAppPath & "\Roster\" & WorldTemp.Name & "\" & VB.Left(WorldTemp.PicDesc, InStr(WorldTemp.PicDesc, "|") - 1), File) Then
				picTmp.Image = System.Drawing.Image.FromFile(gAppPath & "\Roster\" & WorldTemp.Name & "\" & VB.Left(WorldTemp.PicDesc, InStr(WorldTemp.PicDesc, "|") - 1))
			Else
				blnShow1 = False
			End If
			' Resize picture to fit in a 100 x 100 area
			If blnShow1 Then ResizePicture(picTmp, Size1, X1, Y1)
			'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If oFileSys.CheckExists(gAppPath & "\Roster\" & WorldTemp.Name & "\" & VB.Right(WorldTemp.PicDesc, Len(WorldTemp.PicDesc) - InStr(WorldTemp.PicDesc, "|")), File) Then
				picToHit.Image = System.Drawing.Image.FromFile(gAppPath & "\Roster\" & WorldTemp.Name & "\" & VB.Right(WorldTemp.PicDesc, Len(WorldTemp.PicDesc) - InStr(WorldTemp.PicDesc, "|")))
			Else
				blnShow2 = False
			End If
			' Resize picture to fit in a 100 x 100 area
			If blnShow2 Then ResizePicture(picToHit, Size2, X2, Y2)
			If blnShow1 And blnShow2 Then
				' two pics available
				'UPGRADE_ISSUE: PictureBox method picTomeNew.PaintPicture was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picTomeNew.PaintPicture(picTmp, 330 + X1, 202 + Y1 + 50 * CShort(bFromMainMenu), picTmp.Width * Size1, picTmp.Height * Size1)
				'UPGRADE_ISSUE: PictureBox method picTomeNew.PaintPicture was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picTomeNew.PaintPicture(picToHit, 434 + X2, 202 + Y2 + 50 * CShort(bFromMainMenu), picToHit.Width * Size2, picToHit.Height * Size2)
			ElseIf blnShow1 Then 
				' only the first pic
				'UPGRADE_ISSUE: PictureBox method picTomeNew.PaintPicture was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picTomeNew.PaintPicture(picTmp, 382 + X1, 202 + Y1 + 50 * CShort(bFromMainMenu), picTmp.Width * Size1, picTmp.Height * Size1)
			ElseIf blnShow2 Then 
				' only the second pic
				'UPGRADE_ISSUE: PictureBox method picTomeNew.PaintPicture was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picTomeNew.PaintPicture(picToHit, 382 + X2, 202 + Y2 + 50 * CShort(bFromMainMenu), picToHit.Width * Size2, picToHit.Height * Size2)
			Else
				' nothing, in that case default to the world map
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If oFileSys.CheckExists(gAppPath & "\Roster\" & WorldTemp.Name & "\" & WorldTemp.PictureFile, File) = False Then
					' [Titi 2.4.9] not found - either deleted or renamed - anyway default to current world!
					MessageShow(WorldTemp.PictureFile & " not found! Defaulting to blank map...", 0)
					DialogSetUp(bdDlgNoReply)
					DialogSetButton(1, "OK")
					DialogShow("DM", "Error in " & WorldTemp.Name & "!" & Chr(13) & WorldTemp.PictureFile & " not found!" & Chr(13) & Chr(13) & WorldNow.Name & " is still the current world.")
					picTmp.Image = System.Drawing.Image.FromFile(gDataPath & "\Stock\NoSuchFile_2.bmp")
					DialogHide()
					WorldIndex = WorldNow.Index
				Else
					picTmp.Image = System.Drawing.Image.FromFile(gAppPath & "\Roster\" & WorldTemp.Name & "\" & WorldTemp.PictureFile)
				End If
				ResizePicture(picTmp, Size1, X1, Y1)
				'UPGRADE_ISSUE: PictureBox method picTomeNew.PaintPicture was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picTomeNew.PaintPicture(picTmp, 382 + X1, 202 + Y1, picTmp.Width * Size1, picTmp.Height * Size1)
			End If
			' now, reset picToHit
			picToHit.Image = System.Drawing.Image.FromFile(gDataPath & "\Interface\" & GlobalInterfaceName & "\" & "CombatRoll.bmp")
		ElseIf Index = 18 Then  ' [Titi 2.6.0] install tome or world package
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeListTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeListTop = 1
			PackageLoad()
			PackageList(1)
		End If
		' Set up buttons
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdOptionsCount. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
		ScrollBarShow(picTomeNew, 276, 62, 267, ScrollTop, bdOptionsCount - 9 + (LastTarget - 15) * CShort(ScrollSelect = 16) * CShort(bFromMainMenu), 0)
		'    ShowButton picTomeNew, 380, 364, "Default", False
		'    ShowButton picTomeNew, 476, 364, "Done", False
		' [Titi 2.6.0] Default is cancel and Done is Install for the packages installer
		ShowButton(picTomeNew, 380, 364, IIf(Index = 18, "Cancel", "Default"), False)
		ShowButton(picTomeNew, 476, 364, IIf(Index = 18, "Install", "Done"), False)
		' Refresh the screen
		picTomeNew.Refresh()
		picTomeNew.BringToFront()
		picTomeNew.Visible = True
	End Sub
	
	Private Function ShowShortcuts(ByRef intKey As Short) As String
		Dim code As Short
		code = IIf(intKey > 200, intKey - 200, IIf(intKey > 100, intKey - 100, intKey + 200 * CShort(intKey > 200)))
		Select Case code
			Case System.Windows.Forms.Keys.Left
				ShowShortcuts = IIf(intKey > 200, "+", IIf(intKey > 100, "*", "")) & "left"
			Case System.Windows.Forms.Keys.Right
				ShowShortcuts = IIf(intKey > 200, "+", IIf(intKey > 100, "*", "")) & "right"
			Case System.Windows.Forms.Keys.Up
				ShowShortcuts = IIf(intKey > 200, "+", IIf(intKey > 100, "*", "")) & "up "
			Case System.Windows.Forms.Keys.Down
				ShowShortcuts = IIf(intKey > 200, "+", IIf(intKey > 100, "*", "")) & "down"
			Case Else
				ShowShortcuts = IIf(intKey > 200, "+" & Chr(intKey + 200 * CShort(intKey > 200)), IIf(intKey > 100, "*" & Chr(intKey + 100 * CShort(intKey > 100)), Chr(intKey + 200 * CShort(intKey > 200))))
		End Select
	End Function
	
	'UPGRADE_NOTE: Size was upgraded to Size_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub ResizePicture(ByRef picPic As System.Windows.Forms.PictureBox, ByRef Size_Renamed As Single, ByRef X As Short, ByRef Y As Short)
		' Resize picture to fit in a 100 x 100 area
		Size_Renamed = VB6.PixelsToTwipsY(picPic.Height) / VB6.PixelsToTwipsX(picPic.Width)
		If VB6.PixelsToTwipsY(picPic.Height) * Size_Renamed > 100 Then
			Size_Renamed = 100 / VB6.PixelsToTwipsY(picPic.Height)
		End If
		If VB6.PixelsToTwipsX(picPic.Width) * Size_Renamed > 100 Then
			Size_Renamed = 100 / VB6.PixelsToTwipsX(picPic.Width)
		End If
		' Center resized picture in the area
		X = CShort(100 - (VB6.PixelsToTwipsX(picPic.Width) * Size_Renamed)) / 2
		Y = CShort(100 - (VB6.PixelsToTwipsY(picPic.Height) * Size_Renamed)) / 2
	End Sub
	
	Private Sub OptionsChange(ByRef Index As Short, ByRef Direction As Short)
		Dim oErr As Object
		Dim bdTomeOptions As Object
		Dim TomeMenu As Object
		Dim Worlds As Object
		Dim KingdomIndex As Object
		Dim GlobalDiceIndex As Object
		Dim GlobalDiceList As Object
		Dim EncounterNow As Object
		Dim CreatureWithTurn As Object
		Dim ScrollSelect As Object
		Dim GlobalInterfaceIndex As Object
		Dim GlobalInterfaceList As Object
		Dim GlobalAutoCenter As Object
		Dim Adventure As Object
		Dim PlayMusicRnd As Object
		Dim oGameMusic As Object
		Dim rc As Integer
		Dim Found As Short
		Dim FileName As String
		Dim CreatureX As Creature
		Select Case Index
			Case 1 ' Music
				GlobalMusicState = LoopNumber(0, 1, GlobalMusicState, 1)
				If GlobalMusicState = 0 Then
					'MediaPlayerMusic.Stop
					'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.StopPlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					oGameMusic.StopPlay()
					'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.mciClose. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					oGameMusic.mciClose()
					'                rc = mciSendString("close songnow", 0&, 0, 0)
				Else
					Call PlayMusicRnd(Adventure, Me)
				End If
			Case 2 ' Music Random
				'GlobalMusicRandom = LoopNumber(0, 1, GlobalMusicRandom, 1)
				GlobalMusicRandom = IIf(GlobalMusicRandom, 0, 1)
			Case 3 ' Right-Click Menu
				GlobalRightClick = LoopNumber(0, 1, GlobalRightClick, 1)
			Case 4 ' Game Speed
				GlobalGameSpeed = LoopNumber(1, 20, GlobalGameSpeed, 1)
			Case 5 ' Dice Rolling
				GlobalDiceRolling = LoopNumber(0, 1, GlobalDiceRolling, 1)
			Case 6 ' Sound Effects
				GlobalWAVState = LoopNumber(0, 1, GlobalWAVState, 1)
			Case 7 ' Debug Mode
				GlobalDebugMode = LoopNumber(0, 1, GlobalDebugMode, 1)
			Case 8 ' Overswing
				GlobalOverSwing = LoopNumber(0, 1, GlobalOverSwing, 1)
			Case 9 ' Mouse Click
				GlobalMouseClick = LoopNumber(0, 1, GlobalMouseClick, 1)
			Case 10 ' Auto End Turn
				GlobalAutoEndTurn = LoopNumber(0, 1, GlobalAutoEndTurn, 1)
			Case 11 ' Fast Move
				GlobalFastMove = LoopNumber(0, 1, GlobalFastMove, 1)
			Case 12 ' Automatic centering of the map on the party
				'GlobalAutoCenter = LoopNumber(0, 1, GlobalAutoCenter, 1)
				' [Titi 2.6.0] Reuse of GlobalAutoCenter to keep track of customization (if any) of global time variables
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAutoCenter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalAutoCenter = IIf(GlobalAutoCenter And 1 = 1, GlobalAutoCenter And 0, GlobalAutoCenter Or 1)
			Case 13 ' Interface
				'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalInterfaceIndex = LoopNumber(1, GlobalInterfaceList.Count, GlobalInterfaceIndex, Direction)
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalInterfaceName = GlobalInterfaceList(GlobalInterfaceIndex)
				' Reload and refesh the entire screen
				GameInterfaceLoad(True)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsShow(ScrollSelect)
				BorderDrawAll(False)
				If picMenu.Visible = True Or picToHit.Visible = True Then
					BorderDrawSides(True, -1)
					BorderDrawButtons(0)
					Me.Refresh()
					'UPGRADE_ISSUE: PictureBox method picMainMenu.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					picMainMenu.Cls()
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMainMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMainMenu.hdc, 122, 103, 288, 195, picBlack.hdc, 0, 340, SRCCOPY)
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMainMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMainMenu.hdc, 122, 103 + 0 * 39, 288, 39, picBlack.hdc, 0, 536 + 0 * 39, SRCCOPY)
					picMainMenu.Refresh()
					If picGrid.Visible = False Then
						MenuDrawParty()
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatDrawAttack(CreatureWithTurn, CreatureWithTurn, False)
						'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						For	Each CreatureX In EncounterNow.Creatures
							LoadCreaturePic(CreatureX)
						Next CreatureX
					End If
					picMenu.Refresh()
				End If
				Me.Refresh()
				'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
			Case 14 ' Dice
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDiceIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDiceList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalDiceIndex = LoopNumber(1, GlobalDiceList.Count, GlobalDiceIndex, Direction)
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDiceList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalDiceName = GlobalDiceList(GlobalDiceIndex)
				LoadDicePic(GlobalDiceName)
				'            Set picDice = LoadPicture(gDataPath & "\Interface\Dice\" & GlobalDiceName)
				'            picTomeNew.PaintPicture picDice.Picture, 320, 220, picDice.Width, picDice.Height
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsShow(ScrollSelect)
			Case 15 ' Keyboard shortcuts
				' [Titi 2.4.9] KingdomIndex exists, and is used only in Creator, so I borrow it
				'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				KingdomIndex = LoopNumber(0, 2, KingdomIndex, Direction)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsShow(ScrollSelect)
			Case 16 ' Current active WORLD
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeOptions. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeMenu <> bdTomeOptions Then
					WorldIndex = WorldIndex + Direction
					'UPGRADE_WARNING: Couldn't resolve default property of object Worlds.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If WorldIndex > Worlds.Count Then
						WorldIndex = 1
					ElseIf WorldIndex < 1 Then 
						'UPGRADE_WARNING: Couldn't resolve default property of object Worlds.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						WorldIndex = Worlds.Count
					End If
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsShow(ScrollSelect)
			Case 17 ' show splash and credits screens
				If Val(GlobalCredits) = 1 Then
					GlobalCredits = "0"
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTomeNew.hdc, 26, 73 + 14 * 25, 18, 18, picMisc.hdc, 0, 18, SRCCOPY)
				Else
					GlobalCredits = "1"
					'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTomeNew.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTomeNew.hdc, 26, 73 + 14 * 25, 18, 18, picMisc.hdc, 18, 18, SRCCOPY)
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object oErr.LogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call oErr.LogText("Splash option changed. GlobalCredits = " & GlobalCredits)
		End Select
	End Sub
	
	Private Sub OptionsClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short)
		Dim NotTwice As Object
		Dim bdKey As Object
		Dim DialogText As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetUp As Object
		Dim KingdomIndex As Object
		Dim fReadValue As Object
		Dim bdOptionsCount As Object
		Dim ScrollSelect As Object
		Dim OptionsSave As Object
		Dim vsPLAYING As Object
		Dim oGameMusic As Object
		Dim fWriteValue As Object
		Dim File As Object
		Dim oFileSys As Object
		Dim PlayMusic As Object
		Dim CreatePCLoadWorlds As Object
		Dim Worlds As Object
		Dim ScrollTop As Object
		Dim GlobalAutoCenter As Object
		Dim InitKeyboardShortCuts As Object
		Dim lResult As Integer
		Dim code, c, X As Short
		Dim sText As String
		Dim WorldTemp As World '* 8192
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Text_Renamed As String
		If PointIn(AtX, AtY, 380, 364, 90, 18) Then
			' Default
			If ButtonDown Then
				ShowButton(picTomeNew, 380, 364, "Default", True)
			Else
				Call InitKeyboardShortCuts() ' [Titi 2.4.9]
				'UPGRADE_WARNING: Untranslated statement in OptionsClick. Please check source code.
				ShowButton(picTomeNew, 380, 364, "Default", False)
				GlobalMusicState = 1
				GlobalMusicRandom = 1
				GlobalRightClick = 1
				GlobalGameSpeed = 12
				GlobalDiceRolling = 1
				GlobalWAVState = 1
				GlobalDebugMode = 0
				GlobalOverSwing = 1
				GlobalMouseClick = 1
				GlobalAutoEndTurn = 0
				GlobalFastMove = 0
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAutoCenter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				GlobalAutoCenter = 0
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollTop = 1
				If Not bFromMainMenu Then OptionsShow(1)
				GlobalInterfaceName = "WoodWeave"
				GlobalDiceName = "Bone White.bmp"
				' updated by count0 for v2-4-6
				GlobalCredits = "0"
				GameInterfaceLoad(True)
				' [Titi 2.4.9b] Eternia is the default world
				WorldNow.IsCurrent = False
				'UPGRADE_WARNING: Couldn't resolve default property of object Worlds.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For c = 1 To Worlds.Count
					'UPGRADE_WARNING: Couldn't resolve default property of object Worlds(c).Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Worlds(c).Name = "Eternia" Then
						WorldIndex = c
						WorldNow = Worlds(c)
						CreatePCLoadWorlds(WorldNow) ' [Titi 2.6.1] Bug fix for RT76 when clicking on "Default" button to switch to Eternia
						'WorldNow.IsCurrent = True
						Call PlayMusic(WorldNow.IntroMusic, Me, WorldNow.MusicFolder)
					End If
				Next 
				' [Titi 2.4.9b] don't show options if sub called from the main menu
				If bFromMainMenu Then
					picTomeNew.Visible = False
					'UPGRADE_ISSUE: PictureBox method picMainMenu.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					picMainMenu.Cls()
					UpdateMainMenu()
					picMainMenu.Refresh()
					'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Call oFileSys.CheckExists(gAppPath & "\Settings.ini", File, True)
					'UPGRADE_WARNING: Couldn't resolve default property of object fWriteValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					lResult = fWriteValue(gAppPath & "\Settings.ini", "World", "Current", "S", WorldNow.Name)
				End If
			End If
			picTomeNew.Refresh()
		ElseIf PointIn(AtX, AtY, 476, 364, 90, 18) Then 
			' Done
			If ButtonDown Then
				ShowButton(picTomeNew, 476, 364, "Done", True)
				picTomeNew.Refresh()
			Else
				ShowButton(picTomeNew, 476, 364, "Done", False)
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in OptionsClick. Please check source code.
				picTomeNew.Visible = False
				' Save the new Options
				If WorldIndex <> WorldNow.Index Then
					'If MediaPlayerMusic.PlayState = 2 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.Status. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If oGameMusic.Status = vsPLAYING Then
						'MediaPlayerMusic.Stop
						'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.StopPlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						oGameMusic.StopPlay()
						'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.mciClose. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						oGameMusic.mciClose()
					End If
					WorldNow.IsCurrent = False
					WorldNow = Worlds(WorldIndex)
					WorldNow.IsCurrent = True
					Call PlayMusic(WorldNow.IntroMusic, Me, WorldNow.MusicFolder)
				End If
				OptionsSave()
				' save world changes
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call oFileSys.CheckExists(gAppPath & "\Settings.ini", File, True)
				'UPGRADE_WARNING: Couldn't resolve default property of object fWriteValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				lResult = fWriteValue(gAppPath & "\Settings.ini", "World", "Current", "S", WorldNow.Name)
				'Frozen = False
				' [Titi 2.4.9b] if sub called from the main menu, return to menu
				If bFromMainMenu Then
					'UPGRADE_ISSUE: PictureBox method picMainMenu.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					picMainMenu.Cls()
					UpdateMainMenu()
					picMainMenu.Refresh()
				End If
			End If
		ElseIf PointIn(AtX, AtY, 276, 62, 18, 267) Then 
			' [Titi 2.6.0] when coming from Main Menu, the area used for the list of options contains the description of the world.
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdOptionsCount. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
			If ScrollBarClick(AtX, AtY, ButtonDown, picTomeNew, 276, 62, 267, ScrollTop, bdOptionsCount + (LastTarget - 15) * CShort(ScrollSelect = 16) * CShort(bFromMainMenu), 9) = True Then
				' Don't call the install package option if ScrollSelect = 16 (same index as for show world, but we know what is the action since installing packages is not possible from the main menu)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsShow(ScrollSelect + 2 * CShort(ScrollSelect = 16))
			End If
		ElseIf PointIn(AtX, AtY, 26, 73, 18, 250) And ButtonDown = True Then 
			c = CShort((AtY - 76) / 25)
			If IsBetween(c, 0, 9) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsChange(ScrollTop + c, 0)
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsShow(ScrollTop + c)
				'UPGRADE_WARNING: Untranslated statement in OptionsClick. Please check source code.
			End If
		ElseIf PointIn(AtX, AtY, 53, 73, 276, 250) And ButtonDown = True And Not bFromMainMenu Then 
			' Item in ListBox
			c = CShort((AtY - 76) / 25)
			If IsBetween(c, 0, 9) Then
				'OptionsShow ScrollTop + c
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsShow(ScrollTop + c - 2 * CShort(ScrollTop + c = 16)) ' [Titi 2.6.0] kept 16 to change worlds, but from the options menu, this has become "install packages" as #18...
				'UPGRADE_WARNING: Untranslated statement in OptionsClick. Please check source code.
			End If
			'    ElseIf PointIn(AtX, AtY, 340, 200, 90, 18) And (ScrollSelect = 11 Or ScrollSelect = 12 Or ScrollSelect = 13) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 340, 298, 90, 18) And (ScrollSelect >= 12 And ScrollSelect <= 16) Then  ' World change forgotten in 2.4.7 [Titi]
			' Back Interface or Dice Set or Change World or Keyboard Shortcuts
			If ButtonDown Then
				'            ShowButton picTomeNew, 340, 200, "Back", True
				ShowButton(picTomeNew, 340, 298, "Back", True) ' [Titi 2.4.9] moved to bottom to give space to display the world's details
				picTomeNew.Refresh()
				iItemTop = 0 ' [Titi 2.6.0] Re-used for world description display
				TargetAllowDead = 0
			Else
				'            ShowButton picTomeNew, 340, 200, "Back", False
				ShowButton(picTomeNew, 340, 298, "Back", False) ' [Titi 2.4.9] moved to bottom to give space to display the world's details
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in OptionsClick. Please check source code.
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsChange(ScrollSelect, -1)
			End If
			'    ElseIf PointIn(AtX, AtY, 435, 200, 90, 18) And (ScrollSelect = 11 Or ScrollSelect = 12 Or ScrollSelect = 13) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 435, 298, 90, 18) And (ScrollSelect >= 12 And ScrollSelect <= 16) Then  ' World change forgotten in 2.4.7 [Titi]
			' Next Interface or Dice Set or Change World or Keyboard Shortcuts
			If ButtonDown Then
				'            ShowButton picTomeNew, 435, 200, "Next", True
				ShowButton(picTomeNew, 435, 298, "Next", True) ' [Titi 2.4.9] moved to bottom to give space to display the world's details
				iItemTop = 0
				TargetAllowDead = 0
				picTomeNew.Refresh()
			Else
				'            ShowButton picTomeNew, 435, 200, "Next", False
				ShowButton(picTomeNew, 435, 298, "Next", False) ' [Titi 2.4.9] moved to bottom to give space to display the world's details
				picTomeNew.Refresh()
				'UPGRADE_WARNING: Untranslated statement in OptionsClick. Please check source code.
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsChange(ScrollSelect, 1)
			End If
			'    ElseIf PointIn(AtX, AtY, 53, 73, 276, 250) And (ScrollSelect = 14) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 53, 73, 276, 250) And (ScrollSelect = 17) Then  ' 14 is now used by the world change option
			' Splash/credit screen toggle
			'    End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 533, 135, 15, 72) And ScrollSelect = 16 Then 
			' scrollbar next to the world description
			WorldTemp = Worlds(WorldIndex)
			'        lResult = fReadValue(gAppPath & "\roster\" & WorldTemp.Name & "\" & WorldTemp.Name & ".ini", "World", "Description", "S", "No description available", sText)
			'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			lResult = fReadValue(gAppPath & "\roster\" & WorldTemp.Name & "\" & WorldTemp.Name & ".ini", "World", "DescriptionLines", "S", "1", sText)
			'        rc = fReadValue(FileName, "World", "Description" & Trim$(Str(ScrollWorldDesc + 1)), "S", "No description available", Text)
			'        WorldTemp.Description = Text
			'UPGRADE_ISSUE: picTomeNew was upgraded to a Panel, and cannot be coerced to a PictureBox. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="0FF1188E-27C0-4FED-842D-159C65894C9B"'
			If WorldScrollBarClick(AtX, AtY, ButtonDown, picTomeNew, 533, 135, 72, ScrollWorldDesc, Val(sText), 1) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				OptionsShow(ScrollSelect)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf ScrollSelect = 15 Then 
			X = AtX
			' change keyboard shortcuts
			If PointIn(AtX, AtY, 328, 169, 80, 127) Then ' first column
				c = CShort(AtY / 17) - 9
				Select Case c
					Case 1
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "Debug", IIf(KingdomIndex = 1, "Left", "Left"))
					Case 2
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "Exit", IIf(KingdomIndex = 1, "Up", "Up"))
					Case 3
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "Load", IIf(KingdomIndex = 1, "", ""))
					Case 4
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "Music", IIf(KingdomIndex = 1, "", "Journals & Quests"))
					Case 5
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "", IIf(KingdomIndex = 1, "", "Listen"))
					Case 6
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "", IIf(KingdomIndex = 1, "", "Skills"))
					Case 7
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "", IIf(KingdomIndex = 1, "", "Search"))
					Case 8
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "", IIf(KingdomIndex = 1, "", "Inventory"))
					Case Else
						sText = vbNullString
				End Select
			ElseIf PointIn(AtX, AtY, 444, 169, 80, 127) Then  ' second column
				c = CShort(AtY / 17) - 9
				Select Case c
					Case 1
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "Quit", IIf(KingdomIndex = 1, "Right", "Right"))
					Case 2
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "Speed", IIf(KingdomIndex = 1, "Down", "Down"))
					Case 3
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "Save", IIf(KingdomIndex = 1, "", ""))
					Case 4
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "Sound", IIf(KingdomIndex = 1, "", "Journals & Quests"))
					Case 5
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "", IIf(KingdomIndex = 1, "", "Talk"))
					Case 6
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "", IIf(KingdomIndex = 1, "", "Status"))
					Case 7
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "", IIf(KingdomIndex = 1, "", "Open"))
					Case 8
						'UPGRADE_WARNING: Couldn't resolve default property of object KingdomIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sText = IIf(KingdomIndex = 0, "", IIf(KingdomIndex = 1, "", "Equip"))
					Case Else
						sText = vbNullString
				End Select
			End If
			DialogSetUp(bdDlgReplyText)
			If sText <> "" Then
				DialogShow("", "Shortcut for " & sText)
				DialogHide()
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If DialogText <> vbNullString Then
					If Len(DialogText) > 1 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If UCase(VB.Left(DialogText & Space(4), 4)) = "CTRL" Then
							'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If VB.Right(Space(4) & DialogText, 4) = "left" Then
								code = System.Windows.Forms.Keys.Left + 200
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf VB.Right(Space(5) & DialogText, 5) = "right" Then 
								code = System.Windows.Forms.Keys.Right + 200
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf VB.Right(Space(2) & DialogText, 2) = "up" Then 
								code = System.Windows.Forms.Keys.Up + 200
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf VB.Right(Space(4) & DialogText, 4) = "down" Then 
								code = System.Windows.Forms.Keys.Down + 200
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								code = Asc(VB.Right(DialogText, 1)) + 200 - 32
							End If
							'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ElseIf UCase(VB.Left(DialogText & Space(5), 5)) = "SHIFT" Then 
							'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If VB.Right(Space(4) & DialogText, 4) = "left" Then
								code = System.Windows.Forms.Keys.Left + 100
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf VB.Right(Space(5) & DialogText, 5) = "right" Then 
								code = System.Windows.Forms.Keys.Right + 100
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf VB.Right(Space(2) & DialogText, 2) = "up" Then 
								code = System.Windows.Forms.Keys.Up + 100
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf VB.Right(Space(4) & DialogText, 4) = "down" Then 
								code = System.Windows.Forms.Keys.Down + 100
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								code = Asc(VB.Right(DialogText, 1)) + 100 - 32
							End If
						Else
							'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If VB.Right(Space(4) & DialogText, 4) = "left" Then
								code = System.Windows.Forms.Keys.Left
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf VB.Right(Space(5) & DialogText, 5) = "right" Then 
								code = System.Windows.Forms.Keys.Right
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf VB.Right(Space(2) & DialogText, 2) = "up" Then 
								code = System.Windows.Forms.Keys.Up
								'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf VB.Right(Space(4) & DialogText, 4) = "down" Then 
								code = System.Windows.Forms.Keys.Down
							End If
						End If
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						code = Asc(DialogText) - 32
					End If
					Select Case KingdomIndex
						Case 0
							If X < 444 Then
								'UPGRADE_WARNING: Couldn't resolve default property of object NotTwice(2 * c - 1, code). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If NotTwice(2 * c - 1, code) Then bdKey(2 * c - 1) = code
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object NotTwice(2 * c, code). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If NotTwice(2 * c, code) Then bdKey(2 * c) = code
							End If
						Case 1
							If X < 444 Then
								'UPGRADE_WARNING: Couldn't resolve default property of object NotTwice(8 + 2 * c - 1, code). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If NotTwice(8 + 2 * c - 1, code) Then bdKey(8 + 2 * c - 1) = code
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object NotTwice(8 + 2 * c, code). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If NotTwice(8 + 2 * c, code) Then bdKey(8 + 2 * c) = code
							End If
						Case 2
							If c = 4 Then ' Journals and Quests takes a full line
								'UPGRADE_WARNING: Couldn't resolve default property of object NotTwice(17, code). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								If NotTwice(17, code) Then bdKey(17) = code
							ElseIf c < 3 Then  ' still the odd/even counting
								If X < 444 Then
									'UPGRADE_WARNING: Couldn't resolve default property of object NotTwice(12 + 2 * c - 1, code). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									If NotTwice(12 + 2 * c - 1, code) Then bdKey(12 + 2 * c - 1) = code
								Else
									'UPGRADE_WARNING: Couldn't resolve default property of object NotTwice(12 + 2 * c, code). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									If NotTwice(12 + 2 * c, code) Then bdKey(12 + 2 * c) = code
								End If
							Else ' shortcuts AFTER J&Q become even/odd PLUS a line is skipped
								If X < 444 Then
									'UPGRADE_WARNING: Couldn't resolve default property of object NotTwice(12 + 2 * c - 4, code). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									If NotTwice(12 + 2 * c - 4, code) Then bdKey(12 + 2 * c - 4) = code
								Else
									'UPGRADE_WARNING: Couldn't resolve default property of object NotTwice(12 + 2 * c - 3, code). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									If NotTwice(12 + 2 * c - 3, code) Then bdKey(12 + 2 * c - 3) = code
								End If
							End If
					End Select
				End If
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			OptionsShow(ScrollSelect)
		End If
	End Sub
	
	Private Sub TurnCycleCreatureClear(ByRef CreatureX As Creature)
		Dim c As Short
		' If Frozen, then Frozen no longer
		CreatureX.Frozen = False
		CreatureX.Afraid = False
		' Rest the Creature
		CreatureX.ActionPoints = CreatureX.ActionPointsMax
		' Clear all Bonuses
		CreatureX.StrengthBonus = 0
		CreatureX.AgilityBonus = 0
		CreatureX.WillBonus = 0
		CreatureX.AttackBonus = 0
		CreatureX.DamageBonus = 0
		CreatureX.DefenseBonus = 0
		CreatureX.MovementCostBonus = 0
		CreatureX.CombatAttitude = 0
		CreatureX.OpportunityAttack = False
		For c = 0 To 8
			CreatureX.ResistanceBonus(c) = 0
		Next c
	End Sub
	
	Private Sub TurnCycleCreature(ByRef CreatureX As Creature)
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim NoFail, c As Short
		Dim ItemX, ItemY As Item
		Dim TriggerX As Trigger
		If picGrid.Visible = False Then
			' Fire Post-Turn Trigger on CreatureWithTurn
			If CreatureX.HPNow > 0 Then
				CreatureNow = CreatureX
				ItemNow = CreatureX.ItemInHand
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(CreatureX, bdPostTurn)
				For	Each ItemNow In CreatureX.Items
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ItemNow.IsReady = True Then
						CreatureNow = CreatureX
						'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = FireTriggers(ItemNow, bdPostTurn)
					End If
				Next ItemNow
			Else ' [Titi 2.6.0] allow some triggers to run even if the character is dead
				For	Each TriggerX In CreatureX.Triggers
					If TriggerX.DeadToo = True And TriggerX.TriggerType = bdPostTurn Then
						CreatureNow = CreatureX
						NoFail = FireTrigger(CreatureX, TriggerX)
					End If
				Next TriggerX
			End If
			' Clear all their statuses
			TurnCycleCreatureClear(CreatureX)
			' Fire Pre-Turn Trigger on CreatureWithTurn
			If CreatureX.HPNow > 0 Then
				CreatureNow = CreatureX
				ItemNow = CreatureX.ItemInHand
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(CreatureX, bdPreTurn)
				For	Each ItemNow In CreatureX.Items
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ItemNow.IsReady = True Then
						CreatureNow = CreatureX
						'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = FireTriggers(ItemNow, bdPreTurn)
					End If
				Next ItemNow
			Else ' [Titi 2.6.0] allow some triggers to run even if the character is dead
				For	Each TriggerX In CreatureX.Triggers
					If TriggerX.DeadToo = True And TriggerX.TriggerType = bdPreTurn Then
						CreatureNow = CreatureX
						NoFail = FireTrigger(CreatureX, TriggerX)
					End If
				Next TriggerX
			End If
		End If
		' Fire up Post-TurnCycle Triggers on CreatureWithTurn
		If CreatureX.HPNow > 0 Then
			CreatureNow = CreatureX
			ItemNow = CreatureX.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(CreatureX, bdPostTurnCycle)
			For	Each ItemNow In CreatureX.Items
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemNow.IsReady Then
					CreatureNow = CreatureX
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemNow, bdPostTurnCycle)
				End If
			Next ItemNow
		Else ' [Titi 2.6.0] allow some triggers to run even if the character is dead
			For	Each TriggerX In CreatureX.Triggers
				If TriggerX.DeadToo = True And TriggerX.TriggerType = bdPostTurnCycle Then
					CreatureNow = CreatureX
					NoFail = FireTrigger(CreatureX, TriggerX)
				End If
			Next TriggerX
		End If
		CreatureX.HadTurn = False
		' Remove Timed Triggers
		TurnCycleTimedTriggers(CreatureX)
		For	Each ItemNow In CreatureX.Items
			TurnCycleTimedTriggers(ItemNow)
		Next ItemNow
	End Sub
	
	Private Sub TurnCycle()
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim NoFail, c As Short
		Dim CreatureX As Creature
		' Change the time first
		TurnCycleTime()
		' Cycle the Rune Pool
		TurnCycleRunes()
		' Remove Timed Triggers
		TurnCycleTimedTriggers(Tome)
		' Cycle through entire Party
		For	Each CreatureX In Tome.Creatures
			TurnCycleCreature(CreatureX)
		Next CreatureX
		' Fire Post-TurnCycle Triggers on Encounter
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(EncounterNow, bdPostTurnCycle)
		' Remove Timed Triggers
		TurnCycleTimedTriggers(EncounterNow)
		' Cycle through all Creatures in the Encounter
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			TurnCycleCreature(CreatureX)
		Next CreatureX
		If picGrid.Visible = False Then
			MessageShow("", 0)
		End If
	End Sub
	
	Private Sub TurnCycleDemo()
		'more garbage
	End Sub
	
	Private Function IsRareRune(ByRef strRareList As Object, ByRef intRarity As Object) As Short
		Dim i As Short
		Dim Found As Boolean
		Dim sChar As String
		For i = 1 To Len(strRareList)
			'UPGRADE_WARNING: Couldn't resolve default property of object strRareList. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Mid(strRareList, i, 1) = "," Then
				' next rune, proceed with current one
				'UPGRADE_WARNING: Couldn't resolve default property of object intRarity. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Val(sChar) = intRarity Then
					' found, flag it
					Found = True
					Exit For
				End If
				sChar = ""
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object strRareList. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sChar = sChar & Mid(strRareList, i, 1)
			End If
		Next 
		If Found Then
			'UPGRADE_WARNING: Couldn't resolve default property of object intRarity. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			IsRareRune = intRarity
		Else
			IsRareRune = 0
		End If
	End Function
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub TurnCycleRunes()
		Dim Map_Renamed As Object
		Dim c, Found As Short
		' [Titi 2.6.0] use refresh rates and rarity lists from <world name>.txt file
		Dim strVeryRare, strCommon As String
		Dim intRate As Short
		Dim iNbAdded As Object
		strVeryRare = VB.Left(strRarityPattern, InStr(strRarityPattern, "|") - 1)
		strCommon = Mid(strRarityPattern, Len(strVeryRare) + 2)
		If Int(Rnd() * 10) > 8 Then
			'        For c = 0 To 19
			'            Found = False
			'            Select Case c Mod 4
			'                Case 0      ' Very Rare
			'                    If Int(Rnd * 10) < 1 - Map.Runes(c) Then
			'                        Found = True
			'                    End If
			'                Case 1, 2   ' Rare
			'                    If Int(Rnd * 10) < 2 - Map.Runes(c) Then
			'                        Found = True
			'                    End If
			'                Case 3      ' Common
			'                    If Int(Rnd * 10) < 3 - Map.Runes(c) Then
			'                        Found = True
			'                    End If
			'            End Select
			' [Titi 2.6.0] replace 19 by the number of runes
			For c = 0 To intNbRunes - 1
				Found = IsRareRune(strVeryRare, c + 1) = c + 1
				If Found = True Then
					intRate = intVeryRare
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Runes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object iNbAdded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					iNbAdded = System.Math.Abs(CInt(Map.Runes(c) < 1))
				Else
					Found = IsRareRune(strCommon, c + 1) = c + 1
					If Found = True Then
						intRate = intCommon
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Runes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object iNbAdded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						iNbAdded = System.Math.Abs(CInt(Map.Runes(c) < 3))
					Else
						intRate = intRare
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Runes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object iNbAdded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						iNbAdded = System.Math.Abs(CInt(Map.Runes(c) < 2))
					End If
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object iNbAdded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Int(Rnd() * 100) < intRate And iNbAdded > 0 Then
					'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
					BorderDrawSides(True, c)
					BorderDrawButtons(0)
					Me.Refresh()
					'UPGRADE_WARNING: Untranslated statement in TurnCycleRunes. Please check source code.
					' [Titi 2.6.0] Very rare = max 1, rare = max 2, common = max 3 at a time
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Runes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object iNbAdded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Map.Runes(c) = Map.Runes(c) + iNbAdded ' was 1
				End If
			Next c
			BorderDrawSides(True, -1)
			BorderDrawButtons(0)
			Me.Refresh()
			'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		End If
	End Sub
	
	Public Sub UpdateCreatureInfo(ByRef CreatureX As Creature, ByRef blnCombat As Boolean)
		Dim EncounterNow As Object
		Dim ItemX, ItemY As Item
		Dim c, NoFail As Short
		Dim TriggerX As Trigger
		Dim strBones As String
		If CreatureX.HPNow <= 0 Then
			' [Titi 2.6.0] dead can't walk => convert character into a container (corpse)
			ItemY = New Item
			ItemY.Name = "Dead body of " & CreatureX.Name
			If blnCombat = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.DiedOn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.KilledBy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemY.Comments = "This is the dead body of " & CreatureX.Name & ", killed by " & CreatureX.Infos.KilledBy & " on the fateful " & CreatureX.Infos.DiedOn & "."
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.DiedOn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemY.Comments = "This is the corpse of " & CreatureX.Name & IIf(CreatureX.Infos.DiedOn = "", ".", ", who was declared dead on the fateful " & CreatureX.Infos.DiedOn & ".")
			End If
			ItemY.UseDescription = True
			ItemY.SoftCapacity = True
			c = 0
			For	Each ItemX In CreatureX.Items
				' [Titi 2.6.3] the creature is dead, all items are unequipped
				ItemX.IsReady = False
				c = c + ItemX.Bulk
			Next ItemX
			' [Titi 2.6.3] if all items have no bulk, the corpse won't be considered as a container, hence let's add 1 to the capacity
			ItemY.Capacity = c + 1
			ItemY.Bulk = CreatureX.Bulk
			' let's give a weight to the corpse
			NoFail = 0
			For c = 0 To 4
				If CreatureX.Size(c) > 0 Then
					NoFail = c + 1
				End If
			Next 
			If NoFail = 0 Then NoFail = 3
			ItemY.Size = NoFail
			ItemY.Weight = CreatureX.Weight + 30 * NoFail
			For	Each ItemX In CreatureX.Items
				ItemY.AddItem.Copy(ItemX)
			Next ItemX
			strBones = CreatureX.PictureWhenDead
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			If Dir(gDataPath & "\Graphics\Creatures\" & strBones) = strBones Then
				ItemY.PictureFile = strBones
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			ElseIf Dir(gDataPath & "\Graphics\Items\" & strBones) = strBones Then 
				ItemY.PictureFile = strBones
			Else
				ItemY.PictureFile = "Dead body.bmp"
			End If
			TriggerX = New Trigger
			TriggerX.AddCreature.Copy(CreatureX)
			TriggerX.Comments = "Store " & CreatureX.Name & "'s info"
			TriggerX.Name = "Dead body"
			ItemY.AddTrigger.Copy(TriggerX)
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.AddItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			EncounterNow.AddItem.Copy(ItemY)
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub TurnCycleTime(Optional ByRef blnCombat As Boolean = False)
		Dim bdFontSmallWhite As Object
		Dim FireTriggers As Object
		Dim GlobalYearName As Object
		Dim GlobalMoonName As Object
		Dim GlobalDayName As Object
		Dim GlobalAutoCenter As Object
		Dim GlobalTurnName As Object
		Dim Darker As Object
		Dim Tome_Renamed As Object
		Dim c As Short
		Dim rc As Integer
		Dim CreatureX As Creature
		Dim SunChange, NoFail As Short
		Dim ItemX, ItemY As Item
		Dim TriggerX As Trigger
		' Update the Turn, Cycle, Moon, and Year
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.Turn = Tome.Turn + 1
		' [Titi 2.5.1] update the number of turns remaining before camp is allowed again
		TurnsBeforeNextCamp = TurnsBeforeNextCamp + CShort(TurnsBeforeNextCamp > 0)
		' [Titi 2.5.1] increase "age" of creatures - will be converted in moons and years later
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In Tome.Creatures
			If CreatureX.HPNow > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.Age. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureX.Infos.Age = CreatureX.Infos.Age + 1
			Else
				' [Titi 2.6.0] dead can't walk => convert character into a container (corpse)
				NoFail = False
				For	Each TriggerX In CreatureX.Triggers
					If TriggerX.Name = "Limited duration" Then NoFail = True
				Next TriggerX
				If NoFail = False Then ' he he... Someone died outside of combat!
					UpdateCreatureInfo(CreatureX, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Tome.Creatures.Remove("X" & CreatureX.Index)
					MenuDrawParty()
				End If
			End If
		Next CreatureX
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Tome.Turn > 200 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.Turn = 1
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Cycle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.Cycle = Tome.Cycle + 1
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Cycle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Tome.Cycle > 50 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Cycle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.Cycle = 1
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Moon. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.Moon = Tome.Moon + 1
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Moon. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Tome.Moon > 10 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Moon. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Tome.Moon = 1
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Year. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Tome.Year = Tome.Year + 1
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Year. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Tome.Year > 10000 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Year. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Tome.Year = 1
					End If
				End If
			End If
		End If
		' Update the darkness
		SunChange = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If (Tome.Turn > 169 Or Tome.Turn < 31) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Select Case Tome.Turn
				Case 30 ' Daylight
					SunChange = 0
				Case 23 To 29
					SunChange = 20
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Tome.Turn = 23 Then
						MessageShow("It's dawn....", 0)
					End If
				Case 170 To 176
					SunChange = 20
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Tome.Turn = 170 Then
						MessageShow("It's dusk....", 0)
					End If
				Case 177 To 185, 18 To 22
					SunChange = 40
				Case 186 To 199, 10 To 17
					SunChange = 60
				Case 200, 0 To 9
					SunChange = 80
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Tome.Turn = 200 Then
						MessageShow("It's midnight....", 0)
					End If
			End Select
			'UPGRADE_WARNING: Couldn't resolve default property of object Darker. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If SunChange <> Darker Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Darker. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Darker = SunChange
				'UPGRADE_WARNING: Couldn't resolve default property of object Darker. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				LoadTileSet(Darker, True)
				DrawMapAll()
				MessageClear()
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object Darker. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf Darker <> 0 Then 
			'UPGRADE_WARNING: Couldn't resolve default property of object Darker. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Darker = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object Darker. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			LoadTileSet(Darker, True)
			DrawMapAll()
			MessageClear()
		End If
		' Show current Date at the top of the screen
		' [Titi 2.6.0] Check if name is customized. If yes, don't change anything
		'GlobalTurnName = "Turn " & Tome.Turn
		'GlobalDayName = "Day " & Tome.Cycle
		'GlobalMoonName = "of Moon " & Tome.Moon
		'GlobalYearName = "in the Year " & Tome.Year
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTurnName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If (GlobalAutoCenter And 16) = 0 Then GlobalTurnName = "Turn " & Tome.Turn
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Cycle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDayName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If (GlobalAutoCenter And 32) = 0 Then GlobalDayName = "Day " & Tome.Cycle
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Moon. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalMoonName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If (GlobalAutoCenter And 64) = 0 Then GlobalMoonName = "of Moon " & Tome.Moon
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Year. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalYearName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If (GlobalAutoCenter And 128) = 0 Then GlobalYearName = "in the Year " & Tome.Year
		' Fire Post-TurnCycle Triggers on Party
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(Tome, bdPostTurnCycle)
		BorderDrawTop()
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalYearName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalMoonName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDayName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTurnName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(Me, 0, 2, Me.ClientRectangle.Width, 14, bdFontSmallWhite, " ( " & GlobalTurnName & " ) ( " & GlobalDayName & " " & GlobalMoonName & " " & GlobalYearName & " ) ", True, False)
		Me.Refresh()
		' [Titi 2.5.1] now is time to check if wandering monsters are nearby
		If picGrid.Visible = False And blnCombat = False And bFromMainMenu = True Then
			' however, if we're already in combat, or haven't moved, skip the check
			NoFail = CheckWanderingMonster(Map)
			blnCombat = NoFail
			bFromMainMenu = False
		End If
	End Sub
	
	Private Sub TurnCycleTimedTriggers(ByRef ObjectX As Object)
		Dim TriggerX As Trigger
		' Subtract Charges from Timed Triggers (and Destroy if < 1)
		'UPGRADE_WARNING: Couldn't resolve default property of object ObjectX.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each TriggerX In ObjectX.Triggers
			If TriggerX.IsTimed And TriggerX.Turns > 0 And Not TriggerX.IsSkill Then
				TriggerX.Turns = TriggerX.Turns - 1
				If TriggerX.Turns < 1 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ObjectX.RemoveTrigger. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ObjectX.RemoveTrigger("T" & TriggerX.Index)
				End If
			End If
		Next TriggerX
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Function DoorNearBy(ByRef AtX As Short, ByRef AtY As Short) As Object
		Dim Map_Renamed As Object
		Dim X, c, i, Y As Short
		' Look in all directions for a locked/door Tile
		'UPGRADE_WARNING: Couldn't resolve default property of object DoorNearBy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DoorNearBy = False
		For c = 1 To 3
			If c > 1 Then
				X = Greatest(Least(AtX + DirX(c), (Map.Width)), 0)
				Y = Greatest(Least(AtY + DirY(c), (Map.Height)), 0)
			Else
				X = AtX
				Y = AtY
			End If
			' Check all layers for a door
			For i = 0 To 2
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If DoorNearByTile(Map.Tile(i, X, Y)) = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object DoorNearBy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DoorNearBy = True
					Exit For
				End If
			Next i
			'UPGRADE_WARNING: Couldn't resolve default property of object DoorNearBy. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If DoorNearBy = True Then
				Exit For
			End If
		Next c
	End Function
	
	Private Function DoorNearByTile(ByRef Index As Short) As Short
		DoorNearByTile = False
		If Index > 0 Then
			'UPGRADE_WARNING: Untranslated statement in DoorNearByTile. Please check source code.
		End If
	End Function
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub DoorOpen(ByRef AtX As Short, ByRef AtY As Short)
		Dim Tome_Renamed As Object
		Dim DialogDM As Object
		Dim EncounterNow As Object
		Dim ItemNow As Object
		Dim FireTriggers As Object
		Dim CreatureNow As Object
		Dim GlobalPickLockChance As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetUp As Object
		Dim PlaySoundFile As Object
		Dim CreatureWithTurn As Object
		Dim Map_Renamed As Object
		Dim Y, i, c, X, Found As Short
		Dim NoFail, OpenIt As Short
		Dim EntryPointX As EntryPoint
		Dim TileX As Tile
		Dim ItemX As Item
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		' Look in all directions for a locked/door Tile
		Found = False
		For c = 1 To 3
			If c > 1 Then
				X = Greatest(Least(AtX + DirX(c), (Map.Width)), 0)
				Y = Greatest(Least(AtY + DirY(c), (Map.Height)), 0)
			Else
				X = AtX
				Y = AtY
			End If
			' Look at all levels
			For i = 0 To 2
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If DoorNearByTile(Map.Tile(i, X, Y)) = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TileX = Map.Tiles("L" & Map.Tile(i, X, Y))
					Found = True
					Exit For
				End If
			Next i
			If Found = True Then
				Exit For
			End If
		Next c
		' If Found a door, then attempt to Open/Unlock it
		If Found = True Then
			' If Locked, then attempt to unlock. Else, attempt to unstick it. Else open it.
			OpenIt = False
			If TileX.KeyBits > 0 Then
				' Try all keys on the current Creature
				Found = False
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemX In CreatureWithTurn.Items
					If ItemX.KeyBits > 0 Then
						'If (ItemX.KeyBits And TileX.KeyBits) = ItemX.KeyBits Then
						' [Titi 2.6.3] it's the door that takes precedence
						If (ItemX.KeyBits And TileX.KeyBits) = TileX.KeyBits Then
							Found = True
							Exit For
						End If
					End If
				Next ItemX
				' If found a key, then unlock it
				If Found = True Then
					Call PlaySoundFile("DoorUnlock", Tome)
					DialogSetUp(bdDlgNoReply)
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogShow(CreatureWithTurn, CreatureWithTurn.Name & " unlocked the door with the " & ItemX.Name & ".")
					DialogHide()
					OpenIt = True
				Else
					' Attempt a lock pick
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					GlobalPickLockChance = 0
					CreatureNow = CreatureWithTurn
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(CreatureWithTurn, bdPrePickLock)
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each ItemNow In CreatureWithTurn.Items
						'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If ItemNow.IsReady = True Then
							'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							NoFail = FireTriggers(ItemNow, bdPrePickLock)
						End If
					Next ItemNow
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(EncounterNow, bdPreUnlock)
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Int(Rnd() * 100) < GlobalPickLockChance Then
						Call PlaySoundFile("DoorUnlock", Tome)
						DialogSetUp(bdDlgNoReply)
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogShow(CreatureWithTurn, CreatureWithTurn.Name & " picked the lock on the door.")
						DialogHide()
						OpenIt = True
						'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ElseIf GlobalPickLockChance > 0 Then 
						'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Int(Rnd() * 100) > GlobalPickLockChance Then
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							DialogDM(CreatureWithTurn.Name & " attempted to pick the lock, but jammed it shut instead!")
							'                        TileX.Chance = 0  <-- [Titi 2.4.9] will not update the "chance to open" on the map!
							' [Titi 2.4.9] if door is jammed, make it appear so!
							'                        Map.Tiles("L" & Map.Tile(i, X, Y)).Chance = 0
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							Map.Tiles("L" & Map.Tile(i, X, Y)).Key = 0
						Else
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							DialogDM(CreatureWithTurn.Name & " failed to pick the lock on the door.")
							' [Titi 2.4.9] failure - it is now more difficult to pick the lock!
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							Map.Tiles("L" & Map.Tile(i, X, Y)).Chance = Map.Tiles("L" & Map.Tile(i, X, Y)).Chance - 5
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If Map.Tiles("L" & Map.Tile(i, X, Y)).Chance <= 0 Then
								' too many failures - only option now is to bash the door open...
								'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								Map.Tiles("L" & Map.Tile(i, X, Y)).Chance = Int(Rnd() * 100)
								'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								Map.Tiles("L" & Map.Tile(i, X, Y)).Key = 0
							End If
						End If
					Else
						DialogDM("The door is locked.")
					End If
				End If
			ElseIf IsBetween(TileX.Chance, 1, 99) Then 
				' Try to open a stuck door
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Strength. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Int(Rnd() * 100) - CreatureWithTurn.Strength < TileX.Chance Then
					Call PlaySoundFile("Door", Tome)
					DialogSetUp(bdDlgNoReply)
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogShow(CreatureWithTurn, CreatureWithTurn.Name & " bashed the door open.")
					DialogHide()
					OpenIt = True
				Else
					DialogDM("The door is stuck shut.")
				End If
			Else
				' Open a plain door (not locked or stuck)
				Call PlaySoundFile("Door", Tome)
				OpenIt = True
			End If
			If OpenIt = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(EncounterNow, bdPreOpen)
				If NoFail Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Map.Tile(i, X, Y) = TileX.SwapTile
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					MovePartySet(0, 0, Tome.MapX, Tome.MapY)
				End If
			End If
		Else ' Look for EntryPoint to Exit
			MovePartyExit()
		End If
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Private Sub ParseShortCuts(ByRef KeyCode As Short, ByRef Shift As Short)
		Dim bdKey As Object
		' [Titi 2.4.9] added for user-defined Shortcuts
		Dim i As Short
		For i = 1 To 25
			'UPGRADE_WARNING: Couldn't resolve default property of object bdKey(i). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If bdKey(i) = KeyCode + 100 * Shift Then
				Select Case i
					Case 1
						KeyBoardShortCuts(System.Windows.Forms.Keys.D, 2)
					Case 2
						KeyBoardShortCuts(System.Windows.Forms.Keys.Q, 2)
					Case 3
						KeyBoardShortCuts(System.Windows.Forms.Keys.X, 2)
					Case 4
						KeyBoardShortCuts(System.Windows.Forms.Keys.Z, 2)
					Case 5
						KeyBoardShortCuts(System.Windows.Forms.Keys.L, 2)
					Case 6
						KeyBoardShortCuts(System.Windows.Forms.Keys.S, 2)
					Case 7
						KeyBoardShortCuts(System.Windows.Forms.Keys.M, 2)
					Case 8
						KeyBoardShortCuts(System.Windows.Forms.Keys.W, 2)
					Case 9
						KeyBoardShortCuts(System.Windows.Forms.Keys.Left, 1)
					Case 10
						KeyBoardShortCuts(System.Windows.Forms.Keys.Right, 1)
					Case 11
						KeyBoardShortCuts(System.Windows.Forms.Keys.Up, 1)
					Case 12
						KeyBoardShortCuts(System.Windows.Forms.Keys.Down, 1)
					Case 13
						KeyBoardShortCuts(System.Windows.Forms.Keys.Left, 0)
					Case 14
						KeyBoardShortCuts(System.Windows.Forms.Keys.Right, 0)
					Case 15
						KeyBoardShortCuts(System.Windows.Forms.Keys.Up, 0)
					Case 16
						KeyBoardShortCuts(System.Windows.Forms.Keys.Down, 0)
					Case 17
						KeyBoardShortCuts(System.Windows.Forms.Keys.J, 0)
					Case 18
						KeyBoardShortCuts(System.Windows.Forms.Keys.L, 0)
					Case 19
						KeyBoardShortCuts(System.Windows.Forms.Keys.T, 0)
					Case 20
						KeyBoardShortCuts(System.Windows.Forms.Keys.K, 0)
					Case 21
						KeyBoardShortCuts(System.Windows.Forms.Keys.Z, 0)
					Case 22
						KeyBoardShortCuts(System.Windows.Forms.Keys.S, 0)
					Case 23
						KeyBoardShortCuts(System.Windows.Forms.Keys.O, 0)
					Case 24
						KeyBoardShortCuts(System.Windows.Forms.Keys.I, 0)
					Case 25
						KeyBoardShortCuts(System.Windows.Forms.Keys.E, 0)
				End Select
			End If
		Next i
		If KeyCode = System.Windows.Forms.Keys.Return Or KeyCode = System.Windows.Forms.Keys.Escape Then KeyBoardShortCuts(KeyCode, 0)
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub KeyBoardShortCuts(ByRef KeyCode As Short, ByRef Shift As Short)
		Dim ButtonList As Object
		Dim ConvoAction As Object
		Dim JournalShow As Object
		Dim JournalEntryLoad As Object
		Dim JournalCombatLoad As Object
		Dim JournalQuestsLoad As Object
		Dim JournalMode As Object
		Dim bdInvItems As Object
		Dim bdInvStatus As Object
		Dim InvTopIndex As Object
		Dim CreatureWithTurn As Object
		Dim DialogDM As Object
		Dim Tome_Renamed As Object
		Dim bdTomeSaves As Object
		Dim TomeAction As Object
		Dim bdTomeSaveAs As Object
		If (Shift And VB6.ShiftConstants.CtrlMask) > 0 Then
			Select Case KeyCode
				Case System.Windows.Forms.Keys.D
					GlobalDebugMode = 1
				Case System.Windows.Forms.Keys.Q
					GameEnd(True)
				Case System.Windows.Forms.Keys.S
					TomeSavesLoad()
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaveAs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeAction = bdTomeSaveAs
					TomeSavesList(0)
				Case System.Windows.Forms.Keys.L
					TomeSavesLoad()
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeSaves. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeAction = bdTomeSaves
					TomeSavesList(1)
				Case System.Windows.Forms.Keys.M
					PlayMusicState()
				Case System.Windows.Forms.Keys.W
					PlaySoundState()
				Case System.Windows.Forms.Keys.X
					GameEnd(True)
				Case System.Windows.Forms.Keys.Z
					GameSpeed(1)
			End Select
		ElseIf Shift Then 
			Select Case KeyCode
				Case System.Windows.Forms.Keys.Left
					ScrollMap(-1, -1)
				Case System.Windows.Forms.Keys.Right
					ScrollMap(1, 1)
				Case System.Windows.Forms.Keys.Up
					ScrollMap(1, -1)
				Case System.Windows.Forms.Keys.Down
					ScrollMap(-1, 1)
			End Select
		Else
			Select Case KeyCode
				Case System.Windows.Forms.Keys.Left
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					MovePartySet(0, 0, Tome.MapX - 1, Tome.MapY)
				Case System.Windows.Forms.Keys.Right
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					MovePartySet(0, 0, Tome.MapX + 1, Tome.MapY)
				Case System.Windows.Forms.Keys.Up
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					MovePartySet(0, 0, Tome.MapX, Tome.MapY - 1)
				Case System.Windows.Forms.Keys.Down
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					MovePartySet(0, 0, Tome.MapX, Tome.MapY + 1)
				Case System.Windows.Forms.Keys.W ' Wait
					If picGrid.Visible = True Then
						CombatWait()
					End If
				Case System.Windows.Forms.Keys.L ' Listen
					If picGrid.Visible = False Then
						DoorListen()
					End If
				Case System.Windows.Forms.Keys.T ' Talk
					TalkSetup()
				Case System.Windows.Forms.Keys.K ' Skills
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.HPNow > 0 Then
						MenuSkillLoad()
						MenuSkillShow(1)
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogDM(CreatureWithTurn.Name & " is dead.")
					End If
				Case System.Windows.Forms.Keys.Z ' Status
					'UPGRADE_WARNING: Couldn't resolve default property of object InvTopIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvTopIndex = 0
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvStatus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InventoryShow(bdInvStatus)
					picInventory.Visible = True
					picInventory.BringToFront()
					picInventory.Focus()
				Case System.Windows.Forms.Keys.E ' Equip
					'UPGRADE_WARNING: Couldn't resolve default property of object InvTopIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvTopIndex = 0
					'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InventoryShow(bdInvItems)
					picInventory.Visible = True
					picInventory.BringToFront()
					picInventory.Focus()
				Case System.Windows.Forms.Keys.S
					MenuNow = bdMenuSearch
					DoAction(bdMenuActionDefault)
				Case System.Windows.Forms.Keys.I
					MenuNow = bdMenuInventory
					DoAction(bdMenuActionDefault)
				Case System.Windows.Forms.Keys.J
					Select Case JournalMode
						Case 1 ' Quests
							JournalQuestsLoad()
						Case 2 ' Map
						Case 3 ' Combat log
							JournalCombatLoad(False)
						Case Else ' Journal Entries
							JournalEntryLoad()
					End Select
					JournalShow()
				Case System.Windows.Forms.Keys.O
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DoorOpen(Tome.MapX, Tome.MapY)
					'            Case vbKeyD
				Case System.Windows.Forms.Keys.Return
					'UPGRADE_WARNING: Couldn't resolve default property of object ButtonList(0). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ButtonList(0) = "Save" Then
						'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ConvoAction = 1
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ConvoAction = 0
					End If
				Case System.Windows.Forms.Keys.Escape
					If picGrid.Visible = True And (MenuNow = bdMenuTargetCreature Or MenuNow = bdMenuTargetAny Or MenuNow = bdMenuTargetParty) Then
						'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ConvoAction = 0
						MenuNow = bdMenuDefault
						CombatDraw()
					Else
						MenuShow()
					End If
			End Select
		End If
	End Sub
	
	Private Sub ExamineItem(ByRef ItemX As Item)
		Dim DialogHide As Object
		Dim ConvoAction As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim ItemTarget As Object
		Dim GlobalPickLockChance As Object
		Dim DialogDM As Object
		Dim DialogItem As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureWithTurn As Object
		Dim CreatureNow As Object
		Dim NoFail, Found As Short
		Dim TriggerX As Trigger
		Dim ItemZ As Item
		Dim blnOpen As Boolean
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim sTxt, Text_Renamed, strSize As String
		Dim c As Short
		Dim bAlreadyExamined As Boolean
		bAlreadyExamined = ItemX.Examined
		SearchTraps()
		' [Titi 2.4.9b] show size
		Select Case ItemX.Size
			Case 1
				strSize = " tiny "
			Case 2
				strSize = " small "
			Case 3
				strSize = " medium "
			Case 4
				strSize = " large "
			Case 5
				strSize = " huge "
		End Select
		CreatureNow = CreatureWithTurn
		ItemNow = ItemX
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(CreatureNow, bdPreExamine)
		CreatureNow = CreatureWithTurn
		ItemNow = ItemX
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(ItemX, bdPreExamine)
		If NoFail Then
			If ItemX.UseDescription = True Then
				' [Titi 2.4.9b] Why show either description or general comments?
				'            DialogItem ItemX, ItemX.Comments
				sTxt = ItemX.Comments & vbCrLf
			End If
			'        ElseIf ItemX.WearType < 10 Then   ' Potential Armor
			If ItemX.WearType < 10 Then ' Potential Armor
				Select Case ItemX.WearType
					Case 0 ' Body
						Text_Renamed = "on the body"
					Case 1 ' Helm
						Text_Renamed = "on the head"
					Case 2 ' Glove
						Text_Renamed = "on the hand"
					Case 3 ' Bracelet
						Text_Renamed = "on the wrist"
					Case 4 ' BackPack
						Text_Renamed = "on the back"
					Case 5 ' Shield
						Text_Renamed = "on the arm"
					Case 6 ' Boots
						Text_Renamed = "on the feet"
					Case 7 ' Necklace
						Text_Renamed = "around the neck"
					Case 8 ' Belt
						Text_Renamed = "around the waist"
					Case 9 ' Ring
						Text_Renamed = "on a finger"
				End Select
				' [Titi 2.4.9b] Backpacks are armors too. Check if the player wants to open it (use)
				' DialogItem ItemX, sTxt & "This " & ItemX.Name & " is worn " & Text & " and absorbs up to " & ItemX.Resistance & "% damage."
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Text_Renamed = Text_Renamed & IIf(CreatureWithTurn.Level >= ItemX.MinLevel, " and absorbs up to " & ItemX.Resistance & "% damage", "")
				If ItemX.Defense <> 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.Level >= ItemX.MinLevel + System.Math.Abs(ItemX.Defense) Or bAlreadyExamined Then
						Text_Renamed = Text_Renamed & IIf(ItemX.Defense < 0, ", but degrades", ", also improves") & " its wearer's Defense by " & System.Math.Abs(ItemX.Defense) & "."
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Text_Renamed = Text_Renamed & ". " & CreatureWithTurn.Name & " feels there is more to discover."
					End If
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogItem(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				blnOpen = (DialogItem(ItemX, sTxt & "This " & ItemX.Name & " is worn " & Text_Renamed & IIf((ItemX.SizeBit(9) And 512), vbCrLf & "Although " & strSize & " in size, it can be used by anyone.", ""), True) = 0)
			ElseIf ItemX.Damage > 0 Or (ItemX.Family > 4 And ItemX.Family < 10) Then  ' Potential Weapon
				' [Titi 2.4.9b] Added the food family
				If ItemX.Family <> 3 Then
					Text_Renamed = (ItemX.Damage - 1) Mod 5 + 1 & "d" & Int(((ItemX.Damage - 1) Mod 25) / 5) * 2 + 4
					If ItemX.Damage - 1 > 24 Then
						Text_Renamed = Text_Renamed & "+" & Int((ItemX.Damage - 1) / 25)
					End If
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ItemX.DamageBonus <> 0 And (CreatureWithTurn.Level >= ItemX.MinLevel + System.Math.Abs(ItemX.DamageBonus) Or bAlreadyExamined) Then
						Text_Renamed = Text_Renamed & " with " & IIf(ItemX.DamageBonus > 0, "+", "-") & System.Math.Abs(ItemX.DamageBonus) & IIf(ItemX.DamageBonus > 0, " bonus", " penalty")
					End If
					Text_Renamed = Text_Renamed & " in damage"
				Else
					Text_Renamed = Text_Renamed & "some sort of food"
				End If
				' [Titi 2.4.9b] more details available!
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemX.AttackBonus <> 0 And (CreatureWithTurn.Level >= ItemX.MinLevel + System.Math.Abs(ItemX.AttackBonus) Or bAlreadyExamined) Then
					Text_Renamed = Text_Renamed & " and gives a " & IIf(ItemX.AttackBonus < 0, "-", "+") & System.Math.Abs(ItemX.AttackBonus) & IIf(ItemX.AttackBonus < 0, " penalty", " bonus") & " in attack"
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ItemX.Defense <> 0 And (CreatureWithTurn.Level >= ItemX.MinLevel + System.Math.Abs(ItemX.Defense) Or bAlreadyExamined) Then
					Text_Renamed = Text_Renamed & IIf(ItemX.Defense < 0, "but degrades", ", also improves") & " its wearer's Defense by " & System.Math.Abs(ItemX.Defense)
				End If
				If ItemX.WearType = 11 Then ' Two-Handed
					'DialogItem ItemX, sTxt & "This " & ItemX.NameText & " requires two hands to use" & IIf(CreatureWithTurn.Level >= ItemX.MinLevel, " and does " & Text & ".", "."), True
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sTxt = sTxt & "This " & ItemX.NameText & " requires two hands to use" & IIf(CreatureWithTurn.Level >= ItemX.MinLevel Or bAlreadyExamined, " and does " & Text_Renamed & ".", ".")
				Else
					'DialogItem ItemX, sTxt & IIf(CreatureWithTurn.Level >= ItemX.MinLevel, "This " & ItemX.NameText & " does " & Text & ".", CreatureWithTurn.Name & " is not experienced enough to discover more about the " & ItemX.Name & "."), True
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sTxt = sTxt & IIf(CreatureWithTurn.Level >= ItemX.MinLevel Or bAlreadyExamined, "This " & ItemX.NameText & IIf(ItemX.Family = 3, " is ", " does ") & Text_Renamed & ".", CreatureWithTurn.Name & " is not experienced enough to discover more about the " & ItemX.Name & ".")
				End If
				If Not bAlreadyExamined Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.Level < ItemX.MinLevel Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sTxt = sTxt & CreatureWithTurn.Name & " is not experienced enough to discover more about the " & ItemX.Name & "."
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ElseIf CreatureWithTurn.Level < ItemX.MinLevel + Greatest(System.Math.Abs(ItemX.Defense), System.Math.Abs(ItemX.AttackBonus)) And (ItemX.Defense <> 0 Or ItemX.AttackBonus <> 0) Then 
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sTxt = sTxt & " " & CreatureWithTurn.Name & " feels there is more to discover."
					End If
				End If
				DialogItem(ItemX, sTxt, True)
				' [Titi 2.4.9b] why weren't the descriptions of containers never displayed?
				'        ElseIf ItemX.Capacity = 0 Then
			Else
				'            DialogItem ItemX, CreatureWithTurn.Name & " sees nothing unusual about the " & ItemX.Name & "."
				' [Titi 2.6.0] Dead bodies are not really containers!
				' sTxt = sTxt & IIf(CreatureWithTurn.Level >= ItemX.MinLevel, IIf(ItemX.Capacity > 0, "The " & ItemX.NameText & " can store items up to" & strSize & "size.", ""), CreatureWithTurn.Name & " sees nothing unusual about the " & ItemX.Name & ".")
				If ItemX.PictureFile <> "Dead body.bmp" Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sTxt = sTxt & IIf(CreatureWithTurn.Level >= ItemX.MinLevel, IIf(ItemX.Capacity > 0, "The " & ItemX.NameText & " can store items up to" & strSize & "size.", ""), CreatureWithTurn.Name & " sees nothing unusual about the " & ItemX.Name & ".")
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogItem(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				blnOpen = (DialogItem(ItemX, sTxt, True) = 0)
			End If
			' Open the Item (if applicable)
			' [Titi 2.4.9b] You'll need to use the container to use it!
			'        If ItemX.Capacity > 0 Then
			If ItemX.Capacity > 0 And blnOpen Then
				' Unlock the Item if Locked
				If SetUpItemFamily((ItemX.Family)) = "Locked" Or SetUpItemFamily((ItemX.Family)) = "Jammed Shut" Then
					' Try to find a key on the CreatureWithTurn
					Found = False
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each ItemZ In CreatureWithTurn.Items
						If ItemZ.KeyBits > 0 Then
							' Make sure KeyBits match, not the same Item and the Key does not have Capacity (so is not another chest with same lock).
							If (ItemZ.KeyBits And ItemX.KeyBits) = ItemZ.KeyBits And (ItemZ.Index <> ItemX.Index Or ItemZ.Name <> ItemX.Name) And ItemZ.Capacity = 0 Then
								Found = True
								Exit For
							End If
						End If
					Next ItemZ
					' If found a key, open the Item
					If Found = True Then
						ItemX.Family = bdNone
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DialogDM(CreatureWithTurn.Name & " unlocked the " & ItemX.Name & " with the " & ItemZ.Name & ".")
					Else
						' Else try to pick the lock or bash it open
						'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						GlobalPickLockChance = 0
						' If Jammed Shut, then chance is -100
						If SetUpItemFamily((ItemX.Family)) = "Jammed Shut" Then
							'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							GlobalPickLockChance = -100
						End If
						CreatureNow = CreatureWithTurn
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ItemNow = CreatureWithTurn.ItemInHand
						ItemTarget = ItemX
						'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = FireTriggers(CreatureNow, bdPrePickLock)
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						For	Each ItemNow In CreatureWithTurn.Items
							'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.IsReady. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If ItemNow.IsReady = True Then
								'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								NoFail = FireTriggers(ItemNow, bdPrePickLock)
							End If
						Next ItemNow
						CreatureNow = CreatureWithTurn
						ItemNow = ItemX
						'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = FireTriggers(ItemNow, bdPreUnlock)
						'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If GlobalPickLockChance > 0 Then
							DialogSetUp(bdDlgNoReply)
							DialogSetButton(3, "Bash")
							DialogSetButton(2, "Pick")
							DialogSetButton(1, "Done")
						Else
							DialogSetUp(bdDlgNoReply)
							DialogSetButton(2, "Bash")
							DialogSetButton(1, "Done")
						End If
						DialogShow("DM", "The " & ItemX.Name & " is locked.")
						'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If ConvoAction = 0 Then
							' If you attempt to bash, then you could damage the contents
							For	Each ItemZ In ItemX.Items
								If Mid(ItemX.Name, 1, 7) = "Damaged" Then
									ItemX.RemoveItem("I" & ItemZ.Index)
									ItemX.AddItem.Name = "Damaged Junk"
								ElseIf SetUpItemFamily((ItemZ.Family)) = "Fragile" Then 
									If Int(Rnd() * 100) < 50 Then
										ItemZ.Value = 1
										ItemZ.Name = "Damaged " & ItemZ.Name
									End If
								ElseIf SetUpItemFamily((ItemZ.Family)) <> "Durable" And ItemZ.IsMoney = False Then 
									If Int(Rnd() * 100) < 10 Then
										ItemZ.Value = 1
										ItemZ.Name = "Damaged " & ItemZ.NameText
									End If
								End If
							Next ItemZ
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Strength. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If Int(Rnd() * 100) < CreatureWithTurn.Strength * 2 Then
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								DialogDM(CreatureWithTurn.Name & " successfully bashed open the " & ItemX.Name & ".")
								ItemX.Family = bdNone
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								DialogDM(CreatureWithTurn.Name & " failed to bash open the " & ItemX.Name & ".")
							End If
							'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ElseIf GlobalPickLockChance > 0 And ConvoAction = 1 Then 
							'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If Int(Rnd() * 100) < GlobalPickLockChance Then
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								DialogDM(CreatureWithTurn.Name & " successfully picked the lock on the " & ItemX.Name & ".")
								ItemX.Family = bdNone
								'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ElseIf Int(Rnd() * 100) > GlobalPickLockChance Then 
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								DialogDM(CreatureWithTurn.Name & " failed to pick the lock and jams shut the " & ItemX.Name & "!")
								ItemX.Family = 16 ' Jammed Shut
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								DialogDM(CreatureWithTurn.Name & " failed to pick the lock on the " & ItemX.Name & ".")
							End If
						End If
					End If
					' Open the Item if not Locked
					If SetUpItemFamily((ItemX.Family)) <> "Locked" And SetUpItemFamily((ItemX.Family)) <> "Jammed Shut" Then
						' [Titi 2.5.1] Now, we can open the item
						'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = FireTriggers(ItemX, bdPreOpen)
						If NoFail Then
							InventoryContainerShow(ItemX)
						End If
					End If
				ElseIf SetUpItemFamily((ItemX.Family)) = "Armor" Then 
					' [Titi 2.4.9b] Special case: backpacks are armors and containers!
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemX, bdPreOpen)
					If NoFail Then
						InventoryContainerShow(ItemX)
					End If
				Else
					' [Titi 2.4.9b] now, we're dealing with standard bags. Let's open them anyway!
					'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					NoFail = FireTriggers(ItemX, bdPreOpen)
					If NoFail Then
						InventoryContainerShow(ItemX)
					End If
				End If
			End If
			' [Titi 2.4.9b] Item fully examined when all bonuses are known, i.e. when examiner's level exceeds the item level plus its greatest bonus
			c = Greatest(System.Math.Abs(ItemX.AttackBonus), System.Math.Abs(ItemX.Defense))
			Found = Greatest(c, System.Math.Abs(ItemX.DamageBonus))
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Level. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemX.Examined = ((CreatureWithTurn.Level >= ItemX.MinLevel + c) Or bAlreadyExamined)
			DialogHide()
			CreatureNow = CreatureWithTurn
			ItemNow = ItemX
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(ItemX, bdPostExamine)
			CreatureNow = CreatureWithTurn
			ItemNow = ItemX
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(CreatureNow, bdPostExamine)
		End If
	End Sub
	
	Private Sub InventoryContainerShow(ByRef ContainerX As Item)
		Dim bdFontSmallWhite As Object
		Dim ItemPicHeight As Object
		Dim ItemPicWidth As Object
		Dim InvTooMany As Object
		Dim InvC As Object
		Dim bdFontElixirWhite As Object
		Dim InvContainer As Object
		Dim c, yOffSet As Short
		Dim rc As Integer
		Dim ItemX As Item
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, X, Y, Height_Renamed As Short
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		' If a Container is already open, close it first
		If picContainer.Visible = True Then
			InventoryContainerClose()
		End If
		' Set up the new container
		InvContainer = ContainerX
		'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvContainer.Selected = True
		'UPGRADE_ISSUE: PictureBox method picContainer.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picContainer.Cls()
		' Show header
		'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picContainer, 0, 12, picContainer.Width, 14, bdFontElixirWhite, InvContainer.Name, True, False)
		' Clear current locations
		For c = 0 To 80
			'UPGRADE_WARNING: Couldn't resolve default property of object InvC(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvC(c) = -1
		Next c
		' Show all Items (those with a spot first, without a spot second)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvTooMany = False
		'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemX In InvContainer.Items
			If ItemX.Selected = False Then
				LoadItemPic(ItemX)
				'UPGRADE_WARNING: Couldn't resolve default property of object InvC(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryFindSpot(ItemX, 1, 80, 8, InvC())
				' Draw Item in Inventory (if have a spot to display)
				If ItemX.InvSpot > 0 Then
					' Configure Width and Height
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Width_Renamed = ItemPicWidth(ItemX.Pic)
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Height_Renamed = ItemPicHeight(ItemX.Pic)
					' Set location on Search box
					X = 23 + ((ItemX.InvSpot - 1) Mod 8) * 34
					Y = 45 + Int((ItemX.InvSpot - 1) / 8) * 34
					' Paint the Item picture
					'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picContainer.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picContainer.hdc, X, Y, Width_Renamed, Height_Renamed - yOffSet, picItem.hdc, 64 * ItemX.Pic - 64, 96, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picContainer.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picContainer.hdc, X, Y, Width_Renamed, Height_Renamed - yOffSet, picItem.hdc, 64 * ItemX.Pic - 64, 0, SRCPAINT)
					If ItemX.Capacity > 0 And yOffSet = 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picContainer, X, Y, Width_Renamed, 10, bdFontSmallWhite, "(" & ItemX.Items.Count() & ")", 1, False)
					End If
					If ItemX.Count > 1 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picContainer, X, Y + Height_Renamed - 10, Width_Renamed, 10, bdFontSmallWhite, CStr(ItemX.Count), True, False)
					End If
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					InvTooMany = True
				End If
			End If
		Next ItemX
		' Show Buttons
		'UPGRADE_WARNING: Couldn't resolve default property of object InvTooMany. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If InvTooMany = True Then
			ShowButton(picContainer, picSearch.ClientRectangle.Width - 294, picSearch.ClientRectangle.Height - 30, "More", False)
		End If
		ShowButton(picContainer, picSearch.ClientRectangle.Width - 198, picSearch.ClientRectangle.Height - 30, "Empty", False)
		ShowButton(picContainer, picSearch.ClientRectangle.Width - 102, picSearch.ClientRectangle.Height - 30, "Done", False)
		picContainer.Left = 0
		picContainer.Top = Me.ClientRectangle.Height - 48 - picMenu.ClientRectangle.Height - picContainer.ClientRectangle.Height
		' Search gets the focus however
		picContainer.Visible = True
		picContainer.BringToFront()
		picContainer.Focus()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Function DropItem(ByRef FromChar As Creature, ByRef FromList As Short, ByRef FromContainer As Short, ByRef ItemToDrop As Item) As Short
		Dim Tome_Renamed As Object
		Dim Map_Renamed As Object
		Dim EncounterNow As Object
		Dim bdInvContainer As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim c, NoFail As Short
		Dim ItemX As Item
		' Set up for Triggers
		CreatureNow = FromChar
		ItemNow = ItemToDrop
		' Unready (if necessary)
		DropItem = UnReadyItem(FromChar, ItemToDrop)
		If DropItem = False Then
			Exit Function
		End If
		CreatureNow = FromChar
		ItemNow = ItemToDrop
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(ItemToDrop, bdPreDropItem)
		If NoFail Then
			' If above checks ok, drop item between characters/lists
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If FromList = bdInvContainer Then
				'            Containers("I" & FromContainer - 1).ItemX.RemoveItem "I" & ItemToDrop.Index
			Else
				FromChar.RemoveItem("I" & ItemToDrop.Index)
			End If
			' Create encounter on map if necessary
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Map.EncPointer(Tome.MapX, Tome.MapY) = 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.AddEncounter. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				EncounterNow = Map.AddEncounter
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Map.EncPointer(Tome.MapX, Tome.MapY) = EncounterNow.Index
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.AddItem. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemX = EncounterNow.AddItem
			ItemX.Copy(ItemToDrop)
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PositionItem(Map, EncounterNow, ItemX)
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(ItemToDrop, bdPostDropItem)
			DropItem = True
		Else
			DropItem = False
		End If
	End Function
	
	Private Function DestroyItem(ByRef FromChar As Creature, ByRef ItemToDestroy As Item) As Short
		' Unready (if necessary)
		If UnReadyItem(FromChar, ItemToDestroy) Then
			' If above checks ok, drop item between characters/lists
			FromChar.RemoveItem("I" & ItemToDestroy.Index)
			DestroyItem = True
		Else
			DestroyItem = False
		End If
	End Function
	
	Private Sub GameEnd(ByRef AskToEnd As Short)
		Dim ConvoAction As Object
		Dim PlayMusic As Object
		Dim TomeMenu As Object
		Dim Frozen As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim c As Short
		' Ask if really wish to stop
		picMainMenu.Visible = False
		If AskToEnd = True Then
			DialogSetUp(bdDlgNoReply)
			DialogSetButton(1, "No")
			DialogSetButton(2, "Yes")
			DialogShow("DM", "Do you really wish to quit this game?")
			DialogHide()
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ConvoAction = 0 Or AskToEnd = False Then
			GameClear()
			' Back to Main Menu
			'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
			picMenu.Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Frozen = True
			'UPGRADE_ISSUE: Form method frmMain.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			frmMain.Cls()
			BorderDrawAll(False)
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeMenu = bdNone
			picMainMenu.Visible = True
			Call PlayMusic(WorldNow.IntroMusic, Me, WorldNow.MusicFolder)
			Me.Refresh()
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Frozen = False
		End If
	End Sub
	
	Private Sub GameClear()
		Dim EncounterNow As Object
		Dim oGameMusic As Object
		Dim c As Short
		' If in Combat, then End it
		If picGrid.Visible = True Then
			CombatEnd(False)
		End If
		' Stop current song that is playing
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		MessageShow("Clearing Map.", 0)
		'MediaPlayerMusic.Stop
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.StopPlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oGameMusic.StopPlay()
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.mciClose. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call oGameMusic.mciClose(True)
		'    c = mciSendString("close songnow", 0&, 0, 0)
		' Clear Map and CreatureWithTurn Pics
		'UPGRADE_ISSUE: PictureBox method picMap.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picMap.Cls()
		' Hide any stray DialogBrief
		picDialogBrief.Visible = False
		tmrDialogBrief.Enabled = False
		' Reset Tome, Area and Map
		Tome = New Tome
		MessageShow("Clearing Map..", 0)
		Area = New Area
		MessageShow("Clearing Map...", 0)
		Map = New Map
		MessageShow("Clearing Map....", 0)
		EncounterNow = New Encounter
	End Sub
	
	Public Sub PlaySFXItem(ByRef CreatureX As Creature)
		Dim PlaySoundFile As Object
		Dim ItemX As Item
		ItemX = CreatureX.ItemInHand
		If ItemX.IsShooter = True And CreatureX.ItemMaxRange > 1 Then
			If ItemX.ShootType = 0 Or ItemX.ShootType = 1 Then ' Arrow (Short/Long) for Ammo
				Call PlaySoundFile("arrow.wav", Tome)
				PlaySFX("arrow.bmp", bdSFXFromCenter, bdSFXFling, bdSFXFast, 0)
			ElseIf ItemX.ShootType = 2 Or ItemX.ShootType = 3 Then  ' Sling/Illusion
			ElseIf ItemX.ShootType = 4 Or ItemX.ShootType = 5 Then  ' Gun/Bullet
			ElseIf ItemX.ShootType = 6 Or ItemX.ShootType = 7 Then  ' Energy High/Low
			End If
		End If
	End Sub
	
	Public Sub PlaySFX(ByRef PictureFile As String, ByRef FromLoc As Short, ByRef WithStyle As Short, ByRef Speed As Short, ByRef Frames As Short)
		Dim CreatureTarget As Object
		Dim CreatureWithTurn As Object
		' Plays SFX in Combat. Flip = 0 if left to right, Or 1 if right to left
		' Speed is 0 (Fast), 1 (Medium) or 2 (Slow)
		Dim rc, c, i, Pic As Short
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Height_Renamed, Width_Renamed, Flip As Short
		Dim ToX, FromX, FromY, ToY As Short
		Dim FromWidth, ToWidth As Double
		Dim RateX, Cels, RateY As Short
		' If not in Combat, then return immediately
		If picGrid.Visible = False Then
			Exit Sub
		End If
		' Load SFX picture file. If can't find it, then exit.
		Pic = LoadSFXPic(PictureFile)
		If Pic < 0 Then
			Exit Sub
		End If
		' Set animate parameters
		Frames = Greatest(Frames, 1)
		Width_Renamed = (picSFXPic(Pic).Width / Frames) / 2 : Height_Renamed = picSFXPic(Pic).Height / 2
		picTmp.Width = Width_Renamed : picTmp.Height = Height_Renamed
		' Compute FromX,Y and ToX,Y
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GridToCursor(FromX, FromY, CreatureWithTurn.Row, CreatureWithTurn.Col, FromWidth)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GridToCursor(ToX, ToY, CreatureTarget.Row, CreatureTarget.Col, ToWidth)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Pic. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ToY = ToY - (picCPic(CreatureTarget.Pic).Height + Height_Renamed) / 4
		ToX = ToX + (ToWidth - Width_Renamed) / 2
		If FromLoc = bdSFXFromHead Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.FaceTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Pic. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FromY = FromY - (picCPic(CreatureWithTurn.Pic).Height / 2) + CreatureWithTurn.FaceTop * PicSize
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.FaceLeft. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FromX = FromX + CreatureWithTurn.FaceLeft * PicSize - Width_Renamed
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Pic. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FromY = FromY - Int(picCPic(CreatureWithTurn.Pic).Height / 4)
			FromX = FromX + (FromWidth - Width_Renamed) / 2
		End If
		Cels = Greatest(CShort(System.Math.Sqrt((ToX - FromX) ^ 2 + (ToY - FromY) ^ 2) / Width_Renamed) * 2, 1) * 2
		RateX = (ToX - FromX) / Cels
		RateY = (ToY - FromY) / Cels
		' If CreatureTarget to the left of CreatureWithTurn, then Flip
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureTarget.Col < CreatureWithTurn.Col Then
			Flip = picSFXPic(Pic).Width / 2
		Else
			Flip = 0
		End If
		' Animate to Combat screen
		Select Case WithStyle
			Case bdSFXFling
				i = 0
				Cels = Cels / 2 : RateX = RateX * 2 : RateY = RateY * 2
				For c = 0 To Cels
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTmp.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTmp.hdc, 0, 0, Width_Renamed, Height_Renamed, picGrid.hdc, FromX + c * RateX, FromY + c * RateY, SRCCOPY)
					picTmp.Refresh()
					i = LoopNumber(0, Frames - 1, i, 1)
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX + c * RateX, FromY + c * RateY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, Height_Renamed, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX + c * RateX, FromY + c * RateY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, 0, SRCPAINT)
					picGrid.Refresh()
					Select Case Speed
						Case 0 ' Fast
							GameDelay(5000)
						Case 1 ' Medium
							GameDelay(1700)
						Case 2 ' Slow
							GameDelay(500)
					End Select
					'UPGRADE_ISSUE: PictureBox property picTmp.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX + c * RateX, FromY + c * RateY, Width_Renamed, Height_Renamed, picTmp.hdc, 0, 0, SRCCOPY)
				Next c
			Case bdSFXStream
				i = 0
				For c = 0 To Cels
					i = LoopNumber(0, Frames - 1, i, 1)
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX + c * RateX, FromY + c * RateY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, Height_Renamed, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX + c * RateX, FromY + c * RateY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, 0, SRCPAINT)
					picGrid.Refresh()
					Select Case Speed
						Case 0 ' Fast
							GameDelay(3000)
						Case 1 ' Medium
							GameDelay(1000)
						Case 2 ' Slow
							GameDelay(300)
					End Select
				Next c
				CombatDraw()
			Case bdSFXDown
				FromX = ToX : FromY = 0 : Flip = 0
				Cels = Greatest(CShort(System.Math.Sqrt((ToX - FromX) ^ 2 + (ToY - FromY) ^ 2) / Width_Renamed) * 2, 1)
				Cels = Cels * (Speed + 1)
				RateX = (ToX - FromX) / Cels
				RateY = (ToY - FromY) / Cels
				i = 0
				For c = 0 To Cels
					i = LoopNumber(0, Frames - 1, i, 1)
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX + c * RateX, FromY + c * RateY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, Height_Renamed, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX + c * RateX, FromY + c * RateY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, 0, SRCPAINT)
					picGrid.Refresh()
					Select Case Speed
						Case 0 ' Fast
							GameDelay(1000)
						Case 1 ' Medium
							GameDelay(300)
						Case 2 ' Slow
							GameDelay(100)
					End Select
				Next c
				CombatDraw()
			Case bdSFXBurstHere
				For i = 0 To Frames - 1
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTmp.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTmp.hdc, 0, 0, Width_Renamed, Height_Renamed, picGrid.hdc, FromX, FromY, SRCCOPY)
					picTmp.Refresh()
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX, FromY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, Height_Renamed, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX, FromY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, 0, SRCPAINT)
					picGrid.Refresh()
					Select Case Speed
						Case 0 ' Fast
							GameDelay(1000)
						Case 1 ' Medium
							GameDelay(300)
						Case 2 ' Slow
							GameDelay(100)
					End Select
					'UPGRADE_ISSUE: PictureBox property picTmp.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, FromX, FromY, Width_Renamed, Height_Renamed, picTmp.hdc, 0, 0, SRCCOPY)
				Next i
			Case bdSFXBurstThere
				For i = 0 To Frames - 1
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picTmp.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picTmp.hdc, 0, 0, Width_Renamed, Height_Renamed, picGrid.hdc, ToX, ToY, SRCCOPY)
					picTmp.Refresh()
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, ToX, ToY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, Height_Renamed, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, ToX, ToY, Width_Renamed, Height_Renamed, picSFXPic(Pic).hdc, i * Width_Renamed + Flip, 0, SRCPAINT)
					picGrid.Refresh()
					Select Case Speed
						Case 0 ' Fast
							GameDelay(1000)
						Case 1 ' Medium
							GameDelay(300)
						Case 2 ' Slow
							GameDelay(100)
					End Select
					'UPGRADE_ISSUE: PictureBox property picTmp.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picGrid.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picGrid.hdc, ToX, ToY, Width_Renamed, Height_Renamed, picTmp.hdc, 0, 0, SRCCOPY)
				Next i
		End Select
		picGrid.Refresh()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Private Sub ResizeForm()
		Dim X, Y As Short
		' Size and Place Menu
		picMenu.Width = 32 + 5 * (90 + 32) : picMenu.Height = 84
		picMenu.Top = Me.ClientRectangle.Height - picMenu.Height - 16
		picMenu.Left = (Me.ClientRectangle.Width - picMenu.Width) / 2
		picMenu.Visible = False
		' Load the Interface
		' OptionsLoad True
		GameInterfaceLoad(True)
		' Place and Size Borders (Not in Game)
		BorderDrawAll(False)
		' Place and Size Map
		picBox.Top = 16 : picBox.Left = 32
		picBox.Height = Me.ClientRectangle.Height - picMenu.Height - 64
		picBox.Width = Me.ClientRectangle.Width - 64
		picMap.Top = 0 : picMap.Left = 0
		picMap.Height = Int(picBox.Height / 48) * 48 + 48
		picMap.Width = Int(picBox.Width / 96) * 96 + 96
		' Place Combat Boxes
		picGrid.Top = 0 : picGrid.Left = 0
		picGrid.Height = picBox.Height : picGrid.Width = picBox.Width
		picToHit.Top = Me.ClientRectangle.Height - picToHit.Height - 16
		picToHit.Left = (Me.ClientRectangle.Width - picToHit.Width) / 2
		' Place Inventory Box
		picInventory.Top = (picBox.ClientRectangle.Height - picInventory.ClientRectangle.Height) / 2
		picInventory.Left = (Me.ClientRectangle.Width - picInventory.ClientRectangle.Width) / 2
		' Place Search box
		picSearch.Top = (picBox.ClientRectangle.Height - picSearch.ClientRectangle.Height) / 2
		picSearch.Left = (Me.ClientRectangle.Width - picSearch.ClientRectangle.Width) / 2
		' Place Talk box
		picTalk.Top = (picBox.ClientRectangle.Height - picTalk.ClientRectangle.Height) / 2
		picTalk.Left = (Me.ClientRectangle.Width - picTalk.ClientRectangle.Width) / 2
		' Place Convo box
		picConvo.Left = (Me.ClientRectangle.Width - picConvo.ClientRectangle.Width) / 2
		' Place BuySell box
		picBuySell.Top = (picBox.ClientRectangle.Height - picBuySell.ClientRectangle.Height) / 2
		picBuySell.Left = (Me.ClientRectangle.Width - picBuySell.ClientRectangle.Width) / 2
		' Place Journal Box
		picJournal.Top = (picBox.ClientRectangle.Height - picJournal.ClientRectangle.Height) / 2
		picJournal.Left = (Me.ClientRectangle.Width - picJournal.ClientRectangle.Width) / 2
		' Place Main Menu
		picMainMenu.Top = (Me.ClientRectangle.Height - picMainMenu.Height) / 2
		picMainMenu.Left = (Me.ClientRectangle.Width - picMainMenu.Width) / 2
		picMainMenu.BringToFront()
		' Place New Tome
		picTomeNew.Top = (Me.ClientRectangle.Height - picTomeNew.ClientRectangle.Height) / 2
		picTomeNew.Left = (Me.ClientRectangle.Width - picTomeNew.Width) / 2
		picTomeNew.BringToFront()
		' Refresh
		Me.Refresh()
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub DrawMapAll()
		Dim MicroMapTop As Object
		Dim MicroMapLeft As Object
		Dim Map_Renamed As Object
		Dim Darker As Object
		' If TileSet is not loaded, load it now
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TileSetLoaded <> Map.PictureFile Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Darker. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			LoadTileSet(Darker, False)
			LoadTileSetMicro()
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapLeft. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MicroMapLeft = Map.Left
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MicroMapTop = Map.Top
		End If
		' Draw map
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		DrawMapRegion(0, 0, picMap.ClientRectangle.Height, picMap.ClientRectangle.Width)
		picMap.Focus()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
	End Sub
	
	Private Sub BorderDrawTop()
		Dim bdIntHeight As Object
		Dim bdIntWidth As Object
		Dim rc As Integer
		Dim c As Short
		' Top
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 0 To Int(Me.ClientRectangle.Width / bdIntWidth)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, c * bdIntWidth, 0, bdIntWidth, bdIntHeight, picMisc.hdc, 38, 180, SRCCOPY)
		Next c
		' Top Corners
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(Me.hdc, 0, 0, bdIntHeight * 2, bdIntHeight, picMisc.hdc, 139, 180, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(Me.hdc, Me.ClientRectangle.Width - bdIntHeight * 2, 0, bdIntHeight * 2, bdIntHeight, picMisc.hdc, 139, 180, SRCCOPY)
	End Sub
	
	Private Sub BorderDrawBottom()
		Dim bdIntHeight As Object
		Dim bdIntWidth As Object
		Dim rc As Integer
		Dim c As Short
		' Bottom
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 0 To Int(Me.ClientRectangle.Width / bdIntWidth)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, c * bdIntWidth, Me.ClientRectangle.Height - bdIntHeight, bdIntWidth, bdIntHeight, picMisc.hdc, 38, 180, SRCCOPY)
		Next c
		' Bottom Corners
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(Me.hdc, 0, Me.ClientRectangle.Height - bdIntHeight, bdIntHeight * 2, bdIntHeight, picMisc.hdc, 139, 180, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(Me.hdc, Me.ClientRectangle.Width - bdIntHeight * 2, Me.ClientRectangle.Height - bdIntHeight, bdIntHeight * 2, bdIntHeight, picMisc.hdc, 139, 180, SRCCOPY)
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub BorderDrawSides(ByRef InGame As Short, ByRef ShowRune As Short)
		Dim bdFontSmallWhite As Object
		Dim bdIntHeight As Object
		Dim bdIntWidth As Object
		Dim Map_Renamed As Object
		Dim rc As Integer
		Dim fx, X, c, Y, fy As Short
		' [Titi 2.4.9b] Override Map.IsNoRunes if the world magic doesn't use the runes system
		If InGame Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.IsNoRunes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If WorldNow.Runes Then Map.IsNoRunes = True
		End If
		' Left and Right
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 0 To Int(Me.ClientRectangle.Height / bdIntWidth)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, 0, 16 + c * bdIntWidth, bdIntHeight * 2, VB6.PixelsToTwipsX(Width), picMisc.hdc, 139, 89, SRCCOPY)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, Me.ClientRectangle.Width - bdIntHeight * 2, 16 + c * bdIntWidth, bdIntHeight * 2, bdIntWidth, picMisc.hdc, 139, 89, SRCCOPY)
		Next c
		' If InGame then Draw Rune Pool
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.IsNoRunes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If InGame = True And Map.IsNoRunes = False Then
			' Draw number of Runes available
			'        For c = 0 To 19
			For c = 0 To intNbRunes - 1
				If c > 9 Then
					X = Me.ClientRectangle.Width - 32 : Y = (c - 10) * 32 + 16
					fx = c * 32 - 320
					fy = 32
				Else
					X = 0 : Y = c * 32 + 16
					fx = c * 32
					fy = 0
				End If
				If c = ShowRune Then
					'UPGRADE_ISSUE: PictureBox property picRuneSet.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(Me.hdc, X, Y, 32, 32, picRuneSet.hdc, fx, fy + 128, SRCCOPY)
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Runes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, X, Y + 22, 32, 10, bdFontSmallWhite, VB6.Format(Map.Runes(c)), True, False)
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Runes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ElseIf Map.Runes(c) > 0 Then 
					'UPGRADE_ISSUE: PictureBox property picRuneSet.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(Me.hdc, X, Y, 32, 32, picRuneSet.hdc, fx, fy, SRCCOPY)
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Runes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, X, Y + 22, 32, 10, bdFontSmallWhite, VB6.Format(Map.Runes(c)), True, False)
				Else
					'UPGRADE_ISSUE: PictureBox property picRuneSet.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(Me.hdc, X, Y, 32, 32, picRuneSet.hdc, fx, fy + 64, SRCCOPY)
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ShowText(Me, X, Y + 22, 32, 10, bdFontSmallWhite, "-", True, False)
				End If
			Next c
		End If
		' Bottom Corners
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(Me.hdc, 0, Me.ClientRectangle.Height - bdIntHeight, bdIntHeight * 2, bdIntHeight, picMisc.hdc, 139, 180, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(Me.hdc, Me.ClientRectangle.Width - bdIntHeight * 2, Me.ClientRectangle.Height - bdIntHeight, bdIntHeight * 2, bdIntHeight, picMisc.hdc, 139, 180, SRCCOPY)
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub BorderDrawButtons(ByRef ButtonDown As Short, Optional ByVal Ymouse As Short = 0)
		Dim CreatureWithTurn As Object
		Dim bdFontElixirWhite As Object
		Dim EncounterNow As Object
		Dim Map_Renamed As Object
		Dim ItemNow As Object
		Dim bdFontNoxiousWhite As Object
		Dim bdIntHeight As Object
		Dim bdIntWidth As Object
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim rc As Integer
		Dim Y, c, X As Short
		Dim Text_Renamed As String
		Dim sRune() As String
		Dim PauseTime, Start As Single
		' Middle
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 0 To Int(Me.ClientRectangle.Width / bdIntWidth)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, c * bdIntWidth, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 3, bdIntWidth, bdIntHeight, picMisc.hdc, 38, 180, SRCCOPY)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, c * bdIntWidth, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 2, bdIntWidth, bdIntHeight, picMisc.hdc, 38, 180, SRCCOPY)
		Next c
		' Draw Buttons
		'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Y = Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 3 + 7
		' Display an Item Hint if needed
		If ButtonDown = -1 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.Hint. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(Me, 40, Y, picInventory.ClientRectangle.Width - 80, 14, bdFontNoxiousWhite, IIf(sHint <> "", sHint, ItemNow.Hint), True, False)
		Else
			If picGrid.Visible = True Then
				ShowButton(Me, 40, Y, "Equip", (ButtonDown = 1))
				ShowButton(Me, 138, Y, "Talk", (ButtonDown = 2))
				ShowButton(Me, 236, Y, "Defend", (ButtonDown = 3))
				ShowButton(Me, 334, Y, "Wait", (ButtonDown = 4))
				ShowButton(Me, 432, Y, "Flee", (ButtonDown = 5))
				ShowButton(Me, 530, Y, "Guard", (ButtonDown = 9))
			Else
				ShowButton(Me, 40, Y, "Equip", (ButtonDown = 1))
				ShowButton(Me, 138, Y, "Talk", (ButtonDown = 2))
				ShowButton(Me, 236, Y, "Search", (ButtonDown = 3))
				ShowButton(Me, 334, Y, "Listen", (ButtonDown = 4))
				ShowButton(Me, 432, Y, "Open", (ButtonDown = 5))
				' [Titi 2.5.1] Added the "Camp" option
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanCamp. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.CanCamp. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ShowButton(Me, 530, Y, "Camp", (ButtonDown = 9), (Map.CanCamp = False And EncounterNow.CanCamp = False) Or (TurnsBeforeNextCamp > 0))
			End If
			' Draw skill buttons
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(Me, 528, Y, Me.ClientRectangle.Width - 136 - 528, 14, bdFontElixirWhite, CreatureWithTurn.Name, 1, False)
			ShowButton(Me, Me.ClientRectangle.Width - 130, Y, "Skills", (ButtonDown = 6))
		End If
		'    If ButtonDown < -1 Then
		'        ' [Titi 2.4.8] get the runes names
		'        modBD.InitializeRunes (WorldNow.Name)
		'        ReDim sRune(intNbRunes)
		'        Text = Right$(strRunesList, Len(strRunesList) - 5) ' get rid of "List="
		'        For c = 1 To intNbRunes - 1
		'            sRune(c) = Left$(Text, InStr(Text, ",") - 1)
		'            Text = Right$(Text, Len(Text) - Len(sRune(c)) - 1)
		'        Next
		'        sRune(c) = Text
		''        Select Case Abs(ButtonDown + 2)
		''            Case 0: Text = "Blood"
		''            Case 1: Text = "Bile"
		''            Case 2: Text = "Oil"
		''            Case 3: Text = "Nectar"
		''            Case 4: Text = "Fire"
		''            Case 5: Text = "Earth"
		''            Case 6: Text = "Water"
		''            Case 7: Text = "Air"
		''            Case 8: Text = "Time"
		''            Case 9: Text = "Moon"
		''            Case 10: Text = "Sun"
		''            Case 11: Text = "Space"
		''            Case 12: Text = "Insect"
		''            Case 13: Text = "Man"
		''            Case 14: Text = "Animal"
		''            Case 15: Text = "Fish"
		''            Case 16: Text = "Twilight"
		''            Case 17: Text = "Abyss"
		''            Case 18: Text = "Eternium"
		''            Case 19: Text = "Dreams"
		''        End Select
		''        ShowText frmMain, 40, y, picInventory.ScaleWidth - 80, 14, bdFontNoxiousWhite, Map.Runes(Abs(ButtonDown + 2)) & " " & Text & " Rune for Spells", True, False
		'        x = 16
		'        ' first half of the runes list
		'        y = (Abs(ButtonDown) - 2) * 32 + 16
		'        ' second part of the list --> right of the screen
		'        If ButtonDown < -11 Then y = (Abs(ButtonDown) - 12) * 32 + 16
		'        ShowText picMap, x, y, picMap.ScaleWidth - 80, 14, bdFontNoxiousWhite, sRune(Abs(ButtonDown + 1)), IIf(ButtonDown < -11, 1, 0), False
		'        picMap.Refresh
		'        PauseTime = 1   ' duration of display
		'        Start = Timer
		'        Do While Timer < Start + PauseTime
		'           DoEvents
		'        Loop
		'        ' ShowText picMap, x, y, picMap.ScaleWidth - 80, 14, bdFontNoxiousWhite, String(Len(sRune(Abs(ButtonDown + 1))), "*"), IIf(ButtonDown < -11, 1, 0), False
		'        DrawMapRegion 0, 0, 340 + HintX, Len(sRune(Abs(ButtonDown + 1))) * 8 + 16 + HintY
		'        DrawMapRegion 0, picMap.ScaleWidth - Len(sRune(Abs(ButtonDown + 1))) * 8 - 16 - HintY, 340 + HintX, picMap.ScaleWidth
		'    End If
		' Draw the Menu (Button 7) and Journal (Button 8) Orbs
		If ButtonDown = 7 Then
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, 0, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 3, 32, 32, picMisc.hdc, 32, 147, SRCCOPY)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, Me.ClientRectangle.Width - 32, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 3, 32, 32, picMisc.hdc, 64, 147, SRCCOPY)
		ElseIf ButtonDown = 8 Then 
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, 0, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 3, 32, 32, picMisc.hdc, 0, 147, SRCCOPY)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, Me.ClientRectangle.Width - 32, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 3, 32, 32, picMisc.hdc, 96, 147, SRCCOPY)
		Else
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, 0, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 3, 32, 32, picMisc.hdc, 0, 147, SRCCOPY)
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdIntHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, Me.ClientRectangle.Width - 32, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - bdIntHeight * 3, 32, 32, picMisc.hdc, 64, 147, SRCCOPY)
		End If
		' Fill in around menu sides
		If picGrid.Visible = False Then
			'UPGRADE_ISSUE: PictureBox property picConvoBottom.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, 32, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - 16, (Me.ClientRectangle.Width - picMenu.ClientRectangle.Width - 64) / 2, picMenu.ClientRectangle.Height, picConvoBottom.hdc, 0, 6, SRCCOPY)
			'UPGRADE_ISSUE: PictureBox property picConvoBottom.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, 32 + (Me.ClientRectangle.Width - picMenu.ClientRectangle.Width - 64) / 2 + picMenu.ClientRectangle.Width, Me.ClientRectangle.Height - picMenu.ClientRectangle.Height - 16, (Me.ClientRectangle.Width - picMenu.ClientRectangle.Width - 64) / 2, picMenu.ClientRectangle.Height, picConvoBottom.hdc, 0, 6, SRCCOPY)
		Else
			'UPGRADE_ISSUE: PictureBox property picConvoBottom.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, 32, Me.ClientRectangle.Height - picToHit.ClientRectangle.Height - 16, (Me.ClientRectangle.Width - picToHit.ClientRectangle.Width - 64) / 2, picToHit.ClientRectangle.Height, picConvoBottom.hdc, 0, 6, SRCCOPY)
			'UPGRADE_ISSUE: PictureBox property picConvoBottom.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: Form property frmMain.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(Me.hdc, 32 + (Me.ClientRectangle.Width - picToHit.ClientRectangle.Width - 64) / 2 + picToHit.ClientRectangle.Width, Me.ClientRectangle.Height - picToHit.ClientRectangle.Height - 16, (Me.ClientRectangle.Width - picToHit.ClientRectangle.Width - 64) / 2, picToHit.ClientRectangle.Height, picConvoBottom.hdc, 0, 6, SRCCOPY)
		End If
	End Sub
	
	Private Sub BorderDrawAll(ByRef InGame As Short)
		Dim X, i, Y As Short
		Dim rc As Integer
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		BorderDrawTop()
		BorderDrawBottom()
		BorderDrawSides(InGame, -1)
		Width_Renamed = 90 : Height_Renamed = 16
		If InGame = True Then
			BorderDrawButtons(0)
			picMenu.Visible = True
		End If
		Me.Refresh()
	End Sub
	
	Private Sub GameInterfaceLoad(ByRef blnKeepWorld As Short)
		Dim oErr As Object
		Dim GlobalInterfaceIndex As Object
		Dim GlobalInterfaceList As Object
		Dim EncounterNow As Object
		Dim PicFileTime As Object
		Dim PicFile As Object
		Dim bdMaxMonsPics As Object
		Dim Worlds As Object
		Dim fReadValue As Object
		Dim c As Short
		Dim rc As Integer
		Dim CreatureX As Creature
		Dim sPath As String
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim hndFile As Short
		Dim Text_Renamed, sWorld As String
		Dim lResult As Integer
		On Error GoTo ErrorHandler
		'    sPath = gAppPath & "\data\Interface\" & GlobalInterfaceName & "\"
		sPath = gDataPath & "\Interface\" & GlobalInterfaceName & "\"
		' Misc has borders and face stuff
		picSteps.Image = System.Drawing.Image.FromFile(sPath & "Steps.bmp")
		picMisc.Image = System.Drawing.Image.FromFile(sPath & "Misc.bmp")
		picFonts.Image = System.Drawing.Image.FromFile(sPath & "Fonts.bmp")
		' [Titi 2.4.8] since we can now change the name, why not change the picture of the runes?
		'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		lResult = fReadValue(gAppPath & "\Settings.ini", "World", "Current", "S", "Eternia", sWorld)
		' [Titi 2.6.0] if the interface is changed because a different world is loaded, use the latter instead
		'UPGRADE_WARNING: Couldn't resolve default property of object Worlds().Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If blnKeepWorld = False Then sWorld = Worlds(WorldIndex).Name
		InitializeRunes(sWorld)
		' Combat stuff
		picToHit.Image = System.Drawing.Image.FromFile(sPath & "CombatRoll.bmp")
		' Load dice
		LoadDicePic(GlobalDiceName)
		' Clear out any existing Creature Faces
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMaxMonsPics. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 1 To bdMaxMonsPics
			'UPGRADE_WARNING: Couldn't resolve default property of object PicFile(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PicFile(c) = ""
			'UPGRADE_WARNING: Couldn't resolve default property of object PicFileTime(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If PicFileTime(c) > 0 Then
				picCPic.Unload(c)
				picCMap.Unload(c)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object PicFileTime(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PicFileTime(c) = 0
		Next c
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			CreatureX.Pic = 0
		Next CreatureX
		For	Each CreatureX In Tome.Creatures
			CreatureX.Pic = 0
		Next CreatureX
		picFaces.Image = System.Drawing.Image.FromFile(sPath & "DialogFace.bmp")
		picFaces.SizeMode = System.Windows.Forms.PictureBoxSizeMode.AutoSize : picFaces.SizeMode = System.Windows.Forms.PictureBoxSizeMode.Normal
		picMainMenu.Image = System.Drawing.Image.FromFile(sPath & "MainMenuNew.bmp")
		picBlack.Image = System.Drawing.Image.FromFile(sPath & "MainMenuRollOverNew.bmp")
		picTomeNew.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None
		'UPGRADE_WARNING: Picture has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		picTomeNew.BackgroundImage = System.Drawing.Image.FromFile(sPath & "TomeMenu.bmp")
		picCreateName.Image = System.Drawing.Image.FromFile(sPath & "DialogAcceptText.bmp")
		picInventory.Image = System.Drawing.Image.FromFile(sPath & "DialogInventory.bmp")
		' DialogShow
		picConvo.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None
		'UPGRADE_WARNING: Picture has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		picConvo.BackgroundImage = System.Drawing.Image.FromFile(sPath & "DialogShow.bmp")
		picConvoBottom.Width = picConvo.Width : picConvoBottom.Height = 6 + picMenu.ClientRectangle.Height
		'UPGRADE_ISSUE: PictureBox property picConvo.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property picConvoBottom.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picConvoBottom.hdc, 0, 0, picConvo.ClientRectangle.Width, picConvo.ClientRectangle.Height, picConvo.hdc, 0, picConvo.Height - 6, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picConvo.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_ISSUE: PictureBox property picConvoBottom.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picConvoBottom.hdc, 0, 6, picConvo.ClientRectangle.Width, picConvo.ClientRectangle.Height, picConvo.hdc, 6, 64, SRCCOPY)
		picConvoBottom.Refresh()
		picConvoEnter.Image = System.Drawing.Image.FromFile(sPath & "DialogAcceptText.bmp")
		picConvoList.Image = System.Drawing.Image.FromFile(sPath & "DialogListBox.bmp")
		picTalk.Image = System.Drawing.Image.FromFile(sPath & "DialogTalk.bmp")
		picJournal.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None
		'UPGRADE_WARNING: Picture has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		picJournal.BackgroundImage = System.Drawing.Image.FromFile(sPath & "DialogJournal.bmp")
		picSearch.Image = System.Drawing.Image.FromFile(sPath & "DialogSearch.bmp")
		picContainer.Image = System.Drawing.Image.FromFile(sPath & "DialogSearch.bmp")
		picBuySell.Image = System.Drawing.Image.FromFile(sPath & "DialogBuySell.bmp")
		picDialogBrief.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None
		'UPGRADE_WARNING: Picture has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		picDialogBrief.BackgroundImage = System.Drawing.Image.FromFile(sPath & "DialogBrief.bmp")
		Exit Sub
ErrorHandler: 
		If Err.Number = 76 Or Err.Number = 53 Then
			' [Titi 2.6.0] file not found: we're probably looking into a directory that does not contain a real interface set: skip it and try again
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalInterfaceIndex = LoopNumber(1, GlobalInterfaceList.Count, GlobalInterfaceIndex, 1)
			'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			GlobalInterfaceName = GlobalInterfaceList(GlobalInterfaceIndex)
			sPath = gDataPath & "\Interface\" & GlobalInterfaceName & "\"
			GameInterfaceLoad(blnKeepWorld)
			Exit Sub
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			oErr.logError("GameInterfaceLoad()")
			End '  this is an unclean end to the program [borfaux]
		End If
	End Sub
	
	'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub GameInitInventory(ByRef StartAt As Short, ByRef EndAt As Short, ByRef Width_Renamed As Short)
		Dim InvY As Object
		Dim InvX As Object
		Dim c As Short
		For c = 1 To EndAt - StartAt
			'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvX(StartAt + c) = InvX(StartAt) + 34 * (c Mod Width_Renamed)
			'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvY(StartAt + c) = InvY(StartAt) + 34 * Int(c / Width_Renamed)
		Next c
	End Sub
	
	Private Sub GameInitVariables()
		Dim aY As Object
		Dim aX As Object
		Dim aW As Object
		Dim InvY As Object
		Dim InvX As Object
		' Initialize Inventory Tile Positions
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(1) = 22
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(1) = 44 ' LeftBack
		GameInitInventory(1, 6, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(7) = 190
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(7) = 44 ' RightBack
		GameInitInventory(7, 12, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(13) = 106
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(13) = 44 ' Head
		GameInitInventory(13, 16, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(17) = 22
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(17) = 160 ' LeftHandOther
		GameInitInventory(17, 20, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(21) = 190
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(21) = 160 ' RightHandOther
		GameInitInventory(21, 24, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(25) = 106
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(25) = 120 ' Necklace
		GameInitInventory(25, 26, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(27) = 106
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(27) = 154 ' Body
		GameInitInventory(27, 30, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(31) = 106
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(31) = 222 ' Belt
		GameInitInventory(31, 32, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(33) = 22
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(33) = 244 ' LeftHand
		GameInitInventory(33, 38, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(39) = 190
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(39) = 244 ' RightHand
		GameInitInventory(39, 44, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(45) = 106
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(45) = 328 ' Boots
		GameInitInventory(45, 48, 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object InvX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvX(49) = 290
		'UPGRADE_WARNING: Couldn't resolve default property of object InvY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		InvY(49) = 44 ' All Other Items
		GameInitInventory(49, 128, 8)
		' Initialize directions for find path routine
		DirX(0) = 0 : DirY(0) = -1 ' up / Upper Left
		DirX(1) = 1 : DirY(1) = 0 ' right / Upper Right
		DirX(2) = -1 : DirY(2) = 0 ' left / Lower Left
		DirX(3) = 0 : DirY(3) = 1 ' down / Lower Right
		DirX(4) = -1 : DirY(4) = -1 ' up left
		DirX(5) = -1 : DirY(5) = 1 ' down left
		DirX(6) = 1 : DirY(6) = -1 ' up right
		DirX(7) = 1 : DirY(7) = 1 ' down right
		' Initialize directors for LineOfSite (LOS)
		' 0 - up, 1 - right, 2 - left, 3 - down
		LosDir(0, 0) = 0 : LosDir(0, 1) = 0 : LosDir(0, 2) = 0 : LosDir(0, 3) = 0 : LosDir(0, 4) = -1 : LosDir(0, 5) = -1
		LosDir(1, 0) = 0 : LosDir(1, 1) = 0 : LosDir(1, 2) = 1 : LosDir(1, 3) = 0 : LosDir(1, 4) = 0 : LosDir(1, 5) = -1
		LosDir(2, 0) = 0 : LosDir(2, 1) = 1 : LosDir(2, 2) = 0 : LosDir(2, 3) = 1 : LosDir(2, 4) = 0 : LosDir(2, 5) = 1
		LosDir(3, 0) = 1 : LosDir(3, 1) = 0 : LosDir(3, 2) = 1 : LosDir(3, 3) = 0 : LosDir(3, 4) = 1 : LosDir(3, 5) = 0
		LosDir(4, 0) = 1 : LosDir(4, 1) = 1 : LosDir(4, 2) = 0 : LosDir(4, 3) = 1 : LosDir(4, 4) = 1 : LosDir(4, 5) = -1
		LosDir(5, 0) = 1 : LosDir(5, 1) = 1 : LosDir(5, 2) = 1 : LosDir(5, 3) = 1 : LosDir(5, 4) = -1 : LosDir(5, 5) = -1
		' Initialize RuneMenuX and RuneMenuY
		RuneMenuX(0) = 12 : RuneMenuY(0) = 66
		RuneMenuX(1) = 12 : RuneMenuY(1) = 98
		RuneMenuX(2) = 44 : RuneMenuY(2) = 66
		RuneMenuX(3) = 44 : RuneMenuY(3) = 98
		RuneMenuX(4) = 82 : RuneMenuY(4) = 50
		RuneMenuX(6) = 114 : RuneMenuY(6) = 50
		RuneMenuX(5) = 82 : RuneMenuY(5) = 88
		RuneMenuX(7) = 114 : RuneMenuY(7) = 88
		RuneMenuX(8) = 152 : RuneMenuY(8) = 34
		RuneMenuX(9) = 152 : RuneMenuY(9) = 66
		RuneMenuX(10) = 184 : RuneMenuY(10) = 34
		RuneMenuX(11) = 184 : RuneMenuY(11) = 66
		RuneMenuX(12) = 222 : RuneMenuY(12) = 50
		RuneMenuX(13) = 222 : RuneMenuY(13) = 88
		RuneMenuX(14) = 254 : RuneMenuY(14) = 50
		RuneMenuX(15) = 254 : RuneMenuY(15) = 88
		RuneMenuX(16) = 292 : RuneMenuY(16) = 66
		RuneMenuX(17) = 292 : RuneMenuY(17) = 98
		RuneMenuX(18) = 324 : RuneMenuY(18) = 66
		RuneMenuX(19) = 324 : RuneMenuY(19) = 98
		' Init Alpha (small font)
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 32) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 32) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 32) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 33) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 33) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 33) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 34) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 34) = 15
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 34) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 35) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 35) = 22
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 35) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 36) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 36) = 30
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 36) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 37) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 37) = 38
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 37) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 38) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 38) = 46
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 38) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 39) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 39) = 54
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 39) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 40) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 40) = 63
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 40) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 41) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 41) = 71
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 41) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 42) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 42) = 79
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 42) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 43) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 43) = 86
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 43) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 44) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 44) = 93
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 44) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 45) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 45) = 103
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 45) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 46) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 46) = 113
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 46) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 47) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 47) = 122
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 47) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 48) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 48) = 128
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 48) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 49) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 49) = 138
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 49) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 50) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 50) = 146
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 50) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 51) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 51) = 155
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 51) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 52) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 52) = 163
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 52) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 53) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 53) = 172
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 53) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 54) = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 54) = 181
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 54) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 55) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 55) = 193
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 55) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 56) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 56) = 201
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 56) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 57) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 57) = 209
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 57) = 0 ' Z
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 16) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 16) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 16) = 10 ' A
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 17) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 17) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 17) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 18) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 18) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 18) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 19) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 19) = 21
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 19) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 20) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 20) = 29
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 20) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 21) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 21) = 37
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 21) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 22) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 22) = 45
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 22) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 23) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 23) = 53
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 23) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 24) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 24) = 61
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 24) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 15) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 15) = 69
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 15) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 10) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 10) = 77
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 10) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 12) = 5
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 12) = 83
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 12) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 0) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 0) = 88
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 0) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 13) = 3
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 13) = 92
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 13) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 11) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 11) = 95
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 11) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 30) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 30) = 99
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 30) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 1) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 1) = 106
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 1) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 6) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 6) = 112
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 6) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 7) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 7) = 116
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 7) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 8) = 5
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 8) = 122
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 8) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 5) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 5) = 127
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 5) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 9) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 9) = 135
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 9) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 27) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 27) = 146
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 27) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 29) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 29) = 146
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 29) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 4) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 4) = 146
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 4) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 3) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 3) = 146
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 3) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 25) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 25) = 146
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 25) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 26) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 26) = 146
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 26) = 10 ' Z
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 64) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 64) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 64) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 65) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 65) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 65) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 66) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 66) = 15
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 66) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 67) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 67) = 22
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 67) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 68) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 68) = 30
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 68) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 69) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 69) = 38
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 69) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 70) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 70) = 46
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 70) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 71) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 71) = 54
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 71) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 72) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 72) = 63
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 72) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 73) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 73) = 71
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 73) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 74) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 74) = 79
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 74) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 75) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 75) = 86
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 75) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 76) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 76) = 93
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 76) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 77) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 77) = 103
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 77) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 78) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 78) = 113
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 78) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 79) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 79) = 122
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 79) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 80) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 80) = 128
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 80) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 81) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 81) = 138
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 81) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 82) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 82) = 146
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 82) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 83) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 83) = 155
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 83) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 84) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 84) = 163
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 84) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 85) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 85) = 172
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 85) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 86) = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 86) = 181
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 86) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 87) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 87) = 193
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 87) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 88) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 88) = 201
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 88) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 89) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 89) = 209
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 89) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(0, 14) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(0, 14) = 209
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(0, 14) = 10 ' [Titi 2.4.9]
		' Noxious
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 32) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 32) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 32) = 0 ' A
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 33) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 33) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 33) = 0 ' B
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 34) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 34) = 20
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 34) = 0 ' C
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 35) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 35) = 30
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 35) = 0 ' D
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 36) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 36) = 41
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 36) = 0 ' E
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 37) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 37) = 49
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 37) = 0 ' F
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 38) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 38) = 57
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 38) = 0 ' G
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 39) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 39) = 67
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 39) = 0 ' H
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 40) = 5
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 40) = 78
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 40) = 0 ' I
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 41) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 41) = 83
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 41) = 0 ' J
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 42) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 42) = 91
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 42) = 0 ' K
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 43) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 43) = 101
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 43) = 0 ' L
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 44) = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 44) = 109
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 44) = 0 ' M
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 45) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 45) = 121
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 45) = 0 ' N
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 46) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 46) = 131
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 46) = 0 ' O
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 47) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 47) = 142
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 47) = 0 ' P
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 48) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 48) = 150
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 48) = 0 ' Q
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 49) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 49) = 163
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 49) = 0 ' R
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 50) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 50) = 172
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 50) = 0 ' S
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 51) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 51) = 181
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 51) = 0 ' T
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 52) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 52) = 190
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 52) = 0 ' U
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 53) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 53) = 200
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 53) = 0 ' V
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 54) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 54) = 210
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 54) = 0 ' W
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 55) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 55) = 223
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 55) = 0 ' X
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 56) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 56) = 234
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 56) = 0 ' Y
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 57) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 57) = 243
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 57) = 0 ' Z
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 16) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 16) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 16) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 17) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 17) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 17) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 18) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 18) = 16
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 18) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 19) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 19) = 26
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 19) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 20) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 20) = 35
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 20) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 21) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 21) = 45
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 21) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 22) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 22) = 54
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 22) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 23) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 23) = 64
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 23) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 24) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 24) = 73
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 24) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 15) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 15) = 82
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 15) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 10) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 10) = 92
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 10) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 12) = 5
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 12) = 99
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 12) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 0) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 0) = 104
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 0) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 13) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 13) = 108
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 13) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 11) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 11) = 112
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 11) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 30) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 30) = 116
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 30) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 1) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 1) = 123
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 1) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 6) = 5
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 6) = 127
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 6) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 7) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 7) = 132
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 7) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 8) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 8) = 136
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 8) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 5) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 5) = 140
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 5) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 9) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 9) = 154
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 9) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 27) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 27) = 165
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 27) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 29) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 29) = 174
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 29) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 4) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 4) = 183
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 4) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 3) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 3) = 196
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 3) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 25) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 25) = 205
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 25) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 26) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 26) = 209
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 26) = 14 ' Z
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 64) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 64) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 64) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 65) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 65) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 65) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 66) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 66) = 17
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 66) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 67) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 67) = 24
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 67) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 68) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 68) = 34
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 68) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 69) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 69) = 42
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 69) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 70) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 70) = 48
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 70) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 71) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 71) = 57
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 71) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 72) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 72) = 66
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 72) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 73) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 73) = 70
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 73) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 74) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 74) = 76
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 74) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 75) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 75) = 85
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 75) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 76) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 76) = 89
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 76) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 77) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 77) = 103
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 77) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 78) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 78) = 112
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 78) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 79) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 79) = 121
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 79) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 80) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 80) = 131
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 80) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 81) = 5
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 81) = 140
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 81) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 82) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 82) = 145
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 82) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 83) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 83) = 152
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 83) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 84) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 84) = 158
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 84) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 85) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 85) = 167
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 85) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 86) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 86) = 175
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 86) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 87) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 87) = 186
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 87) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 88) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 88) = 195
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 88) = 28
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 89) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 89) = 202
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 89) = 28 ' Z
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(1, 14) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(1, 14) = 216
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(1, 14) = 14 ' [Titi 2.4.9]
		' Elixir
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 32) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 32) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 32) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 33) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 33) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 33) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 34) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 34) = 21
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 34) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 35) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 35) = 31
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 35) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 36) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 36) = 42
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 36) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 37) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 37) = 52
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 37) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 38) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 38) = 63
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 38) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 39) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 39) = 74
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 39) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 40) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 40) = 85
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 40) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 41) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 41) = 91
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 41) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 42) = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 42) = 97
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 42) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 43) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 43) = 109
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 43) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 44) = 17
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 44) = 119
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 44) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 45) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 45) = 136
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 45) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 46) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 46) = 150
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 46) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 47) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 47) = 163
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 47) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 48) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 48) = 176
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 48) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 49) = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 49) = 187
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 49) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 50) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 50) = 199
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 50) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 51) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 51) = 209
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 51) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 52) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 52) = 218
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 52) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 53) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 53) = 231
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 53) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 54) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 54) = 242
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 54) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 55) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 55) = 256
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 55) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 56) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 56) = 269
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 56) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 57) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 57) = 280
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 57) = 0 ' Z
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 16) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 16) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 16) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 17) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 17) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 17) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 18) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 18) = 15
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 18) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 19) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 19) = 24
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 19) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 20) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 20) = 32
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 20) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 21) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 21) = 42
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 21) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 22) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 22) = 50
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 22) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 23) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 23) = 57
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 23) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 24) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 24) = 65
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 24) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 15) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 15) = 74
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 15) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 10) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 10) = 85
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 10) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 12) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 12) = 93
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 12) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 0) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 0) = 100
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 0) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 13) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 13) = 104
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 13) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 11) = 5
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 11) = 108
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 11) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 30) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 30) = 113
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 30) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 1) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 1) = 120
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 1) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 6) = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 6) = 129
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 6) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 7) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 7) = 137
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 7) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 8) = 4
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 8) = 141
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 8) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 5) = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 5) = 145
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 5) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 9) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 9) = 157
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 9) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 27) = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 27) = 167
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 27) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 29) = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 29) = 168
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 29) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 4) = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 4) = 169
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 4) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 3) = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 3) = 170
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 3) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 25) = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 25) = 171
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 25) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 26) = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 26) = 172
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 26) = 14 ' Z
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 64) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 64) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 64) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 65) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 65) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 65) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 66) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 66) = 21
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 66) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 67) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 67) = 31
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 67) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 68) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 68) = 42
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 68) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 69) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 69) = 52
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 69) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 70) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 70) = 63
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 70) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 71) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 71) = 74
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 71) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 72) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 72) = 85
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 72) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 73) = 6
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 73) = 91
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 73) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 74) = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 74) = 97
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 74) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 75) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 75) = 109
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 75) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 76) = 17
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 76) = 119
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 76) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 77) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 77) = 136
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 77) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 78) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 78) = 150
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 78) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 79) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 79) = 163
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 79) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 80) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 80) = 176
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 80) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 81) = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 81) = 187
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 81) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 82) = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 82) = 199
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 82) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 83) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 83) = 209
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 83) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 84) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 84) = 218
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 84) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 85) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 85) = 231
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 85) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 86) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 86) = 242
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 86) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 87) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 87) = 256
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 87) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 88) = 11
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 88) = 269
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 88) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 89) = 9
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 89) = 280
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 89) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(2, 14) = 7
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(2, 14) = 280
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(2, 14) = 14 ' [Titi 2.4.9]
		' Large White Numbers
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 16) = 13
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 16) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 16) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 17) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 17) = 16
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 17) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 18) = 16
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 18) = 30
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 18) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 19) = 16
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 19) = 46
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 19) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 20) = 18
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 20) = 62
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 20) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 21) = 16
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 21) = 80
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 21) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 22) = 14
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 22) = 96
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 22) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 23) = 15
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 23) = 110
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 23) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 24) = 16
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 24) = 125
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 24) = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object aW(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aW(3, 15) = 18
		'UPGRADE_WARNING: Couldn't resolve default property of object aX(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aX(3, 15) = 142
		'UPGRADE_WARNING: Couldn't resolve default property of object aY(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		aY(3, 15) = 0
		' [Titi 2.5.1] default to display all skills
		Dim c As Short
		For c = 0 To 3
			FilterStatus(c) = True
		Next 
		' [Titi 2.5.1] number of EncounterTargetInArea
		intCountEncounterTarget = -1
	End Sub
	
	Private Sub GameInit()
		Dim File As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetUp As Object
		Dim ScrollList As Object
		Dim TomeList As Object
		Dim GlobalDiceIndex As Object
		Dim GlobalDiceList As Object
		Dim GlobalInterfaceIndex As Object
		Dim ERR_CRITICAL As Object
		Dim GlobalInterfaceList As Object
		Dim UberWizMaps As Object
		Dim PlayMusic As Object
		Dim CreatePCLoadWorlds As Object
		Dim TomeAction As Object
		Dim Frozen As Object
		Dim bdMaxItemPics As Object
		Dim TomeWizardSize As Object
		Dim TomeWizardStory As Object
		Dim TomeWizardLevel As Object
		Dim TomeWizardParty As Object
		Dim OptionsLoad As Object
		Dim bdFontElixirWhite As Object
		Dim JournalMode As Object
		Dim DarkDir As Object
		Dim Folder As Object
		Dim oGameMusic As Object
		Dim oFileSys As Object
		Dim ERR_DEBUG As Object
		Dim fReadValue As Object
		Dim oErr As Object
		Dim bdMaxMonsPics As Object
		On Error GoTo Err_Handler
		Dim rc, hCursor As Integer
		Dim CreatureX As Creature
		Dim MapSketchX As MapSketch
		Dim FileName, StringX As String
		Dim c As Short
		Dim TomeX As Tome
		Dim bm As BITMAP
		Dim CommandArgs() As String
		Dim ArgText As String
		Dim tmp As String
		Dim PauseTime, Start As Integer
		Dim logError As Short
		Dim errLevel As Short
		Dim lResult As Integer
		' [Titi 2.4.9b] Moved from Dialog.bas (if more than 12 creatures to display simultaneously, the game mixed the pictures)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMaxMonsPics. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		bdMaxMonsPics = 12 ' therefore changed from Const to Integer
		Dim PicFile(bdMaxMonsPics) As String
		Dim PicPortrait(bdMaxMonsPics) As String
		Dim PicFileTime(bdMaxMonsPics) As Double
		' [rb] Added for 2.4.6
		'Call ParseCommandLineArgs
		' Initialize Error Handler Object
		'Set oErr = New CErrorHandler
		' [rb] I borrow the GlobalDebugMode variable just to set this
		'Call oErr.Initialize("gengine.txt", GlobalDebugMode)
		gAppPath = My.Application.Info.DirectoryPath
		oErr = New CErrorHandler
		'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		lResult = fReadValue(gAppPath & "\Settings.ini", "System", "ErrorLog", "B", "0", logError)
		'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		lResult = fReadValue(gAppPath & "\Settings.ini", "System", "ErrorLvl", "B", "3", errLevel)
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.Initialize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call oErr.Initialize(CShort(logError), CShort(errLevel), "EngineLog.txt")
		'Call oErr.Initialize(LOG_DEBUG Or LOG_TOFILE, "creatorlog.txt")
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: Started", ERR_DEBUG)
		On Error GoTo Err_Handler
		' Initialize our new IO Class
		oFileSys = New clsInOut
		oGameMusic = New IMCI
		' [Titi 2.4.9] Borfaux's addition
		'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		lResult = fReadValue(gAppPath & "\Settings.ini", "System", "DataFolder", "S", gAppPath, tmp)
		gDataPath = tmp
		'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If oFileSys.CheckExists(gDataPath & "\Data", Folder) Then
			gDataPath = gDataPath & "\Data"
		End If
		' [Titi 2.6.0] Same idea: define a path to the library
		'UPGRADE_WARNING: Couldn't resolve default property of object fReadValue(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		lResult = fReadValue(gAppPath & "\Settings.ini", "System", "LibraryFolder", "S", gAppPath, tmp)
		gLibPath = tmp
		'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If oFileSys.CheckExists(gLibPath & "\Library", Folder) Then
			gLibPath = gLibPath & "\Library"
		End If
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		'UPGRADE_ISSUE: Form property frmMain.Image was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		GetObject_Renamed(Image, Len(bm), bm)
		GlobalScreenX = GetSystemMetrics(SM_CXSCREEN)
		GlobalScreenY = GetSystemMetrics(SM_CYSCREEN)
		GlobalScreenColor = CShort(VB6.Format(bm.bmBitsPixel))
		' ChangeScreenSettings 800, 600, 16
		' Determine CommonScale for Pictures (default to 800x600)
		CommonScale = GlobalScreenX / 800
		' [Titi 2.6.0] Widescreens display bug: in combat, monsters would be below the visible area
		If GlobalScreenX / GlobalScreenY > 4 / 3 Then CommonScale = GlobalScreenY / 600 'CommonScale * 9 / 16
		PicSize = CommonScale * 0.6
		'UPGRADE_WARNING: Couldn't resolve default property of object DarkDir. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DarkDir = 1
		Randomize()
		' Set some variables
		Call SetUpBits()
		MaxSFX = -1
		TotalStepsTaken = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		JournalMode = 0
		' Load the Options for the Game
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading game options - started")
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTPic, 0, 0, picTPic.ClientRectangle.Width, 0, bdFontElixirWhite, "Loading game options", True, True)
		picTPic.Refresh()
		Call OptionsLoad(True)
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading game options - finished")
		' Set TomeWizard
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardParty. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeWizardParty = 2
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeWizardLevel = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardStory. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeWizardStory = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeWizardSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeWizardSize = 1
		' Set up default Item picture size (bdMaxItemPics Pictures)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMaxItemPics. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		picItem.Width = 64 * bdMaxItemPics
		picItem.Height = 96 * 2 + 32
		' Init all the game variables
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading game variables - started")
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTPic, 0, 0, picTPic.ClientRectangle.Width, 0, bdFontElixirWhite, "Loading game variables", True, True)
		picTPic.Refresh()
		Call GameInitVariables()
		Me.Show()
		picTPic.Width = Me.ClientRectangle.Width - 64 : picTPic.Height = 14
		picTPic.Left = 32 : picTPic.Top = Me.ClientRectangle.Height / 2
		picTPic.Visible = True
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading game variables - finished")
		'    ' Load bones picture for Creature
		'    oErr.logError "GameInit: " & "Loading bones picture - Started"
		'    picTPic.Cls
		'    ShowText picTPic, 0, 0, picTPic.ScaleWidth, 0, bdFontElixirWhite, "Loading bones picture", True, True
		'    picTPic.Refresh
		'    Set CreatureX = New Creature
		'    CreatureX.PictureFile = "bones.bmp"
		'    LoadCreaturePic CreatureX
		'    oErr.logError "GameInit: " & "Loading bones picture - Finished"
		' Freeze Map and Menu actions
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = True
		' Load up the tomes for selection
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeAction = -1
		' Load up the Roster Defaults
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading Roster Defaults - Started")
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTPic, 0, 0, picTPic.ClientRectangle.Width, 0, bdFontElixirWhite, "Loading Roster Defaults", True, True)
		picTPic.Refresh()
		Call CreatePCLoadWorlds()
		WorldIndex = WorldNow.Index
		' [borfaux] Moved here.  Let the Worlds INI file dictate which file to play as the Worlds
		' intro music
		' Play the Intro music
		Call PlayMusic(WorldNow.IntroMusic, Me, WorldNow.MusicFolder)
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading Roster Defaults - Started")
		' Load bones picture for Creature
		' [Titi 2.4.9b] moved here to have WorldNow defined before the call to the picture is made (different "bones.bmp" thus allowed per world setting)
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading bones picture - Started")
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTPic, 0, 0, picTPic.ClientRectangle.Width, 0, bdFontElixirWhite, "Loading bones picture", True, True)
		picTPic.Refresh()
		CreatureX = New Creature
		CreatureX.PictureFile = "bones.bmp"
		LoadCreaturePic(CreatureX)
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading bones picture - Finished")
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		' Now load the Story Tomes for the Tome Wizard
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading Story Tomes for the Tome Wizard - Started")
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTPic, 0, 0, picTPic.ClientRectangle.Width, 0, bdFontElixirWhite, "Loading Story Tomes for the Tome Wizard", True, True)
		picTPic.Refresh()
		UberWizMaps = New UberWizard
		'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		modDungeonMaker.InitUberWizMaps(UberWizMaps)
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading Story Tomes for the Tome Wizard - Finished")
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTPic, 0, 0, picTPic.ClientRectangle.Width, 0, bdFontElixirWhite, "Loading Interface List", True, True)
		picTPic.Refresh()
		' Load Interface List
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading Interface List - Started")
		GlobalInterfaceList = New Collection
		'    FileName = Dir$(gAppPath & "/Data/Interface/*", vbDirectory)
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(gDataPath & "/Interface/*", FileAttribute.Directory)
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If FileName = "" Then oErr.logError("GameInit: " & vbTab & "No Interface List!!!", ERR_CRITICAL)
		Do While FileName <> ""
			If FileName <> "." And FileName <> ".." And FileName <> "Dice" Then
				' Find alphabetical spot in list
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For c = 1 To GlobalInterfaceList.Count
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If UCase(GlobalInterfaceList(c)) > UCase(FileName) Then
						'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						GlobalInterfaceList.Add(Item:=FileName, Before:=c)
						Exit For
					End If
				Next c
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c > GlobalInterfaceList.Count Then
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					GlobalInterfaceList.Add(Item:=FileName)
				End If
			End If
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir()
		Loop 
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalInterfaceIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalInterfaceIndex = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading Interface List - Finished")
		' Load Dice List
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTPic, 0, 0, picTPic.ClientRectangle.Width, 0, bdFontElixirWhite, "Loading Dice List", True, True)
		picTPic.Refresh()
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading Dice List - Started")
		GlobalDiceList = New Collection
		'    FileName = Dir$(gAppPath & "/Data/Interface/Dice/*.bmp", vbDirectory)
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(gDataPath & "/Interface/Dice/*.bmp", FileAttribute.Directory)
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If FileName = "" Then oErr.logError("GameInit: " & vbTab & "No Dice List!!!", ERR_CRITICAL)
		Do While FileName <> ""
			If FileName <> "." And FileName <> ".." Then
				' Find alphabetical spot in list
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDiceList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For c = 1 To GlobalDiceList.Count
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDiceList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If UCase(GlobalDiceList(c)) > UCase(FileName) Then
						'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDiceList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						GlobalDiceList.Add(Item:=FileName, Before:=c)
						Exit For
					End If
				Next c
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDiceList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c > GlobalDiceList.Count Then
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDiceList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					GlobalDiceList.Add(Item:=FileName)
				End If
			End If
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir()
		Loop 
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDiceIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDiceIndex = 1
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Loading Dice List - Finished")
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTPic, 0, 0, picTPic.ClientRectangle.Width, 0, bdFontElixirWhite, "Finishing Game Init . . .", True, True)
		picTPic.Refresh()
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Finishing Game Init . . .")
		' Clean up any non-MainMap MapSketchs
		'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MapSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each MapSketchX In UberWizMaps.MapSketchs
			If MapSketchX.IsMainMap = False Or MapSketchX.TomeIndex = 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MapSketchs. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				UberWizMaps.MapSketchs.Remove("M" & MapSketchX.Index)
			End If
		Next MapSketchX
		'UPGRADE_WARNING: Couldn't resolve default property of object UberWizMaps.MainMapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		UberWizMaps.MainMapIndex = 0
		' Load the splash logo
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		picTPic.Visible = False
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("GameInit: " & "Splash Screen")
		If (Val(GlobalCredits) = 1) Then
			myLoadSplash()
		End If
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		If VB.Command() = "" Then
			Call UpdateMainMenu()
			'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			oErr.logError("GameInit: Loaded", ERR_DEBUG)
			picMainMenu.Visible = True
		Else ' [Titi 2.6.0] command line feature added
			TomeSavesLoad()
			TomeLoad()
			FileName = vbNullString
			For	Each TomeX In TomeList
				If InStr(UCase(TomeX.FullPath), UCase(VB.Command())) > 0 Then
					picTomeNew.Visible = True
					FileName = TomeX.FullPath & "\" & TomeX.FileName
					TomeLoadParty(TomeX)
					TomeLoadRoster()
					TomeGatherList()
					Exit Sub
				End If
			Next TomeX
			If UCase(VB.Command()) Like "LASTSAVE" Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ScrollList.Count > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Item. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeRestore(ScrollList.Item(ScrollList.Count).FileName)
				Else
					DialogSetUp(bdDlgNoReply)
					DialogShow("DM", "Save not found.")
					DialogHide()
					Call UpdateMainMenu()
					'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					oErr.logError("GameInit: Loaded", ERR_DEBUG)
					picMainMenu.Visible = True
				End If
			ElseIf InStr(VB.Command(), "\") = 0 Or IsNumeric(VB.Right(VB.Command(), 1)) Then 
				For	Each TomeX In ScrollList
					If InStr(UCase(TomeX.FileName), UCase(VB.Command())) > 0 Then
						FileName = TomeX.FileName
						Exit For
					End If
				Next TomeX
				If FileName <> "" Then
					TomeRestore(FileName)
				Else
					DialogSetUp(bdDlgNoReply)
					DialogShow("DM", "Save not found.")
					DialogHide()
					Call UpdateMainMenu()
					'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					oErr.logError("GameInit: Loaded", ERR_DEBUG)
					picMainMenu.Visible = True
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf oFileSys.CheckExists(VB.Command(), File) = True Then 
				TomeRestore(VB.Command())
			Else
				DialogSetUp(bdDlgNoReply)
				DialogShow("DM", "Unrecognized command, game will start normally")
				DialogHide()
				Call UpdateMainMenu()
				'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				oErr.logError("GameInit: Loaded", ERR_DEBUG)
				picMainMenu.Visible = True
			End If
		End If
Exit_Sub: 
		Exit Sub
Err_Handler: 
		If Err.Number = 91 Then
			' not a problem with a block "With" (hehe), but here we probably have two instances of Creator running
			'UPGRADE_WARNING: Couldn't resolve default property of object oErr.Initialize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Call oErr.Initialize(CShort(logError), CShort(errLevel), "EngineLog2.txt")
			Resume Next
		ElseIf Err.Number = 9 Then 
			' [Titi 2.4.9b] if the game tries to load a deleted/renamed world, revert to Eternia
			If WorldNow.Name <> "Eternia" Then
				'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				oErr.logError("Cannot load " & WorldNow.Name & "; reverting to Eternia")
			Else
				MsgBox("Eternia missing! Re-install the game...", MsgBoxStyle.Critical, "Cannot find Eternia")
				End
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			oErr.logError("GameInit has failed", ERR_CRITICAL)
			Resume Exit_Sub
		End If
	End Sub
	
	Private Sub myLoadSplash()
		Dim File As Object
		Dim oFileSys As Object
		Dim aImages(2, 1) As Object
		'Dim KillSplash As Boolean
		Dim SplashNow As Object
		Dim bCheckFile As Boolean
		Dim iImage As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object SplashNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		SplashNow = True : KillSplash = False
		'    bCheckFile = oFileSys.CheckExists(gAppPath & "\data\interface\" & GlobalInterfaceName & "\crosscut.bmp", File, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		bCheckFile = oFileSys.CheckExists(gDataPath & "\interface\" & GlobalInterfaceName & "\crosscut.bmp", File, False)
		If bCheckFile = True Then
			'     aImages(0, 0) = gAppPath & "\data\interface\" & GlobalInterfaceName & "\crosscut.bmp": aImages(0, 1) = 1
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(0, 0). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			aImages(0, 0) = gDataPath & "\interface\" & GlobalInterfaceName & "\crosscut.bmp"
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(0, 1). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			aImages(0, 1) = 1
		Else
			'     aImages(0, 0) = gAppPath & "\data\stock\crosscut.bmp": aImages(0, 1) = 1
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(0, 0). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			aImages(0, 0) = gDataPath & "\stock\crosscut.bmp"
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(0, 1). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			aImages(0, 1) = 1
		End If
		'    bCheckFile = oFileSys.CheckExists(gAppPath & "\data\interface\" & GlobalInterfaceName & "\splash.bmp", File, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		bCheckFile = oFileSys.CheckExists(gDataPath & "\interface\" & GlobalInterfaceName & "\splash.bmp", File, False)
		If bCheckFile = True Then
			'     aImages(1, 0) = gAppPath & "\data\interface\" & GlobalInterfaceName & "\splash.bmp": aImages(0, 1) = 1
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(1, 0). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			aImages(1, 0) = gDataPath & "\interface\" & GlobalInterfaceName & "\splash.bmp"
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(0, 1). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			aImages(0, 1) = 1
		Else
			'     aImages(1, 0) = gAppPath & "\data\stock\splash.bmp": aImages(0, 1) = 1
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(1, 0). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			aImages(1, 0) = gDataPath & "\stock\splash.bmp"
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(0, 1). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			aImages(0, 1) = 1
		End If
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		iImage = 0
		Do While KillSplash = False And iImage < 2
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(iImage, 1). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object aImages(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Call FadeToBlack(aImages(iImage, 0), aImages(iImage, 1))
			iImage = iImage + 1
		Loop 
		'UPGRADE_WARNING: Couldn't resolve default property of object SplashNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		SplashNow = False
		picMainMenu.Visible = True
	End Sub
	
	Private Sub FadeToBlack(ByVal FileName As String, ByVal bFade As Short)
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, c, Height_Renamed As Short
		'UPGRADE_NOTE: Size was upgraded to Size_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Y, X, i As Short
		Dim Size_Renamed As Double
		Dim hMemSplash As Integer ', filename As String
		'UPGRADE_WARNING: Arrays in structure bmSplash may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmSplash As BITMAPINFO
		'UPGRADE_WARNING: Array bmFadeToBlack may need to have individual elements initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B97B714D-9338-48AC-B03F-345B617E2B02"'
		Dim bmFadeToBlack(255) As BITMAPINFO
		Dim rc, lpMem, TransparentRGB As Integer
		If KillSplash = False Then
			ReadBitmapFile(FileName, bmSplash, hMemSplash, TransparentRGB)
			MakeFadeToBlack(bmSplash, bmFadeToBlack)
			lpMem = GlobalLock(hMemSplash)
			'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = SetStretchBltMode(picMap.hdc, 3)
			Width_Renamed = bmSplash.bmiHeader.biWidth
			Height_Renamed = bmSplash.bmiHeader.biHeight
			Y = (Me.ClientRectangle.Height - Height_Renamed - picMenu.Height) / 2
			X = (Me.ClientRectangle.Width - Width_Renamed - 64) / 2
			'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = StretchDIBits(picMap.hdc, X, Y, Width_Renamed, Height_Renamed, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmSplash, DIB_RGB_COLORS, SRCCOPY)
			If bFade = 0 Then ' Fade In
				For c = 0 To 255
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = StretchDIBits(picMap.hdc, X, Y, Width_Renamed, Height_Renamed, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmFadeToBlack(c), DIB_RGB_COLORS, SRCCOPY)
					picMap.Refresh()
					Sleep(10)
					System.Windows.Forms.Application.DoEvents()
					If KillSplash = True Then
						Exit For
					End If
				Next c
			ElseIf bFade = 1 Then  ' Fade Out
				picMap.Refresh()
				For c = 1 To 250
					Sleep(10)
					System.Windows.Forms.Application.DoEvents()
					If KillSplash = True Then
						Exit For
					End If
				Next c
				For c = 255 To 0 Step -5
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = StretchDIBits(picMap.hdc, X, Y, Width_Renamed, Height_Renamed, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmFadeToBlack(c), DIB_RGB_COLORS, SRCCOPY)
					picMap.Refresh()
					Sleep(10)
					System.Windows.Forms.Application.DoEvents()
					If KillSplash = True Then
						Exit For
					End If
				Next c
			End If
			'UPGRADE_ISSUE: PictureBox method picMap.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			picMap.Cls()
			rc = GlobalUnlock(hMemSplash)
			rc = GlobalFree(hMemSplash)
		End If
	End Sub
	
	Private Function SorceryQueRune(ByRef CreatureX As Creature, ByRef RuneToQue As Short) As Short
		Dim rc, c, Cost As Short
		Dim sText As String
		Dim strReagent() As String
		Dim ItemX, ItemY As Item
		Dim i As Short
		Dim Coef As Single
		' If blank rune to que then bad
		If RuneToQue < 0 Then
			SorceryQueRune = False
			Exit Function
		End If
		' Que Rune to next available slot.
		For c = CreatureX.RuneQueLimit To 5
			If CreatureX.Runes(c) = 0 Then
				Exit For
			End If
		Next c
		' [Titi 2.4.9b] if the world doesn't use runes, look for reagents in the inventory
		If WorldNow.Runes = True Then
			' load the list of reagents
			ReDim strReagent(intNbRunes - 1)
			sText = VB.Right(strRunesList, Len(strRunesList) - 5) & "," ' get rid of "List="
			For i = 0 To RuneToQue
				strReagent(i) = VB.Left(sText, InStr(sText, ",") - 1)
				sText = VB.Right(sText, Len(sText) - Len(VB.Left(sText, InStr(sText, ",") - 1)) - 1)
			Next 
			' now, find match
			Cost = 0
			For	Each ItemX In CreatureX.Items
				If ItemX.Name = Trim(Str(ItemX.Count) & " " & strReagent(RuneToQue) & "s") Then
					' use one
					If ItemX.Count = 1 Then
						CreatureX.RemoveItem("I" & ItemX.Index)
					Else
						Coef = (ItemX.Count - 1) / ItemX.Count
						ItemX.Value = ItemX.Value * Coef
						ItemX.Weight = ItemX.Weight * Coef
						ItemX.Count = ItemX.Count - 1
					End If
					Cost = 1
				End If
				If Cost <> 1 Then
					' not found in the inventory. Maybe in a container?
					For	Each ItemY In ItemX.Items
						If ItemY.Name = Trim(Str(ItemY.Count) & " " & strReagent(RuneToQue) & "s") Then
							' use one
							If ItemY.Count = 1 Then
								ItemX.RemoveItem("I" & ItemY.Index)
							Else
								Coef = (ItemY.Count - 1) / ItemY.Count
								ItemY.Value = ItemY.Value * Coef
								ItemY.Weight = ItemY.Weight * Coef
								ItemY.Count = ItemY.Count - 1
							End If
							Cost = 1
						End If
					Next ItemY
				End If
			Next ItemX
			If Cost <> 1 Then
				' not found, failure
				'UPGRADE_WARNING: Untranslated statement in SorceryQueRune. Please check source code.
				SorceryQueRune = False
				Exit Function
			End If
		Else
			' If RunePool is drained or there's no room left in the que, do nothing.
			'UPGRADE_WARNING: Untranslated statement in SorceryQueRune. Please check source code.
			' Show before take Rune
			BorderDrawSides(True, RuneToQue)
			BorderDrawButtons(0)
			Me.Refresh()
			'UPGRADE_WARNING: Untranslated statement in SorceryQueRune. Please check source code.
			'UPGRADE_WARNING: Untranslated statement in SorceryQueRune. Please check source code.
			' Show after
			BorderDrawSides(True, -1)
			BorderDrawButtons(0)
			Me.Refresh()
		End If
		' Que the Rune
		CreatureX.Runes(c) = RuneToQue + 1
		SorceryQueRune = True
	End Function
	
	Private Sub CastSpell(ByRef CreatureX As Creature, ByRef TriggerX As Trigger)
		Dim GlobalSpellFizzleChance As Object
		Dim CreatureTarget As Object
		Dim ItemNow As Object
		Dim CreatureWithTurn As Object
		Dim CreatureNow As Object
		Dim GlobalSaveStyle As Object
		Dim DialogDM As Object
		Dim Found As Boolean
		If CreatureX.ActionPoints < 10 Then
			MessageShow("Not enough Action Points!", 0)
		ElseIf CreatureX.Eternium < TriggerX.SkillPoints Then 
			MessageShow("Not enough " & WorldNow.Magic & "!", 0)
		Else
			' [Titi 2.4.9b] deduct magic points accordingly
			If CreatureX.Eternium >= TriggerX.SkillPoints Then
				CreatureX.Eternium = CreatureX.Eternium - TriggerX.SkillPoints
				CreatureX.ActionPoints = CreatureX.ActionPoints - 10
				' [Titi 2.5.1] update additional information
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.SpellsCast. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureX.Infos.SpellsCast = CreatureX.Infos.SpellsCast + 1
				' Check if spell casting successful
				MessageShow("Casting " & TriggerX.Name, 0)
				'UPGRADE_WARNING: Couldn't resolve default property of object TriggerX.Statements().B. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSpellFizzleChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Int(Rnd() * 100) + 1 < GlobalSpellFizzleChance And ((TriggerX.Statements.Item(1).B(6) And &H1) > 0) Then
					If picGrid.Visible = True Then
						MessageShow(TriggerX.Name & " fizzles!", 0)
					Else
						DialogDM(TriggerX.Name & " fizzles!")
					End If
					' [Titi 2.5.1] update additional information
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.SpellsFailed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureX.Infos.SpellsFailed = CreatureX.Infos.SpellsFailed + 1
				Else
					' Set GlobalSaveStyle value if the Trigger has the Rune Statement with Save Checked
					'UPGRADE_WARNING: Couldn't resolve default property of object TriggerX.Statements().B. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If (TriggerX.Statements.Item(1).B(6) And &H2) > 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSaveStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						GlobalSaveStyle = TriggerX.Styles
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSaveStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						GlobalSaveStyle = 0
					End If
					' Cast the Spell
					CreatureNow = CreatureWithTurn
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ItemNow = CreatureWithTurn.ItemInHand
					If picGrid.Visible = True Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureTarget = CreatureWithTurn.CreatureTarget
					End If
					FireTrigger(CreatureX, TriggerX)
					' Turn off the GlobalSaveStyle
					'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSaveStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					GlobalSaveStyle = 0
				End If
				'    Else
				'        MessageShow "Invoking " & TriggerX.Name, 0
				'    End If
			Else
				MessageShow(CreatureX.Name & " doesn't have enough " & WorldNow.Magic & "!", 0)
				Found = True
			End If
			' expected syntax: Reagents (list),[Fail/Save/FailSave])
		End If
	End Sub
	
	Private Sub SorceryTrigger(ByRef CreatureX As Creature, ByRef OwnerObjectX As Object, ByRef TriggerX As Trigger)
		Dim GlobalSpellFizzleChance As Object
		Dim CreatureTarget As Object
		Dim ItemNow As Object
		Dim CreatureWithTurn As Object
		Dim CreatureNow As Object
		Dim GlobalSaveStyle As Object
		Dim DialogDM As Object
		Dim Found, c, i, NoFail As Short
		Dim SpellRunes, QuedRunes As String
		Dim EterniumCost As Short
		QuedRunes = ""
		For c = 5 To 0 Step -1
			QuedRunes = QuedRunes & Chr(CreatureX.Runes(c) + 64)
		Next c
		' Check for Rune match
		'UPGRADE_WARNING: Couldn't resolve default property of object TriggerX.Statements(1).Statement. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TriggerX.Statements.Item(1).Statement = 23 Then ' Rune Statement '[Titi 2.4.9b] Read Reagent if the world doesn't use runes.
			SpellRunes = ""
			For c = 5 To 0 Step -1
				'UPGRADE_WARNING: Couldn't resolve default property of object TriggerX.Statements().B. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TriggerX.Statements.Item(1).B(c) > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object TriggerX.Statements().B. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					SpellRunes = SpellRunes & Chr(TriggerX.Statements.Item(1).B(c) + 64)
				End If
			Next c
			For i = 6 To CreatureX.RuneTop Step -2
				If IsBetween(InStr(Mid(QuedRunes, 7 - i), SpellRunes), 1, 2) Then
					If i - CreatureX.RuneTop < 2 Then
						MessageShow("Casting " & TriggerX.Name, 0)
						' [Titi 2.5.1] update additional information
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.SpellsCast. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureX.Infos.SpellsCast = CreatureX.Infos.SpellsCast + 1
						' Check if Fizzle
						'UPGRADE_WARNING: Couldn't resolve default property of object TriggerX.Statements().B. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSpellFizzleChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Int(Rnd() * 100) + 1 < GlobalSpellFizzleChance And ((TriggerX.Statements.Item(1).B(6) And &H1) > 0) Then
							If picGrid.Visible = True Then
								MessageShow(TriggerX.Name & " fizzles!", 0)
							Else
								DialogDM(TriggerX.Name & " fizzles!")
							End If
							' [Titi 2.5.1] update additional information
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.SpellsFailed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							CreatureX.Infos.SpellsFailed = CreatureX.Infos.SpellsFailed + 1
						Else
							' Set GlobalSaveStyle value if the Trigger has the Rune Statement with Save Checked
							'UPGRADE_WARNING: Couldn't resolve default property of object TriggerX.Statements().B. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If (TriggerX.Statements.Item(1).B(6) And &H2) > 0 Then
								'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSaveStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								GlobalSaveStyle = TriggerX.Styles
							Else
								'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSaveStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								GlobalSaveStyle = 0
							End If
							' Cast the Spell
							CreatureNow = CreatureWithTurn
							'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							ItemNow = CreatureWithTurn.ItemInHand
							If picGrid.Visible = True Then
								'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								CreatureTarget = CreatureWithTurn.CreatureTarget
							End If
							NoFail = FireTrigger(OwnerObjectX, TriggerX)
							' Turn off the GlobalSaveStyle
							'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSaveStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							GlobalSaveStyle = 0
						End If
					Else
						MessageShow("Invoking " & TriggerX.Name, 0)
					End If
				End If
			Next i
		End If
	End Sub
	
	Public Function SorceryMatchRunes(ByRef CreatureX As Creature, ByRef Runes() As Byte, ByRef CastIt As Short) As Short
		Dim k, n, c, i, Found As Short
		Dim OldPointer As Short
		Dim sText As String
		Dim strReagent() As String
		Dim ItemX, ItemY As Item
		' Returns 0= Ok, 1 = Not Enough ActionPoints, 2 = Undefined, 3 = Too Many Runes, 4 = Not Enough Runes, 99 = Undefined
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		OldPointer = System.Windows.Forms.Cursor.Current
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		SorceryMatchRunes = 0
		' Count the Runes (0 to 5)
		' [Titi 2.4.9b] read Reagents if the world doesn't use runes.
		For c = 0 To 5
			If Runes(c) > 0 Then
				n = c
			End If
		Next c
		' Match the Runes
		Found = False
		For c = 0 To CreatureX.RuneQueLimit - 1
			' Check if beyond limit of RuneQue
			If c + n > 5 Then
				Exit For
			End If
			' Check for matching Runes
			For i = 0 To n
				If CreatureX.Runes(c + i) <> Runes(i) And CreatureX.Runes(c + i) <> 0 Then
					Exit For
				End If
			Next i
			If i > n Then
				Found = True
				Exit For
			End If
		Next c
		' If piggy-back, then set starting Rune and new length
		If Found = True Then
			c = CreatureX.RuneQueLimit - c
			n = n - c
		Else
			c = 0
		End If
		' Check if have enough ActionPoints,  room in RuneQue
		If picGrid.Visible = True And CreatureX.ActionPoints < 10 Then
			SorceryMatchRunes = 1
		ElseIf c + n > 5 Then 
			SorceryMatchRunes = 3
		ElseIf CastIt = True Then 
			CreatureX.ActionPoints = 0
			If picGrid.Visible = True Then
				CombatDraw()
			End If
			For i = c To c + n
				k = SorceryQueRune(CreatureX, Runes(i) - 1)
				If k = False Then
					SorceryMatchRunes = 4
					Exit For
				End If
			Next i
			' Lock in the RuneQueLimit
			For c = 5 To 0 Step -1
				If CreatureX.Runes(c) > 0 Then
					CreatureX.RuneQueLimit = c + 1
					Exit For
				End If
			Next c
			' Invoke (if possible)
			If CreatureX.RuneTop = 0 Then
				If picGrid.Visible = True Then
					CreatureX.RuneTop = 2
				Else
					CreatureX.RuneTop = Least((CreatureX.RuneQueLimit), 6)
				End If
				SorceryCast(CreatureX)
			End If
		Else
			' Check for available in RunePool
			If WorldNow.Runes = False Then
				Found = False
				For i = c To c + n
					'UPGRADE_WARNING: Untranslated statement in SorceryMatchRunes. Please check source code.
				Next i
				If Found = True Then
					SorceryMatchRunes = 4
				Else
					SorceryMatchRunes = 0
				End If
			Else
				' [Titi 2.4.9b] we're not looking for runes on the map (the world doesn't use them) but for reagents in the inventory
				' load the list of reagents
				ReDim strReagent(intNbRunes - 1)
				sText = VB.Right(strRunesList, Len(strRunesList) - 5) & "," ' get rid of "List="
				For i = 0 To intNbRunes - 1
					strReagent(i) = VB.Left(sText, InStr(sText, ",") - 1)
					sText = VB.Right(sText, Len(sText) - Len(VB.Left(sText, InStr(sText, ",") - 1)) - 1)
				Next 
				For i = c To c + n
					For	Each ItemX In CreatureX.Items
						If Trim(Str(ItemX.Count)) & " " & strReagent(Runes(i) - 1) & "s" = ItemX.Name Then
							If ItemX.Count < 1 Then
								Found = True
								Exit For
							End If
						End If
						' check also inside containers
						For	Each ItemY In ItemX.Items
							If Trim(Str(ItemY.Count)) & " " & strReagent(Runes(i) - 1) & "s" = ItemY.Name Then
								If ItemY.Count < 1 Then
									Found = True
									Exit For
								End If
							End If
						Next ItemY
					Next ItemX
				Next i
				If Found = True Then
					SorceryMatchRunes = 4
				Else
					SorceryMatchRunes = 0
				End If
			End If
		End If
		'UPGRADE_ISSUE: Screen property Screen.MousePointer does not support custom mousepointers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="45116EAB-7060-405E-8ABE-9DBB40DC2E86"'
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = OldPointer
	End Function
	
	Public Sub SorceryInvokeNext(ByRef CreatureX As Creature)
		If CreatureX.RuneTop > 0 Then
			CreatureX.RuneTop = CreatureX.RuneTop + 2
			SorceryCast(CreatureX)
		End If
	End Sub
	
	Private Sub SorceryCastTrigger(ByRef CreatureX As Creature, ByRef ParentX As Object)
		Dim TriggerX As Trigger
		'UPGRADE_WARNING: Couldn't resolve default property of object ParentX.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each TriggerX In ParentX.Triggers
			If TriggerX.TriggerType = bdOnCast Or TriggerX.TriggerType = bdOnCastTarget Then
				SorceryTrigger(CreatureX, ParentX, TriggerX)
			End If
			SorceryCastTrigger(CreatureX, TriggerX)
		Next TriggerX
	End Sub
	
	Public Sub SorceryCast(ByRef CreatureX As Creature)
		Dim i, c, Found As Short
		Dim TriggerX, TriggerZ As Trigger
		Dim ItemX As Item
		' Find OnCast Triggers on CreatureX
		SorceryCastTrigger(CreatureX, CreatureX)
		' Find OnCast Triggers on ready items
		For	Each ItemX In CreatureX.Items
			If ItemX.IsReady = True Then
				SorceryCastTrigger(CreatureX, ItemX)
			End If
		Next ItemX
		' Clear out Runes if not in Combat or at end of Que in combat
		If picGrid.Visible = False Or (CreatureX.RuneTop >= CreatureX.RuneQueLimit And CreatureX.RuneTop > 2) Then
			For c = 0 To 5
				CreatureX.Runes(c) = 0
			Next 
			CreatureX.RuneTop = 0
			CreatureX.RuneQueLimit = 0
		End If
	End Sub
	
	Private Sub TalkMove(ByRef AtX As Short, ByRef AtY As Short)
		Dim ReplySelect As Object
		Dim ReplyTop As Object
		Dim ReplyHeight As Object
		Dim c, PosY As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ReplyHeight(0) - 4
		'UPGRADE_WARNING: Couldn't resolve default property of object ReplyTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 1 To ReplyTop
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplySelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If PointIn(AtX, AtY, 119, PosY, 306, ReplyHeight(c)) And c <> ReplySelect Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ReplySelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ReplySelect = c
				TalkList()
				Exit For
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PosY = PosY + ReplyHeight(c) + 4
		Next c
	End Sub
	
	Private Sub TalkReply(ByRef Index As Short)
		Dim ReplyTop As Object
		Dim Frozen As Object
		Dim FireTriggers As Object
		Dim DialogBrief As Object
		Dim ReplyIndex As Object
		Dim ReplyList As Object
		Dim CreatureWithTurn As Object
		Dim CreatureNow As Object
		Dim ScrollSelect As Object
		Dim ScrollList As Object
		Dim CreatureTarget As Object
		Dim Found, NoFail, c, Abort, FactFound As Short
		Dim ConvoX As Conversation
		Dim TopicX As Topic
		Dim FactoidX, FactoidZ As Factoid
		On Error Resume Next
		' Set up Creature and Conversation
		CreatureTarget = ScrollList(ScrollSelect)
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.CurrentConvo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureTarget.CurrentConvo = 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ReplyList(0) = CreatureTarget.Name & " doesn't want to talk right now."
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Conversations. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf Index = 0 And CreatureTarget.Conversations.Count > 0 Then 
			' Establish default Replies
			Found = False
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Conversations. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each ConvoX In CreatureTarget.Conversations
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.CurrentConvo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ConvoX.Index = CreatureTarget.CurrentConvo Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.CurrentConvo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Conversations. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ConvoX = CreatureTarget.Conversations("C" & CreatureTarget.CurrentConvo)
					Found = True
					Exit For
				End If
			Next ConvoX
			' If default convo is misplaced, can't talk.
			If Found = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ReplyList(0) = CreatureTarget.Name & " doesn't want to talk right now."
				ConvoX = New Conversation
			End If
			If ConvoX.HaveTalked = True And Len(ConvoX.SecondTalk) > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ReplyList(0) = ConvoX.SecondTalk
			Else
				ConvoX.HaveTalked = True
				'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ReplyList(0) = ConvoX.FirstTalk
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.CurrentConvo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Conversations. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ConvoX = CreatureTarget.Conversations("C" & CreatureTarget.CurrentConvo)
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyIndex(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TopicX = ConvoX.Topics.Item("Q" & ReplyIndex(Index))
			If Err.Number = 5 Then ' [Titi 2.4.9b] clicked on "(end convo)"
				TopicX = New Topic
				TopicX.Action = 5
				TopicX.Reply = "Forced exit of conversation!"
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ReplyList(0) = TopicX.Reply
			' [Titi 2.6.0] replace [CreatureTarget/Now] by the corresponding string.
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ReplyList(0) = ConvertName(ReplyList(0))
			'        Abort = False
			Select Case TopicX.Action
				Case 0 ' Do Nothing
				Case 1 ' SetConvo
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.CurrentConvo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureTarget.CurrentConvo = TopicX.ActionRef
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.CurrentConvo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Conversations. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ConvoX = CreatureTarget.Conversations("C" & CreatureTarget.CurrentConvo)
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ReplyList(0) = ReplyList(0) & vbCrLf & ConvoX.FirstTalk ' [Titi 2.6.0]
				Case 2 ' Remove
					TopicX.Default_Renamed = False
				Case 3 ' Add
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.CurrentConvo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Conversations. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureTarget.Conversations("C" & CreatureTarget.CurrentConvo).Topics("Q" & TopicX.ActionRef).Default = True
				Case 4 ' Replace
					TopicX.Default_Renamed = False
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.CurrentConvo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Conversations. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureTarget.Conversations("C" & CreatureTarget.CurrentConvo).Topics("Q" & TopicX.ActionRef).Default = True
				Case 5 ' Close
					' [Titi 2.4.9] show the final reply if there's one
					'                picTalk.Cls
					'                ShowText picTalk, 119, 42, 312, 306, bdFontNoxiousWhite, TopicX.Reply, False, False
					'                TopicX.Say = vbNullString
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(0). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If ReplyList(0) <> "He/She replies...." And ReplyList(0) <> "" Then
						DialogBrief(CreatureTarget, ReplyList(0))
					End If
					Abort = True
			End Select
			' Fire any Post-Topic Triggers
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(TopicX, bdPostTopic)
			If NoFail = False Or Abort = True Then
				picTalk.Visible = False
				'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Frozen = False
				picMap.Focus()
				Exit Sub
			End If
		End If
		' List Topics
		c = 1
		For	Each TopicX In ConvoX.Topics
			' Check for Factoid existence
			Found = True
			For	Each FactoidX In TopicX.Factoids
				FactFound = False
				For	Each FactoidZ In Tome.Factoids
					If FactoidX.Text = FactoidZ.Text Then
						FactFound = True
						Exit For
					End If
				Next FactoidZ
				If FactFound = False Then
					Found = False
					Exit For
				End If
			Next FactoidX
			' Check for PreTopic Triggers
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(TopicX, bdPreTopic)
			If NoFail And Found = True Then
				If TopicX.Default_Renamed = True And c < 11 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ReplyList(c) = TopicX.Say
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyIndex(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ReplyIndex(c) = TopicX.Index
					c = c + 1
				End If
			End If
		Next TopicX
		'UPGRADE_WARNING: Couldn't resolve default property of object ReplyTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ReplyTop = c - 1
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Agressive. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TalkList(CreatureTarget.Agressive)
	End Sub
	
	Private Function ConvertName(ByRef strReply As Object) As String
		Dim CreatureNow As Object
		Dim CreatureTarget As Object
		' [Titi 2.6.0] Function to replace [CreatureTarget/Now] by their name in conversations
		Dim intWhere As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object strReply. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		intWhere = InStr(strReply, "[Creature")
		While intWhere > 0
			'UPGRADE_WARNING: Couldn't resolve default property of object strReply. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Select Case UCase(Mid(strReply, intWhere + 9, 1))
				Case "T"
					'UPGRADE_WARNING: Couldn't resolve default property of object strReply. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					strReply = VB.Left(strReply, intWhere - 1) & CreatureTarget.Name & Mid(strReply, InStr(intWhere, strReply, "]") + 1)
				Case "N"
					'UPGRADE_WARNING: Couldn't resolve default property of object strReply. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					strReply = VB.Left(strReply, intWhere - 1) & CreatureNow.Name & Mid(strReply, InStr(intWhere, strReply, "]") + 1)
			End Select
			'UPGRADE_WARNING: Couldn't resolve default property of object strReply. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			intWhere = InStr(strReply, "[Creature")
		End While
		'UPGRADE_WARNING: Couldn't resolve default property of object strReply. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ConvertName = strReply
	End Function
	
	Private Sub TalkClick(ByRef AtX As Short, ByRef AtY As Short, ByRef ButtonDown As Short)
		Dim ReplyTop As Object
		Dim ReplyHeight As Object
		Dim ScrollThumbY As Object
		Dim ScrollSelect As Object
		Dim ScrollList As Object
		Dim ScrollTop As Object
		Dim bDialog As Object
		Dim Frozen As Object
		Dim CreatureTarget As Object
		Dim c, PosY As Short
		If PointIn(AtX, AtY, 350, 363, 90, 18) Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Agressive. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureTarget.Agressive = True Then Exit Sub ' [Titi 2.4.9b] You must first talk to the creature if it can't be ignored!
			ShowButton(picTalk, 350, 363, "Done", ButtonDown)
			picTalk.Refresh()
			If ButtonDown = False Then
				'UPGRADE_WARNING: Untranslated statement in TalkClick. Please check source code.
				picTalk.Visible = False
				'[borf] 2.4.6a Freeze issue - Phule's example #1
				' If a Dialog has been covered by the talk form, the Dialog is not present but is still caught in a DoEvent
				' If this is the case we don't want to return to the map
				If Not bDialog Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Frozen = False
					picMap.Focus()
				End If
			End If
		ElseIf PointIn(AtX, AtY, 18, 38, 66, 316) And ButtonDown = False Then 
			' Pick a person to talk with
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ScrollSelect = Least(ScrollTop + Greatest(Least(Int((AtY - 38) / 80), 3), 0), ScrollList.Count)
			TalkReply(0)
			'UPGRADE_WARNING: Untranslated statement in TalkClick. Please check source code.
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollThumbY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 85, 37 + 18, 18, ScrollThumbY - (37 + 18)) And ButtonDown Then 
			' Big Scroll Up
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ScrollTop = ScrollTop - 3
			TalkList()
			'UPGRADE_WARNING: Untranslated statement in TalkClick. Please check source code.
		ElseIf PointIn(AtX, AtY, 85, 37, 18, 18) Then 
			' Scroll Up
			If ButtonDown Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollThumbY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollThumbY = ScrollBarShow(picConvoList, 85, 37, 317, ScrollTop, ScrollList.Count - 3, 1)
				picConvoList.Refresh()
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollTop = ScrollTop - 1
				TalkList()
				'UPGRADE_WARNING: Untranslated statement in TalkClick. Please check source code.
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollThumbY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf PointIn(AtX, AtY, 85, ScrollThumbY + 18, 18, (37 + 317) - 36 - ScrollThumbY) And ButtonDown Then 
			' Big Scroll Down
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ScrollTop = ScrollTop + 3
			TalkList()
			'UPGRADE_WARNING: Untranslated statement in TalkClick. Please check source code.
		ElseIf PointIn(AtX, AtY, 85, (37 + 317) - 18, 18, 18) Then 
			' Scroll Down
			If ButtonDown Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollThumbY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollThumbY = ScrollBarShow(picConvoList, 85, 37, 317, ScrollTop, ScrollList.Count - 3, 2)
				picConvoList.Refresh()
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollTop = Greatest(Least(ScrollTop + 1, ScrollList.Count - 3), 1)
				TalkList()
				'UPGRADE_WARNING: Untranslated statement in TalkClick. Please check source code.
			End If
		ElseIf PointIn(AtX, AtY, 119, 42, 312, 306) And ButtonDown = False Then 
			' Choose a Reply
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PosY = ReplyHeight(0) - 4
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For c = 1 To ReplyTop
				'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If PointIn(AtX, AtY, 119, PosY, 306, ReplyHeight(c)) Then
					'UPGRADE_WARNING: Untranslated statement in TalkClick. Please check source code.
					TalkReply(c)
					Exit For
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				PosY = PosY + ReplyHeight(c) + 4
			Next c
		End If
	End Sub
	
	Private Sub TalkList(Optional ByRef Agressive As Short = 0)
		Dim ScrollThumbY As Object
		Dim ReplySelect As Object
		Dim bdFontNoxiousGrey As Object
		Dim bdFontNoxiousGold As Object
		Dim ReplyHeight As Object
		Dim ReplyIndex As Object
		Dim ReplyList As Object
		Dim ReplyTop As Object
		Dim bdFontNoxiousWhite As Object
		Dim bdFaceSelect As Object
		Dim bdFaceMin As Object
		Dim ScrollSelect As Object
		Dim ScrollList As Object
		Dim ScrollTop As Object
		Dim CreatureTarget As Object
		Dim bdFontElixirWhite As Object
		Dim c, PosY As Short
		Dim rc As Integer
		Dim CreatureX As Creature
		' List Portraits
		'UPGRADE_ISSUE: PictureBox method picTalk.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTalk.Cls()
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picTalk, 0, 12, picTalk.Width, 14, bdFontElixirWhite, "Talk with " & CreatureTarget.Name, True, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollTop = Greatest(Least(ScrollTop, ScrollList.Count - 3), 1)
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ScrollSelect = Least(Greatest(ScrollSelect, 1), ScrollList.Count)
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = ScrollTop To Least(ScrollTop + 3, ScrollList.Count)
			' Load and show picture
			CreatureX = ScrollList(c)
			LoadCreaturePic(CreatureX)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picTalk.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picTalk.hdc, 18, 38 + 80 * (c - ScrollTop), 66, 76, picFaces.hdc, bdFaceMin + CreatureX.Pic * 66, 0, SRCCOPY)
			' Show select indicator
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If c = ScrollSelect Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picTalk.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTalk.hdc, 18, 38 + 80 * (c - ScrollTop), 66, 76, picFaces.hdc, bdFaceSelect + 66, 0, SRCAND)
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_ISSUE: PictureBox property picTalk.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = BitBlt(picTalk.hdc, 18, 38 + 80 * (c - ScrollTop), 66, 76, picFaces.hdc, bdFaceSelect, 0, SRCPAINT)
			End If
		Next c
		' Show Current Reply and Topics
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.CurrentConvo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Dim TopicX As Topic
		Dim Found As Short
		Dim ConvoX As Conversation
		If CreatureTarget.CurrentConvo = 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picTalk, 119, 42, 312, 306, bdFontNoxiousWhite, CreatureTarget.Name & " has nothing to say.", False, False)
			TalkReply(0)
		Else
			' [Titi 2.4.9b] check if there's a way to end the convo when the creature can't be ignored
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Agressive. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureTarget.Agressive = True Then
				For	Each ConvoX In CreatureX.Conversations
					For	Each TopicX In ConvoX.Topics
						If TopicX.Action = 5 Then
							' found "Close convo", but is it a topic we automatically see?
							If TopicX.Factoids.Count() = 0 And TopicX.Default_Renamed = True Then
								' no factoids required, default topic - OK, we can always get it
								Found = True
								Exit For
							End If
						End If
					Next TopicX
				Next ConvoX
				If Not Found Then
					' [Titi 2.4.9b] Ouch! No way to exit... Let's add one!
					ConvoX = CreatureX.Conversations.Item("C" & CreatureX.CurrentConvo)
					TopicX = ConvoX.AddTopic ' New Topic [Titi 2.5.1] rewrote this part
					TopicX.Action = 5 ' Close convo
					TopicX.ActionRef = True ' Default
					TopicX.Say = "(End convo)"
					'                ConvoX.Topics.Add TopicX, "Q" & ConvoX.Topics.Count + 1
					'                Found = CreatureX.CurrentConvo
					'                CreatureX.Conversations.Remove "C" & Found
					'                CreatureX.Conversations.Add ConvoX, "C" & Found
					'                CreatureX.CurrentConvo = Found
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ReplyTop = ReplyTop + 1
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ReplyList(ReplyTop) = TopicX.Say
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyIndex(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ReplyIndex(ReplyTop) = TopicX.Index
				End If
			End If
			' List Reply or First/Second Talk
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PosY = 42 + 16 + ShowText(picTalk, 119, 42, 312, 306, bdFontNoxiousWhite, ReplyList(0), False, True)
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ReplyHeight(0) = PosY
			' List Topics
			'UPGRADE_WARNING: Couldn't resolve default property of object ReplyTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For c = 1 To ReplyTop
				' [Titi 2.6.0] convert [CreatureNow/Target] into their names
				'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ReplyList(c) = ConvertName(ReplyList(c))
				'UPGRADE_WARNING: Couldn't resolve default property of object ReplySelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ReplySelect = c Then
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousGold. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ReplyHeight(c) = ShowText(picTalk, 119, PosY, 312, 152, bdFontNoxiousGold, ReplyList(c), False, True)
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyList(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousGrey. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ReplyHeight(c) = ShowText(picTalk, 119, PosY, 312, 152, bdFontNoxiousGrey, ReplyList(c), False, True)
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ReplyHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				PosY = PosY + ReplyHeight(c) + 4
			Next c
		End If
		' Show Scrollbar
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ScrollList.Count > 4 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollThumbY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ScrollThumbY = ScrollBarShow(picTalk, 85, 37, 317, Least(ScrollTop, ScrollList.Count - 3), ScrollList.Count - 3, 0)
		End If
		' [Titi 2.4.9b] You must talk to a creature whose "Can't ignore" property is set!
		' ShowButton picTalk, 350, 363, "Done", False
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Agressive. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowButton(picTalk, 350, 363, "Done", False, (CreatureTarget.Agressive = Agressive) And (Agressive <> False))
		' Refresh the screen
		'    If picConvo.Visible = True Then
		'        picConvo.Enabled = False
		'    End If
		picTalk.Refresh()
		picTalk.BringToFront()
		picTalk.Visible = True
	End Sub
	
	Private Sub TalkSetup()
		Dim Frozen As Object
		Dim ScrollSelect As Object
		Dim ScrollTop As Object
		Dim DialogDM As Object
		Dim CreatureWithTurn As Object
		Dim EncounterNow As Object
		Dim ScrollList As Object
		Dim CreatureX As Creature
		Dim Found As Short
		Dim ConvoX As Conversation
		Dim TopicX As Topic
		MenuNow = bdMenuTalkWith
		ScrollList = New Collection
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			If CreatureX.Conversations.Count() > 0 And CreatureX.HPNow > 0 Then
				For	Each ConvoX In CreatureX.Conversations
					If CreatureX.CurrentConvo > 0 Then Found = Found + 1
				Next ConvoX
				' [Titi 2.4.9b] if no default convo, create one
				If Found = 0 Then
					ConvoX = New Conversation
					TopicX = New Topic
					TopicX.Action = 5 ' Close convo
					TopicX.ActionRef = True ' Default
					TopicX.Say = CreatureX.Name & " has nothing to say."
					TopicX.Reply = CreatureX.Name & " didn't want to talk right now."
					ConvoX.Topics.Add(TopicX, "Q" & ConvoX.Topics.Count())
					CreatureX.CurrentConvo = CreatureX.Conversations.Count() + 1
					CreatureX.Conversations.Add(ConvoX, "C" & CreatureX.Conversations.Count() + 1)
					ConvoX.Index = CreatureX.CurrentConvo
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add(Item:=CreatureX)
			End If
		Next CreatureX
		Found = 0
		For	Each CreatureX In Tome.Creatures
			' [Titi 2.6.0] Found was not set if NPC in the party had convos...
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureX.Conversations.Count() > 0 And CreatureX.HPNow > 0 And CreatureX.Index <> CreatureWithTurn.Index Then
				For	Each ConvoX In CreatureX.Conversations
					If CreatureX.CurrentConvo > 0 Then Found = Found + 1
				Next ConvoX
				' [Titi 2.4.9b] if no default convo, create one
				If Found = 0 Then
					ConvoX = New Conversation
					TopicX = New Topic
					TopicX.Action = 5 ' Close convo
					TopicX.ActionRef = True ' Default
					TopicX.Say = CreatureX.Name & " has nothing to say."
					TopicX.Reply = CreatureX.Name & " didn't want to talk right now."
					ConvoX.Topics.Add(TopicX, "Q" & ConvoX.Topics.Count())
					CreatureX.CurrentConvo = CreatureX.Conversations.Count() + 1
					CreatureX.Conversations.Add(ConvoX, "C" & CreatureX.Conversations.Count() + 1)
					ConvoX.Index = CreatureX.CurrentConvo
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Add. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ScrollList.Add(Item:=CreatureX)
			End If
		Next CreatureX
		'UPGRADE_WARNING: Couldn't resolve default property of object ScrollList.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ScrollList.Count < 1 Then
			DialogDM("There's nobody to talk with here.")
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ScrollTop = 1
			'UPGRADE_WARNING: Couldn't resolve default property of object ScrollSelect. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ScrollSelect = 1
			TalkReply(0)
			'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Frozen = True
		End If
	End Sub
	
	Private Sub TomeDelete(ByRef TomeX As Tome)
		Dim oErr As Object
		Dim ConvoAction As Object
		Dim TomeIndex As Object
		Dim TomeList As Object
		Dim File As Object
		Dim oFileSys As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim FileName As String
		Dim c As Short
		Dim CreatureX As Creature
		Dim TomeZ As Tome
		Dim CreatureZ As Creature
		Dim sPath As String
		On Error GoTo ErrorHandler
		DialogSetUp(bdDlgNoReply)
		DialogSetButton(1, "No")
		DialogSetButton(2, "Yes")
		DialogShow("DM", "Do you really wish to delete " & TomeX.Name & "?")
		picConvo.Visible = False
		' If Yes then Remove the Tome Files
		'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ConvoAction = 0 Then
			' sPath = gAppPath & "\World\" & WorldNow.Name & "\"
			sPath = gAppPath & "\World\"
			' Read in the Tome (if you can find it)
			FileName = sPath & TomeX.FileName
			'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If oFileSys.CheckExists(FileName, File) Then
				c = FreeFile
				TomeZ = New Tome
				FileOpen(c, FileName, OpenMode.Binary)
				TomeZ.ReadFromFile(c)
				FileClose(c)
				' Free up any characters in the Tome
				For	Each CreatureX In TomeZ.Creatures
					FileName = gAppPath & "\Roster\" & WorldNow.Name & "\"
					'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureX.RequiredInTome = False And oFileSys.CheckExists(FileName & CreatureX.Name & ".rsc", File) Then
						c = FreeFile
						CreatureZ = New Creature
						FileOpen(c, FileName & CreatureX.Name & ".rsc", OpenMode.Binary)
						CreatureZ.ReadFromFile(c)
						FileClose(c)
						CreatureZ.OnAdventure = False
						c = FreeFile
						FileOpen(c, FileName & CreatureZ.Name & ".rsc", OpenMode.Binary)
						CreatureZ.SaveToFile(c)
						FileClose(c)
					End If
				Next CreatureX
			End If
			' Clean out folder of origin under Tomes
			' FileName = Dir$(TomeX.FullPath & "\" & WorldNow.Name & "\" & Left$(TomeX.FileName, Len(TomeX.FileName) - 4) & "*.*")
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(TomeX.FullPath & "\" & VB.Left(TomeX.FileName, Len(TomeX.FileName) - 4) & "*.*")
			Do Until FileName = ""
				Kill(TomeX.FullPath & "\" & FileName)
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir()
			Loop 
			' [Titi 2.4.9b] Also remove the folder
			ChDir(gAppPath & "\Tomes\" & WorldNow.Name)
			RmDir(TomeX.FullPath)
			' Clean out World folder
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(gAppPath & "\World\" & WorldNow.Name & "\" & VB.Left(TomeX.FileName, Len(TomeX.FileName) - 5) & "*.*")
			Do Until FileName = ""
				Kill(gAppPath & "\World\" & WorldNow.Name & "\" & FileName)
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir()
			Loop 
			' Remove it from the TomeList
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeList.Remove("T" & TomeX.Index)
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeNewList(TomeIndex)
		End If
		Exit Sub
ErrorHandler: 
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("TomeDelete")
		Resume Next
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub TomeLoadParty(ByRef TomeX As Tome)
		Dim Tome_Renamed As Object
		' When this routine finishes, Tome contains the "right" version
		Dim c As Short
		Dim CreatureX, CreatureZ As Creature
		Dim FileName As String
		' If Tome is InPlay, then load from \World
		If TomeX.IsInPlay = True Then
			c = FreeFile
			'Open gAppPath & "\World\" & TomeX.FileName For Binary As c
			FileOpen(c, gAppPath & "\World\" & WorldNow.Name & "\" & TomeX.FileName, OpenMode.Binary)
			Tome = New Tome
			' [Titi 2.4.9b] reset bug here: new tomes by definition don't have the IsReset flag on!
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.IsReset. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.IsReset = TomeX.IsReset
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.IsPersistent. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.IsPersistent = TomeX.IsPersistent ' [Titi 2.6.1] make sure the flag is set
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.ReadFromFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.ReadFromFile(c)
			FileClose(c)
			' If reset, then restore the Party
			If TomeX.IsReset = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each CreatureX In Tome.Creatures
					'FileName = Dir(gAppPath & "\Roster\" & CreatureX.Name & ".rsc")
					'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
					FileName = Dir(gAppPath & "\Roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc")
					If FileName <> "" Then
						' Read the existing file
						c = FreeFile
						FileOpen(c, gAppPath & "\Roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc", OpenMode.Binary)
						CreatureZ = New Creature
						CreatureZ.ReadFromFile(c)
						FileClose(c)
						' Set to not on adventure and save back
						CreatureZ.OnAdventure = False
						c = FreeFile
						FileOpen(c, gAppPath & "\Roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc", OpenMode.Binary)
						CreatureZ.SaveToFile(c)
						FileClose(c)
					End If
				Next CreatureX
			End If
		End If
		' If InPlay and Reset or Not InPlay, load the Tome from it's FullPath
		If (TomeX.IsInPlay And TomeX.IsReset = True) Or TomeX.IsInPlay = False Then
			c = FreeFile
			FileOpen(c, TomeX.FullPath & "\" & TomeX.FileName, OpenMode.Binary)
			Tome = New Tome
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.ReadFromFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.ReadFromFile(c)
			FileClose(c)
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.OnAdventure = False
		End If
		' In anycase, make certain the FileName and FullPath are correct
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.FileName = TomeX.FileName
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.FullPath = TomeX.FullPath
	End Sub
	
	Private Function TomeInPlayCheck() As Object
		Dim TomeIndex As Object
		Dim TomeList As Object
		Dim c As Short
		Dim TomeX As Tome
		Dim CreatureX As Creature
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeInPlayCheck. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TomeInPlayCheck = False
		' If InPlay then check for existing Party
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(TomeIndex).IsInPlay. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeList(TomeIndex).IsInPlay = True Then
			' Get the Tome in the World folder and check for OnAdventure
			c = FreeFile
			'Open gAppPath & "\World\" & TomeList(TomeIndex).FileName For Binary As c
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeList(TomeIndex).FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileOpen(c, gAppPath & "\World\" & WorldNow.Name & "\" & TomeList(TomeIndex).FileName, OpenMode.Binary)
			TomeX = New Tome
			TomeX.ReadFromFileHeader(c)
			FileClose(c)
			If TomeX.OnAdventure = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeInPlayCheck. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeInPlayCheck = True
			End If
		End If
	End Function
	
	Private Sub TomeInfo(ByRef TomeX As Tome)
		Dim DialogDM As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		DialogSetUp(bdDlgNoReply)
		DialogSetButton(1, "Done")
		DialogDM("Folder Name: " & Mid(TomeX.FullPath, Len(gAppPath & "\Tomes\") + 1) & Chr(13) & "Tome File: " & TomeX.FileName & Chr(13) & "Modified: " & VB6.Format(FileDateTime(TomeX.FullPath & "\" & TomeX.FileName), "dddd, mmm d yyyy hh:mm AMPM") & Chr(13) & "File Size: " & FileLen(TomeX.FullPath & "\" & TomeX.FileName) & " Bytes")
		picConvo.Visible = False
	End Sub
	
	Private Sub TomeCopy(ByRef TomeX As Tome)
		Dim Folder As Object
		Dim oFileSys As Object
		Dim FileName As String
		Dim c As Short
		' If InPlay, read in the Tome
		' If not InPlay or resetting the Tome, clean up and copy the Tome and Area files
		If TomeX.IsInPlay = False Or TomeX.IsReset = True Then
			' Delete any copies already in the \world directory
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(gAppPath & "\world\" & WorldNow.Name & "\" & Mid(TomeX.FileName, 1, Len(TomeX.FileName) - 4) & "*.*")
			If FileName <> "" Then
				Kill(gAppPath & "\world\" & WorldNow.Name & "\" & Mid(TomeX.FileName, 1, Len(TomeX.FileName) - 4) & "*.*")
			End If
			' Save the Tome to the \world directory
			' [Titi 2.4.9b] Check if the \world folder under the \tomes exists. If not, create it.
			'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			c = oFileSys.CheckExists(gAppPath & "\World\" & WorldNow.Name, Folder, True)
			c = FreeFile
			FileOpen(c, gAppPath & "\world\" & WorldNow.Name & "\" & TomeX.FileName, OpenMode.Binary)
			TomeX.OnAdventure = False
			TomeX.SaveToFile(c)
			FileClose(c)
			' Copy Area files to \world directory
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(TomeX.FullPath & "\*.rsa")
			Do Until FileName = ""
				FileCopy(TomeX.FullPath & "\" & FileName, gAppPath & "\world\" & WorldNow.Name & "\" & FileName)
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir()
			Loop 
		End If
		Exit Sub
	End Sub
	
	Private Sub TomeStartClearGlobals()
		Dim GlobalTicks As Object
		Dim GlobalTurnName As Object
		Dim GlobalYearName As Object
		Dim GlobalMoonName As Object
		Dim GlobalDayName As Object
		Dim GlobalTextC As Object
		Dim GlobalTextB As Object
		Dim GlobalTextA As Object
		Dim GlobalIntegerC As Object
		Dim GlobalIntegerB As Object
		Dim GlobalIntegerA As Object
		Dim GlobalRemoveTrapChance As Object
		Dim GlobalPickLockChance As Object
		Dim GlobalDamageStyle As Object
		Dim GlobalSkillLevel As Object
		Dim GlobalOffer As Object
		Dim GlobalDieCountRoll As Object
		Dim GlobalDieTypeRoll As Object
		Dim GlobalDamageRoll As Object
		Dim GlobalHitLocation As Object
		Dim GlobalArmorRoll As Object
		Dim GlobalAttackRoll As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalAttackRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalAttackRoll = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalArmorRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalArmorRoll = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalHitLocation. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalHitLocation = ""
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDamageRoll = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDieTypeRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDieTypeRoll = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDieCountRoll. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDieCountRoll = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalOffer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalOffer = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalSkillLevel. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalSkillLevel = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDamageStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDamageStyle = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalPickLockChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalPickLockChance = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalRemoveTrapChance. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalRemoveTrapChance = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalIntegerA. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalIntegerA = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalIntegerB. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalIntegerB = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalIntegerC. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalIntegerC = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTextA. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalTextA = ""
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTextB. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalTextB = ""
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTextC. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalTextC = ""
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDayName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDayName = ""
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalMoonName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalMoonName = ""
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalYearName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalYearName = ""
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTurnName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalTurnName = ""
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTicks. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalTicks = 0
		TurnsBeforeNextCamp = 0
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub TomeStart(ByRef TomeX As Tome)
		Dim bdFontSmallWhite As Object
		Dim GlobalYearName As Object
		Dim GlobalMoonName As Object
		Dim GlobalDayName As Object
		Dim GlobalTurnName As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim Map_Renamed As Object
		Dim Adventure As Object
		Dim PlayMusicRnd As Object
		Dim vsPLAYING As Object
		Dim oGameMusic As Object
		Dim DialogDM As Object
		Dim CreatureWithTurn As Object
		Dim Tome_Renamed As Object
		Dim Frozen As Object
		Dim bdTomeGather As Object
		Dim bdTomeNew As Object
		Dim TomeAction As Object
		Dim File As Object
		Dim oFileSys As Object
		' This presumes that TomeX is already in the /world directory
		Dim c As Short
		Dim AreaX As Area
		Dim MapX As Map
		Dim CreatureX As Creature
		Dim FileName As String
		Dim NoFail, Found As Short
		Dim Creatures As Collection
		' [Titi 2.4.9] if tome is a home tome, load version in progress, unless a saved game is selected
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeGather. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeAction = bdTomeNew Or TomeAction = bdTomeGather Then
			FileName = gAppPath & "\Roster\" & WorldNow.Name & "\Home\" & TomeX.FileName
			Creatures = New Collection
			For	Each CreatureX In TomeX.Creatures
				Creatures.Add(CreatureX)
				If CreatureX.Home = WorldNow.Name & "/" & VB.Right(TomeX.FullPath, Len(TomeX.FullPath) - InStrRev(TomeX.FullPath, "\")) & "/" & TomeX.FileName Then
					' found a character whose home this tome is
					'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If oFileSys.CheckExists(FileName, File) Then
						' and this tome has already been lived in
						IsHomeTome = True
					End If
				End If
			Next CreatureX
			If IsHomeTome Then
				TomeRestore(FileName, True)
				For	Each CreatureX In TomeX.Creatures
					TomeX.RemoveCreature("X" & CreatureX.Index)
				Next CreatureX
				Do While Creatures.Count() > 0
					CreatureX = Creatures.Item(Creatures.Count())
					TomeX.AddCreature.Copy(CreatureX)
					Creatures.Remove((Creatures.Count()))
				Loop 
			End If
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = True
		' Create Tome Object
		Tome = TomeX
		' [Titi 2.4.7] Tome.LoadPath not set?
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.LoadPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.LoadPath = Tome.FullPath
		CreatureWithTurn = New Creature
		' Check the obvious errors
		If TomeX.Creatures.Count() < 1 Then
			DialogDM("Nobody is on this adventure.")
			GameEnd(False)
			Exit Sub
		End If
		If TomeX.Areas.Count() < 1 Then
			DialogDM("There are no Maps in this Tome.")
			GameEnd(False)
			Exit Sub
		End If
		If TomeX.AreaIndex < 1 Or TomeX.MapIndex < 1 Then
			DialogDM("There is no connecting EntryPoint in this Tome.")
			GameEnd(False)
			Exit Sub
		End If
		' Check for live Party
		Found = False
		For	Each CreatureX In TomeX.Creatures
			If CreatureX.HPNow > 0 Then
				Found = True
				Exit For
			End If
		Next CreatureX
		If Not Found Then
			DialogDM("Everybody on this adventure is dead.")
			GameEnd(False)
			Exit Sub
		End If
		' [Titi 2.4.9] moved this block out of the following For/Next CreatureX loop
		'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.Status. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If oGameMusic.Status = vsPLAYING Then
			'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.mciClose. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Call oGameMusic.mciClose()
		End If
		' Display Party
		LoadPartyPics()
		MenuDrawParty()
		' Set CreatureWithTurn to first party member
		SetTurn(0)
		' Clear Global Variables
		TomeStartClearGlobals()
		' [borf] 2.4.7 moved this here so that users can assign a song to their tome in the Enter_Tome trigger without it being jacked by this call below.
		Call PlayMusicRnd(Adventure, Me)
		' [Titi 2.4.9a] moved here to have the Post-EnterTome and On-EnterTome triggers fired before the encounter triggers
		' Draw Borders (turn off drawing runes for a moment) [Titi 2.4.9] moved here to have the borders free of runes when tomes titles/splashscreens show
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.IsNoRunes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Found = Map.IsNoRunes '[Titi 2.4.9]
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.IsNoRunes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Map.IsNoRunes = True
		BorderDrawAll(True)
		' Fire Post-EnterTome Triggers
		If TomeX.OnAdventure = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			NoFail = FireTriggers(Tome, bdPostEnterTome)
			If NoFail = False Then
				GameEnd(False)
				Exit Sub
			End If
		End If
		' fire On-EnterHome triggers (even if tome is on adventure!)
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(Tome, bdOnEnterHome)
		If NoFail = False Then
			GameEnd(False)
			Exit Sub
		End If
		' Save all the Creatures in this Tome (that are not locked NPCs)
		For	Each CreatureX In TomeX.Creatures
			If CreatureX.RequiredInTome = False And CreatureX.OnAdventure = False Then
				CreatureX.OnAdventure = True
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc")
				If FileName <> "" Then
					FileName = gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc"
					' RT 76 error! was Filename instead of CreatureX.Name & ".rsc"
					Kill(FileName)
				Else
					' RT 76 error! was Filename instead of CreatureX.Name & ".rsc"
					FileName = gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc" ' error! was Filename
				End If
				c = FreeFile
				FileOpen(c, FileName, OpenMode.Binary)
				CreatureX.SaveToFile(c)
				FileClose(c)
			End If
			' [Titi 2.4.9] check if current tome is the home of the active character
			' note the "/" instead of "\" - this is due to the use of "/" or "/n" as carriage return
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.LoadPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureX.Home = WorldNow.Name & "/" & VB.Right(Tome.LoadPath, Len(Tome.LoadPath) - InStrRev(Tome.LoadPath, "\")) & "/" & Tome.FileName Then
				' The character has elected this tome as his living place.
				' Fire 'Home' triggers to put things back as they were when he left
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(CreatureX, bdOnEnterHome)
				If NoFail = False Then
					GameEnd(False)
					Exit Sub
				End If
			End If
		Next CreatureX
		' [Titi 2.6.0] reset list of characters on adventure
		ReDim OnAdventureList(0)
		' Load Current Plot
		If TomeX.OnAdventure = True Then
			TomeStartArea((TomeX.AreaIndex), (TomeX.MapIndex), 0, (TomeX.MapX), (TomeX.MapY))
		Else
			TomeStartArea((TomeX.AreaIndex), (TomeX.MapIndex), (TomeX.EntryIndex), (TomeX.MapX), (TomeX.MapY))
		End If
		' Save Tome to \Worlds folder
		c = FreeFile
		FileOpen(c, gAppPath & "\World\" & WorldNow.Name & "\" & TomeX.FileName, OpenMode.Binary)
		TomeX.OnAdventure = True
		TomeX.SaveToFile(c)
		FileClose(c)
		' Run a TurnCycle
		TurnCycle()
		' Stop Party moving and Play Map Music
		tmrMoveParty.Enabled = False
		'    Call PlayMusicRnd(Adventure, Me)
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = False
		'[Titi 2.4.9] set the runes back to the correct status
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.IsNoRunes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Map.IsNoRunes = Found
		BorderDrawAll(True)
		' [Titi 2.4.9b] show date
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Turn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTurnName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalTurnName = "Turn " & Tome.Turn
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Cycle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDayName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalDayName = "Day " & Tome.Cycle
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Moon. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalMoonName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalMoonName = "of Moon " & Tome.Moon
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Year. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalYearName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalYearName = "in the Year " & Tome.Year
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalYearName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalMoonName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalDayName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTurnName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(Me, 0, 2, Me.ClientRectangle.Width, 14, bdFontSmallWhite, " ( " & GlobalTurnName & " ) ( " & GlobalDayName & " " & GlobalMoonName & " " & GlobalYearName & " ) ", True, False)
		Me.Refresh()
		picMap.Focus()
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Area was upgraded to Area_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub TomeStartArea(ByRef AreaIndex As Short, ByRef MapIndex As Short, ByRef EntryIndex As Short, ByRef AtX As Short, ByRef AtY As Short, Optional ByRef MapName As String = "")
		Dim Map_Renamed As Object
		Dim Area_Renamed As Object
		Dim DialogDM As Object
		Dim File As Object
		Dim Tome_Renamed As Object
		Dim TomeSavePathName As Object
		Dim Folder As Object
		Dim oFileSys As Object
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim CreatureWithTurn As Object
		Dim ItemNow As Object
		Dim i, c, Found As Short
		Dim CreatureX As Creature
		Dim FileName As String
		Dim NoFail As Short
		Dim AreaX As Area
		Dim MapX As Map
		Dim EntryX As EntryPoint
		Dim EncounterX As Encounter
		' If going to AreaIndex = 0 then Exit to Menu
		If AreaIndex = 0 Then
			' Fire Pre-ExitTome Triggers
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ItemNow = CreatureWithTurn.ItemInHand
			NoFail = FireTriggers(EncounterNow, bdPreExitTome) And FireTriggers(Tome, bdPreExitTome)
			If NoFail Then
				' Save out the Party
				For	Each CreatureX In Tome.Creatures
					' [Titi 2.4.9] store 'home' info
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.LoadPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureX.Home = WorldNow.Name & "/" & VB.Right(Tome.LoadPath, Len(Tome.LoadPath) - InStrRev(Tome.LoadPath, "\")) & "/" & Tome.FileName Then
						' [Titi 2.5.1] only needs to be saved once!
						If Found = False Then
							'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.CheckExists. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							c = oFileSys.CheckExists(gAppPath & "\Roster\" & WorldNow.Name & "\Home", Folder, True)
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePathName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							TomeSavePathName = gAppPath & "\Roster\" & WorldNow.Name & "\Home"
							'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object TomeSavePathName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							FileName = TomeSavePathName & "\" & Tome.FileName
							TomeSave(False)
							Found = True
						End If
					End If
					If Found = False Then
						' means it's not a home tome, where the character is likely to come again and again
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureX.Infos.Tomes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureX.Infos.Tomes = CreatureX.Infos.Tomes + 1
					End If
					If CreatureX.RequiredInTome = False Then
						CreatureX.OnAdventure = False
						'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Move. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						FileName = oFileSys.Move(gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc", File,  , True)
						On Error Resume Next
						c = FreeFile
						FileOpen(c, gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc", OpenMode.Binary)
						CreatureX.SaveToFile(c)
						FileClose(c)
						If Err.Number <> 0 Then ' error occured lets put rollback
							'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Move. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							Call oFileSys.Move(FileName, File, gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc")
							DialogDM("Could not save character " & CreatureX.Name & ".")
							Exit Sub
						Else
							'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Delete. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							Call oFileSys.Delete(FileName, File, True)
						End If
						' Clear out the Tome [Titi 2.4.9] no need for another loop!
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RemoveCreature. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Tome.RemoveCreature("X" & CreatureX.Index)
					End If
				Next CreatureX
				'            ' Clear out the Tome
				'            For Each CreatureX In Tome.Creatures
				'                If CreatureX.RequiredInTome = False Then
				'                    Tome.RemoveCreature "X" & CreatureX.Index
				'                End If
				'            Next CreatureX
				' Save Tome to Worlds folder
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Move. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = oFileSys.Move(gAppPath & "\World\" & WorldNow.Name & "\" & Tome.FileName, File,  , True)
				On Error Resume Next
				c = FreeFile
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileOpen(c, gAppPath & "\World\" & WorldNow.Name & "\" & Tome.FileName, OpenMode.Binary)
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.OnAdventure. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.OnAdventure = False
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.SaveToFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.SaveToFile(c)
				FileClose(c)
				If Err.Number <> 0 Then
					'                Call oFileSys.Move(Filename, File, gAppPath & "\roster\" & WorldNow.Name & "\" & CreatureX.Name & ".rsc")
					'               [Titi] shouldn't we save the tome here?
					'               Not a problem if one area, but will prevent the "Reset the Tome?" box from showing if more than one area
					'               since the OnAdventure property is not set into the correct "tome" file
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Move. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Call oFileSys.Move(FileName, File, gAppPath & "\World\" & WorldNow.Name & "\" & Tome.FileName & ".tom")
					DialogDM("Could not save tome.")
					Exit Sub
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object oFileSys.Delete. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Call oFileSys.Delete(FileName, File, True)
				End If
				'[borfaux] Still need to remove all the saved tomes so characters don't get fubar
				' [Titi 2.4.9] Delete any copies already in the \world directory
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gAppPath & "\world\" & WorldNow.Name & "\" & Mid(Tome.FileName, 1, Len(Tome.FileName) - 4) & "*.*")
				If FileName <> "" Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Kill(gAppPath & "\world\" & WorldNow.Name & "\" & Mid(Tome.FileName, 1, Len(Tome.FileName) - 4) & "*.*")
				End If
				' Back to the Main Menu
				GameEnd(False)
			End If
			Exit Sub
		End If
		' Find Plot to load
		Found = False
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Areas. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each AreaX In Tome.Areas
			If AreaX.Index = AreaIndex Then
				FileName = AreaX.FileName
				Found = True
				Exit For
			End If
		Next AreaX
		If Not Found Then
			DialogDM("Could not locate Area #" & AreaIndex & " for this Tome.")
			GameEnd(False)
			Exit Sub
		End If
		' If new Area, then save current and load new
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		'UPGRADE_WARNING: Couldn't resolve default property of object Area.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If AreaX.Index <> Area.Index Then
			If Area.Index <> 0 Then
				Call TomeSaveArea(gAppPath & "\World\" & WorldNow.Name)
				If IsHomeTome Then ' [Titi 2.5.1] keep a copy in the roster folder
					Call TomeSaveArea(gAppPath & "\Roster\" & WorldNow.Name & "\Home")
				End If
				'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
			End If
			c = FreeFile
			'Open gAppPath & "\world\" & FileName For Binary As c
			FileOpen(c, gAppPath & "\world\" & WorldNow.Name & "\" & FileName, OpenMode.Binary)
			Area = New Area
			'UPGRADE_WARNING: Couldn't resolve default property of object Area.Plot. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Area.Plot.ReadFromFile(c)
			'UPGRADE_WARNING: Couldn't resolve default property of object Area.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Area.Index = AreaIndex
			'UPGRADE_WARNING: Couldn't resolve default property of object Area.FileName. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Area.FileName = FileName
			FileClose(c)
		End If
		' Check if missing Maps
		'UPGRADE_WARNING: Couldn't resolve default property of object Area.Plot. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Area.Plot.Maps.Count < 1 Then
			DialogDM("There are no Maps in the starting Area.")
			GameEnd(False)
			Exit Sub
		End If
		' Set current Map (will autodraw when window sizes)
		Found = False
		'UPGRADE_WARNING: Couldn't resolve default property of object Area.Plot. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each MapX In Area.Plot.Maps
			If MapX.Index = MapIndex Or MapX.Name = MapName Then
				Map = MapX
				Found = True
				Exit For
			End If
		Next MapX
		If Not Found Then
			'UPGRADE_NOTE: IsMissing() was changed to IsNothing(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="8AE1CB93-37AB-439A-A4FF-BE3B6760BB23"'
			If Not IsNothing(MapName) Then
				DialogDM("Could not locate Map '" & MapName & "' for Area.")
			Else
				DialogDM("Could not locate Map #" & MapIndex & " for Area.")
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MapCenter(Tome.MapX, Tome.MapY)
			DrawMapAll()
			'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
			Exit Sub
		End If
		' ReGen Map if set
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.GenerateUponEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Map.GenerateUponEntry = True Then
			modDungeonMaker.MakeMap(Map, True)
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.GenerateUponEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Map.GenerateUponEntry = False
		End If
		' [Titi 2.5.1] Now is time to check if TargetEncounterInArea can be found in the current map
		Found = False
		If intCountEncounterTarget >= 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Encounters. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each EncounterX In Map.Encounters
				For c = 0 To intCountEncounterTarget
					If ListEncounterTarget(c).Name = EncounterX.Name And ListEncounterTarget(c).Index = EncounterX.Index Then
						' all the changes made to the encounter are not yet applied (the map has just been loaded), so let's do it now
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Encounters. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Map.Encounters(EncounterX.Index).Copy(ListEncounterTarget(c))
						ListEncounterTarget(c).Index = -1 ' flag to remember the encounter has been copied
						Found = True
						Exit For
					End If
				Next 
				If Found = True Then
					Exit For
				End If
			Next EncounterX
		End If
		' Locate EntryPoint and set (if first time in)
		Found = False
		For	Each EntryX In MapX.EntryPoints
			If EntryX.Index = EntryIndex Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.MapX = EntryX.MapX
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.MapY = EntryX.MapY
				Found = True
				Exit For
			End If
		Next EntryX
		If Found = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MapX = AtX
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MapY = AtY
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.MoveToX = Tome.MapX
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.MoveToY = Tome.MapY
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.AreaIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.AreaIndex = AreaIndex
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.MapIndex = MapIndex
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.EntryIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Tome.EntryIndex = EntryIndex
		' Set all CreatureWithTurns in Party to Map's starting point
		c = -1
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In Tome.Creatures
			c = LoopNumber(0, 4, c, 1)
			CreatureX.TileSpot = c
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureX.MapX = Tome.MapX
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureX.MapY = Tome.MapY
		Next CreatureX
		' [Titi 2.4.9b] Override Map.IsNoRunes if the world magic doesn't use the runes system
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.IsNoRunes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If WorldNow.Runes Then Map.IsNoRunes = True
		' Draw Map
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		MapCenter(Tome.MapX, Tome.MapY)
		DrawMapAll()
		MoveParty()
		BorderDrawAll(True)
		' Set up current Encounter
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Map.EncPointer(Tome.MapX, Tome.MapY) > 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Encounters. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			EncounterNow = Map.Encounters("E" & Map.EncPointer(Tome.MapX, Tome.MapY))
		Else
			EncounterNow = New Encounter
		End If
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		' Enter Encounter
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.IsActive. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If EncounterNow.IsActive = True Then
			EncounterEnter()
		End If
		Me.Refresh()
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub LoadTileSetMicro()
		Dim bdMicroSize As Object
		Dim Map_Renamed As Object
		Dim Tome_Renamed As Object
		' Load and sets Tiles for Map
		Dim FileName As String
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed, OldWidth As Short
		Dim hMemTiles As Integer
		'UPGRADE_WARNING: Arrays in structure bmTiles may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmTiles As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmBlack may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmBlack As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmMask may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMask As BITMAPINFO
		Dim rc, lpMem, TransparentRGB As Integer
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor ' Hourglass
		' Load TileSet bitmap
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(Tome.FullPath & "\" & Map.PictureFile)
		If FileName = "" Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(Tome.FullPath & "\tiles\" & Map.PictureFile)
			If FileName = "" Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gAppPath & "\roster\" & WorldNow.Name & "\" & Map.PictureFile)
				If FileName = "" Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
					FileName = Dir(gAppPath & "\roster\" & WorldNow.Name & "\Tiles\" & Map.PictureFile)
					'FileName = Dir(gAppPath & "\data\graphics\tiles\" & Map.PictureFile)
					'FileName = gAppPath & "\data\graphics\tiles\" & Map.PictureFile
					If FileName = "" Then
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						FileName = gDataPath & "\graphics\tiles\" & Map.PictureFile
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						FileName = gAppPath & "\roster\" & WorldNow.Name & "\Tiles\" & Map.PictureFile
					End If
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					FileName = gAppPath & "\roster\" & WorldNow.Name & "\" & Map.PictureFile
				End If
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = Tome.FullPath & "\tiles\" & Map.PictureFile
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileName = Tome.FullPath & "\" & Map.PictureFile
		End If
		ReadBitmapFile(FileName, bmTiles, hMemTiles, TransparentRGB)
		' Make a copy of the current palette for the picture
		'UPGRADE_WARNING: Couldn't resolve default property of object bmBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		bmBlack = bmTiles
		' Build palettes: first, change from blue to black
		ChangeColor(bmBlack, TransparentRGB, 0, 0, 0)
		' Convert to Mask (pure Blue is the mask color)
		MakeMask(bmTiles, bmMask, TransparentRGB)
		' Paint bitmap to picture box using converted palette
		lpMem = GlobalLock(hMemTiles)
		Width_Renamed = bmTiles.bmiHeader.biWidth
		Height_Renamed = bmTiles.bmiHeader.biHeight
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMicroSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		picTSmall.Width = Width_Renamed * 2 * bdMicroSize
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMicroSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		picTSmall.Height = Height_Renamed * 2 * bdMicroSize
		'UPGRADE_ISSUE: PictureBox property picTSmall.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picTSmall.hdc, 3)
		' Upper left quad: normal picture
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMicroSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picTSmall.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picTSmall.hdc, 0, 0, Width_Renamed * bdMicroSize, Height_Renamed * bdMicroSize, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmTiles, DIB_RGB_COLORS, SRCCOPY)
		' Upper right quad: flip normal picture
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMicroSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picTSmall.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picTSmall.hdc, Width_Renamed * bdMicroSize, 0, Width_Renamed * bdMicroSize, Height_Renamed * bdMicroSize, picTSmall.hdc, Width_Renamed * bdMicroSize - 1, 0, -Width_Renamed * bdMicroSize, Height_Renamed * bdMicroSize, SRCCOPY)
		' Lower left quad: mask
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMicroSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picTSmall.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picTSmall.hdc, 0, Height_Renamed * bdMicroSize, Width_Renamed * bdMicroSize, Height_Renamed * bdMicroSize, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmMask, DIB_RGB_COLORS, SRCCOPY)
		' Lower right quadrant: flip mask
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMicroSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picTSmall.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picTSmall.hdc, Width_Renamed * bdMicroSize, Height_Renamed * bdMicroSize, Width_Renamed * bdMicroSize, Height_Renamed * bdMicroSize, picTSmall.hdc, Width_Renamed * bdMicroSize - 1, Height_Renamed * bdMicroSize, -Width_Renamed * bdMicroSize, Height_Renamed * bdMicroSize, SRCCOPY)
		' Set Current TileSet Name and release memory
		rc = GlobalUnlock(hMemTiles)
		rc = GlobalFree(hMemTiles)
		picTSmall.Refresh()
		' Load DarkTile bitmap
		'    ReadBitmapFile gAppPath & "\data\stock\darkmicro.bmp", bmTiles, hMemTiles, TransparentRGB
		ReadBitmapFile(gDataPath & "\stock\darkmicro.bmp", bmTiles, hMemTiles, TransparentRGB)
		' Paint bitmap to picture box using converted palette
		lpMem = GlobalLock(hMemTiles)
		Width_Renamed = bmTiles.bmiHeader.biWidth
		Height_Renamed = bmTiles.bmiHeader.biHeight
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMicroSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		picBlackHeightSmall = (Height_Renamed * bdMicroSize) / 2
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMicroSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		picBlack.Width = bdBlackWidth + Width_Renamed * bdMicroSize
		' Writes out normal tiles (black border) to upper left.
		'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picBlack.hdc, 3)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMicroSize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picBlack.hdc, bdBlackWidth, 0, Width_Renamed * bdMicroSize, Height_Renamed * bdMicroSize, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmTiles, DIB_RGB_COLORS, SRCCOPY)
		' Release memory
		rc = GlobalUnlock(hMemTiles)
		rc = GlobalFree(hMemTiles)
		picBlack.Refresh()
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default ' Default
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub LoadTileSet(ByRef AsDark As Short, ByRef SupressMsg As Short)
		Dim Map_Renamed As Object
		Dim Tome_Renamed As Object
		' Load and sets Tiles for Map
		Dim FileName As String
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Height_Renamed, Width_Renamed As Short
		Dim hMemTiles As Integer
		'UPGRADE_WARNING: Arrays in structure bmTiles may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmTiles As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmDark may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		'UPGRADE_WARNING: Arrays in structure bmBlack may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmBlack, bmDark As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmMask may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMask As BITMAPINFO
		Dim rc, lpMem, TransparentRGB As Integer
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor ' Hourglass
		If Not SupressMsg Then
			MessageShow("Loading Map..", 0)
		End If
		' Load TileSet bitmap
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(Tome.FullPath & "\" & Map.PictureFile)
		If FileName = "" Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(Tome.FullPath & "\tiles\" & Map.PictureFile)
			If FileName = "" Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gAppPath & "\roster\" & WorldNow.Name & "\" & Map.PictureFile)
				If FileName = "" Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
					FileName = Dir(gAppPath & "\roster\" & WorldNow.Name & "\Tiles\" & Map.PictureFile)
					'    FileName = gAppPath & "\data\graphics\tiles\" & Map.PictureFile
					If FileName = "" Then
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						FileName = gDataPath & "\graphics\tiles\" & Map.PictureFile
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						FileName = gAppPath & "\roster\" & WorldNow.Name & "\Tiles\" & Map.PictureFile
					End If
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					FileName = gAppPath & "\roster\" & WorldNow.Name & "\" & Map.PictureFile
				End If
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = Tome.FullPath & "\tiles\" & Map.PictureFile
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileName = Tome.FullPath & "\" & Map.PictureFile
		End If
		ReadBitmapFile(FileName, bmTiles, hMemTiles, TransparentRGB)
		' Make a copy of the current palette for the picture
		If Not SupressMsg Then
			MessageShow("Loading Map....", 0)
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object bmBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		bmBlack = bmTiles
		' Build palettes: first, change from blue to black
		ChangeColor(bmBlack, TransparentRGB, 0, 0, 0)
		' Convert to Mask (pure Blue is the mask color)
		MakeMask(bmTiles, bmMask, TransparentRGB)
		' Darken a bit
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.IsOutside. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Map.IsOutside = True Then
			MakeDark(bmBlack, bmDark, AsDark)
		Else
			MakeDark(bmBlack, bmDark, 0)
		End If
		' Paint bitmap to picture box using converted palette
		lpMem = GlobalLock(hMemTiles)
		Width_Renamed = bmTiles.bmiHeader.biWidth
		Height_Renamed = bmTiles.bmiHeader.biHeight
		'UPGRADE_ISSUE: PictureBox method picTPic.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		picTPic.Cls()
		picTPic.Width = Width_Renamed * 2
		picTPic.Height = Height_Renamed * 2
		If Not SupressMsg Then
			MessageShow("Loading Map.....", 0)
		End If
		' Upper left quad: normal picture
		'UPGRADE_ISSUE: PictureBox property picTPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picTPic.hdc, 3)
		'UPGRADE_ISSUE: PictureBox property picTPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picTPic.hdc, 0, 0, Width_Renamed, Height_Renamed, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmDark, DIB_RGB_COLORS, SRCCOPY)
		If Not SupressMsg Then
			MessageShow("Loading Map......", 0)
		End If
		' Upper right quad: flip normal picture
		'UPGRADE_ISSUE: PictureBox property picTPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picTPic.hdc, Width_Renamed, 0, Width_Renamed, Height_Renamed, picTPic.hdc, Width_Renamed - 1, 0, -Width_Renamed, Height_Renamed, SRCCOPY)
		' Lower left quad: mask
		'UPGRADE_ISSUE: PictureBox property picTPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picTPic.hdc, 0, Height_Renamed, Width_Renamed, Height_Renamed, 0, 0, Width_Renamed, Height_Renamed, lpMem, bmMask, DIB_RGB_COLORS, SRCCOPY)
		If Not SupressMsg Then
			MessageShow("Loading Map........", 0)
		End If
		' Lower right quadrant: flip mask
		'UPGRADE_ISSUE: PictureBox property picTPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picTPic.hdc, Width_Renamed, Height_Renamed, Width_Renamed, Height_Renamed, picTPic.hdc, Width_Renamed - 1, Height_Renamed, -Width_Renamed, Height_Renamed, SRCCOPY)
		picTPic.Refresh()
		' Release memory
		If Not SupressMsg Then
			MessageShow("Loading Map..........", 0)
		End If
		' Set Current TileSet Name
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		TileSetLoaded = Map.PictureFile
		rc = GlobalUnlock(hMemTiles)
		rc = GlobalFree(hMemTiles)
		If Not SupressMsg Then
			MessageClear()
		End If
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default ' Default
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub PlotTile(ByRef TileToPlot As Short, ByRef X As Short, ByRef Y As Short, ByRef XWidth As Short, ByRef YWidth As Short, ByRef XSrcOff As Short, ByRef YSrcOff As Short, ByRef XFlip As Short)
		Dim Tome_Renamed As Object
		Dim Map_Renamed As Object
		Dim DialogDM As Object
		Dim oErr As Object
		Dim bdTileDark As Object
		Dim bdTileGrey As Object
		Dim bdTileBlack As Object
		Dim rc As Integer
		Dim MaxHeight, MaxWidth As Short
		Dim TileX, TileY As Short
		' [Titi 2.4.6] case of the missing tileset
		Dim save As String
		On Error GoTo ErrorHandler
		' Draw tile
		If TileToPlot < 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileDark. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileGrey. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Select Case TileToPlot
				Case bdTileBlack ' Pure Black
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMap.hdc, X, Y, XWidth, YWidth, picBlack.hdc, XSrcOff, 72 + YSrcOff, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMap.hdc, X, Y, XWidth, YWidth, picBlack.hdc, XSrcOff, YSrcOff, SRCPAINT)
				Case bdTileGrey ' Light Dim
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMap.hdc, X, Y, XWidth, YWidth, picBlack.hdc, 96 + XSrcOff, YSrcOff, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMap.hdc, X, Y, XWidth, YWidth, picBlack.hdc, XSrcOff, YSrcOff, SRCPAINT)
				Case bdTileDark ' Dark Dim
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMap.hdc, X, Y, XWidth, YWidth, picBlack.hdc, 96 + XSrcOff, YSrcOff, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMap.hdc, X, Y, XWidth, YWidth, picBlack.hdc, XSrcOff, YSrcOff, SRCPAINT)
			End Select
		Else
			' Set height, width and location of tile in bmp
			MaxHeight = (picTPic.Height / 144)
			MaxWidth = (picTPic.Width / 192)
			TileX = 96 * Int(TileToPlot / MaxHeight)
			TileY = 72 * (TileToPlot Mod MaxHeight)
			If XFlip = True Then
				TileX = picTPic.Width - 96 * (TileX / 96) - 96
			End If
			'UPGRADE_ISSUE: PictureBox property picTPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMap.hdc, X, Y, XWidth, YWidth, picTPic.hdc, TileX + XSrcOff, TileY + YSrcOff + (picTPic.Height / 2), SRCAND)
			'UPGRADE_ISSUE: PictureBox property picTPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMap.hdc, X, Y, XWidth, YWidth, picTPic.hdc, TileX + XSrcOff, TileY + YSrcOff, SRCPAINT)
		End If
		Exit Sub
ErrorHandler: 
		'UPGRADE_WARNING: Couldn't resolve default property of object oErr.logError. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oErr.logError("PlotTile")
		If Err.Number = 11 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.PictureFile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DialogDM("Sorry, you cannot enter this area without the tileset named " & Map.PictureFile)
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MoveToX = FromEntryPoint.MapX
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MoveToY = FromEntryPoint.MapY
			'UPGRADE_NOTE: Object FromEntryPoint may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			FromEntryPoint = Nothing
			MovePartyExit(True)
			'        save = MsgBox("Save the game now?", vbYesNo)
			'        If save = vbYes Then
			'            TomeSavesLoad
			'            CreateNameNew = "Missing " & Map.PictureFile & " (" & CreateNameNew & ")"
			'            TomeSave True, False
			'        End If
			'        End
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub CombatFlee()
		Dim DialogDM As Object
		Dim EncounterNow As Object
		Dim Tome_Renamed As Object
		Dim CreatureWithTurn As Object
		' Check for chance to flee
		If picGrid.Visible = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Afraid. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.Afraid = True
			CombatMove(MOVEDIRECTION.bdMoveFlee, MOVEDIRECTION.bdMoveFlee)
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FleeToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FleeToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MovePartySet(0, 0, Tome.FleeToX, Tome.FleeToY)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			CreatureWithTurn.ActionPoints = 0
			CombatNextTurn()
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.ChanceToFlee. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf Int(Rnd() * 100) < EncounterNow.ChanceToFlee Then 
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FleeToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FleeToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MovePartySet(0, 0, Tome.FleeToX, Tome.FleeToY)
		Else
			DialogDM("You try to flee, but fail.")
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub MoveParty()
		Dim JournalMode As Object
		Dim JournalShowMap As Object
		Dim FireTriggers As Object
		Dim CreatureWithTurn As Object
		Dim ItemNow As Object
		Dim EncounterNow As Object
		Dim Map_Renamed As Object
		Dim DialogBrief As Object
		Dim DialogSetUp As Object
		Dim Tome_Renamed As Object
		'UPGRADE_NOTE: my was upgraded to my_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim X, mx, my_Renamed, Y As Short
		Dim cy, cx, Found As Short
		Dim Friendly, i, c, k, NoFail As Short
		Dim MaxX, MinX, MinY, MaxY As Short
		Dim rc, cdir As Short
		Dim CreatureX As Creature
		Dim TileX As Tile
		Dim NewEncounter As Short
		Dim EntryPointX As EntryPoint
		Dim Start, sinTooHeavy, PauseTime As Single
		Dim CreatureY As Creature
		' [Titi 2.5.1] borrow an existing boolean variable to check if the party did move (used for wandering monsters check)
		bFromMainMenu = True
		' Find minimum and maximum coordinates of Party
		MinX = 32700 : MinY = 32700
		' If Party standing in destination, then wipe destination. Disable movement.
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Tome.MapX = Tome.MoveToX And Tome.MapY = Tome.MoveToY Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MoveToX = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MoveToY = 0
			tmrMoveParty.Enabled = False
		End If
		' Move Tome
		NewEncounter = False
		If tmrMoveParty.Enabled = True Then
			' [Titi 2.4.8] slow movement if too heavy!
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each CreatureX In Tome.Creatures
				If (CreatureX.Weight > CreatureX.MaxWeight * 0.75 Or CreatureX.Bulk > 0.75 * CreatureX.Agility * 8) And sinTooHeavy <> 2 Then
					sinTooHeavy = 1
					If Not CreatureY Is Nothing Then
						If CreatureY.Weight / CreatureY.MaxWeight < CreatureX.Weight / CreatureX.MaxWeight Then
							CreatureY = CreatureX
						End If
					Else
						CreatureY = CreatureX
					End If
				End If
				If CreatureX.Weight > CreatureX.MaxWeight * 0.9 Or CreatureX.Bulk > 0.9 * CreatureX.Agility * 8 Then
					sinTooHeavy = 2
					If Not CreatureY Is Nothing Then
						If CreatureY.Weight / CreatureY.MaxWeight < CreatureX.Weight / CreatureX.MaxWeight Then
							CreatureY = CreatureX
						End If
					Else
						CreatureY = CreatureX
					End If
				End If
			Next CreatureX
			If sinTooHeavy <> 0 Then
				DialogSetUp(bdDlgNoReply)
				DialogBrief(CreatureY, CreatureY.Name & IIf(sinTooHeavy = 1, " is heavily loaded", " carries too much") & " and slows the party down.")
				' pause...
				PauseTime = sinTooHeavy
				Start = VB.Timer()
				Do While VB.Timer() < Start + PauseTime
					System.Windows.Forms.Application.DoEvents()
				Loop 
				' advance time
				If GlobalFastMove > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.MovementCost. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TotalStepsTaken = TotalStepsTaken + (Map.MovementCost(mx, my_Renamed) + Int(sinTooHeavy)) * 3
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.MovementCost. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TotalStepsTaken = TotalStepsTaken + Map.MovementCost(mx, my_Renamed) + Int(sinTooHeavy)
				End If
			End If
			' Party takes a step
			If GlobalFastMove > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.NextMaxStep. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.NextMaxStep(mx, my_Renamed)
				'            If GlobalAutoCenter Then ' [Titi 2.4.9]
				'                MapCenter mx, my ' Ephestion [2.4.9]
				'                DrawMapAll ' Ephestion [2.4.9]
				'            End If
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.NextStep. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.NextStep(mx, my_Renamed)
				'            If GlobalAutoCenter Then ' [Titi 2.4.9]
				'                MapCenter mx, my ' Ephestion [2.4.9]
				'                DrawMapAll ' Ephestion [2.4.9]
				'            End If
			End If
			' If moving to a new encounter, then save laststep information to FleeTo
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Map.EncPointer(mx, my_Renamed) <> EncounterNow.Index Then
				' Check to see if the new Encounter is truly Active
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Map.EncPointer(mx, my_Renamed) > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Encounters. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Map.Encounters("E" & Map.EncPointer(mx, my_Renamed)).IsActive = True Then
						NewEncounter = True
					End If
				Else
					NewEncounter = True
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FleeToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.FleeToX = Tome.MapX
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FleeToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.FleeToY = Tome.MapY
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MapX = mx
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MapY = my_Renamed
			' Add one to steps. If exceed 9, then take a turn
			If GlobalFastMove > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.MovementCost. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TotalStepsTaken = TotalStepsTaken + Map.MovementCost(mx, my_Renamed) * 3
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.MovementCost. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TotalStepsTaken = TotalStepsTaken + Map.MovementCost(mx, my_Renamed)
			End If
			If TotalStepsTaken > 9 Then
				Do Until TotalStepsTaken < 10
					TurnCycle()
					TotalStepsTaken = TotalStepsTaken - 10
				Loop 
			End If
			If NewEncounter = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemNow = CreatureWithTurn.ItemInHand
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(EncounterNow, bdPostStepEncounter)
			End If
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		mx = Tome.MapX
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		my_Renamed = Tome.MapY
		' Reset back to a human controlled player instead of an NPC
		Found = False
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.DMControlled. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.DMControlled = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For c = 1 To Tome.Creatures.Count
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Tome.Creatures(c).DMControlled = False Then
					Found = True
					Exit For
				End If
			Next c
		End If
		If Found = True Then
			If c < PartyLeft Or c > PartyLeft + 4 Then
				PartyLeft = c - 1
				MenuDrawParty()
			End If
			SetTurn(c - 1)
		End If
		' Line of Site fill to show any hidden tiles
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Map.Hidden(mx, my_Renamed) = False
		For k = 0 To 3
			For c = 0 To 5 : cx = mx : cy = my_Renamed : For i = 0 To 5
					cdir = LosDir(c, i)
					Select Case k
						Case 0 ' Normal
						Case 1 ' Flip X
							If LosDir(c, i) = 1 Then
								cdir = 2
							End If
						Case 2 ' Flip Y
							If LosDir(c, i) = 0 Then
								cdir = 3
							End If
						Case 3 ' Flip X and Y
							If LosDir(c, i) = 1 Then
								cdir = 2
							End If
							If LosDir(c, i) = 0 Then
								cdir = 3
							End If
					End Select
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.See. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Map.See(cx, cy, cdir) = False Then
						Select Case cdir
							Case 0 ' Up
								cy = Greatest(cy - 1, 0)
							Case 1 ' Right
								'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								cx = Least(cx + 1, Map.Width)
							Case 2 ' Left
								cx = Greatest(cx - 1, 0)
							Case 3 ' Down
								'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
								cy = Least(cy + 1, Map.Height)
						End Select
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Map.Hidden(cx, cy) = True Then
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							Map.Hidden(cx, cy) = False
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							MinX = Least(((cy - Map.Top) + (cx - Map.Left)) * 48, MinX)
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							MinY = Least(((cy - Map.Top) - (cx - Map.Left)) * 24 - 24, MinY)
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							MaxX = Greatest(((cy - Map.Top) + (cx - Map.Left)) * 48 + 96, MaxX)
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							MaxY = Greatest(((cy - Map.Top) - (cx - Map.Left)) * 24 + 48, MaxY)
						End If
					Else
						Exit For
					End If
				Next i : Next c
		Next k
		' Determine bounding rectangle for party
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In Tome.Creatures
			' Anchor at corners of picture
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			X = (CreatureX.MapY + CreatureX.MapX - Map.Top - Map.Left) * 48 + CreatureX.TileSpotX
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Y = (CreatureX.MapY - CreatureX.MapX - Map.Top + Map.Left) * 24 + CreatureX.TileSpotY - 24
			MinX = Least(X, MinX)
			MinY = Least(Y - picCMap(CreatureX.Pic).Height / 2, MinY)
			MaxX = Greatest(X + picCMap(CreatureX.Pic).Width / 2, MaxX)
			MaxY = Greatest(Y, MaxY)
		Next CreatureX
		DrawMapRegion(MinY - 72, MinX - 48, MaxY + 96, MaxX + 144)
		'    DrawMapRegion MinY - 24, MinX - 24, MaxY + 48, MaxX + 96
		' If NewEncounter found, then deal with it
		If NewEncounter = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Map.EncPointer(mx, my_Renamed) < 1 Then
				EncounterNow = New Encounter
				EncNow = EncounterNow ' [Titi 2.5.1] used to fix the MoveParty bug in triggers
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Encounters. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				EncounterNow = Map.Encounters("E" & Map.EncPointer(mx, my_Renamed))
				EncounterEnter()
			End If
		End If
		'[Titi 2.5.1] Update camping status
		BorderDrawButtons(False)
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Tome.MoveToX = Tome.MapX And Tome.MoveToY = Tome.MapY Then
			' save coordinates in case the tileset for the next area is missing
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.EntryPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each EntryPointX In Map.EntryPoints
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If EntryPointX.MapX = Tome.MapX And EntryPointX.MapY = Tome.MapY Then
					FromEntryPoint = EntryPointX
					Exit For
				End If
			Next EntryPointX
			' If have arrived, then stop the party
			tmrMoveParty.Enabled = False
			MovePartyExit()
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If picJournal.Visible = True And JournalMode = 2 And tmrMoveParty.Enabled = False Then
			JournalShowMap()
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub MovePartyExit(Optional ByRef blnDontShowMsg As Boolean = False)
		Dim DialogHide As Object
		Dim Map_Renamed As Object
		Dim Tome_Renamed As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim ConvoAction As Object
		'UPGRADE_NOTE: my was upgraded to my_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim mx, my_Renamed As Short
		Dim cy, cx, Found As Short
		Dim i, c, k As Short
		Dim cdir As Short
		Dim EntryPointX As EntryPoint
		' Determine if stopped on an EntryPoint
		For	Each EntryPointX In Map.EntryPoints
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Tome.MapX = EntryPointX.MapX And Tome.MapY = EntryPointX.MapY Then
				tmrMoveParty.Enabled = False
				' Ask Yes/No question to leave through exit
				'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ConvoAction = 0
				If Not (blnDontShowMsg And FromEntryPoint Is Nothing) Then ' but only if we're not coming back from an error
					DialogSetUp(bdDlgNoReply)
					DialogSetButton(1, "No")
					DialogSetButton(2, "Yes")
					If Len(EntryPointX.Description) > 0 Then
						DialogShow("DM", EntryPointX.Description)
					ElseIf EntryPointX.AreaIndex = 0 Then 
						DialogShow("DM", "Do you want to exit this Tome and return to the Main Menu?")
					Else
						DialogShow("DM", "Do you want to exit to the next area?")
					End If
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If ConvoAction = 0 Then
					' If leaving to the MainMenu
					If EntryPointX.AreaIndex = 0 Then
						TomeStartArea(0, 0, 0, 0, 0)
					Else
						TomeStartArea((EntryPointX.AreaIndex), (EntryPointX.MapIndex), (EntryPointX.EntryIndex), (EntryPointX.MapX), (EntryPointX.MapY))
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						mx = Tome.MapX
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						my_Renamed = Tome.MapY
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Tome.MoveToX = mx
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Tome.MoveToY = my_Renamed
						MapCenter(mx, my_Renamed)
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Map.Hidden(mx, my_Renamed) = False
						For k = 0 To 3
							For c = 0 To 5 : cx = mx : cy = my_Renamed : For i = 0 To 5
									cdir = LosDir(c, i)
									Select Case k
										Case 0 ' Normal
										Case 1 ' Flip X
											If LosDir(c, i) = 1 Then
												cdir = 2
											End If
										Case 2 ' Flip Y
											If LosDir(c, i) = 0 Then
												cdir = 3
											End If
										Case 3 ' Flip X and Y
											If LosDir(c, i) = 1 Then
												cdir = 2
											End If
											If LosDir(c, i) = 0 Then
												cdir = 3
											End If
									End Select
									'UPGRADE_WARNING: Couldn't resolve default property of object Map.See. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
									If Map.See(cx, cy, cdir) = False Then
										Select Case cdir
											Case 0 ' Up
												cy = Greatest(cy - 1, 0)
											Case 1 ' Right
												'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
												cx = Least(cx + 1, Map.Width)
											Case 2 ' Left
												cx = Greatest(cx - 1, 0)
											Case 3 ' Down
												'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
												cy = Least(cy + 1, Map.Height)
										End Select
										'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										If Map.Hidden(cx, cy) = True Then
											'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
											Map.Hidden(cx, cy) = False
										End If
									Else
										Exit For
									End If
								Next i : Next c
						Next k
						' Cycle a turn to check map lighting
						TurnCycleTime()
					End If
				End If
				DialogHide()
				Exit For
			End If
		Next EntryPointX
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub EncounterEnter()
		Dim Tome_Renamed As Object
		Dim ConvoAction As Object
		Dim DialogHide As Object
		Dim DialogShow As Object
		Dim DialogSetButton As Object
		Dim DialogSetUp As Object
		Dim DialogDM As Object
		Dim CreatureWithTurn As Object
		Dim ItemNow As Object
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim CreatureX As Creature
		Dim ItemX As Item
		Dim i, j As Short
		Dim Agressive, CreatureCount, Friendly, NoFail As Short
		' Fire Pre-Enter Triggers
		SearchTraps(True)
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(EncounterNow, bdPreEnterEncounter)
		' If ReGen set, do it now.
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.GenerateUponEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If EncounterNow.GenerateUponEntry = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MakeEncounter(Map, EncounterNow)
		End If
		' Load up Creature pictures if missing
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each CreatureX In EncounterNow.Creatures
			If CreatureX.Pic = 0 Then
				LoadCreaturePic(CreatureX)
			End If
			' [Titi 2.6.0] take care of already dead ones
			If CreatureX.HPNow <= 0 Then
				UpdateCreatureInfo(CreatureX, False)
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				EncounterNow.Creatures.Remove("X" & CreatureX.Index)
			End If
		Next CreatureX
		' Load up Item pictures if missing
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each ItemX In EncounterNow.Items
			If ItemX.Pic = 0 Then
				LoadItemPic(ItemX)
			End If
		Next ItemX
		' Fire Post-Enter Triggers
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(EncounterNow, bdPostStepEncounter)
		' If nobody is in here, then just display intro stuff
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If EncounterNow.Creatures.Count = 0 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.HaveEntered. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If EncounterNow.HaveEntered = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.FirstEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Len(EncounterNow.FirstEntry) > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.FirstEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogDM(EncounterNow.FirstEntry)
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.SecondEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf Len(BreakText(EncounterNow.SecondEntry, 1)) > 0 Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.SecondEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DialogDM(BreakText(EncounterNow.SecondEntry, 1))
			End If
		Else
			' Look and see if unfriendlies and agressives in the Encounter
			Friendly = True : CreatureCount = 0 : Agressive = False
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For	Each CreatureX In EncounterNow.Creatures
				If CreatureX.AllowedTurn = True Then
					CreatureCount = CreatureCount + 1
					If CreatureX.Friendly = False Then
						Friendly = False
					End If
					If CreatureX.Agressive = True Then
						Agressive = True
					End If
				End If
			Next CreatureX
			' Set up dialog buttons for Encounter
			If CreatureCount > 0 Then
				If Friendly = True Then
					' If friendly then you might be able to talk with them
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanTalk. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If EncounterNow.CanTalk = True Then
						DialogSetUp(bdDlgNoReply)
						DialogSetButton(1, "Talk")
						' [Titi 2.4.9b]
						' DialogSetButton 2, "Ignore" <-- Bug: doesn't account for the "can't ignore" property of the creature!
						If Agressive = False Then DialogSetButton(2, "Ignore")
					Else
						DialogSetUp(bdDlgNoReply)
						DialogSetButton(1, "Done")
					End If
				ElseIf Agressive = True Then 
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanTalk. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If EncounterNow.CanTalk = True Then
						DialogSetUp(bdDlgNoReply)
						DialogSetButton(1, "Talk")
						DialogSetButton(2, "Fight")
					Else
						DialogSetUp(bdDlgNoReply)
						DialogSetButton(1, "Fight")
					End If
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanTalk. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanFlee. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If EncounterNow.CanFlee = True And EncounterNow.CanTalk = True Then
						DialogSetUp(bdDlgNoReply)
						DialogSetButton(4, "Ignore")
						DialogSetButton(3, "Fight")
						DialogSetButton(2, "Flee")
						DialogSetButton(1, "Talk")
						'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CanTalk. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					ElseIf EncounterNow.CanTalk = True Then 
						DialogSetUp(bdDlgNoReply)
						DialogSetButton(3, "Ignore")
						DialogSetButton(2, "Fight")
						DialogSetButton(1, "Talk")
					Else
						DialogSetUp(bdDlgNoReply)
						DialogSetButton(3, "Ignore")
						DialogSetButton(2, "Fight")
						DialogSetButton(1, "Flee")
					End If
				End If
			Else
				DialogSetUp(bdDlgNoReply)
			End If
			' Now display it
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.HaveEntered. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.FirstEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Len(EncounterNow.FirstEntry) > 0 And (EncounterNow.HaveEntered = False) Then
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.FirstEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DialogShow(EncounterNow.Creatures(1), EncounterNow.FirstEntry)
				'            DialogHide
				'            MenuNow = bdMenuEncounter
				'            DoAction ConvoAction
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.HaveEntered. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.SecondEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf Len(BreakText(EncounterNow.SecondEntry, 1)) > 0 And EncounterNow.HaveEntered = True Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.SecondEntry. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DialogShow(EncounterNow.Creatures(1), BreakText(EncounterNow.SecondEntry, 1))
				'            DialogHide
				'            MenuNow = bdMenuEncounter
				'            DoAction ConvoAction
				'        ElseIf (EncounterNow.HaveEntered = False Or Agressive = True) And CreatureCount > 0 Then
				' [Titi 2.5.1] if unfriendly, CombatStart will be called, where the description is more accurate
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.HaveEntered. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf (EncounterNow.HaveEntered = False And Friendly = True) And CreatureCount > 0 Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If EncounterNow.Creatures.Count = 1 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogShow(EncounterNow.Creatures(1), "A single " & EncounterNow.Creatures(1).Name & " is here.")
				Else
					' [Titi 2.4.9] check how many different creatures there are
					Dim strCreatures(CreatureCount) As String
					Dim intNb(CreatureCount) As Short
					i = 1
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					For	Each CreatureX In EncounterNow.Creatures
						' [Titi 2.4.9b] list all creatures (both friendly and aggressive)
						' [Titi 2.4.9b] If you fled, or if some creatures felt betrayed, you may enter again - but the number of LIVING creatures has probably decreased...
						If CreatureX.HPNow > 0 Then
							strCreatures(i) = CreatureX.Name
							i = i + 1
						End If
					Next CreatureX
					' sort alphabetically
					For i = 1 To CreatureCount - 1
						For j = i + 1 To CreatureCount
							If strCreatures(i) > strCreatures(j) Then
								strCreatures(0) = strCreatures(i)
								strCreatures(i) = strCreatures(j)
								strCreatures(j) = strCreatures(0)
							End If
						Next j
					Next i
					' now, count how many of them
					j = 1
					For i = 1 To CreatureCount - 1
						intNb(j) = intNb(j) + 1
						If strCreatures(i) <> strCreatures(i + 1) Then
							j = j + 1
						End If
					Next 
					' don't forget to count the last one!
					intNb(j) = intNb(j) + 1
					' OK, now we have j-1 types, and intNb(1..j-1) each
					strCreatures(0) = "" : i = 0 : intNb(0) = 1
					While i < j
						i = i + 1
						strCreatures(0) = strCreatures(0) & Str(intNb(i)) & " " & strCreatures(intNb(0)) & IIf(intNb(i) > 1, "s, ", ", ")
						If i = j - 1 Then strCreatures(0) = VB.Left(strCreatures(0), Len(strCreatures(0)) - 2) & " and "
						intNb(0) = intNb(0) + intNb(i)
					End While
					' erase the last ", "
					strCreatures(0) = VB.Left(strCreatures(0), Len(strCreatures(0)) - 2)
					' DialogShow EncounterNow.Creatures(1), "There are " & EncounterNow.Creatures.Count & " " & EncounterNow.Creatures(1).Name & "s here."
					'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogShow(EncounterNow.Creatures(1), "There are " & strCreatures(0) & " here.")
				End If
				'            DialogHide
				'            MenuNow = bdMenuEncounter
				'            DoAction ConvoAction
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.HaveEntered. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf EncounterNow.HaveEntered = True And CreatureCount > 0 Then 
				' DialogShow EncounterNow.Creatures(1), "You fled... But the enemy is still here."
				' [Titi 2.6.0] Fight only if there is an unfriendly creature!
				If Not Friendly Then CombatStart()
			End If
			DialogHide()
			MenuNow = bdMenuEncounter
			'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DoAction(ConvoAction)
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.HaveEntered. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		EncounterNow.HaveEntered = True
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(EncounterNow, bdPostEnterEncounter)
		If Not NoFail Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MoveToX = Tome.MapX
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MoveToY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.MoveToY = Tome.MapY
			tmrMoveParty.Enabled = False
		End If
		EncNow = EncounterNow
	End Sub
	
	Private Sub EncounterIgnore()
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim CreatureWithTurn As Object
		Dim ItemNow As Object
		Dim NoFail As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(EncounterNow, bdOnIgnore)
	End Sub
	
	Private Function CombatFindPath(ByRef CreatureX As Creature, ByVal ToCol As Short, ByVal ToRow As Short) As Short
		Dim EncounterNow As Object
		Dim Turns As Object
		Dim pxlist(500) As Short
		Dim pylist(500) As Short
		Dim llist(500) As Short
		Dim lMap(bdCombatWidth + 1, bdCombatHeight + 1) As Short
		Dim c, X, Y, i As Short
		Dim shortest, NumPoints, PathFound As Short
		Dim dy, dx, StickySpot As Short
		'UPGRADE_NOTE: Dir was upgraded to Dir_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Dir_Renamed, TotalTiles As Short
		'UPGRADE_NOTE: my was upgraded to my_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim my_Renamed, sy, sx, mx, mv As Short
		Dim ny, ey, ex, nx, tx As Short
		Dim CloseY, CloseX, CloseRange As Short
		Dim oldmv, Failed As Short
		' If don't need to move anywhere, then pop out of this
		If CreatureX.Row = ToRow And CreatureX.Col = ToCol Then
			CombatStepTop = -1
			CombatFindPath = True
			Exit Function
		End If
		' Load starting point in my list
		pxlist(0) = CreatureX.Col : pylist(0) = CreatureX.Row
		sx = CreatureX.Col : sy = CreatureX.Row
		NumPoints = 1
		' Compute distance from starting point to ending point
		dx = sx - ToCol : dy = sy - ToRow
		llist(0) = (dx * dx) + (dy * dy)
		' Initialize our move cost where we are starting
		mv = 1
		' Set all coordinates in our traveled map to large value (we're not moving there)
		For X = 0 To bdCombatWidth : For Y = 0 To bdCombatHeight
				lMap(X, Y) = 32700
			Next Y : Next X
		' But plop a zero where we're starting from (we are moving there)
		lMap(sx, sy) = 0
		TotalTiles = 0
		CloseRange = 32700
		CombatStepTop = -1
		Do 
			TotalTiles = TotalTiles + 1
			' We only try 50 times to find a path (arbitrary number)
			If TotalTiles > 50 Then
				PathFound = 0
				Exit Do
			End If
			' Find the coordinate that has the shortest distance
			shortest = 0
			For c = 0 To NumPoints - 1
				If llist(c) < llist(shortest) Then
					shortest = c
				End If
			Next c
			' That's where we start from
			sx = pxlist(shortest)
			sy = pylist(shortest)
			' The shortest is swaped with the top of the stack
			pxlist(shortest) = pxlist(NumPoints - 1)
			pylist(shortest) = pylist(NumPoints - 1)
			llist(shortest) = llist(NumPoints - 1)
			' And we reduce the stack size by one
			NumPoints = NumPoints - 1
			' Move values will range from 0 (where we start) plus one for every square away
			oldmv = lMap(sx, sy)
			' For every direction, see if can move that way
			For Dir_Renamed = 0 To 5
				' Set a funky x direction based on the offset of the grid
				If Dir_Renamed > 3 Then
					tx = DirX(Dir_Renamed) + 2 * (sy Mod 2)
				Else
					tx = DirX(Dir_Renamed)
				End If
				' See if blocked by any Creature
				Failed = False : StickySpot = 0
				For i = 0 To CombatTurn
					'UPGRADE_WARNING: Couldn't resolve default property of object Turns(i).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If i <> TurnNow And Turns(i).Ref.HPNow > 0 Then
						' If Creature is standing in the block
						'UPGRADE_WARNING: Couldn't resolve default property of object Turns(i).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Turns(i).Ref.Col = sx + tx And Turns(i).Ref.Row = sy + DirY(Dir_Renamed) Then
							Failed = True
						End If
					End If
				Next i
				' See if blocked by a CombatGrid space
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.CombatGrid. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If EncounterNow.CombatGrid(sx + tx, sy + DirY(Dir_Renamed)) = 1 Then
					Failed = True
				End If
				' If not then add that space to the que
				If Not Failed And IsBetween(sx + tx, 0, bdCombatWidth) And IsBetween(sy + DirY(Dir_Renamed), 0, bdCombatHeight) Then
					' If can, look at the movement cost compare to where we are
					mx = sx + tx : my_Renamed = sy + DirY(Dir_Renamed)
					If lMap(sx, sy) < lMap(mx, my_Renamed) Then
						' If where we are is less than where we're moving...
						' (which means we haven't tried there yet)
						' Compute the distance from our destination point
						dx = mx - ToCol
						dy = my_Renamed - ToRow
						' Add a cost of one to the tile we were just in
						lMap(mx, my_Renamed) = oldmv + 1
						' Place on the top of the stack this new coordinate and distance
						pxlist(NumPoints) = mx
						pylist(NumPoints) = my_Renamed
						llist(NumPoints) = (dx * dx) + (dy * dy)
						' Store CloseX and CloseY
						If llist(NumPoints) < CloseRange Then
							CloseX = mx : CloseY = my_Renamed
							CloseRange = llist(NumPoints)
						End If
						NumPoints = NumPoints + 1
						' If we just moved to our final destination, you're done
						If (mx = ToCol) And (my_Renamed = ToRow) Then
							PathFound = 1
							Exit For
						End If
					End If
				End If
			Next Dir_Renamed
			If NumPoints = 0 Then
				PathFound = 0
				Exit Function
			End If
		Loop Until PathFound = 1
		' If could not find a path, find the closest point.
		If PathFound = 0 Then
			ToCol = CloseX
			ToRow = CloseY
		End If
		' Now back track best path
		sx = CreatureX.Col : sy = CreatureX.Row
		ex = ToCol : ey = ToRow
		Do While (ex <> sx) Or (ey <> sy)
			c = 32700
			For Dir_Renamed = 0 To 5
				' Have to set a funky x based on offset grid
				If Dir_Renamed > 3 Then
					tx = DirX(Dir_Renamed) + 2 * (ey Mod 2)
				Else
					tx = DirX(Dir_Renamed)
				End If
				mx = Greatest(Least(ex + tx, bdCombatWidth), 0)
				my_Renamed = Greatest(Least(ey + DirY(Dir_Renamed), bdCombatHeight), 0)
				If lMap(mx, my_Renamed) < c Then
					c = lMap(mx, my_Renamed)
					nx = mx : ny = my_Renamed
				End If
			Next Dir_Renamed
			CombatStepTop = CombatStepTop + 1
			CombatStepCol(CombatStepTop) = ex
			CombatStepRow(CombatStepTop) = ey
			ex = nx : ey = ny
		Loop 
	End Function
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub FindPath(ByRef TomeX As Tome)
		Dim pxlist As Object
		Dim Map_Renamed As Object
		'UPGRADE_WARNING: Untranslated statement in FindPath. Please check source code.
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Dim pylist(CDbl(Map.Height + 1) * CDbl(Map.Width + 1)) As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Dim llist(CDbl(Map.Height + 1) * CDbl(Map.Width + 1)) As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Dim lMap(Map.Width, Map.Height) As Short
		Dim Y, X, c As Short
		Dim shortest, NumPoints, PathFound As Short
		Dim dx, dy As Short
		'UPGRADE_NOTE: Dir was upgraded to Dir_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Dir_Renamed, TotalTiles As Short
		'UPGRADE_NOTE: my was upgraded to my_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim my_Renamed, sy, sx, mx, mv As Short
		Dim nx, ex, ey, ny As Short
		Dim CloseY, CloseX, CloseRange As Short
		Dim oldmv As Short
		' If don't need to move anywhere, then pop out of this
		If TomeX.MapX = TomeX.MoveToX And TomeX.MapY = TomeX.MoveToY Then
			Exit Sub
		End If
		' Load starting point in my list
		'UPGRADE_WARNING: Couldn't resolve default property of object pxlist(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		pxlist(0) = TomeX.MapX : pylist(0) = TomeX.MapY
		sx = TomeX.MapX : sy = TomeX.MapY
		NumPoints = 1
		' Compute distance from starting point to ending point
		dx = sx - TomeX.MoveToX : dy = sy - TomeX.MoveToY
		llist(0) = (dx * dx) + (dy * dy)
		' Initialize our move cost where we are starting
		mv = 1
		' Set all coordinates in our traveled map to large value (we're not moving there)
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For X = 0 To Map.Width
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For Y = 0 To Map.Height
				lMap(X, Y) = 32700
			Next Y : Next X
		' But plop a zero where we're starting from (we are moving there)
		lMap(sx, sy) = 0
		TotalTiles = 0
		CloseRange = 32700
		Do 
			TotalTiles = TotalTiles + 1
			' We only try 250 times to find a path (arbitrary number)
			If TotalTiles > 250 Then
				PathFound = 0
				Exit Do
			End If
			' Find the coordinate that has the shortest distance
			shortest = 0
			For c = 0 To NumPoints - 1
				If llist(c) < llist(shortest) Then
					shortest = c
				End If
			Next c
			' That's where we start from
			'UPGRADE_WARNING: Couldn't resolve default property of object pxlist(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			sx = pxlist(shortest)
			sy = pylist(shortest)
			' The shortest which was is swaped with the top of the stack
			'UPGRADE_WARNING: Couldn't resolve default property of object pxlist(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			pxlist(shortest) = pxlist(NumPoints - 1)
			pylist(shortest) = pylist(NumPoints - 1)
			llist(shortest) = llist(NumPoints - 1)
			' And we reduce the stack size by one
			NumPoints = NumPoints - 1
			' Move values will range from 0 (where we start) plus one for every square away
			oldmv = lMap(sx, sy)
			' For every direction, see if can move that way
			For Dir_Renamed = 0 To 3
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Blocked. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Not Map.Blocked(sx, sy, Dir_Renamed) Then
					' If can, look at the movement cost compare to where we are
					mx = sx + DirX(Dir_Renamed) : my_Renamed = sy + DirY(Dir_Renamed)
					If lMap(sx, sy) < lMap(mx, my_Renamed) Then
						' If where we are is less than where we're moving...
						' (which means we haven't tried there yet)
						' Compute the distance from our destination point
						dx = mx - TomeX.MoveToX
						dy = my_Renamed - TomeX.MoveToY
						' Add a cost of one to the tile we were just in
						lMap(mx, my_Renamed) = oldmv + 1
						' Place on the top of the stack this new coordinate and distance
						'UPGRADE_WARNING: Couldn't resolve default property of object pxlist(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						pxlist(NumPoints) = mx
						pylist(NumPoints) = my_Renamed
						llist(NumPoints) = (dx * dx) + (dy * dy)
						' Store CloseX and CloseY
						If llist(NumPoints) < CloseRange Then
							CloseX = mx : CloseY = my_Renamed
							CloseRange = llist(NumPoints)
						End If
						NumPoints = NumPoints + 1
						' If we just moved to our final destination, you're done
						If (mx = TomeX.MoveToX) And (my_Renamed = TomeX.MoveToY) Then
							PathFound = 1
							Exit Do
						End If
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If NumPoints > CDbl(Map.Height + 1) * CDbl(Map.Width + 1) Then
							PathFound = 0
							Exit Do
						End If
					End If
				End If
			Next Dir_Renamed
			If NumPoints = 0 Then
				PathFound = 0
				Exit Do
			End If
		Loop 
		' If could not find a path, find the closest point.
		If PathFound = 0 Then
			TomeX.MoveToX = CloseX
			TomeX.MoveToY = CloseY
		End If
		' Now back track best path
		sx = TomeX.MapX : sy = TomeX.MapY
		ex = TomeX.MoveToX : ey = TomeX.MoveToY
		Do While (ex <> sx) Or (ey <> sy)
			c = 32700
			For Dir_Renamed = 0 To 3
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Blocked. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Not Map.Blocked(ex, ey, Dir_Renamed) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					mx = Least(Greatest(ex + DirX(Dir_Renamed), 0), Map.Width)
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					my_Renamed = Least(Greatest(ey + DirY(Dir_Renamed), 0), Map.Height)
					If lMap(mx, my_Renamed) < c Then
						c = lMap(mx, my_Renamed)
						nx = mx : ny = my_Renamed
					End If
				End If
			Next Dir_Renamed
			TomeX.AddStep(ex, ey)
			ex = nx : ey = ny
		Loop 
	End Sub
	
	Private Function HasTrigger(ByRef ObjectX As Object, ByRef AsTriggerType As Short) As Short
		Dim rc As Short
		Dim TriggerX As Trigger
		HasTrigger = False
		'UPGRADE_WARNING: Couldn't resolve default property of object ObjectX.Triggers. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For	Each TriggerX In ObjectX.Triggers
			If TriggerX.TriggerType = AsTriggerType Then
				HasTrigger = True
				Exit Function
			End If
		Next TriggerX
	End Function
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Right was upgraded to Right_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Bottom was upgraded to Bottom_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Left was upgraded to Left_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	'UPGRADE_NOTE: Top was upgraded to Top_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub DrawMapRegion(ByRef Top_Renamed As Short, ByRef Left_Renamed As Short, ByRef Bottom_Renamed As Short, ByRef Right_Renamed As Short)
		Dim bdSideSecondBottom As Object
		Dim bdSideFirstBottom As Object
		Dim bdSideRight As Object
		Dim bdSideLeft As Object
		Dim bdSideTop As Object
		Dim Map_Renamed As Object
		' Based on bounding coordinates in Pixels, draw the correct number
		' of tiles the correct way. Only draw the overlaps necessary
		' (only on the outer most region of the rectangle).
		' Draw Bottom Layer of entire region, Items, Creatures, Party
		' then Middle, Top.
		Dim Side, X, Y, i As Short
		Dim rc As Short
		'UPGRADE_NOTE: my was upgraded to my_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim XMap, mx, my_Renamed, YMap As Short
		Dim sx, sy As Short
		Dim FromY, ToY As Short
		Dim FromX, ToX As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		SetMapCursor(Left_Renamed, Top_Renamed, Map.Left, Map.Top, FromX, FromY, XMap, YMap)
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		SetMapCursor(Right_Renamed, Bottom_Renamed, Map.Left, Map.Top, ToX, ToY, XMap, YMap)
		FromX = Int(FromX / 96) : FromY = Int(FromY / 24) + (XMap + YMap) Mod 2
		ToX = Int(ToX / 96) + 1 : ToY = Int(ToY / 24)
		' Draw Top of Region
		Y = FromY
		For X = FromX To ToX - 1
			'UPGRADE_WARNING: Couldn't resolve default property of object bdSideTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Side = bdSideTop
			If X = FromX Then
				Side = Side Or bdSideLeft
			End If
			If X = ToX Then
				Side = Side Or bdSideRight
			End If
			DrawTile(X, Y, Side)
		Next X
		' Draw Middle of Region
		For Y = FromY + 1 To ToY
			For X = FromX To ToX - (Y Mod 2)
				Side = 0
				If X = FromX And (Y Mod 2) = 0 Then
					Side = Side Or bdSideLeft
				End If
				If X = ToX And (Y Mod 2) = 0 Then
					Side = Side Or bdSideRight
				End If
				DrawTile(X, Y, Side)
			Next X
		Next Y
		' Draw Bottom of Region
		For Y = ToY + 1 To ToY + 2
			For X = FromX To ToX - (Y Mod 2)
				If Y = ToY + 1 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdSideFirstBottom. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Side = bdSideFirstBottom
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdSideSecondBottom. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Side = bdSideSecondBottom
				End If
				If X = FromX And (Y Mod 2) = 0 Then
					Side = Side Or bdSideLeft
				End If
				If X = ToX And (Y Mod 2) = 0 Then
					Side = Side Or bdSideRight
				End If
				DrawTile(X, Y, Side)
			Next X
		Next Y
		picMap.Refresh()
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub ScrollMap(Optional ByRef MoveMapX As Object = Nothing, Optional ByRef MoveMapY As Object = Nothing)
		Dim JournalMode As Object
		Dim JournalShowMap As Object
		Dim MicroMapTop As Object
		Dim MicroMapLeft As Object
		Dim Map_Renamed As Object
		Dim PosNow As POINTAPI
		Dim rc As Integer
		Dim X, Y As Short
		Static LastMove As Short
		' Calculate if mouse in borders of Screen
		'UPGRADE_NOTE: IsMissing() was changed to IsNothing(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="8AE1CB93-37AB-439A-A4FF-BE3B6760BB23"'
		If IsNothing(MoveMapX) And IsNothing(MoveMapY) Then
			rc = GetCursorPos(PosNow)
			If PosNow.Y < 0 And PosNow.X > 0 Then
				
			ElseIf PosNow.Y < (VB6.PixelsToTwipsY(System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height) / VB6.TwipsPerPixelY) - picMenu.ClientRectangle.Height - 128 And (PosNow.X > VB6.PixelsToTwipsX(System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width) / VB6.TwipsPerPixelX - 2 Or PosNow.X < 2) Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MoveMapX = System.Math.Sign(PosNow.X - 3)
				'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MoveMapY = System.Math.Sign(PosNow.X - 3)
			ElseIf PosNow.Y > VB6.PixelsToTwipsY(System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height) / VB6.TwipsPerPixelY - 16 Or PosNow.Y < 16 Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MoveMapX = -System.Math.Sign(PosNow.Y - 17)
				'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MoveMapY = System.Math.Sign(PosNow.Y - 17)
				'UPGRADE_WARNING: Couldn't resolve default property of object JournalMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf LastMove = True And picJournal.Visible = True And JournalMode = 2 Then 
				LastMove = False
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapLeft. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MicroMapLeft = Map.Left
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MicroMapTop = Map.Top
				JournalShowMap()
				Exit Sub
			Else
				Exit Sub
			End If
		End If
		' Check if moving will move the Party off the Map
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If System.Math.Sqrt((Map.Top + MoveMapY + Int(System.Math.Sqrt((picMap.ClientRectangle.Width ^ 2) + (picMap.ClientRectangle.Height ^ 2)) / 108) - 1 - Tome.MapY) ^ 2 + (Map.Left - 2 + MoveMapX - Tome.MapX) ^ 2) > (picMap.ClientRectangle.Height / 54) Then
			Exit Sub
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Map.Top = Map.Top + MoveMapY
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Map.Left = Map.Left + MoveMapX
		LastMove = True
		' Scroll Screen
		'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If MoveMapX = -1 And MoveMapY = -1 Then
			' Mouse Left (Shift Screen Right)
			'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMap.hdc, 96, 0, picMap.ClientRectangle.Width - 96, picMap.ClientRectangle.Height, picMap.hdc, 0, 0, SRCCOPY)
			DrawMapRegion(-48, 0, picMap.ClientRectangle.Height, 96)
			'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf MoveMapX = 1 And MoveMapY = 1 Then 
			' Mouse Right (Shift Screen Left)
			'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMap.hdc, 0, 0, picMap.ClientRectangle.Width - 96, picMap.ClientRectangle.Height, picMap.hdc, 96, 0, SRCCOPY)
			DrawMapRegion(0, picMap.ClientRectangle.Width - 96, picMap.ClientRectangle.Height, picMap.ClientRectangle.Width)
			'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf MoveMapX = 1 And MoveMapY = -1 Then 
			' Mouse Up (Shift Screen Down)
			'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMap.hdc, 0, 48, picMap.ClientRectangle.Width, picMap.ClientRectangle.Height - 48, picMap.hdc, 0, 0, SRCCOPY)
			DrawMapRegion(0, 0, 48, picMap.ClientRectangle.Width)
			'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object MoveMapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf MoveMapX = -1 And MoveMapY = 1 Then 
			' Mouse Down (Shift Screen Up)
			'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMap.hdc, 0, 0, picMap.ClientRectangle.Width, picMap.ClientRectangle.Height - 48, picMap.hdc, 0, 48, SRCCOPY)
			DrawMapRegion(picMap.ClientRectangle.Height - 48, 0, picMap.ClientRectangle.Height, picMap.ClientRectangle.Width)
		End If
	End Sub
	
	Private Sub LoadPartyPics()
		' Load Party Pictures
		Dim c As Short
		Dim CreatureX As Creature
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor ' Hourglass
		' Loop through Party and load pictures
		For	Each CreatureX In Tome.Creatures
			' Load Creature bitmap
			LoadCreaturePic(CreatureX)
		Next CreatureX
		'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default ' Default
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Function LoadSFXPic(ByRef PictureFile As String) As Short
		Dim Tome_Renamed As Object
		' Loads SFX picture and returns pointer to array
		Dim FileName As String
		Dim c, PicToLoad As Short
		'UPGRADE_WARNING: Arrays in structure bmBlack may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmBlack As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmMask may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMask As BITMAPINFO
		Dim rc, lpMem, hMem, TransparentRGB As Integer
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		' If PictureFile already loaded, then return that reference
		For c = 0 To MaxSFX
			If SFXFile(c) = PictureFile Then
				LoadSFXPic = c
				Exit Function
			End If
		Next c
		' Find an empty picture box
		For c = 0 To MaxSFX
			If SFXFile(c) = "" Then
				Exit For
			End If
		Next c
		' If found one, use that. Else, load a new one.
		If c < MaxSFX Then
			PicToLoad = c
		Else
			MaxSFX = MaxSFX + 1
			PicToLoad = MaxSFX
			ReDim Preserve SFXFile(PicToLoad)
			If PicToLoad > 0 Then
				picSFXPic.Load(PicToLoad)
			End If
		End If
		SFXFile(PicToLoad) = PictureFile
		' Load Bitmap (try Tome path first). Then try other directories.
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(Tome.FullPath & "\" & PictureFile)
		If FileName = "" Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(Tome.FullPath & "\effects\" & PictureFile)
			If FileName = "" Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(Tome.FullPath & "\creatures\" & PictureFile)
				If FileName = "" Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
					FileName = Dir(Tome.FullPath & "\tiles\" & PictureFile)
					'                If FileName = "" Then
					'                    LoadSFXPic = -1
					'                    Exit Function
					'                'Else
					'                '    FileName = gAppPath & "\data\graphics\tiles\" & PictureFile
					'                End If
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					FileName = Tome.FullPath & "\creatures\" & PictureFile
				End If
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = Tome.FullPath & "\effects\" & PictureFile
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileName = Tome.FullPath & "\" & PictureFile
		End If
		If FileName = "" Then
			'        FileName = Dir$(gAppPath & "\data\graphics\effects\" & PictureFile)
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(gDataPath & "\graphics\effects\" & PictureFile)
			If FileName = "" Then
				'            FileName = Dir$(gAppPath & "\data\graphics\creatures\" & PictureFile)
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gDataPath & "\graphics\creatures\" & PictureFile)
				If FileName = "" Then
					'                FileName = Dir$(gAppPath & "\data\graphics\tiles\" & PictureFile)
					'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
					FileName = Dir(gDataPath & "\graphics\tiles\" & PictureFile)
					If FileName = "" Then
						LoadSFXPic = -1
						Exit Function
					End If
				Else
					'                FileName = gAppPath & "\data\graphics\creatures\" & PictureFile
					FileName = gDataPath & "\graphics\creatures\" & PictureFile
				End If
			Else
				'            FileName = gAppPath & "\data\graphics\effects\" & PictureFile
				FileName = gDataPath & "\graphics\effects\" & PictureFile
			End If
		End If
		ReadBitmapFile(FileName, bmBlack, hMem, TransparentRGB)
		' Convert to Mask (pure Blue is the mask color)
		MakeMask(bmBlack, bmMask, TransparentRGB)
		' Paint bitmap to picture box using converted palette
		lpMem = GlobalLock(hMem)
		Width_Renamed = Int(bmBlack.bmiHeader.biWidth * PicSize)
		Height_Renamed = Int(bmBlack.bmiHeader.biHeight * PicSize)
		picSFXPic(PicToLoad).Width = Width_Renamed * 2
		picSFXPic(PicToLoad).Height = Height_Renamed * 2
		' Draw Normal and Flip (X = 0, X = Width respectively)
		'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picSFXPic(PicToLoad).hdc, 3)
		'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picSFXPic(PicToLoad).hdc, 0, 0, Width_Renamed, Height_Renamed, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picSFXPic(PicToLoad).hdc, Width_Renamed, 0, Width_Renamed, Height_Renamed, picSFXPic(PicToLoad).hdc, Width_Renamed - 1, 0, -Width_Renamed, Height_Renamed, SRCCOPY)
		' Draw Mask Normal and Flip (Y = Height, X = 0 and X = Width respectively)
		'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picSFXPic(PicToLoad).hdc, 0, Height_Renamed, Width_Renamed, Height_Renamed, 0, 0, bmMask.bmiHeader.biWidth, bmMask.bmiHeader.biHeight, lpMem, bmMask, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picSFXPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picSFXPic(PicToLoad).hdc, Width_Renamed, Height_Renamed, Width_Renamed, Height_Renamed, picSFXPic(PicToLoad).hdc, Width_Renamed - 1, Height_Renamed, -Width_Renamed, Height_Renamed, SRCCOPY)
		picSFXPic(PicToLoad).Refresh()
		' Release memory
		rc = GlobalUnlock(hMem)
		rc = GlobalFree(hMem)
		' Return pointer to PictureBox
		LoadSFXPic = PicToLoad
	End Function
	
	Public Sub LoadCreaturePicForce(ByRef CreatureX As Creature)
		Dim PicFile As Object
		If CreatureX.Pic > -1 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object PicFile(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PicFile(CreatureX.Pic) = ""
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub LoadCreaturePic(ByRef CreatureX As Creature)
		Dim bdFaceBlank As Object
		Dim bdMapPartySize As Object
		Dim Tome_Renamed As Object
		Dim bdFaceMin As Object
		Dim PicPortrait As Object
		Dim PicFile As Object
		Dim PicFileTime As Object
		Dim bdMaxMonsPics As Object
		Dim FileName, sPicture As String
		'UPGRADE_NOTE: Size was upgraded to Size_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim c, i As Short
		Dim k, Size_Renamed As Double
		Dim PicToLoad As Short
		Dim PartyX As Creature
		Dim Y, X, Keep As Short
		'UPGRADE_WARNING: Arrays in structure bmBlack may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmBlack As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmMask may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMask As BITMAPINFO
		Dim rc, lpMem, hMem, TransparentRGB As Integer
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		Dim PartyWidth, PartyHeight As Short
		' If loading the bones.bmp picture, skip all this.
		If CreatureX.PictureFile = "bones.bmp" Or CreatureX.PictureFile = "" Or CreatureX.HPNow <= 0 Then
			PicToLoad = 0
		Else
			' If PictureFile already loaded, then return that reference
			'UPGRADE_WARNING: Couldn't resolve default property of object bdMaxMonsPics. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For c = 1 To bdMaxMonsPics
				'UPGRADE_WARNING: Couldn't resolve default property of object PicPortrait(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object PicFile(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If PicFile(c) = CreatureX.PictureFile And (PicPortrait(c) = CreatureX.PortraitFile Or Len(CreatureX.PortraitFile) = 0) Then
					CreatureX.Pic = c
					'UPGRADE_WARNING: Couldn't resolve default property of object PicFileTime(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					PicFileTime(c) = TimeOfDay.ToOADate()
					Exit Sub
				End If
			Next c
			' Sort to find oldest picture box free
			k = 1 : i = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object bdMaxMonsPics. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			For c = 1 To bdMaxMonsPics
				Keep = False
				'UPGRADE_WARNING: Couldn't resolve default property of object PicFileTime(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If PicFileTime(c) < k Then
					For	Each PartyX In Tome.Creatures
						'UPGRADE_WARNING: Couldn't resolve default property of object PicFile(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If PartyX.PictureFile = PicFile(c) Then
							Keep = True
						End If
					Next PartyX
					If Not Keep Then
						i = c
						'UPGRADE_WARNING: Couldn't resolve default property of object PicFileTime(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						k = PicFileTime(c)
					End If
				End If
			Next c
			PicToLoad = i
			'UPGRADE_WARNING: Couldn't resolve default property of object PicFileTime(PicToLoad). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If PicFileTime(PicToLoad) = 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				picFaces.Width = 66 * PicToLoad + bdFaceMin + 66
				picFaces.Height = 76
				If PicToLoad > 0 Then
					picCPic.Load(PicToLoad)
					picCMap.Load(PicToLoad)
				End If
			End If
		End If
		' [Titi 2.6.0] Use picture based on world's or creature's bones
		sPicture = CreatureX.PictureFile
		If PicToLoad = 0 Then ' bones
			CreatureX.PictureFile = CreatureX.PictureWhenDead
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object PicFile(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PicFile(PicToLoad) = CreatureX.PictureFile
		'UPGRADE_WARNING: Couldn't resolve default property of object PicPortrait(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PicPortrait(PicToLoad) = CreatureX.PortraitFile
		'UPGRADE_WARNING: Couldn't resolve default property of object PicFileTime(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PicFileTime(PicToLoad) = TimeOfDay.ToOADate()
		' Load Bitmap
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(Tome.FullPath & "\" & CreatureX.PictureFile)
		If FileName = "" Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(Tome.FullPath & "\creatures\" & CreatureX.PictureFile)
			If FileName = "" Then
				' [Titi 2.4.9b] added the possibility to have pictures only in a given world
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gAppPath & "\Roster\" & WorldNow.Name & "\" & CreatureX.PictureFile)
				If FileName = "" Then
					'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
					FileName = Dir(gAppPath & "\Roster\" & WorldNow.Name & "\Creatures\" & CreatureX.PictureFile)
					If FileName = "" Then
						'            FileName = gAppPath & "\data\graphics\creatures\" & CreatureX.PictureFile
						'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
						FileName = Dir(gDataPath & "\graphics\creatures\" & CreatureX.PictureFile)
						If FileName = "" Then '[Titi 2.6.1] maybe trying to display a dead body's picture?
							FileName = gDataPath & "\graphics\items\" & CreatureX.PictureFile
						Else
							FileName = gDataPath & "\graphics\creatures\" & CreatureX.PictureFile
						End If
					Else
						FileName = gAppPath & "\Roster\" & WorldNow.Name & "\Creatures\" & CreatureX.PictureFile
					End If
				Else
					FileName = gAppPath & "\Roster\" & WorldNow.Name & "\" & CreatureX.PictureFile
				End If
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = Tome.FullPath & "\creatures\" & CreatureX.PictureFile
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileName = Tome.FullPath & "\" & CreatureX.PictureFile
		End If
		ReadBitmapFile(FileName, bmBlack, hMem, TransparentRGB)
		' Convert to Mask (pure Blue is the mask color)
		MakeMask(bmBlack, bmMask, TransparentRGB)
		' Paint bitmap to picture box using converted palette
		lpMem = GlobalLock(hMem)
		Width_Renamed = Int(bmBlack.bmiHeader.biWidth * PicSize)
		Height_Renamed = Int(bmBlack.bmiHeader.biHeight * PicSize)
		picCPic(PicToLoad).Width = Width_Renamed * 2
		picCPic(PicToLoad).Height = Height_Renamed * 4
		'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picCPic(PicToLoad).hdc, 3)
		' Draw Normal and Flip
		'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picCPic(PicToLoad).hdc, 0, 0, Width_Renamed, Height_Renamed, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picCPic(PicToLoad).hdc, Width_Renamed, 0, Width_Renamed, Height_Renamed, picCPic(PicToLoad).hdc, Width_Renamed - 1, 0, -Width_Renamed, Height_Renamed, SRCCOPY)
		' Paint Mask Normal and Flip
		'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picCPic(PicToLoad).hdc, 0, Height_Renamed, Width_Renamed, Height_Renamed, 0, 0, bmMask.bmiHeader.biWidth, bmMask.bmiHeader.biHeight, lpMem, bmMask, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picCPic(PicToLoad).hdc, Width_Renamed, Height_Renamed, Width_Renamed, Height_Renamed, picCPic(PicToLoad).hdc, Width_Renamed - 1, Height_Renamed, -Width_Renamed, Height_Renamed, SRCCOPY)
		' Draw Normal and Flip (Below for Yellow Outline)
		'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picCPic(PicToLoad).hdc, 0, Height_Renamed * 2, Width_Renamed, Height_Renamed, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picCPic(PicToLoad).hdc, Width_Renamed, Height_Renamed * 2, Width_Renamed, Height_Renamed, picCPic(PicToLoad).hdc, Width_Renamed - 1, 0, -Width_Renamed, Height_Renamed, SRCCOPY)
		' Draw Normal and Flip (Below for Red Outline)
		'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picCPic(PicToLoad).hdc, 0, Height_Renamed * 3, Width_Renamed, Height_Renamed, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchBlt(picCPic(PicToLoad).hdc, Width_Renamed, Height_Renamed * 3, Width_Renamed, Height_Renamed, picCPic(PicToLoad).hdc, Width_Renamed - 1, 0, -Width_Renamed, Height_Renamed, SRCCOPY)
		' Find outline and paint it yellow and black
		For Y = Height_Renamed To Height_Renamed * 2 - 1 : For X = 0 To Width_Renamed - 1
				'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = GetPixel(picCPic(PicToLoad).hdc, X, Y)
				If rc = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black) Then
					For c = 0 To 3
						Select Case c
							Case 0
								If X < Width_Renamed - 1 Then
									'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picCPic(PicToLoad).hdc, X + 1, Y)
								End If
							Case 1
								If Y > 0 Then
									'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picCPic(PicToLoad).hdc, X, Y - 1)
								End If
							Case 2
								If Y < Height_Renamed * 2 - 1 Then
									'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picCPic(PicToLoad).hdc, X, Y + 1)
								End If
							Case 3
								If X > 0 Then
									'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picCPic(PicToLoad).hdc, X - 1, Y)
								End If
						End Select
						If rc > System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black) Then
							' Black Outline
							'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = SetPixel(picCPic(PicToLoad).hdc, X, Y - Height_Renamed, System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black))
							'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = SetPixel(picCPic(PicToLoad).hdc, System.Math.Abs(X - Width_Renamed) + Width_Renamed, Y - Height_Renamed, System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black))
							' Yellow Outline
							'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = SetPixel(picCPic(PicToLoad).hdc, X, Y + Height_Renamed, System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow))
							'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = SetPixel(picCPic(PicToLoad).hdc, System.Math.Abs(X - Width_Renamed) + Width_Renamed, Y + Height_Renamed, System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow))
							' Red Outline
							'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = SetPixel(picCPic(PicToLoad).hdc, X, Y + Height_Renamed * 2, System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Red))
							'UPGRADE_ISSUE: PictureBox property picCPic.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = SetPixel(picCPic(PicToLoad).hdc, System.Math.Abs(X - Width_Renamed) + Width_Renamed, Y + Height_Renamed * 2, System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Red))
							Exit For
						End If
					Next c
				End If
			Next X : Next Y
		picCPic(PicToLoad).Refresh()
		' Paint party size picture box
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMapPartySize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PartyWidth = CShort(bmBlack.bmiHeader.biWidth * bdMapPartySize)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMapPartySize. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PartyHeight = CShort(bmBlack.bmiHeader.biHeight * bdMapPartySize)
		picCMap(PicToLoad).Width = PartyWidth
		picCMap(PicToLoad).Height = PartyHeight * 2
		'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picCMap(PicToLoad).hdc, 3)
		'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picCMap(PicToLoad).hdc, 0, 0, PartyWidth, PartyHeight, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picCMap(PicToLoad).hdc, 0, PartyHeight, PartyWidth, PartyHeight, 0, 0, bmMask.bmiHeader.biWidth, bmMask.bmiHeader.biHeight, lpMem, bmMask, DIB_RGB_COLORS, SRCCOPY)
		' Draw line around party mask picture
		For Y = 0 To PartyHeight - 1 : For X = 0 To PartyWidth - 1
				'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = GetPixel(picCMap(PicToLoad).hdc, X, Y)
				If rc = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black) Then
					For c = 0 To 3
						Select Case c
							Case 0
								If X < PartyWidth - 1 Then
									'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picCMap(PicToLoad).hdc, X + 1, Y)
								End If
							Case 1
								If Y > 0 Then
									'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picCMap(PicToLoad).hdc, X, Y - 1)
								End If
							Case 2
								If Y < PartyHeight - 1 Then
									'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picCMap(PicToLoad).hdc, X, Y + 1)
								End If
							Case 3
								If X > 0 Then
									'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picCMap(PicToLoad).hdc, X - 1, Y)
								End If
						End Select
						If rc > System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black) Then
							'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = SetPixel(picCMap(PicToLoad).hdc, X, Y + PartyHeight, System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black))
							Exit For
						End If
					Next c
				End If
			Next X : Next Y
		picCMap(PicToLoad).Refresh()
		' If have portrait, fetch that and paint. Else, scale face from picture.
		'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picFaces.hdc, 3)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceBlank. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		rc = BitBlt(picFaces.hdc, bdFaceMin + 66 * PicToLoad, 0, 66, 76, picFaces.hdc, bdFaceBlank, 0, SRCCOPY)
		If Len(CreatureX.PortraitFile) > 0 Then
			' Release memory
			rc = GlobalUnlock(hMem)
			rc = GlobalFree(hMem)
			' Load Bitmap
			'        Filename = Dir$(Tome.FullPath & "\" & CreatureX.PortraitFile)
			'        If Filename = "" Then
			'            Filename = Dir$(Tome.FullPath & "\creatures\" & CreatureX.PortraitFile)
			'            If Filename = "" Then
			'                Filename = Dir$(gAppPath & "\Data\Graphics\Creatures\" & CreatureX.PortraitFile)
			'            Else
			'                Filename = Tome.FullPath & "\creatures\" & CreatureX.PortraitFile
			'            End If
			'        Else
			'            Filename = Tome.FullPath & "\" & CreatureX.PortraitFile
			'        End If
			' [Titi 2.4.8] added the alternative portraits folders
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			If Dir(Tome.FullPath & "\" & CreatureX.PortraitFile) = CreatureX.PortraitFile Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = Tome.FullPath & "\" & CreatureX.PortraitFile
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			ElseIf Dir(Tome.FullPath & "\Creatures\" & CreatureX.PortraitFile) = CreatureX.PortraitFile Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = Tome.FullPath & "\Creatures\" & CreatureX.PortraitFile
				'        ElseIf Dir$(gAppPath & "\Data\Graphics\Creatures\" & CreatureX.PortraitFile) = CreatureX.PortraitFile Then
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			ElseIf Dir(gDataPath & "\Graphics\Creatures\" & CreatureX.PortraitFile) = CreatureX.PortraitFile Then 
				'            FileName = gAppPath & "\Data\Graphics\Creatures\" & CreatureX.PortraitFile
				FileName = gDataPath & "\Graphics\Creatures\" & CreatureX.PortraitFile
				'        ElseIf Dir$(gAppPath & "\Data\Graphics\Portraits\" & CreatureX.PortraitFile) = CreatureX.PortraitFile Then
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			ElseIf Dir(gDataPath & "\Graphics\Portraits\" & CreatureX.PortraitFile) = CreatureX.PortraitFile Then 
				'            FileName = gAppPath & "\Data\Graphics\Portraits\" & CreatureX.PortraitFile
				FileName = gDataPath & "\Graphics\Portraits\" & CreatureX.PortraitFile
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			ElseIf Dir(Tome.FullPath & "\Portraits\" & CreatureX.PortraitFile) = CreatureX.PortraitFile Then 
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = Tome.FullPath & "\Portraits\" & CreatureX.PortraitFile
			Else
				'            FileName = gAppPath & "\Data\Graphics\Creatures\NoSuchFile.bmp"
				FileName = gDataPath & "\Graphics\Creatures\NoSuchFile.bmp"
			End If
			ReadBitmapFile(FileName, bmBlack, hMem, TransparentRGB)
			' Convert to Mask (pure Blue is the mask color)
			MakeMask(bmBlack, bmMask, TransparentRGB)
			' Paint bitmap to picture box using converted palette
			lpMem = GlobalLock(hMem)
			Width_Renamed = Int(bmBlack.bmiHeader.biWidth)
			Height_Renamed = Int(bmBlack.bmiHeader.biHeight)
			' Resize Creature to fit in space available
			Size_Renamed = 1
			If Width_Renamed > 66 Then
				Size_Renamed = 66 / Width_Renamed
			End If
			If Height_Renamed * Size_Renamed > 76 Then
				Size_Renamed = 76 / Height_Renamed
			End If
			' Center Creature in frame
			X = CShort(66 - (Width_Renamed * Size_Renamed)) / 2
			Y = CShort(76 - (Height_Renamed * Size_Renamed)) / 2
			Height_Renamed = CShort(Height_Renamed * Size_Renamed)
			Width_Renamed = CShort(Width_Renamed * Size_Renamed)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = StretchDIBits(picFaces.hdc, bdFaceMin + 66 * PicToLoad + X, Y, 66, 76, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmMask, DIB_RGB_COLORS, SRCAND)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = StretchDIBits(picFaces.hdc, bdFaceMin + 66 * PicToLoad + X, Y, 66, 76, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCPAINT)
			' Release memory
			rc = GlobalUnlock(hMem)
			rc = GlobalFree(hMem)
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = StretchDIBits(picFaces.hdc, bdFaceMin + 66 * PicToLoad, Greatest(-CreatureX.FaceTop - 15, 0), 66, 76, Greatest(CreatureX.FaceLeft - 6, 0), Greatest(bmBlack.bmiHeader.biHeight - Greatest(CreatureX.FaceTop - 15, 0) - 61, 0), Least(bmBlack.bmiHeader.biWidth - Greatest(CreatureX.FaceLeft - 6, 0), 53), Least(bmBlack.bmiHeader.biHeight - Greatest(CreatureX.FaceTop - 15, 0), 61), lpMem, bmMask, DIB_RGB_COLORS, SRCAND)
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFaceMin. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_ISSUE: PictureBox property picFaces.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = StretchDIBits(picFaces.hdc, bdFaceMin + 66 * PicToLoad, Greatest(-CreatureX.FaceTop - 15, 0), 66, 76, Greatest(CreatureX.FaceLeft - 6, 0), Greatest(bmBlack.bmiHeader.biHeight - Greatest(CreatureX.FaceTop - 15, 0) - 61, 0), Least(bmBlack.bmiHeader.biWidth - Greatest(CreatureX.FaceLeft - 6, 0), 53), Least(bmBlack.bmiHeader.biHeight - Greatest(CreatureX.FaceTop - 15, 0), 61), lpMem, bmBlack, DIB_RGB_COLORS, SRCPAINT)
			' Release memory
			rc = GlobalUnlock(hMem)
			rc = GlobalFree(hMem)
		End If
		picFaces.Refresh()
		' Return pointer to PictureBox
		CreatureX.Pic = PicToLoad
		' [Titi 2.6.0] reset picture file! (was a lazy way not to rewrite everything!)
		CreatureX.PictureFile = sPicture
	End Sub
	
	Public Sub LoadDicePic(ByRef FileName As String)
		Dim c, i As Short
		Dim LoadFile As String
		Dim YY, X, Y, XX As Short
		Dim k As Double
		'UPGRADE_WARNING: Arrays in structure bmBlack may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmBlack As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmMask may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMask As BITMAPINFO
		Dim rc, lpMem, hMem, TransparentRGB As Integer
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		' Load Bitmap
		'    LoadFile = gAppPath & "\data\interface\Dice\" & FileName
		LoadFile = gDataPath & "\interface\Dice\" & FileName
		ReadBitmapFile(LoadFile, bmBlack, hMem, TransparentRGB)
		' Convert to Mask
		MakeMask(bmBlack, bmMask, TransparentRGB)
		' Paint bitmap to picture box using converted palette
		lpMem = GlobalLock(hMem)
		Width_Renamed = Int(bmBlack.bmiHeader.biWidth)
		Height_Renamed = Int(bmBlack.bmiHeader.biHeight)
		picDice.Height = Height_Renamed : picDice.Width = Width_Renamed * 2
		' Paint the Item PIcture
		'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picDice.hdc, 3)
		'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picDice.hdc, 0, 0, Width_Renamed, Height_Renamed, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picDice.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picDice.hdc, Width_Renamed, 0, Width_Renamed, Height_Renamed, 0, 0, bmMask.bmiHeader.biWidth, bmMask.bmiHeader.biHeight, lpMem, bmMask, DIB_RGB_COLORS, SRCCOPY)
		picDice.Refresh()
		' Release memory
		rc = GlobalUnlock(hMem)
		rc = GlobalFree(hMem)
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Public Sub LoadItemPic(ByRef ItemX As Item)
		Dim ItemPicWidth As Object
		Dim ItemPicHeight As Object
		Dim Tome_Renamed As Object
		Dim ItemPicFile As Object
		Dim ItemPicTime As Object
		Dim bdMaxItemPics As Object
		Dim FileName As String
		Dim i, c, PicToLoad As Short
		Dim YY, X, Y, XX As Short
		Dim k As Double
		'UPGRADE_WARNING: Arrays in structure bmBlack may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmBlack As BITMAPINFO
		'UPGRADE_WARNING: Arrays in structure bmMask may need to be initialized before they can be used. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="814DF224-76BD-4BB4-BFFB-EA359CB9FC48"'
		Dim bmMask As BITMAPINFO
		Dim rc, lpMem, hMem, TransparentRGB As Integer
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		' If PictureFile already loaded, then return that reference
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMaxItemPics. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 1 To bdMaxItemPics
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicFile(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemPicFile(c) = ItemX.PictureFile Then
				ItemX.Pic = c
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicTime(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemPicTime(c) = TimeOfDay.ToOADate()
				Exit Sub
			End If
		Next c
		' Sort to find oldest picture box free
		k = 1 : i = 0
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMaxItemPics. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		For c = 1 To bdMaxItemPics
			'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicTime(c). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If ItemPicTime(c) < k Then
				i = c
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicTime(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				k = ItemPicTime(c)
			End If
		Next c
		PicToLoad = i
		'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicFile(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemPicFile(PicToLoad) = ItemX.PictureFile
		'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicTime(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemPicTime(PicToLoad) = TimeOfDay.ToOADate()
		' Load Bitmap
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
		FileName = Dir(Tome.FullPath & "\" & ItemX.PictureFile)
		If FileName = "" Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			FileName = Dir(Tome.FullPath & "\Items\" & ItemX.PictureFile)
			If FileName = "" Then
				' [Titi 2.4.9b] added the possibility to have pictures only in a given world
				'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				FileName = Dir(gAppPath & "\Roster\" & WorldNow.Name & "\" & ItemX.PictureFile)
				If FileName = "" Then
					'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
					FileName = Dir(gAppPath & "\Roster\" & WorldNow.Name & "\Items\" & ItemX.PictureFile)
					If FileName = "" Then
						'            FileName = gAppPath & "\data\graphics\creatures\" & CreatureX.PictureFile
						'UPGRADE_WARNING: Dir has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
						FileName = Dir(gDataPath & "\graphics\items\" & ItemX.PictureFile)
						If FileName = "" Then
							FileName = gDataPath & "\graphics\creatures\" & ItemX.PictureFile '[Titi 2.6.1] just in case: are we looking for a dead body's picture?
						Else
							FileName = gDataPath & "\graphics\items\" & ItemX.PictureFile
						End If
					Else
						FileName = gAppPath & "\Roster\" & WorldNow.Name & "\Items\" & ItemX.PictureFile
					End If
				Else
					FileName = gAppPath & "\Roster\" & WorldNow.Name & "\" & ItemX.PictureFile
				End If
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				FileName = Tome.FullPath & "\Items\" & ItemX.PictureFile
			End If
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.FullPath. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			FileName = Tome.FullPath & "\" & ItemX.PictureFile
		End If
		ReadBitmapFile(FileName, bmBlack, hMem, TransparentRGB)
		' Convert to Mask (pure Blue is the mask color)
		MakeMask(bmBlack, bmMask, TransparentRGB)
		' Paint bitmap to picture box using converted palette
		lpMem = GlobalLock(hMem)
		Width_Renamed = Int(bmBlack.bmiHeader.biWidth)
		Height_Renamed = Int(bmBlack.bmiHeader.biHeight)
		' Store Height/Width of Item Picture
		Select Case Height_Renamed
			Case 0 To 32
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemPicHeight(PicToLoad) = 32
			Case 33 To 64
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemPicHeight(PicToLoad) = 64
			Case Else
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemPicHeight(PicToLoad) = 96
		End Select
		Select Case Width_Renamed
			Case 0 To 32
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemPicWidth(PicToLoad) = 32
			Case Else
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemPicWidth(PicToLoad) = 64
		End Select
		' Center the Item Picture
		'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		X = 64 * PicToLoad - 64 + (ItemPicWidth(PicToLoad) - Width_Renamed) / 2
		'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Y = (ItemPicHeight(PicToLoad) - Height_Renamed) / 2
		' Paint the Item PIcture (normal and mask)
		'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = SetStretchBltMode(picItem.hdc, 3)
		'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picItem.hdc, X, Y, Width_Renamed, Height_Renamed, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picItem.hdc, X, Y + 96, Width_Renamed, Height_Renamed, 0, 0, bmMask.bmiHeader.biWidth, bmMask.bmiHeader.biHeight, lpMem, bmMask, DIB_RGB_COLORS, SRCCOPY)
		' Paint micro size for map object
		'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(PicToLoad). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picItem.hdc, X, Y + 96 * 2, ItemPicWidth(PicToLoad) / 3, ItemPicHeight(PicToLoad) / 3, 0, 0, bmBlack.bmiHeader.biWidth, bmBlack.bmiHeader.biHeight, lpMem, bmBlack, DIB_RGB_COLORS, SRCCOPY)
		'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(PicToLoad). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = StretchDIBits(picItem.hdc, X + 32, Y + 96 * 2, ItemPicWidth(PicToLoad) / 3, ItemPicHeight(PicToLoad) / 3, 0, 0, bmMask.bmiHeader.biWidth, bmMask.bmiHeader.biHeight, lpMem, bmMask, DIB_RGB_COLORS, SRCCOPY)
		' Find outline and paint it black
		For YY = Y + 96 To Y + 96 * 2 - 1 : For XX = X To X + Width_Renamed - 1
				'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				rc = GetPixel(picItem.hdc, XX, YY)
				If rc = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black) Then
					For c = 0 To 3
						Select Case c
							Case 0
								If XX < X + Width_Renamed - 1 Then
									'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picItem.hdc, XX + 1, YY)
								End If
							Case 1
								If YY > Y Then
									'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picItem.hdc, XX, YY - 1)
								End If
							Case 2
								If YY < Y + Height_Renamed * 2 - 1 Then
									'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picItem.hdc, XX, YY + 1)
								End If
							Case 3
								If XX > X Then
									'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
									rc = GetPixel(picItem.hdc, XX - 1, YY)
								End If
						End Select
						If rc > System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black) Then
							' Black Outline
							'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = SetPixel(picItem.hdc, XX, YY - 96, System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black))
							'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							rc = SetPixel(picItem.hdc, System.Math.Abs(XX - Width_Renamed) + Width_Renamed, YY - 96, System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black))
							Exit For
						End If
					Next c
				End If
			Next XX : Next YY
		picItem.Refresh()
		' Release memory
		rc = GlobalUnlock(hMem)
		rc = GlobalFree(hMem)
		' Return pointer to PictureBox
		ItemX.Pic = PicToLoad
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub LayerTile(ByRef Layer As Short, ByRef XMap As Short, ByRef YMap As Short, ByRef AtX As Short, ByRef AtY As Short, ByRef AtWidth As Short, ByRef AtHeight As Short, ByRef AtOffX As Short, ByRef AtOffY As Short, ByRef Gray As Short)
		Dim bdTileDark As Object
		Dim bdTileBlack As Object
		Dim Map_Renamed As Object
		Dim c, Flip As Short
		Select Case Layer
			Case bdMapBottom
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.BottomTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				c = Map.BottomTile(XMap, YMap)
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c > 0 And Map.Hidden(XMap, YMap) = False Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = Map.Tiles("L" & c).Pic
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTileBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = bdTileBlack
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.BottomFlip. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Flip = Map.BottomFlip(XMap, YMap)
				PlotTile(c, AtX, AtY, AtWidth, AtHeight, AtOffX, AtOffY, Flip)
			Case bdMapMiddle
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.MiddleTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				c = Map.MiddleTile(XMap, YMap)
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c > 0 And (Map.Hidden(XMap, YMap) = False Or Map.Hidden(Least(XMap + 1, Map.Width), YMap) = False Or Map.Hidden(XMap, Greatest(YMap - 1, 0)) = False) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = Map.Tiles("L" & c).Pic
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.MiddleFlip. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Flip = Map.MiddleFlip(XMap, YMap)
					PlotTile(c, AtX, AtY, AtWidth, AtHeight, AtOffX, AtOffY, Flip)
				End If
			Case bdMapTop
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.TopTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				c = Map.TopTile(XMap, YMap)
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If c > 0 And (Map.Hidden(XMap, YMap) = False Or Map.Hidden(Least(XMap + 1, Map.Width), YMap) = False Or Map.Hidden(XMap, Greatest(YMap - 1, 0)) = False) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Tiles. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = Map.Tiles("L" & c).Pic
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.TopFlip. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Flip = Map.TopFlip(XMap, YMap)
					PlotTile(c, AtX, AtY, AtWidth, AtHeight, AtOffX, AtOffY, Flip)
				End If
			Case bdMapDim
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.TopTile. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				c = Map.TopTile(XMap, YMap)
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Map.Hidden(XMap, YMap) = True And (Map.Hidden(Least(XMap + 1, Map.Width), YMap) = False Or Map.Hidden(XMap, Greatest(YMap - 1, 0)) = False) Then
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTileDark. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					PlotTile(bdTileDark, AtX, AtY, AtWidth, AtHeight, AtOffX, AtOffY, Flip)
				End If
		End Select
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub DrawTile(ByRef AtX As Short, ByRef AtY As Short, ByRef Side As Short)
		Dim bdTileBlack As Object
		Dim bdSideRight As Object
		Dim bdSideSecondBottom As Object
		Dim bdSideFirstBottom As Object
		Dim bdSideLeft As Object
		Dim bdSideTop As Object
		Dim Map_Renamed As Object
		' AtX is a Pixel / 48, AtY is Pixel / 24
		'UPGRADE_NOTE: my was upgraded to my_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim mx, c, my_Renamed As Short
		Dim X, Y As Short
		Dim rc As Integer
		Dim OffX, OffY As Short
		'UPGRADE_NOTE: Height was upgraded to Height_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		'UPGRADE_NOTE: Width was upgraded to Width_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim Width_Renamed, Height_Renamed As Short
		Dim XMap, YMap As Short
		' Convert AtX and AtY to Map Coordinates
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		XMap = Map.Left + AtX - Int(AtY / 2)
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		YMap = Map.Top + AtX + Int((AtY + 1) / 2) - 1
		X = (AtX * 2 - 1 + (AtY Mod 2)) * 48
		Y = (AtY - 2) * 24
		' The calc above is spot on. I've double checked it.
		OffX = 0 : OffY = 0
		Height_Renamed = 72 : Width_Renamed = 96
		' Set Offsets and Width/Height
		If (Side And bdSideTop) > 0 Then
			OffY = 48 : Height_Renamed = 24
		End If
		If (Side And bdSideLeft) > 0 Then
			OffX = 48 : Width_Renamed = 48
		End If
		If (Side And bdSideFirstBottom) > 0 Then
			Height_Renamed = 48
		End If
		If (Side And bdSideSecondBottom) > 0 Then
			Height_Renamed = 24
		End If
		If (Side And bdSideRight) > 0 Then
			Width_Renamed = 48
		End If
		' LayerTile: XMap, YMap, x, y, width, height, offx, offy
		' Plot blank tile if out of bounds
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Height. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Width. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If XMap < 0 Or YMap < 0 Or XMap > Map.Width Or YMap > Map.Height Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileBlack. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			PlotTile(bdTileBlack, X + OffX, Y + OffY, Width_Renamed, Height_Renamed, OffX, OffY, 0)
		Else
			LayerTile(bdMapBottom, XMap, YMap, X + OffX, Y + OffY, Width_Renamed, Height_Renamed, OffX, OffY, 0)
			LayerTile(bdMapMiddle, XMap, YMap, X + OffX, Y + OffY, Width_Renamed, Height_Renamed, OffX, OffY, 0)
			LayerTile(bdMapTop, XMap, YMap, X + OffX, Y + OffY, Width_Renamed, Height_Renamed, OffX, OffY, 0)
			DrawTileObjects(XMap, YMap)
			DrawTileExitSign(XMap, YMap)
			LayerTile(bdMapDim, XMap, YMap, X + OffX, Y + OffY, Width_Renamed, Height_Renamed, OffX, OffY, 0)
		End If
	End Sub
	
	Private Sub DrawTileAnnotate(ByRef XMap As Short, ByRef YMap As Short)
		Dim bdTileHeight As Object
		Dim bdTileWidth As Object
		Dim MicroMapLeft As Object
		Dim MicroMapTop As Object
		Dim cy, cx, n As Short
		Dim rc As Integer
		' Draw Party
		If Tome.MapX = XMap And Tome.MapY = YMap Then
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapLeft. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			cx = ((YMap - MicroMapTop) + (XMap - MicroMapLeft)) * (bdTileWidth / 2) + 6
			'UPGRADE_WARNING: Couldn't resolve default property of object bdTileHeight. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapLeft. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object MicroMapTop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			cy = ((YMap - MicroMapTop) - (XMap - MicroMapLeft)) * (bdTileHeight / 3) - 12
			'UPGRADE_ISSUE: PictureBox property picMisc.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			'UPGRADE_ISSUE: PictureBox property picMicroMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			rc = BitBlt(picMicroMap.hdc, cx, cy, 15, 15, picMisc.hdc, 36, 18, SRCCOPY)
		End If
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub DrawTileObjects(ByRef XMap As Short, ByRef YMap As Short)
		Dim ItemPicHeight As Object
		Dim ItemPicWidth As Object
		Dim Map_Renamed As Object
		Dim EncounterX As Encounter
		Dim CreatureX As Creature
		Dim ItemX As Item
		Dim cy, cx, n As Short
		Dim rc As Integer
		' Draw Encounter
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Map.EncPointer(XMap, YMap) > 0 And Map.Hidden(XMap, YMap) = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.EncPointer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Map.Encounters. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			EncounterX = Map.Encounters("E" & Map.EncPointer(XMap, YMap))
			If EncounterX.IsActive = True Then
				' Encounter Items
				For	Each ItemX In EncounterX.Items
					If ItemX.MapX = 0 And ItemX.MapY = 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object Map. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						PositionItem(Map, EncounterX, ItemX)
					End If
					If ItemX.MapX = XMap And ItemX.MapY = YMap And Len(ItemX.PictureFile) > 0 Then
						LoadItemPic(ItemX)
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						cx = ((YMap - Map.Top) + (XMap - Map.Left)) * 48 + ItemX.TileSpotX
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						cy = ((YMap - Map.Top) - (XMap - Map.Left)) * 24 - 24 + ItemX.TileSpotY - 24
						'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						rc = BitBlt(picMap.hdc, cx, cy, ItemPicWidth(ItemX.Pic) / 3, ItemPicHeight(ItemX.Pic) / 3, picItem.hdc, 64 * ItemX.Pic - 32, 96 * 2, SRCAND)
						'UPGRADE_ISSUE: PictureBox property picItem.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicHeight(ItemX.Pic). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object ItemPicWidth(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						rc = BitBlt(picMap.hdc, cx, cy, ItemPicWidth(ItemX.Pic) / 3, ItemPicHeight(ItemX.Pic) / 3, picItem.hdc, 64 * ItemX.Pic - 64, 96 * 2, SRCPAINT)
					End If
				Next ItemX
				' Encounter Creatures
				For	Each CreatureX In EncounterX.Creatures
					If CreatureX.MapX = XMap And CreatureX.MapY = YMap And CreatureX.IsInanimate = False And Len(CreatureX.PictureFile) > 0 Then
						LoadCreaturePic(CreatureX)
						If CreatureX.HPNow > 0 Then
							n = CreatureX.Pic
						Else
							n = 0
						End If
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						cx = ((YMap - Map.Top) + (XMap - Map.Left)) * 48 + CreatureX.TileSpotX
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						cy = ((YMap - Map.Top) - (XMap - Map.Left)) * 24 - 24 + CreatureX.TileSpotY - (picCMap(n).Height / 2)
						'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						rc = BitBlt(picMap.hdc, cx, cy, picCMap(n).Width, picCMap(n).Height / 2, picCMap(n).hdc, 0, picCMap(n).Height / 2, SRCAND)
						'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						rc = BitBlt(picMap.hdc, cx, cy, picCMap(n).Width, picCMap(n).Height / 2, picCMap(n).hdc, 0, 0, SRCPAINT)
					End If
				Next CreatureX
			End If
		End If
		' Draw Party
		For	Each CreatureX In Tome.Creatures
			'        If CreatureX.MapX = XMap And CreatureX.MapY = YMap And CreatureX.IsInanimate = False Then
			' [Titi 2.4.9] added a check (creature position = party position?) to avoid "ghosts" creatures after MoveCreature or CopyCreature statements
			If CreatureX.MapX = XMap And CreatureX.MapY = YMap And CreatureX.MapX = Tome.MapX And CreatureX.MapY = Tome.MapY And CreatureX.IsInanimate = False Then
				If CreatureX.HPNow > 0 Then
					LoadCreaturePic(CreatureX)
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					cx = ((YMap - Map.Top) + (XMap - Map.Left)) * 48 + CreatureX.TileSpotX
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					cy = ((YMap - Map.Top) - (XMap - Map.Left)) * 24 - 24 + CreatureX.TileSpotY - (picCMap(CreatureX.Pic).Height / 2)
					'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMap.hdc, cx, cy, picCMap(CreatureX.Pic).Width, picCMap(CreatureX.Pic).Height / 2, picCMap(CreatureX.Pic).hdc, 0, picCMap(CreatureX.Pic).Height / 2, SRCAND)
					'UPGRADE_ISSUE: PictureBox property picCMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMap.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMap.hdc, cx, cy, picCMap(CreatureX.Pic).Width, picCMap(CreatureX.Pic).Height / 2, picCMap(CreatureX.Pic).hdc, 0, 0, SRCPAINT)
				End If
			End If
		Next CreatureX
	End Sub
	
	'UPGRADE_NOTE: Map was upgraded to Map_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub DrawTileExitSign(ByRef XMap As Short, ByRef YMap As Short)
		Dim bdFontSmallWhite As Object
		Dim Map_Renamed As Object
		Dim EntryPointX As EntryPoint
		Dim cx, cy As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object Map.Hidden. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Map.Hidden(XMap, YMap) = False Then
			For	Each EntryPointX In Map.EntryPoints
				If EntryPointX.MapX = XMap And EntryPointX.MapY = YMap And EntryPointX.IsNoExitSign = False Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					cx = ((YMap - Map.Top) + (XMap - Map.Left)) * 48
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Left. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object Map.Top. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					cy = ((YMap - Map.Top) - (XMap - Map.Left)) * 24
					If EntryPointX.AreaIndex = 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picMap, cx + 24, cy - 12, 48, 72, bdFontSmallWhite, "Main Exit", True, False)
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowText(picMap, cx, cy, 96, 72, bdFontSmallWhite, "Exit", True, False)
					End If
				End If
			Next EntryPointX
		End If
	End Sub
	
	Private Sub frmMain_Load(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles MyBase.Load
		Dim SetTrayTip As Object
		Dim AddToTray As Object
		Dim modRegistry As Object
		Dim DialogDM As Object
		Dim DialogSetUp As Object
		Dim ctl As System.Windows.Forms.Control
		GameInit()
		' Determine if large fonts are used
		If Not SmallFonts Then
			picMainMenu.Visible = False
			DialogSetUp(bdDlgNoReply)
			DialogDM("Large fonts are not fully supported. Some windows may look strange unless you change your display settings.")
			'        GameEndAll ' no need to continue...
			picMainMenu.Visible = True
			For	Each ctl In Me.Controls
				' Adjust forms where large fonts cause display problems
				If ctl.Name = "picCreateName" Then
					ctl.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(ctl.Top) / 1.25)
				End If
			Next ctl
		End If
		'    DoEvents
		' [Titi 2.6.0] feature not available for Win 9x
		'UPGRADE_WARNING: Couldn't resolve default property of object modRegistry.VBWinVer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Mid(modRegistry.VBWinVer, 9, 1) = "9" Or Mid(modRegistry.VBWinVer, 9, 1) = "M" Then Exit Sub
		' [Titi 2.4.9b] Add a tray icon
		If WindowState = System.Windows.Forms.FormWindowState.Minimized Then
			'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbNormal to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			LastState = vbNormal
		Else
			LastState = WindowState
		End If
		AddToTray(Me, mnuTray)
		'UPGRADE_WARNING: App property App.EXEName has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		SetTrayTip(My.Application.Info.AssemblyName & " (" & My.Application.Info.Version.Major & "." & My.Application.Info.Version.Minor & "." & My.Application.Info.Version.Revision & ")")
	End Sub
	
	Private Sub frmMain_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles MyBase.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		MenuAction(CShort(X), CShort(Y), True)
	End Sub
	
	Private Sub frmMain_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles MyBase.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		MenuAction(CShort(X), CShort(Y), False)
	End Sub
	
	Private Sub frmMain_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles MyBase.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim bdFontNoxiousWhite As Object
		'UPGRADE_NOTE: Text was upgraded to Text_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
		Dim c As Short
		Dim blnShow As Boolean
		Dim Text_Renamed As String
		Dim sRune() As String
		Dim PauseTime, Start As Single
		' [Titi 2.6.0] RT 91 sometimes: mouse move while exiting the game!
		If WorldNow Is Nothing Then Exit Sub
		' [Titi 2.4.9] no display when map doesn't have any runes or [2.6.0] when showing/creating characters!
		If Map.IsNoRunes = True Or bFromMainMenu Then Exit Sub
		' [Titi 2.4.8] get the runes names
		modBD.InitializeRunes((WorldNow.Name))
		ReDim sRune(intNbRunes + 1)
		Text_Renamed = VB.Right(strRunesList, Len(strRunesList) - 5) ' get rid of "List="
		For c = 1 To intNbRunes - 1
			sRune(c) = VB.Left(Text_Renamed, InStr(Text_Renamed, ",") - 1)
			Text_Renamed = VB.Right(Text_Renamed, Len(Text_Renamed) - Len(sRune(c)) - 1)
		Next 
		sRune(c) = Text_Renamed
		If IsBetween(X, Me.ClientRectangle.Width - 32, Me.ClientRectangle.Width) And IsBetween(Y, 16, 336) Then
			' hovering over second half of runes list
			c = Int((Y - 16) / 32 + 10)
			Y = (c - 10) * 32 + 16
			blnShow = True
		ElseIf IsBetween(X, 0, 32) And IsBetween(Y, 16, 336) Then 
			' hovering on first half of runes list
			c = Int((Y - 16) / 32)
			Y = c * 32 + 16
			blnShow = True
		End If
		X = 16
		If blnShow Then
			' [Titi 2.5.1] right display too far to the left
			'ShowText picMap, X, Y, picMap.ScaleWidth - 80, 14, bdFontNoxiousWhite, sRune(c + 1), IIf(c > 9, 1, 0), False
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picMap, X, Y, picBox.ClientRectangle.Width - 24, 14, bdFontNoxiousWhite, sRune(c + 1), IIf(c > 9, 1, 0), False)
			picMap.Refresh()
			PauseTime = 0.25 ' duration of display
			Start = VB.Timer()
			Do While VB.Timer() < Start + PauseTime
				'            DoEvents
			Loop 
			' clear message
			DrawMapRegion(0, 0, 340 + HintX, Len(sRune(c)) * 8 + 16 + HintY)
			DrawMapRegion(0, picMap.ClientRectangle.Width - Len(sRune(c)) * 8 - 16 - HintY, 340 + HintX, picMap.ClientRectangle.Width)
		End If
	End Sub
	
	'UPGRADE_WARNING: Event frmMain.Resize may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub frmMain_Resize(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles MyBase.Resize
		' [Titi 2.4.9b] added for tray icon
		If LastState = 0 Then ResizeForm()
		SetTrayMenuItems(WindowState)
		If WindowState <> System.Windows.Forms.FormWindowState.Minimized Then LastState = WindowState
	End Sub
	
	Private Sub fraMediaPlayerAVI_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles fraMediaPlayerAVI.Click
		fraMediaPlayerAVI.Visible = False
		fraMediaPlayerAVI.Refresh()
		'MediaPlayerAVI.Stop
		CutSceneNow = False
	End Sub
	
	Private Sub lblHyperLink_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lblHyperLink.Click
		'Dim rc As Long
		'rc = HyperJump(bdOrderURL)
	End Sub
	
	'Private Sub MediaPlayerAVI_Click(Button As Integer, ShiftState As Integer, x As Single, y As Single)
	'    fraMediaPlayerAVI.Visible = False
	'    fraMediaPlayerAVI.Refresh
	'    MediaPlayerAVI.Stop
	'    CutSceneNow = False
	'End Sub
	'
	'Private Sub MediaPlayerAVI_EndOfStream(ByVal Result As Long)
	'    fraMediaPlayerAVI.Visible = False
	'    MediaPlayerAVI.Stop
	'    CutSceneNow = False
	'End Sub
	
	Private Sub picBuySell_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picBuySell.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim DialogBuySellClick As Object
		If picConvo.Visible = False Then
			ClickX = X : ClickY = Y
			DialogBuySellClick(ClickX, ClickY, True)
		End If
	End Sub
	
	Private Sub picBuySell_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picBuySell.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Delta As Object
		Dim DialogBuySellClick As Object
		Dim EnumThreadProc As Object
		' [Titi 2.5.1] Mouse wheel support added
		EnumThreadProc(Me.Handle.ToInt32, Y * &H10000 + X)
		If picConvo.Visible = False Then
			If X > (653 + 32 - 18) / 2 Then ' we're on the right side of the window: we're selling items
				ClickX = 653 : ClickY = 200 ' middle of Sell ScrollBar
			Else ' we buying items
				ClickX = 32 : ClickY = 200 ' middle of Buy ScrollBar
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Delta > 0 Then
				' 18 is the height of the scroll arrow, and 44 is the position of the top of the scrollbar
				DialogBuySellClick(ClickX, (44 + 18) + 2, True) ' top of the scrollbar (+2 pixels to not click on the up arrow)
				'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf Delta < 0 Then 
				' 312 is the height of the scrollbar, 44 and 18 same as above
				DialogBuySellClick(ClickX, (44 + 312 - 18) - 2, True) ' bottom of the scrollbar (-2 pixels to not click on the up arrow)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Delta = 0
		End If
	End Sub
	
	Private Sub picBuySell_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picBuySell.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim DialogBuySellClick As Object
		Dim sWait As Single
		If picConvo.Visible = False Then
			' [Titi 2.6.0] Sometimes, MouseUp and MouseDown events mixed up. Maybe a problem of too fast clicks?
			sWait = VB.Timer()
			Do  ' wait 0.1 s
			Loop Until VB.Timer() > sWait + 0.1
			DialogBuySellClick(ClickX, ClickY, False)
		End If
	End Sub
	
	Private Sub picContainer_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles picContainer.DoubleClick
		If picConvo.Visible = False Then
			InventoryContainerClick(ClickX, ClickY, True, VB6.MouseButtonConstants.LeftButton, True)
		End If
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picContainer.KeyPress was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picContainer_KeyPress(ByRef KeyAscii As Short)
		Dim InvDragMode As Object
		Dim InvDragItem As Object
		' [Titi 2.6.0] fix dragged item not released
		If KeyAscii = System.Windows.Forms.Keys.Escape Then
			' No matter what, shut off dragging Item
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvDragItem.Selected = False
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvDragMode = False
			picInvDrag.Visible = False
		End If
	End Sub
	
	Private Sub picContainer_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picContainer.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		If picConvo.Visible = False Then
			ClickX = X : ClickY = Y
			InventoryContainerClick(ClickX, ClickY, True, Button)
		End If
	End Sub
	
	Private Sub picContainer_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picContainer.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim InvDragMode As Object
		Dim JournalX As Object
		Dim JournalY As Object
		Dim InvContainer As Object
		Dim InvDragItem As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If InvDragMode = True Then
			If picInvDrag.Visible = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvDragItem.Selected = 1
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryContainerShow(InvContainer)
				picInvDrag.BringToFront()
				picInvDrag.Visible = True
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picInvDrag.Top = picContainer.Top + Y - JournalY
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picInvDrag.Left = picContainer.Left + X - JournalX
		Else
			InventoryHint(2, Int(X), Int(Y))
		End If
	End Sub
	
	Private Sub picContainer_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picContainer.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim InvDragMode As Object
		Dim InvContainer As Object
		Dim FromList, c, ToList As Short
		If picConvo.Visible = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If InvDragMode = True Then
				InventoryContainerDrag(picContainer.Left + CShort(X), picContainer.Top + CShort(Y))
				'UPGRADE_WARNING: Couldn't resolve default property of object InvContainer. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryContainerShow(InvContainer)
			Else
				InventoryContainerClick(ClickX, ClickY, False, Button)
			End If
		End If
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picConvo.KeyDown was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picConvo_KeyDown(ByRef KeyCode As Short, ByRef Shift As Short)
		'    KeyBoardShortCuts KeyCode, Shift
		ParseShortCuts(KeyCode, Shift)
	End Sub
	
	Private Sub picConvo_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picConvo.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim DialogClick As Object
		ClickX = X : ClickY = Y
		DialogClick(ClickX, ClickY, True)
	End Sub
	
	Private Sub picConvo_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picConvo.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim DialogStyle As Object
		Dim DialogReplyMove As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If DialogStyle = bdDlgWithReply Then
			DialogReplyMove(CShort(X), CShort(Y))
		End If
	End Sub
	
	Private Sub picConvo_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picConvo.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim DialogClick As Object
		DialogClick(ClickX, ClickY, False)
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picConvoEnter.KeyDown was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picConvoEnter_KeyDown(ByRef KeyCode As Short, ByRef Shift As Short)
		Dim DialogEnter As Object
		Dim bdTomeOptions As Object
		Dim TomeAction As Object
		Dim DialogText As Object
		' [Titi 2.4.9] get CTRL, SHIFT and arrows for shortcuts
		Dim oldDialogText As String
		'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oldDialogText = DialogText
		Select Case KeyCode
			Case System.Windows.Forms.Keys.Left, System.Windows.Forms.Keys.Right, System.Windows.Forms.Keys.Up, System.Windows.Forms.Keys.Down
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeOptions. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeAction = bdTomeOptions Then
					' options shown, then we're defining shortcuts
					'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogText = IIf(KeyCode = System.Windows.Forms.Keys.Left, "left", IIf(KeyCode = System.Windows.Forms.Keys.Right, "right", IIf(KeyCode = System.Windows.Forms.Keys.Up, "up", "down")))
					'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If VB.Left(oldDialogText & Space(4), 4) = "shif" Or VB.Left(oldDialogText & Space(4), 4) = "ctrl" Then DialogText = Trim(VB.Left(oldDialogText & Space(5), 5)) & DialogText
				End If
			Case System.Windows.Forms.Keys.ControlKey, System.Windows.Forms.Keys.ShiftKey
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeOptions. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeAction = bdTomeOptions Then
					' options shown, then we're defining shortcuts
					'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogText = IIf(KeyCode = System.Windows.Forms.Keys.ShiftKey, "shift", "ctrl")
					'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Shift = 3 Then DialogText = "ctrl" ' if both shift and control pressed, default to ctrl
				End If
		End Select
		DialogEnter(DialogText)
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picConvoEnter.KeyPress was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picConvoEnter_KeyPress(ByRef KeyAscii As Short)
		Dim DialogEnter As Object
		Dim DialogText As Object
		Select Case KeyAscii
			Case System.Windows.Forms.Keys.Back ', vbKeyLeft   ' BackSpace
				If Len(DialogText) > 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DialogText = VB.Left(DialogText, Len(DialogText) - 1)
				End If
			Case 32 ' Space
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DialogText = DialogText & " "
			Case 47 To 57, 65 To 90, 97 To 122 ' [Titi 2.4.9] allowed "/" (ascii code # 47)
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If VB.Left(DialogText & Space(5), 5) = "shift" And KeyAscii > 96 Then KeyAscii = KeyAscii - 32
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogText. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DialogText = DialogText & Chr(KeyAscii)
		End Select
		DialogEnter(DialogText)
	End Sub
	
	Private Sub picConvoList_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picConvoList.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim DebugClick As Object
		Dim DialogStyle As Object
		ClickX = X : ClickY = Y
		'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If DialogStyle = bdDlgItemList Then
			TargetItemClick(ClickX, ClickY, True)
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf DialogStyle = bdDlgCreatureList Then 
			TargetCreatureClick(ClickX, ClickY, True)
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf DialogStyle = bdDlgDebug Then 
			DebugClick(ClickX, ClickY, True)
		End If
	End Sub
	
	Private Sub picConvoList_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picConvoList.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Delta As Object
		Dim DialogStyle As Object
		Dim EnumThreadProc As Object
		' [Titi 2.5.1] Mouse wheel support added
		EnumThreadProc(Me.Handle.ToInt32, Y * &H10000 + X)
		'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Delta > 0 Then
			' 340 = 331 (position of scrollbar in picInventory) + 9 (half of scrollbar width)
			' 18 is the height of the scroll arrow, and 2 is the position of the top of the scrollbar
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If DialogStyle = bdDlgCreatureList Then
				TargetCreatureClick(340, (2 + 18) + 2, True) ' top of the scrollbar (+2 pixels to not click on the up arrow)
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf DialogStyle = bdDlgItemList Then 
				TargetItemClick(340, (2 + 18) + 2, True) ' top of the scrollbar (+2 pixels to not click on the up arrow)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf Delta < 0 Then 
			' 338 is the height of the scrollbar, 45 and 18 same as above
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If DialogStyle = bdDlgCreatureList Then
				TargetCreatureClick(340, (2 + 269 - 18) - 2, True) ' bottom of the scrollbar (-2 pixels to not click on the up arrow)
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf DialogStyle = bdDlgItemList Then 
				TargetItemClick(340, (2 + 269 - 18) - 2, True) ' bottom of the scrollbar (-2 pixels to not click on the up arrow)
			End If
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Delta = 0
	End Sub
	
	Private Sub picConvoList_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picConvoList.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim DebugClick As Object
		Dim DialogStyle As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If DialogStyle = bdDlgItemList Then
			TargetItemClick(ClickX, ClickY, False)
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf DialogStyle = bdDlgCreatureList Then 
			TargetCreatureClick(ClickX, ClickY, False)
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogStyle. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf DialogStyle = bdDlgDebug Then 
			DebugClick(ClickX, ClickY, False)
		End If
	End Sub
	
	Private Sub picDialogBrief_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles picDialogBrief.Click
		picDialogBrief.Visible = False
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picInvDrag.KeyPress was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picInvDrag_KeyPress(ByRef KeyAscii As Short)
		Dim InvDragMode As Object
		Dim InvDragItem As Object
		If KeyAscii = System.Windows.Forms.Keys.Escape Then
			' shut off dragging Item
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvDragItem.Selected = False
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.InvSpot. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvDragItem.InvSpot = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvDragMode = False
			picInvDrag.Visible = False
		End If
	End Sub
	
	Private Sub picInventory_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles picInventory.DoubleClick
		If picConvo.Visible = False Then
			InventoryClick(ClickX, ClickY, True, VB6.MouseButtonConstants.LeftButton, True)
		End If
	End Sub
	
	Private Sub picInventory_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picInventory.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		If picConvo.Visible = False Then
			ClickX = X : ClickY = Y
			InventoryClick(ClickX, ClickY, True, Button)
		End If
	End Sub
	
	Private Sub picInventory_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picInventory.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Delta As Object
		Dim EnumThreadProc As Object
		Dim InvDragMode As Object
		Dim InvNowShow As Object
		Dim JournalX As Object
		Dim JournalY As Object
		Dim bdInvItems As Object
		Dim InvDragItem As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If InvDragMode = True Then
			If picInvDrag.Visible = False Then
				picInvDrag.BringToFront()
				picInvDrag.Visible = True
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvDragItem.Selected = 1
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryShow(bdInvItems)
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picInvDrag.Top = picInventory.Top + Y - JournalY
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picInvDrag.Left = picInventory.Left + X - JournalX
			'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf InvNowShow = bdInvItems Then 
			InventoryHint(0, Int(X), Int(Y))
		End If
		' [Titi 2.5.1] Mouse wheel support added
		EnumThreadProc(Me.Handle.ToInt32, Y * &H10000 + X)
		'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Delta > 0 Then
			' 553 = 544 (position of scrollbar in picInventory) + 9 (half of scrollbar width)
			' 18 is the height of the scroll arrow, and 45 is the position of the top of the scrollbar
			InventoryClick(553, (45 + 18) - 2, False, False) ' top of the scrollbar (-2 pixels to not click on the up arrow)
			'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf Delta < 0 Then 
			' 338 is the height of the scrollbar, 45 and 18 same as above
			InventoryClick(553, (45 + 338 - 18) + 2, False, False) ' bottom of the scrollbar (+2 pixels to not click on the up arrow)
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Delta = 0
	End Sub
	
	Private Sub picInventory_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picInventory.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim InvDragMode As Object
		Dim bdInvItems As Object
		Dim JournalY As Object
		Dim JournalX As Object
		If picConvo.Visible = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If InvDragMode = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryDragItem(picInventory.Left + CShort(X) - (JournalX / 2), picInventory.Top + CShort(Y) - (JournalY / 2))
				'UPGRADE_WARNING: Couldn't resolve default property of object bdInvItems. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InventoryShow(bdInvItems)
			Else
				InventoryClick(ClickX, ClickY, False, Button)
			End If
		End If
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picJournal.KeyPress was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picJournal_KeyPress(ByRef KeyAscii As Short)
		Dim AddJournalText As Object
		Call AddJournalText(KeyAscii)
	End Sub
	
	Private Sub picJournal_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picJournal.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim JournalClick As Object
		Dim JournalDragDrop As Object
		Dim JournalY As Object
		Dim JournalX As Object
		ClickX = X : ClickY = Y
		If Y < 24 Then
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			JournalX = X
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			JournalY = Y
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalDragDrop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			JournalDragDrop = True
		Else
			JournalClick(ClickX, ClickY, True)
		End If
	End Sub
	
	Private Sub picJournal_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picJournal.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Delta As Object
		Dim JournalClick As Object
		Dim EnumThreadProc As Object
		Dim JournalDragDrop As Object
		Dim JournalX As Object
		Dim JournalY As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalDragDrop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If JournalDragDrop = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picJournal.Top = picJournal.Top + Y - JournalY
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picJournal.Left = picJournal.Left + X - JournalX
		End If
		' [Titi 2.5.1] Mouse wheel support added
		EnumThreadProc(Me.Handle.ToInt32, Y * &H10000 + X)
		'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Delta > 0 Then
			' 326 = 317 (position of scrollbar in picJournal) + 9 (half of scrollbar width)
			' 18 is the height of the scroll arrow, and 81 is the position of the top of the scrollbar
			JournalClick(326, (81 + 18) + 2, True) ' top of the scrollbar (+2 pixels to not click on the up arrow)
			'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf Delta < 0 Then 
			' 218 is the height of the scrollbar, 81 and 18 same as above
			JournalClick(326, (81 + 218 - 18) - 2, True) ' bottom of the scrollbar (-2 pixels to not click on the up arrow)
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Delta = 0
	End Sub
	
	Private Sub picJournal_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picJournal.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim JournalClick As Object
		Dim JournalDragDrop As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalDragDrop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		JournalDragDrop = False
		JournalClick(ClickX, ClickY, False)
	End Sub
	
	Private Sub picMainMenu_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles picMainMenu.Click
		Dim bdTomeNew As Object
		Dim bdWorldMenu As Object
		Dim bdCharacterMenu As Object
		Dim TomeMenu As Object
		Dim bdTomeMenu As Object
		Dim TomeAction As Object
		Dim intSubMenu As Short
		'UPGRADE_WARNING: Untranslated statement in picMainMenu_Click. Please check source code.
		' [Titi 2.6.0] change TomeAction value depending on the active menu
		'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeNew. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If TomeAction < 3 And TomeMenu = bdTomeNew Then
			' Main menu: only "options" and "quit" are direct choices, other lines lead to sub-menus
			Select Case TomeAction
				Case 0 ' Tome
					'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeMenu = bdTomeMenu
				Case 1 ' Character
					'UPGRADE_WARNING: Couldn't resolve default property of object bdCharacterMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					TomeMenu = bdCharacterMenu
				Case 2 ' World
					'                TomeMenu = bdWorldMenu
					TomeDo(7)
			End Select
		Else
			Select Case TomeMenu
				Case bdTomeMenu
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					intSubMenu = IIf(TomeAction = 3, 5, 0)
				Case bdWorldMenu
					intSubMenu = 5
				Case bdCharacterMenu
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					intSubMenu = IIf(TomeAction = 2, 6, 5)
				Case Else
					intSubMenu = 0
			End Select
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			TomeDo(TomeAction + intSubMenu)
		End If
	End Sub
	
	'Private Sub picMainMenu_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
	'    ' [Titi 2.4.9b] Left-Click = next world, Right-Click = previous world
	'    If TomeAction = 5 And TomeMenu <> bdTomeOptions Then TomeAction = TomeAction - (Button = vbRightButton)
	'End Sub
	
	Private Sub picMainMenu_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picMainMenu.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim TomeAction As Object
		Dim bdTomeOptions As Object
		Dim bdCharacterMenu As Object
		Dim bdTomeMenu As Object
		Dim TomeMenu As Object
		Dim rc As Integer
		Dim c As Short
		Dim sPath As String
		Dim intYmask, intHeight, intYmenu, intXmenu As Short
		If IsBetween(Y, 98, 289) Then
			c = Int((Y - 98) / 39)
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If TomeAction <> c Then
				' [Titi 2.6.0] added sub-menus
				sPath = gDataPath & "\Interface\" & GlobalInterfaceName & "\"
				Select Case TomeMenu
					Case bdTomeMenu
						picMainMenu.Image = System.Drawing.Image.FromFile(sPath & "MainMenuTomeSub.bmp")
						picBlack.Image = System.Drawing.Image.FromFile(sPath & "MainMenuTomeSubRollOver.bmp")
						intHeight = 46 : intYmenu = 84 : intYmask = 84 : intXmenu = 0
						'                Case bdWorldMenu
						'                    picMainMenu.Picture = LoadPicture(sPath & "MainMenuWorldSub.bmp")
						'                    picBlack.Picture = LoadPicture(sPath & "MainMenuWorldSubRollOver.bmp")
						'                    intHeight = 39: intYmenu = 103: intYmask = 144
					Case bdCharacterMenu
						picMainMenu.Image = System.Drawing.Image.FromFile(sPath & "MainMenuCharSub.bmp")
						picBlack.Image = System.Drawing.Image.FromFile(sPath & "MainMenuCharSubRollOver.bmp")
						intHeight = 59 : intYmenu = 80 : intYmask = 80 : intXmenu = 0
					Case Else
						picMainMenu.Image = System.Drawing.Image.FromFile(sPath & "MainMenuNew.bmp")
						picBlack.Image = System.Drawing.Image.FromFile(sPath & "MainMenuRollOverNew.bmp")
						intHeight = 39 : intYmenu = 98 : intYmask = 145 : intXmenu = 122
				End Select
				'UPGRADE_ISSUE: PictureBox method picMainMenu.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				picMainMenu.Cls()
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeOptions. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeMenu = bdTomeOptions Then
					'rc = BitBlt(picMainMenu.hdc, 122, 103, 288, 195, picBlack.hdc, 0, 340, SRCCOPY)
					'rc = BitBlt(picMainMenu.hdc, 122, 103 + c * 39, 288, 39, picBlack.hdc, 0, 536 + c * 39, SRCCOPY)
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMainMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMainMenu.hdc, 122, 98, 288, 195, picBlack.hdc, 0, 340, SRCCOPY)
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMainMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMainMenu.hdc, 122, 98 + c * 39, 288, 39, picBlack.hdc, 0, 536 + c * 39, SRCCOPY)
				Else
					'                rc = BitBlt(picMainMenu.hdc, 122, 103 + c * 39, 288, 39, picBlack.hdc, 0, 144  + c * 39, SRCCOPY)
					'UPGRADE_ISSUE: PictureBox property picBlack.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_ISSUE: PictureBox property picMainMenu.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					rc = BitBlt(picMainMenu.hdc, intXmenu, intYmenu + c * intHeight, 288 - 144 * CShort(intXmenu = 0), intHeight, picBlack.hdc, 0, intYmask + c * intHeight, SRCCOPY)
				End If
				Call UpdateMainMenu()
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				TomeAction = c
				picMainMenu.Refresh()
				' reset default mask
				picBlack.Image = System.Drawing.Image.FromFile(sPath & "MainMenuRollOverNew.bmp")
			End If
			'    ElseIf IsBetween(Y, picMainMenu.ScaleHeight - 85, picMainMenu.ScaleHeight - 65) And TomeMenu <> bdTomeOptions Then
			'    ' [Titi 2.4.9b] Quick selection of world
			'        picMainMenu.Cls
			'        UpdateMainMenu
			'        ShowText picMainMenu, 1, picMainMenu.ScaleHeight - 85, picMainMenu.ScaleWidth, 14, bdFontElixirWhite, "Current World: " & WorldNow.Name, True, False
			'        picMainMenu.Refresh
			'        TomeAction = 5 - (Button = vbRightButton)
		End If
	End Sub
	
	Private Sub UpdateMainMenu()
		Dim bdFontSmallWhite As Object
		'    If TomeMenu = bdTomeNew Then ShowText picMainMenu, 1, picMainMenu.ScaleHeight - 85, picMainMenu.ScaleWidth, 14, bdFontElixirGold, "Current World: " & WorldNow.Name, True, False
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picMainMenu, 12, picMainMenu.ClientRectangle.Height - 15, picMainMenu.ClientRectangle.Width - 24, 14, bdFontSmallWhite, "CrossCut Games, Inc.", False, False)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picMainMenu, 12, picMainMenu.ClientRectangle.Height - 15, picMainMenu.ClientRectangle.Width - 24, 14, bdFontSmallWhite, "v" & My.Application.Info.Version.Major & "." & My.Application.Info.Version.Minor & " Build " & My.Application.Info.Version.Revision, 1, False)
	End Sub
	
	Private Sub picMap_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles picMap.Click
		Dim Frozen As Object
		If Not Frozen And picGrid.Visible = False Then
			If BtnClick = VB6.MouseButtonConstants.LeftButton Then
				MovePartySet(ClickX, ClickY)
			End If
		ElseIf SplashNow = True Then 
			KillSplash = True
		ElseIf CutSceneNow = True Then 
			CutSceneNow = False
		End If
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picMap.KeyDown was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picMap_KeyDown(ByRef KeyCode As Short, ByRef Shift As Short)
		Dim Frozen As Object
		If Not Frozen And picGrid.Visible = False Then
			' KeyBoardShortCuts KeyCode, Shift
			ParseShortCuts(KeyCode, Shift)
		End If
	End Sub
	
	Private Sub picMap_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picMap.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Frozen As Object
		If Not Frozen And picGrid.Visible = False Then
			ClickX = CShort(X)
			ClickY = CShort(Y)
			BtnClick = Button
			If BtnClick = VB6.MouseButtonConstants.RightButton Then
				MenuSkillUse(False)
			End If
		End If
	End Sub
	
	Private Sub picMap_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picMap.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Frozen As Object
		If Not Frozen And picGrid.Visible = False Then
			HintX = CShort(X) : HintY = CShort(Y)
		End If
	End Sub
	
	Private Sub SetTurn(ByRef Index As Short)
		Dim bdMenuSkill As Object
		Dim TomeAction As Object
		Dim DialogBuySellShow As Object
		Dim DialogBuySellPC As Object
		Dim InvNowShow As Object
		Dim InvTopIndex As Object
		Dim MenuParty As Object
		Dim CreatureWithTurn As Object
		Dim MenuPartyIndex As Object
		' Need to scroll if more than 5 away from far left CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object MenuPartyIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		MenuPartyIndex = Index
		MenuDrawParty()
		CreatureWithTurn = MenuParty(MenuPartyIndex)
		MenuDrawParty()
		' If Inventory is open, show new CreatureWithTurn's inventory
		If picInventory.Visible = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object InvTopIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InvTopIndex = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object InvNowShow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			InventoryShow(InvNowShow)
		ElseIf picBuySell.Visible = True Then 
			DialogBuySellPC()
			DialogBuySellShow()
			'UPGRADE_WARNING: Couldn't resolve default property of object bdMenuSkill. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf picTomeNew.Visible = True And TomeAction = bdMenuSkill Then 
			'        MenuSkillPostRaise
			' [Titi 2.4.9] this was causing the "Raise Skill" bug
			MenuSkillLoad()
			MenuSkillShow(1)
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub picMenu_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles picMenu.DoubleClick
		Dim Tome_Renamed As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object Tome.Creatures. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If ClickX > 32 And Least(CShort((ClickX - 32) / 122), 4) < Tome.Creatures.Count Then
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.MapX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MapCenter(Tome.MapX, Tome.MapY)
			DrawMapAll()
		End If
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picMenu.KeyDown was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picMenu_KeyDown(ByRef KeyCode As Short, ByRef Shift As Short)
		Dim Frozen As Object
		If Not Frozen Or picInventory.Visible = True Or picBuySell.Visible = True Or picTalk.Visible = True Then
			'UPGRADE_ISSUE: PictureBox event picMap.KeyDown was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
			picMap_KeyDown(KeyCode, Shift)
		End If
	End Sub
	
	Private Sub picMenu_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picMenu.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Frozen As Object
		Dim CreatureWithTurn As Object
		Dim MenuParty As Object
		Dim CreatureTarget As Object
		Dim MenuPartyIndex As Object
		Dim bdMenuSkill As Object
		Dim TomeAction As Object
		ClickX = CShort(X)
		ClickY = CShort(Y)
		' [Titi 2.4.9] moved from SetTurn to fix the "Gained new Spells" bug
		'UPGRADE_WARNING: Couldn't resolve default property of object bdMenuSkill. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If (picTomeNew.Visible = True And TomeAction = bdMenuSkill) Then MenuSkillPostRaise()
		' Scroll Party Members (if more than 5)
		If PartyLeft > 0 And ClickX < 32 Then
			'UPGRADE_WARNING: Untranslated statement in picMenu_MouseDown. Please check source code.
			PartyLeft = PartyLeft - 1
			'UPGRADE_WARNING: Couldn't resolve default property of object MenuPartyIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			SetTurn(Least(MenuPartyIndex + 1, 4))
		ElseIf PartyLeft + 5 < Tome.Creatures.Count() And ClickX > 610 Then 
			'UPGRADE_WARNING: Untranslated statement in picMenu_MouseDown. Please check source code.
			PartyLeft = PartyLeft + 1
			'UPGRADE_WARNING: Couldn't resolve default property of object MenuPartyIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			SetTurn(Greatest(MenuPartyIndex - 1, 0))
			'UPGRADE_WARNING: Couldn't resolve default property of object bdMenuSkill. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf Not Frozen Or picInventory.Visible = True Or picBuySell.Visible = True Or picTalk.Visible = True Or picSearch.Visible = True Or (picTomeNew.Visible = True And TomeAction = bdMenuSkill) Then 
			If Least(CShort((ClickX - 32) / 122), 4) < Tome.Creatures.Count() And ClickX > 32 And ClickX < 610 Then
				If Button = VB6.MouseButtonConstants.RightButton Then
					CreatureTarget = MenuParty(Least(CShort((ClickX - 32) / 122), 4))
					MenuSkillUse(True)
				Else
					SetTurn(Least(CShort((ClickX - 32) / 122), 4))
					'UPGRADE_WARNING: Untranslated statement in picMenu_MouseDown. Please check source code.
				End If
			End If
			' [Titi 2.6.0] If changed active character because the previous one was dead, update "Take all" button
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.HPNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If picSearch.Visible Then ShowButton(picSearch, picSearch.ClientRectangle.Width - 198, picSearch.ClientRectangle.Height - 30, "Take All", False, (CreatureWithTurn.HPNow > 0))
		End If
	End Sub
	
	Private Sub picMicroMap_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picMicroMap.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = VB6.FromPixelsUserX(eventArgs.X, 0, 309, 309)
		Dim Y As Single = VB6.FromPixelsUserY(eventArgs.Y, 0, 225, 604)
		Dim JournalY As Object
		Dim JournalX As Object
		Dim JournalDragDrop As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalDragDrop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		JournalDragDrop = True
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		JournalX = X
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		JournalY = Y
		'UPGRADE_WARNING: PictureBox property picMicroMap.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		picMicroMap.Cursor = System.Windows.Forms.Cursors.SizeAll
	End Sub
	
	Private Sub picMicroMap_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picMicroMap.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = VB6.FromPixelsUserX(eventArgs.X, 0, 309, 309)
		Dim Y As Single = VB6.FromPixelsUserY(eventArgs.Y, 0, 225, 604)
		Dim JournalDragDrop As Object
		Dim JournalX As Object
		Dim JournalY As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalDragDrop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If JournalDragDrop = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picMicroMap.Top = picMicroMap.Top + Y - JournalY
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picMicroMap.Left = picMicroMap.Left + X - JournalX
		End If
	End Sub
	
	Private Sub picMicroMap_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picMicroMap.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = VB6.FromPixelsUserX(eventArgs.X, 0, 309, 309)
		Dim Y As Single = VB6.FromPixelsUserY(eventArgs.Y, 0, 225, 604)
		Dim JournalMoveMap As Object
		Dim JournalDragDrop As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object JournalDragDrop. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		JournalDragDrop = False
		JournalMoveMap()
		picMicroMap.Cursor = System.Windows.Forms.Cursors.Default
	End Sub
	
	Private Sub picSearch_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles picSearch.DoubleClick
		If picConvo.Visible = False Then
			SearchClick(ClickX, ClickY, True, VB6.MouseButtonConstants.LeftButton, True)
		End If
	End Sub
	
	Private Sub picSearch_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picSearch.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		If picConvo.Visible = False Then
			ClickX = X : ClickY = Y
			SearchClick(ClickX, ClickY, True, Button)
		End If
	End Sub
	
	Private Sub picSearch_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picSearch.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim InvDragMode As Object
		Dim JournalX As Object
		Dim JournalY As Object
		Dim InvDragItem As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If InvDragMode = True Then
			If picInvDrag.Visible = False Then
				'UPGRADE_WARNING: Couldn't resolve default property of object InvDragItem.Selected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				InvDragItem.Selected = 1
				SearchShow()
				picInvDrag.BringToFront()
				picInvDrag.Visible = True
			End If
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picInvDrag.Top = picSearch.Top + Y - JournalY
			'UPGRADE_WARNING: Couldn't resolve default property of object JournalX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			picInvDrag.Left = picSearch.Left + X - JournalX
		Else
			InventoryHint(1, Int(X), Int(Y))
		End If
	End Sub
	
	Private Sub picSearch_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picSearch.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim InvDragMode As Object
		Dim EncounterNow As Object
		Dim FromList, c, ToList As Short
		If picConvo.Visible = False Then
			'UPGRADE_WARNING: Couldn't resolve default property of object InvDragMode. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If InvDragMode = True Then
				SearchDrag(picSearch.Left + CShort(X), picSearch.Top + CShort(Y))
				'UPGRADE_WARNING: Couldn't resolve default property of object EncounterNow.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If EncounterNow.Items.Count < 1 Then
					SearchClose()
				Else
					SearchShow()
				End If
			Else
				SearchClick(ClickX, ClickY, False, Button)
			End If
		End If
	End Sub
	
	Private Sub picTalk_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picTalk.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		ClickX = X : ClickY = Y
		TalkClick(ClickX, ClickY, True)
	End Sub
	
	Private Sub picTalk_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picTalk.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		TalkMove(CShort(X), CShort(Y))
	End Sub
	
	Private Sub picTalk_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picTalk.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		TalkClick(ClickX, ClickY, False)
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picCreateName.KeyPress was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picCreateName_KeyPress(ByRef KeyAscii As Short)
		Dim CreatePCNameEnter As Object
		CreatePCNameEnter(KeyAscii)
	End Sub
	
	Private Sub picTomeNew_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picTomeNew.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim bdMenuSkill As Object
		Dim bdTomeOptions As Object
		Dim bdTomeMenu As Object
		Dim TomeMenu As Object
		Dim CreatePCClick As Object
		Dim bdCreatePCName As Object
		Dim bdCreatePCSkills As Object
		Dim bdCreatePCPicture As Object
		Dim bdCreatePCKingdom As Object
		Dim bdTomeSaveAs As Object
		Dim bdTomeSaves As Object
		Dim bdTomePackage As Object
		Dim bdTomeGather As Object
		Dim bdTomeNew As Object
		Dim TomeAction As Object
		ClickX = X : ClickY = Y
		Select Case TomeAction
			Case bdTomeNew, bdTomeGather, bdTomePackage
				TomeNewClick(ClickX, ClickY, True, (Button = VB6.MouseButtonConstants.RightButton)) ' [Titi 2.4.9] added right-click
			Case bdTomeSaves, bdTomeSaveAs
				TomeSavesClick(ClickX, ClickY, True)
			Case bdCreatePCKingdom, bdCreatePCPicture, bdCreatePCSkills, bdCreatePCName
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeAction = 2 And TomeMenu = bdTomeMenu Then
					TomeNewClick(ClickX, ClickY, True, (Button = VB6.MouseButtonConstants.RightButton)) ' [Titi 2.6.0] Create random tome
				Else
					CreatePCClick(ClickX, ClickY, True)
				End If
			Case bdTomeOptions
				OptionsClick(ClickX, ClickY, True)
			Case bdMenuSkill
				MenuSkillClick(ClickX, ClickY, True)
		End Select
	End Sub
	
	Private Sub picTomeNew_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picTomeNew.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Delta As Object
		Dim CreatePCClick As Object
		Dim bdCreatePCSkills As Object
		Dim bdTomeOptions As Object
		Dim bdMenuSkill As Object
		Dim bdTomePackage As Object
		Dim bdTomeSaveAs As Object
		Dim bdTomeSaves As Object
		Dim EnumThreadProc As Object
		Dim TomeRosterDrag As Object
		Dim TomeRosterDragX As Object
		Dim TomeRosterDragY As Object
		Dim bdTomeGather As Object
		Dim bdTomeNew As Object
		Dim TomeAction As Object
		ClickX = X : ClickY = Y
		Select Case TomeAction
			Case bdTomeNew, bdTomeGather
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDrag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeRosterDrag <> 0 Then
					picInvDrag.Visible = True
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDragY. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					picInvDrag.Top = picTomeNew.Top - TomeRosterDragY + Y
					'UPGRADE_WARNING: Couldn't resolve default property of object TomeRosterDragX. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					picInvDrag.Left = picTomeNew.Left - TomeRosterDragX + X
				End If
		End Select
		' [Titi 2.5.1] Mouse wheel support added
		EnumThreadProc(Me.Handle.ToInt32, Y * &H10000 + X)
		'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Delta > 0 Then
			' 285 = 276 (position of scrollbar in picTomeNew) + 9 (half of scrollbar width)
			' 18 is the height of the scroll arrow, and 62 is the position of the top of the scrollbar
			Select Case TomeAction
				Case bdTomeSaves, bdTomeSaveAs
					TomeSavesClick(285, (62 + 18) + 2, True) ' top of the scrollbar (+2 pixels to not click on the up arrow)
				Case bdTomeNew, bdTomeGather, bdTomePackage
					TomeNewClick(285, (62 + 18) + 2, True) ' top of the scrollbar (+2 pixels to not click on the up arrow)
				Case bdMenuSkill
					MenuSkillClick(285, (62 + 18) + 2, True) ' top of the scrollbar (+2 pixels to not click on the up arrow)
				Case bdTomeOptions
					OptionsClick(285, (62 + 18) + 2, True) ' top of the scrollbar (+2 pixels to not click on the up arrow)
				Case bdCreatePCSkills
					CreatePCClick(285, (62 + 18) + 2, True) ' top of the scrollbar (+2 pixels to not click on the up arrow)
			End Select
			'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ElseIf Delta < 0 Then 
			' 267 is the height of the scrollbar, 45 and 18 same as above
			Select Case TomeAction
				Case bdTomeSaves, bdTomeSaveAs
					TomeSavesClick(285, (62 + 267 - 18) - 2, True) ' bottom of the scrollbar (-2 pixels to not click on the up arrow)
				Case bdTomeNew, bdTomeGather, bdTomePackage
					TomeNewClick(285, (62 + 267 - 18) - 2, True) ' bottom of the scrollbar (-2 pixels to not click on the up arrow)
				Case bdMenuSkill
					MenuSkillClick(285, (62 + 267 - 18) - 2, True) ' bottom of the scrollbar (-2 pixels to not click on the up arrow)
				Case bdTomeOptions
					OptionsClick(285, (62 + 267 - 18) - 2, True) ' bottom of the scrollbar (-2 pixels to not click on the up arrow)
				Case bdCreatePCSkills
					CreatePCClick(285, (62 + 267 - 18) - 2, True) ' bottom of the scrollbar (-2 pixels to not click on the up arrow)
			End Select
		End If
		'UPGRADE_WARNING: Couldn't resolve default property of object Delta. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Delta = 0
	End Sub
	
	Private Sub picTomeNew_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picTomeNew.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim bdMenuSkill As Object
		Dim bdTomeOptions As Object
		Dim bdTomeMenu As Object
		Dim TomeMenu As Object
		Dim CreatePCClick As Object
		Dim bdCreatePCName As Object
		Dim bdCreatePCSkills As Object
		Dim bdCreatePCPicture As Object
		Dim bdCreatePCKingdom As Object
		Dim bdTomeSaveAs As Object
		Dim bdTomeSaves As Object
		Dim bdTomePackage As Object
		Dim bdTomeGather As Object
		Dim bdTomeNew As Object
		Dim TomeAction As Object
		Select Case TomeAction
			Case bdTomeNew, bdTomeGather, bdTomePackage
				TomeNewClick(ClickX, ClickY, False)
			Case bdTomeSaves, bdTomeSaveAs
				TomeSavesClick(ClickX, ClickY, False)
			Case bdCreatePCKingdom, bdCreatePCPicture, bdCreatePCSkills, bdCreatePCName
				'UPGRADE_WARNING: Couldn't resolve default property of object bdTomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeMenu. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object TomeAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If TomeAction = 2 And TomeMenu = bdTomeMenu Then
					TomeNewClick(ClickX, ClickY, False) ' [Titi 2.6.0] create random tome
				Else
					CreatePCClick(ClickX, ClickY, False)
				End If
			Case bdTomeOptions
				OptionsClick(ClickX, ClickY, False)
			Case bdMenuSkill
				MenuSkillClick(ClickX, ClickY, False)
		End Select
	End Sub
	
	Private Sub picWallPaper_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles picWallPaper.Click
		If CutSceneNow = True Then
			CutSceneNow = False
		End If
	End Sub
	
	Private Sub timerMusicLoop_Tick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles timerMusicLoop.Tick
		Dim vsSTOPPED As Object
		Dim oGameMusic As Object
		' check status of background music
		If GlobalMusicState = 1 Then
			' see if the music is still playing
			'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.Status. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If oGameMusic.Status = vsSTOPPED Then
				'UPGRADE_WARNING: Couldn't resolve default property of object oGameMusic.Play. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				oGameMusic.Play()
			End If
		End If
	End Sub
	
	Private Sub tmrDialogBrief_Tick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles tmrDialogBrief.Tick
		Dim bdFontNoxiousWhite As Object
		Dim DialogBriefSet As Object
		Dim DialogShowFaceBrief As Object
		Static TimeToRead As Double
		'UPGRADE_WARNING: Couldn't resolve default property of object DialogBriefSet.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If DialogBriefSet.Count > 0 And TimeToRead = 0 Then
			'UPGRADE_ISSUE: PictureBox method picDialogBrief.Cls was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			picDialogBrief.Cls()
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogBriefSet().CreatureTalking. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DialogShowFaceBrief(DialogBriefSet(1).CreatureTalking)
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogBriefSet().Text. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ShowText(picDialogBrief, 90, 37, picDialogBrief.ClientRectangle.Width - 90, picDialogBrief.ClientRectangle.Height, bdFontNoxiousWhite, DialogBriefSet(1).Text, False, True) ' [Titi 2.4.9b] allows several lines even in brief dialogs!
			' Position DialogBrief box
			picDialogBrief.Top = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogBriefSet(1).CreatureTalking. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If DialogBriefSet(1).CreatureTalking.Friendly = True Then
				picDialogBrief.Left = 0
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogBriefSet(1).CreatureTalking. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			ElseIf DialogBriefSet(1).CreatureTalking.Name = "DM" Then 
				picDialogBrief.Left = Me.ClientRectangle.Width - picDialogBrief.Width
			Else
				picDialogBrief.Left = Me.ClientRectangle.Width - picDialogBrief.Width
			End If
			' Make it visible
			picDialogBrief.Refresh()
			picDialogBrief.Visible = True
			picDialogBrief.BringToFront()
			TimeToRead = VB.Timer() + 5
			' [Titi 2.4.8] change duration if message for too heavy/too bulky
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogBriefSet().Text. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If VB.Right(DialogBriefSet(1).Text, 21) = "slows the party down." Then TimeToRead = VB.Timer() + 1
		End If
		If VB.Timer() > TimeToRead Then
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogBriefSet.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If DialogBriefSet.Count > 0 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object DialogBriefSet.Remove. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DialogBriefSet.Remove(1)
			End If
			TimeToRead = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object DialogBriefSet.Count. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If DialogBriefSet.Count = 0 Then
				picDialogBrief.Visible = False
				tmrDialogBrief.Enabled = False
			End If
		End If
	End Sub
	
	Private Sub tmrEncounterName_Tick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles tmrEncounterName.Tick
		Dim Frozen As Object
		Static LastX, LastY As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Frozen = False Then
			If System.Math.Abs(HintX - LastX) < 8 And System.Math.Abs(HintY - LastY) < 8 Then
				MessageEncounterName(HintX, HintY)
			Else
				MessageShow("", 0)
				LastX = HintX
				LastY = HintY
			End If
		End If
	End Sub
	
	Private Sub tmrKeyboardHandler_Tick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles tmrKeyboardHandler.Tick
		Dim modGameGeneral As Object
		' [Titi 2.4.9b] Added to deal with the Alt-Tab and Ctrl-Esc key combinations
		'UPGRADE_WARNING: Couldn't resolve default property of object modGameGeneral.HookKeyboard. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call modGameGeneral.HookKeyboard(False)
	End Sub
	
	Private Sub tmrMoveMap_Tick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles tmrMoveMap.Tick
		Dim Frozen As Object
		If Not Frozen And picGrid.Visible = False Then
			ScrollMap()
		End If
	End Sub
	
	Private Sub tmrMoveParty_Tick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles tmrMoveParty.Tick
		Dim Frozen As Object
		If Not Frozen And picGrid.Visible = False Then
			MoveParty()
		End If
	End Sub
	
	'UPGRADE_ISSUE: PictureBox event picGrid.KeyDown was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="ABD9AF39-7E24-4AFF-AD8D-3675C1AA3054"'
	Private Sub picGrid_KeyDown(ByRef KeyCode As Short, ByRef Shift As Short)
		' KeyBoardShortCuts KeyCode, Shift
		ParseShortCuts(KeyCode, Shift)
	End Sub
	
	Private Sub ShowMonster(ByRef CreatureX As Creature)
		Dim ConvoAction As Object
		Dim Frozen As Object
		Dim DialogSetButton As Object
		Dim bdFontSmallWhite As Object
		Dim bdFontNoxiousWhite As Object
		Dim bdFontElixirWhite As Object
		Dim bdDlgExamItem As Object
		Dim DialogSetUp As Object
		Dim CreatureNow As Object
		' [Titi 2.5.1] reminder: all values are x 100 (to get %)
		Dim LastY, PosY, c As Short
		Dim rc As Integer
		Dim sDifficulty As String
		Dim strSize(5) As String
		Dim intToHitX, intAttAvgX, intAttAvgNow, intToHitNow As Short
		Dim intArmorX, intDefX, intDefNow, intArmorNow As Short
		Const bdAvgDef As Short = 13
		strSize(5) = "Undefined" : strSize(4) = "Huge" : strSize(3) = "Large" : strSize(2) = "Normal" : strSize(1) = "Small" : strSize(0) = "Tiny"
		For c = 0 To 4
			If CreatureX.Size(c) < 0 Then Exit For ' keeps c as the index of the size
		Next 
		' [Titi 2.6.0] "undefined" size defaults to "normal"
		If c = 5 Then c = 3
		' get the average damage the creature can inflict
		intAttAvgX = GetWeaponDamage(CreatureX, intAttAvgX, intDefX)
		intAttAvgX = intAttAvgX + GetTriggersAttack(CreatureX)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		intAttAvgNow = GetWeaponDamage(CreatureNow, intAttAvgNow, intDefNow)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		intAttAvgNow = intAttAvgNow + GetTriggersAttack(CreatureNow)
		' get the protection of the creature
		intDefX = GetDefCoef(CreatureX, intArmorX, bdAvgDef)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		intDefNow = GetDefCoef(CreatureNow, intArmorNow, bdAvgDef)
		' probability of a hit against the opponent
		intToHitX = 5 * (20 + CreatureX.AttackBonus - intDefNow)
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.AttackBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		intToHitNow = 5 * (20 + CreatureNow.AttackBonus - intDefX)
		' percentage of damage taken by the armor and resistance bonus
		intArmorX = 200 - intArmorX
		intArmorNow = 200 - intArmorNow
		' now, let's deal with the division by 0 and negative values problems
		If intArmorX <= 0 Then intArmorX = 1
		If intArmorNow <= 0 Then intArmorNow = 1
		If intAttAvgX <= 0 Then intAttAvgX = 1
		If intAttAvgNow <= 0 Then intAttAvgNow = 1
		If intToHitNow <= 0 Then intToHitNow = 1
		If intToHitX <= 0 Then intToHitX = 1
		' compute difficulty level
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Index. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureX.Name = CreatureNow.Name And CreatureX.Index = CreatureNow.Index Then
			sDifficulty = "Level " & CreatureX.Level
			' in that case, use the standard monster as opponent --> recompute the probabilities
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			intDefNow = GetDefCoef(CreatureNow, intArmorNow, bdAvgDef)
			intDefNow = 5 * (20 - intDefNow)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.AttackBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			intToHitNow = 5 * (20 + CreatureNow.AttackBonus - bdAvgDef)
		Else
			'        rc = (100 * (CreatureX.HPMax / intAttAvgNow) / intToHitNow / intArmorX * (1 + (0.5 * CInt(CreatureNow.IsSpellCaster)))) / (100 * (CreatureNow.HPMax / intAttAvgX) / intToHitX * intArmorNow) * (1 + 0.5 * CInt(CreatureX.IsSpellCaster)) * 100
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.IsSpellCaster. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.HPMax. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rc = 100 * ((CreatureX.HPMax / (intAttAvgNow / 100 * intArmorX / 100 * intToHitNow / 100)) * (1 + 0.5 * CShort(CreatureX.IsSpellCaster)) / (CreatureNow.HPMax / (intAttAvgX / 100 * intArmorNow / 100 * intToHitX / 100)) * (1 + 0.5 * CShort(CreatureNow.IsSpellCaster)))
			Select Case rc
				Case 0 To 12
					sDifficulty = "Dangerous only if numerous"
				Case 13 To 39
					sDifficulty = "Easy"
				Case 40 To 79
					sDifficulty = "Could prove worthy"
				Case 80 To 120
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sDifficulty = "As powerful as " & CreatureNow.Name
				Case 121 To 159
					sDifficulty = "Mighty opponent"
				Case 160 To 249
					sDifficulty = "Difficult to overcome"
				Case 250 To 339
					sDifficulty = "Might prove challenging"
				Case 340 To 450
					sDifficulty = "Did you prepare your will?"
				Case Else
					sDifficulty = "Impossible!"
			End Select
		End If
		DialogSetUp(bdDlgExamItem)
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ShowText(picConvo, 0, 12, picConvo.Width, 14, bdFontElixirWhite, (CreatureX.Name), True, True)
		LastY = 32
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 10, LastY, picConvo.Width, 14, bdFontElixirWhite, "Difficulty factor", False, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 48, LastY, picConvo.Width, 14, bdFontNoxiousWhite, sDifficulty, False, True)
		LastY = LastY + PosY + 10
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontElixirWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 10, LastY, picConvo.Width, 14, bdFontElixirWhite, "Details", False, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 48, LastY, picConvo.Width, 10, bdFontNoxiousWhite, CreatureX.HPNow & "/" & CreatureX.HPMax & " HP, worth " & CreatureX.ExperiencePoints & " XP" & " moves " & CreatureX.ActionPoints & " AP", False, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 48, LastY, picConvo.Width, 10, bdFontNoxiousWhite, "Size " & strSize(c) & ", Status " & CreatureX.StatusText, False, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 48, LastY, picConvo.Width, 10, bdFontNoxiousWhite, "Average damage " & intAttAvgX / 100 & "; %To Hit " & IIf(sDifficulty Like "Level*", intToHitNow, intToHitX) & "; % Being hit " & IIf(sDifficulty Like "Level*", intDefNow, intDefX), False, True)
		LastY = LastY + PosY
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontNoxiousWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 48, LastY, picConvo.Width, 10, bdFontNoxiousWhite, "Str " & CreatureX.Strength + CreatureX.StrengthBonus & ", Int " & CreatureX.Will + CreatureX.WillBonus & ", Agl " & CreatureX.Agility + CreatureX.AgilityBonus, False, True)
		LastY = LastY + PosY + 10
		'UPGRADE_WARNING: Couldn't resolve default property of object bdFontSmallWhite. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		PosY = ShowText(picConvo, 10, LastY, picConvo.Width - 20, 30, bdFontSmallWhite, (CreatureX.Comments), False, True)
		DialogSetButton(1, "Done")
		ShowButton(picConvo, picConvo.Width - 6 - 96, picConvo.Height - 30, "Done", False)
		'UPGRADE_ISSUE: PictureBox property picConvo.hdc was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		rc = BitBlt(picConvo.hdc, 0, picConvo.Height - 6, picConvo.Width, 6, picConvo.hdc, 0, 0, SRCCOPY)
		picConvo.Refresh()
		picConvo.Visible = True
		picConvo.BringToFront()
		picConvo.Focus()
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = True
		'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ConvoAction = -1
		'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Do Until ConvoAction > -1
			System.Windows.Forms.Application.DoEvents()
		Loop 
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Frozen = False
		picConvo.Visible = False
	End Sub
	
	Private Sub picGrid_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picGrid.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Frozen As Object
		Dim CreatureWithTurn As Object
		Dim CreatureTarget As Object
		Dim ConvoAction As Object
		ClickX = X : ClickY = Y
		If MenuNow = bdMenuTargetCreature Or MenuNow = bdMenuTargetAny Or MenuNow = bdMenuTargetParty Then
			If Target > -1 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object ConvoAction. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ConvoAction = Target + 1
			End If
		ElseIf Not Frozen Then 
			If Button = VB6.MouseButtonConstants.RightButton Then
				If Target > -1 Then
					' [Titi 2.5.1] if shift is down, show target details
					If Shift And VB6.ShiftConstants.ShiftMask Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						ShowMonster(CreatureTarget)
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CreatureWithTurn.CreatureTarget = CreatureTarget
						MenuSkillUse(True)
					End If
				End If
			Else
				CombatPC()
			End If
		End If
	End Sub
	
	Private Sub picGrid_MouseMove(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles picGrid.MouseMove
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = eventArgs.X
		Dim Y As Single = eventArgs.Y
		Dim Frozen As Object
		If Not Frozen Or (MenuNow = bdMenuTargetCreature Or MenuNow = bdMenuTargetAny Or MenuNow = bdMenuTargetParty) Then
			CombatMouseX = X : CombatMouseY = Y
			CombatRectangle()
		End If
	End Sub
	
	Private Function CombatAllDead() As Short
		Dim Turns As Object
		Dim CreatureWithTurn As Object
		Dim c As Short
		' If all enemies are dead, end combat
		CombatAllDead = True
		For c = 0 To CombatTurn
			'UPGRADE_WARNING: Couldn't resolve default property of object Turns(c).Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.Friendly <> Turns(c).Ref.Friendly And Turns(c).Ref.HPNow > 0 And Turns(c).Ref.IsInanimate = False Then
				CombatAllDead = False
				Exit For
			End If
		Next c
	End Function
	
	Private Sub CombatPC()
		Dim Turns As Object
		Dim FireTriggers As Object
		Dim CreatureNow As Object
		Dim ItemNow As Object
		Dim CreatureTarget As Object
		Dim CreatureWithTurn As Object
		Dim OverSwing, c, NoFail, OldActionPoints As Short
		Dim ItemX As Item
		Dim Movement, Distance, MinRange, MaxRange As Short
		Dim Distance2, n, Distance1, Found As Short
		Dim CreatureX As Creature
		' If targeting something, then roll to hit
		If Target > -1 Then
			' If weapon in hand is a shoot and have no ammo, doesn't work and abort combat
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If CreatureWithTurn.ItemInHand.IsShooter = True Then
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.ItemAmmo.Index = CreatureWithTurn.ItemInHand.Index And CreatureWithTurn.ItemAmmo.Name = CreatureWithTurn.ItemInHand.Name Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CombatMessage(CreatureWithTurn.ItemInHand.Name & " out of ammo")
					Exit Sub
				End If
			End If
			' Compute (DistanceToTarget - Range - Movement)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Distance = CombatRange(CreatureWithTurn, CreatureTarget.Col, CreatureTarget.Row)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemMinRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MinRange = Greatest(CreatureWithTurn.ItemMinRange, TargetCreatureRange)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemMaxRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			MaxRange = Greatest(CreatureWithTurn.ItemMaxRange, TargetCreatureRange)
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MovementRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Movement = Greatest(CreatureWithTurn.MovementRange, 1)
			If Distance > MaxRange Then
				' CombatMove bdMoveToward, bdMoveTarget [Titi 2.6.0] Medium range bug: without the distance, the character will move as close as possible
				CombatMove(MOVEDIRECTION.bdMoveToward, MOVEMOTIVE.bdMoveTarget, Distance)
			ElseIf Distance < MinRange Then 
				' CombatMove bdMoveAway, bdMoveTarget [Titi 2.6.0] Medium range bug: without the distance, the character will move as far as possible
				CombatMove(MOVEDIRECTION.bdMoveAway, MOVEMOTIVE.bdMoveTarget, Distance)
			End If
			' Compute new distance after move
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Row. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Col. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Distance = CombatRange(CreatureWithTurn, CreatureTarget.Col, CreatureTarget.Row)
			' Compute Overswing penalty or message
			OverSwing = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If (CreatureWithTurn.ActionPoints - CreatureWithTurn.ItemInHand.ActionPoints < 0) Or (CreatureWithTurn.ItemInHand.ActionPoints = 0 And CreatureWithTurn.ActionPoints < 10) Then
				' Compute over swing penalty or required action points
				If GlobalOverSwing = 1 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.ItemInHand.ActionPoints = 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						OverSwing = CreatureWithTurn.ActionPoints - 10
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						OverSwing = CreatureWithTurn.ActionPoints - CreatureWithTurn.ItemInHand.ActionPoints
					End If
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If CreatureWithTurn.ItemInHand.ActionPoints = 0 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.ItemInHand.Name & " requires 10 Action Points")
					Else
						'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						CombatMessage(CreatureWithTurn.ItemInHand.Name & " requires " & CreatureWithTurn.ItemInHand.ActionPoints & " Action Points")
					End If
					Distance = MaxRange + 1
				End If
			End If
			' If now in range, attack
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureTarget.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Distance <= MaxRange And Distance >= MinRange And CreatureWithTurn.Friendly <> CreatureTarget.Friendly Then
				' Remove ActionPoints
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.ItemInHand.ActionPoints = 0 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.ActionPoints = CreatureWithTurn.ActionPoints - 10
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.ActionPoints = CreatureWithTurn.ActionPoints - CreatureWithTurn.ItemInHand.ActionPoints
				End If
				CombatDraw()
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemNow = CreatureWithTurn.ItemInHand
				' Begin Attack
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CombatMessage(CreatureWithTurn.ItemInHand.Name & " Attack")
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				PlaySFXItem(CreatureWithTurn)
				'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.AttackBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CombatRollAttack(Greatest(CreatureWithTurn.ItemAmmo.DamageType, 0), ItemNow.AttackBonus + OverSwing) = True Then
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureNow.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object ItemNow.DamageBonus. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					c = CombatRollDamage(bdContextDice, CreatureWithTurn.ItemAmmo.Damage - 1, Greatest(CreatureNow.ItemAmmo.DamageType, 0), True, ItemNow.DamageBonus + CreatureNow.ItemAmmo.DamageBonus * (CreatureNow.ItemAmmo.IsAmmo)) ' [Titi 2.4.9b] ItemAmmo is ItemNow if not a shooter! Don't add its bonus twice!!!
				Else
					CombatMessage("Miss")
					' [Titi 2.6.0] update stats
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Infos. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					CreatureWithTurn.Infos.Misses = CreatureWithTurn.Infos.Misses + 1
				End If
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.UseAmmo. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureWithTurn.UseAmmo()
				CombatDraw()
				' Fire Post-Attack Triggers
				CreatureNow = CreatureWithTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				ItemNow = CreatureWithTurn.ItemInHand
				'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				NoFail = FireTriggers(CreatureWithTurn, bdPostAttack)
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Items. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				For	Each ItemX In CreatureWithTurn.Items
					If ItemX.IsReady = True Then
						CreatureNow = CreatureWithTurn
						ItemNow = ItemX
						'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						NoFail = FireTriggers(ItemX, bdPostAttack)
					End If
				Next ItemX
			End If
		Else
			CombatMove(MOVEDIRECTION.bdMoveClick, MOVEDIRECTION.bdMoveClick)
		End If
		' Check if all opponents are dead or not
		If CombatAllDead = True Then
			CombatNextTurn()
			Exit Sub
		End If
		' If out of ActionPoints, go to next turn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ActionPoints. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.ActionPoints < 1 Then
			CombatNextTurn()
			Exit Sub
		ElseIf GlobalAutoEndTurn > 0 Then 
			' Determine if enemy exists within weapon range
			Found = False
			For c = 0 To CombatTurn
				'UPGRADE_WARNING: Couldn't resolve default property of object Turns().Ref. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CreatureX = Turns(c).Ref
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				CombatFindPath(CreatureWithTurn, CreatureX.Col, CreatureX.Row)
				' Distance1 is from where CreatureWithTurn can move to
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MovementRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If CreatureWithTurn.MovementRange < 1 Or CombatStepTop < 0 Then
					Distance1 = 999
				Else
					'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.MovementRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					n = Greatest(CombatStepTop - CreatureWithTurn.MovementRange, 0)
					'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Distance1 = CombatRange(CreatureX, CombatStepCol(n), CombatStepRow(n))
				End If
				' Distance2 is from where CreatureWithTurn is standing
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				'UPGRADE_WARNING: Couldn't resolve default property of object CombatRange(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Distance2 = CombatRange(CreatureWithTurn, (CreatureX.Col), (CreatureX.Row))
				' MaxRange is the ItemInHand.MaxRange
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemMaxRange. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				MaxRange = CreatureWithTurn.ItemMaxRange
				'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Friendly. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If (Distance1 <= MaxRange Or Distance2 <= MaxRange) And CreatureWithTurn.Friendly <> CreatureX.Friendly Then
					Found = True
					Exit For
				End If
			Next c
			If Not Found Then
				CombatNextTurn()
				Exit Sub
			End If
		End If
	End Sub
	
	'UPGRADE_NOTE: Tome was upgraded to Tome_Renamed. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A9E4979A-37FA-4718-9994-97DD76ED70A7"'
	Private Sub RealTimeTicks()
		Dim Tome_Renamed As Object
		Dim GlobalTicks As Object
		Static c As Short
		'UPGRADE_WARNING: Couldn't resolve default property of object GlobalTicks. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		GlobalTicks = LoopNumber(0, 9999, GlobalTicks, 1)
		c = c + 1
		If c > 9 Then
			c = 0
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealSeconds. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			Tome.RealSeconds = Tome.RealSeconds + 1
			'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealSeconds. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			If Tome.RealSeconds > 59 Then
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealSeconds. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.RealSeconds = 1
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealMinutes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Tome.RealMinutes = Tome.RealMinutes + 1
				'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealMinutes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If Tome.RealMinutes > 59 Then
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealMinutes. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Tome.RealMinutes = 1
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealHours. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					Tome.RealHours = Tome.RealHours + 1
					'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealHours. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If Tome.RealHours > 23 Then
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealHours. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Tome.RealHours = 1
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealDays. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						Tome.RealDays = Tome.RealDays + 1
						'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealDays. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Tome.RealDays > 10000 Then
							'UPGRADE_WARNING: Couldn't resolve default property of object Tome.RealDays. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							Tome.RealDays = 1
						End If
					End If
				End If
			End If
		End If
	End Sub
	
	Private Sub RealTimeEvent()
		Dim EncounterNow As Object
		Dim FireTriggers As Object
		Dim ItemNow As Object
		Dim CreatureNow As Object
		Dim CreatureWithTurn As Object
		Dim NoFail As Short
		' [Titi 2.4.9b] No need if the game has not started yet! Besides, it prevents the user from creating several new characters in a row!
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If CreatureWithTurn.Name = "Creature" Then Exit Sub
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(Tome, bdOnRealTime)
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(EncounterNow, bdOnRealTime)
		CreatureNow = CreatureWithTurn
		'UPGRADE_WARNING: Couldn't resolve default property of object CreatureWithTurn.ItemInHand. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		ItemNow = CreatureWithTurn.ItemInHand
		'UPGRADE_WARNING: Couldn't resolve default property of object FireTriggers(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		NoFail = FireTriggers(CreatureWithTurn, bdOnRealTime)
		EncounterNow = EncNow ' [Titi 2.5.1] reset EncounterNow to what it should be (if RealTimeEvent was run at the same time as EnterEncounter, it would have used the previous EncounterNow!)
	End Sub
	
	Private Sub tmrOnRealTime_Tick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles tmrOnRealTime.Tick
		Dim Frozen As Object
		'UPGRADE_WARNING: Couldn't resolve default property of object Frozen. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		If Frozen = False Then
			RealTimeEvent()
			RealTimeTicks()
		End If
	End Sub
	
	Public Sub UpdateListEncounterTarget(ByRef EncounterX As Encounter)
		intCountEncounterTarget = intCountEncounterTarget + 1
		ListEncounterTarget(intCountEncounterTarget) = EncounterX
	End Sub
End Class